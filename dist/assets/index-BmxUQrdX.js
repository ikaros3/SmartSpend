(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=t(a);fetch(a.href,s)}})();var Y1={exports:{}},nh={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var KE;function qD(){if(KE)return nh;KE=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,a,s){var l=null;if(s!==void 0&&(l=""+s),a.key!==void 0&&(l=""+a.key),"key"in a){s={};for(var u in a)u!=="key"&&(s[u]=a[u])}else s=a;return a=s.ref,{$$typeof:r,type:n,key:l,ref:a!==void 0?a:null,props:s}}return nh.Fragment=e,nh.jsx=t,nh.jsxs=t,nh}var XE;function KD(){return XE||(XE=1,Y1.exports=qD()),Y1.exports}var B=KD(),$1={exports:{}},ht={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var WE;function XD(){if(WE)return ht;WE=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),_=Symbol.iterator;function y(Q){return Q===null||typeof Q!="object"?null:(Q=_&&Q[_]||Q["@@iterator"],typeof Q=="function"?Q:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},T=Object.assign,S={};function O(Q,N,J){this.props=Q,this.context=N,this.refs=S,this.updater=J||w}O.prototype.isReactComponent={},O.prototype.setState=function(Q,N){if(typeof Q!="object"&&typeof Q!="function"&&Q!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Q,N,"setState")},O.prototype.forceUpdate=function(Q){this.updater.enqueueForceUpdate(this,Q,"forceUpdate")};function U(){}U.prototype=O.prototype;function R(Q,N,J){this.props=Q,this.context=N,this.refs=S,this.updater=J||w}var Y=R.prototype=new U;Y.constructor=R,T(Y,O.prototype),Y.isPureReactComponent=!0;var te=Array.isArray;function G(){}var A={H:null,A:null,T:null,S:null},C=Object.prototype.hasOwnProperty;function k(Q,N,J){var X=J.ref;return{$$typeof:r,type:Q,key:N,ref:X!==void 0?X:null,props:J}}function V(Q,N){return k(Q.type,N,Q.props)}function F(Q){return typeof Q=="object"&&Q!==null&&Q.$$typeof===r}function M(Q){var N={"=":"=0",":":"=2"};return"$"+Q.replace(/[=:]/g,function(J){return N[J]})}var L=/\/+/g;function Ie(Q,N){return typeof Q=="object"&&Q!==null&&Q.key!=null?M(""+Q.key):N.toString(36)}function Re(Q){switch(Q.status){case"fulfilled":return Q.value;case"rejected":throw Q.reason;default:switch(typeof Q.status=="string"?Q.then(G,G):(Q.status="pending",Q.then(function(N){Q.status==="pending"&&(Q.status="fulfilled",Q.value=N)},function(N){Q.status==="pending"&&(Q.status="rejected",Q.reason=N)})),Q.status){case"fulfilled":return Q.value;case"rejected":throw Q.reason}}throw Q}function ae(Q,N,J,X,ee){var ce=typeof Q;(ce==="undefined"||ce==="boolean")&&(Q=null);var we=!1;if(Q===null)we=!0;else switch(ce){case"bigint":case"string":case"number":we=!0;break;case"object":switch(Q.$$typeof){case r:case e:we=!0;break;case m:return we=Q._init,ae(we(Q._payload),N,J,X,ee)}}if(we)return ee=ee(Q),we=X===""?"."+Ie(Q,0):X,te(ee)?(J="",we!=null&&(J=we.replace(L,"$&/")+"/"),ae(ee,N,J,"",function(Oe){return Oe})):ee!=null&&(F(ee)&&(ee=V(ee,J+(ee.key==null||Q&&Q.key===ee.key?"":(""+ee.key).replace(L,"$&/")+"/")+we)),N.push(ee)),1;we=0;var De=X===""?".":X+":";if(te(Q))for(var Ae=0;Ae<Q.length;Ae++)X=Q[Ae],ce=De+Ie(X,Ae),we+=ae(X,N,J,ce,ee);else if(Ae=y(Q),typeof Ae=="function")for(Q=Ae.call(Q),Ae=0;!(X=Q.next()).done;)X=X.value,ce=De+Ie(X,Ae++),we+=ae(X,N,J,ce,ee);else if(ce==="object"){if(typeof Q.then=="function")return ae(Re(Q),N,J,X,ee);throw N=String(Q),Error("Objects are not valid as a React child (found: "+(N==="[object Object]"?"object with keys {"+Object.keys(Q).join(", ")+"}":N)+"). If you meant to render a collection of children, use an array instead.")}return we}function le(Q,N,J){if(Q==null)return Q;var X=[],ee=0;return ae(Q,X,"","",function(ce){return N.call(J,ce,ee++)}),X}function Fe(Q){if(Q._status===-1){var N=Q._result;N=N(),N.then(function(J){(Q._status===0||Q._status===-1)&&(Q._status=1,Q._result=J)},function(J){(Q._status===0||Q._status===-1)&&(Q._status=2,Q._result=J)}),Q._status===-1&&(Q._status=0,Q._result=N)}if(Q._status===1)return Q._result.default;throw Q._result}var ie=typeof reportError=="function"?reportError:function(Q){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var N=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Q=="object"&&Q!==null&&typeof Q.message=="string"?String(Q.message):String(Q),error:Q});if(!window.dispatchEvent(N))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Q);return}console.error(Q)},Ne={map:le,forEach:function(Q,N,J){le(Q,function(){N.apply(this,arguments)},J)},count:function(Q){var N=0;return le(Q,function(){N++}),N},toArray:function(Q){return le(Q,function(N){return N})||[]},only:function(Q){if(!F(Q))throw Error("React.Children.only expected to receive a single React element child.");return Q}};return ht.Activity=x,ht.Children=Ne,ht.Component=O,ht.Fragment=t,ht.Profiler=a,ht.PureComponent=R,ht.StrictMode=n,ht.Suspense=f,ht.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,ht.__COMPILER_RUNTIME={__proto__:null,c:function(Q){return A.H.useMemoCache(Q)}},ht.cache=function(Q){return function(){return Q.apply(null,arguments)}},ht.cacheSignal=function(){return null},ht.cloneElement=function(Q,N,J){if(Q==null)throw Error("The argument must be a React element, but you passed "+Q+".");var X=T({},Q.props),ee=Q.key;if(N!=null)for(ce in N.key!==void 0&&(ee=""+N.key),N)!C.call(N,ce)||ce==="key"||ce==="__self"||ce==="__source"||ce==="ref"&&N.ref===void 0||(X[ce]=N[ce]);var ce=arguments.length-2;if(ce===1)X.children=J;else if(1<ce){for(var we=Array(ce),De=0;De<ce;De++)we[De]=arguments[De+2];X.children=we}return k(Q.type,ee,X)},ht.createContext=function(Q){return Q={$$typeof:l,_currentValue:Q,_currentValue2:Q,_threadCount:0,Provider:null,Consumer:null},Q.Provider=Q,Q.Consumer={$$typeof:s,_context:Q},Q},ht.createElement=function(Q,N,J){var X,ee={},ce=null;if(N!=null)for(X in N.key!==void 0&&(ce=""+N.key),N)C.call(N,X)&&X!=="key"&&X!=="__self"&&X!=="__source"&&(ee[X]=N[X]);var we=arguments.length-2;if(we===1)ee.children=J;else if(1<we){for(var De=Array(we),Ae=0;Ae<we;Ae++)De[Ae]=arguments[Ae+2];ee.children=De}if(Q&&Q.defaultProps)for(X in we=Q.defaultProps,we)ee[X]===void 0&&(ee[X]=we[X]);return k(Q,ce,ee)},ht.createRef=function(){return{current:null}},ht.forwardRef=function(Q){return{$$typeof:u,render:Q}},ht.isValidElement=F,ht.lazy=function(Q){return{$$typeof:m,_payload:{_status:-1,_result:Q},_init:Fe}},ht.memo=function(Q,N){return{$$typeof:d,type:Q,compare:N===void 0?null:N}},ht.startTransition=function(Q){var N=A.T,J={};A.T=J;try{var X=Q(),ee=A.S;ee!==null&&ee(J,X),typeof X=="object"&&X!==null&&typeof X.then=="function"&&X.then(G,ie)}catch(ce){ie(ce)}finally{N!==null&&J.types!==null&&(N.types=J.types),A.T=N}},ht.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},ht.use=function(Q){return A.H.use(Q)},ht.useActionState=function(Q,N,J){return A.H.useActionState(Q,N,J)},ht.useCallback=function(Q,N){return A.H.useCallback(Q,N)},ht.useContext=function(Q){return A.H.useContext(Q)},ht.useDebugValue=function(){},ht.useDeferredValue=function(Q,N){return A.H.useDeferredValue(Q,N)},ht.useEffect=function(Q,N){return A.H.useEffect(Q,N)},ht.useEffectEvent=function(Q){return A.H.useEffectEvent(Q)},ht.useId=function(){return A.H.useId()},ht.useImperativeHandle=function(Q,N,J){return A.H.useImperativeHandle(Q,N,J)},ht.useInsertionEffect=function(Q,N){return A.H.useInsertionEffect(Q,N)},ht.useLayoutEffect=function(Q,N){return A.H.useLayoutEffect(Q,N)},ht.useMemo=function(Q,N){return A.H.useMemo(Q,N)},ht.useOptimistic=function(Q,N){return A.H.useOptimistic(Q,N)},ht.useReducer=function(Q,N,J){return A.H.useReducer(Q,N,J)},ht.useRef=function(Q){return A.H.useRef(Q)},ht.useState=function(Q){return A.H.useState(Q)},ht.useSyncExternalStore=function(Q,N,J){return A.H.useSyncExternalStore(Q,N,J)},ht.useTransition=function(){return A.H.useTransition()},ht.version="19.2.3",ht}var YE;function Av(){return YE||(YE=1,$1.exports=XD()),$1.exports}var Qe=Av(),Q1={exports:{}},ah={},J1={exports:{}},Z1={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $E;function WD(){return $E||($E=1,(function(r){function e(ae,le){var Fe=ae.length;ae.push(le);e:for(;0<Fe;){var ie=Fe-1>>>1,Ne=ae[ie];if(0<a(Ne,le))ae[ie]=le,ae[Fe]=Ne,Fe=ie;else break e}}function t(ae){return ae.length===0?null:ae[0]}function n(ae){if(ae.length===0)return null;var le=ae[0],Fe=ae.pop();if(Fe!==le){ae[0]=Fe;e:for(var ie=0,Ne=ae.length,Q=Ne>>>1;ie<Q;){var N=2*(ie+1)-1,J=ae[N],X=N+1,ee=ae[X];if(0>a(J,Fe))X<Ne&&0>a(ee,J)?(ae[ie]=ee,ae[X]=Fe,ie=X):(ae[ie]=J,ae[N]=Fe,ie=N);else if(X<Ne&&0>a(ee,Fe))ae[ie]=ee,ae[X]=Fe,ie=X;else break e}}return le}function a(ae,le){var Fe=ae.sortIndex-le.sortIndex;return Fe!==0?Fe:ae.id-le.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;r.unstable_now=function(){return s.now()}}else{var l=Date,u=l.now();r.unstable_now=function(){return l.now()-u}}var f=[],d=[],m=1,x=null,_=3,y=!1,w=!1,T=!1,S=!1,O=typeof setTimeout=="function"?setTimeout:null,U=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;function Y(ae){for(var le=t(d);le!==null;){if(le.callback===null)n(d);else if(le.startTime<=ae)n(d),le.sortIndex=le.expirationTime,e(f,le);else break;le=t(d)}}function te(ae){if(T=!1,Y(ae),!w)if(t(f)!==null)w=!0,G||(G=!0,M());else{var le=t(d);le!==null&&Re(te,le.startTime-ae)}}var G=!1,A=-1,C=5,k=-1;function V(){return S?!0:!(r.unstable_now()-k<C)}function F(){if(S=!1,G){var ae=r.unstable_now();k=ae;var le=!0;try{e:{w=!1,T&&(T=!1,U(A),A=-1),y=!0;var Fe=_;try{t:{for(Y(ae),x=t(f);x!==null&&!(x.expirationTime>ae&&V());){var ie=x.callback;if(typeof ie=="function"){x.callback=null,_=x.priorityLevel;var Ne=ie(x.expirationTime<=ae);if(ae=r.unstable_now(),typeof Ne=="function"){x.callback=Ne,Y(ae),le=!0;break t}x===t(f)&&n(f),Y(ae)}else n(f);x=t(f)}if(x!==null)le=!0;else{var Q=t(d);Q!==null&&Re(te,Q.startTime-ae),le=!1}}break e}finally{x=null,_=Fe,y=!1}le=void 0}}finally{le?M():G=!1}}}var M;if(typeof R=="function")M=function(){R(F)};else if(typeof MessageChannel<"u"){var L=new MessageChannel,Ie=L.port2;L.port1.onmessage=F,M=function(){Ie.postMessage(null)}}else M=function(){O(F,0)};function Re(ae,le){A=O(function(){ae(r.unstable_now())},le)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(ae){ae.callback=null},r.unstable_forceFrameRate=function(ae){0>ae||125<ae?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<ae?Math.floor(1e3/ae):5},r.unstable_getCurrentPriorityLevel=function(){return _},r.unstable_next=function(ae){switch(_){case 1:case 2:case 3:var le=3;break;default:le=_}var Fe=_;_=le;try{return ae()}finally{_=Fe}},r.unstable_requestPaint=function(){S=!0},r.unstable_runWithPriority=function(ae,le){switch(ae){case 1:case 2:case 3:case 4:case 5:break;default:ae=3}var Fe=_;_=ae;try{return le()}finally{_=Fe}},r.unstable_scheduleCallback=function(ae,le,Fe){var ie=r.unstable_now();switch(typeof Fe=="object"&&Fe!==null?(Fe=Fe.delay,Fe=typeof Fe=="number"&&0<Fe?ie+Fe:ie):Fe=ie,ae){case 1:var Ne=-1;break;case 2:Ne=250;break;case 5:Ne=1073741823;break;case 4:Ne=1e4;break;default:Ne=5e3}return Ne=Fe+Ne,ae={id:m++,callback:le,priorityLevel:ae,startTime:Fe,expirationTime:Ne,sortIndex:-1},Fe>ie?(ae.sortIndex=Fe,e(d,ae),t(f)===null&&ae===t(d)&&(T?(U(A),A=-1):T=!0,Re(te,Fe-ie))):(ae.sortIndex=Ne,e(f,ae),w||y||(w=!0,G||(G=!0,M()))),ae},r.unstable_shouldYield=V,r.unstable_wrapCallback=function(ae){var le=_;return function(){var Fe=_;_=le;try{return ae.apply(this,arguments)}finally{_=Fe}}}})(Z1)),Z1}var QE;function YD(){return QE||(QE=1,J1.exports=WD()),J1.exports}var ex={exports:{}},Sn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var JE;function $D(){if(JE)return Sn;JE=1;var r=Av();function e(f){var d="https://react.dev/errors/"+f;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)d+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+f+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function s(f,d,m){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:x==null?null:""+x,children:f,containerInfo:d,implementation:m}}var l=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(f,d){if(f==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Sn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Sn.createPortal=function(f,d){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return s(f,d,null,m)},Sn.flushSync=function(f){var d=l.T,m=n.p;try{if(l.T=null,n.p=2,f)return f()}finally{l.T=d,n.p=m,n.d.f()}},Sn.preconnect=function(f,d){typeof f=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,n.d.C(f,d))},Sn.prefetchDNS=function(f){typeof f=="string"&&n.d.D(f)},Sn.preinit=function(f,d){if(typeof f=="string"&&d&&typeof d.as=="string"){var m=d.as,x=u(m,d.crossOrigin),_=typeof d.integrity=="string"?d.integrity:void 0,y=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;m==="style"?n.d.S(f,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:x,integrity:_,fetchPriority:y}):m==="script"&&n.d.X(f,{crossOrigin:x,integrity:_,fetchPriority:y,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Sn.preinitModule=function(f,d){if(typeof f=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var m=u(d.as,d.crossOrigin);n.d.M(f,{crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&n.d.M(f)},Sn.preload=function(f,d){if(typeof f=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var m=d.as,x=u(m,d.crossOrigin);n.d.L(f,m,{crossOrigin:x,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Sn.preloadModule=function(f,d){if(typeof f=="string")if(d){var m=u(d.as,d.crossOrigin);n.d.m(f,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else n.d.m(f)},Sn.requestFormReset=function(f){n.d.r(f)},Sn.unstable_batchedUpdates=function(f,d){return f(d)},Sn.useFormState=function(f,d,m){return l.H.useFormState(f,d,m)},Sn.useFormStatus=function(){return l.H.useHostTransitionStatus()},Sn.version="19.2.3",Sn}var ZE;function QD(){if(ZE)return ex.exports;ZE=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),ex.exports=$D(),ex.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ew;function JD(){if(ew)return ah;ew=1;var r=YD(),e=Av(),t=QD();function n(i){var o="https://react.dev/errors/"+i;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)o+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function s(i){var o=i,c=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,(o.flags&4098)!==0&&(c=o.return),i=o.return;while(i)}return o.tag===3?c:null}function l(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function u(i){if(i.tag===31){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function f(i){if(s(i)!==i)throw Error(n(188))}function d(i){var o=i.alternate;if(!o){if(o=s(i),o===null)throw Error(n(188));return o!==i?null:i}for(var c=i,h=o;;){var g=c.return;if(g===null)break;var v=g.alternate;if(v===null){if(h=g.return,h!==null){c=h;continue}break}if(g.child===v.child){for(v=g.child;v;){if(v===c)return f(g),i;if(v===h)return f(g),o;v=v.sibling}throw Error(n(188))}if(c.return!==h.return)c=g,h=v;else{for(var b=!1,P=g.child;P;){if(P===c){b=!0,c=g,h=v;break}if(P===h){b=!0,h=g,c=v;break}P=P.sibling}if(!b){for(P=v.child;P;){if(P===c){b=!0,c=v,h=g;break}if(P===h){b=!0,h=v,c=g;break}P=P.sibling}if(!b)throw Error(n(189))}}if(c.alternate!==h)throw Error(n(190))}if(c.tag!==3)throw Error(n(188));return c.stateNode.current===c?i:o}function m(i){var o=i.tag;if(o===5||o===26||o===27||o===6)return i;for(i=i.child;i!==null;){if(o=m(i),o!==null)return o;i=i.sibling}return null}var x=Object.assign,_=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),T=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),O=Symbol.for("react.profiler"),U=Symbol.for("react.consumer"),R=Symbol.for("react.context"),Y=Symbol.for("react.forward_ref"),te=Symbol.for("react.suspense"),G=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),C=Symbol.for("react.lazy"),k=Symbol.for("react.activity"),V=Symbol.for("react.memo_cache_sentinel"),F=Symbol.iterator;function M(i){return i===null||typeof i!="object"?null:(i=F&&i[F]||i["@@iterator"],typeof i=="function"?i:null)}var L=Symbol.for("react.client.reference");function Ie(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===L?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case T:return"Fragment";case O:return"Profiler";case S:return"StrictMode";case te:return"Suspense";case G:return"SuspenseList";case k:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case w:return"Portal";case R:return i.displayName||"Context";case U:return(i._context.displayName||"Context")+".Consumer";case Y:var o=i.render;return i=i.displayName,i||(i=o.displayName||o.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case A:return o=i.displayName||null,o!==null?o:Ie(i.type)||"Memo";case C:o=i._payload,i=i._init;try{return Ie(i(o))}catch{}}return null}var Re=Array.isArray,ae=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,le=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Fe={pending:!1,data:null,method:null,action:null},ie=[],Ne=-1;function Q(i){return{current:i}}function N(i){0>Ne||(i.current=ie[Ne],ie[Ne]=null,Ne--)}function J(i,o){Ne++,ie[Ne]=i.current,i.current=o}var X=Q(null),ee=Q(null),ce=Q(null),we=Q(null);function De(i,o){switch(J(ce,o),J(ee,i),J(X,null),o.nodeType){case 9:case 11:i=(i=o.documentElement)&&(i=i.namespaceURI)?pE(i):0;break;default:if(i=o.tagName,o=o.namespaceURI)o=pE(o),i=gE(o,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}N(X),J(X,i)}function Ae(){N(X),N(ee),N(ce)}function Oe(i){i.memoizedState!==null&&J(we,i);var o=X.current,c=gE(o,i.type);o!==c&&(J(ee,i),J(X,c))}function st(i){ee.current===i&&(N(X),N(ee)),we.current===i&&(N(we),Zf._currentValue=Fe)}var Z,Ft;function lt(i){if(Z===void 0)try{throw Error()}catch(c){var o=c.stack.trim().match(/\n( *(at )?)/);Z=o&&o[1]||"",Ft=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Z+i+Ft}var Rt=!1;function ct(i,o){if(!i||Rt)return"";Rt=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(o){var be=function(){throw Error()};if(Object.defineProperty(be.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(be,[])}catch(_e){var xe=_e}Reflect.construct(i,[],be)}else{try{be.call()}catch(_e){xe=_e}i.call(be.prototype)}}else{try{throw Error()}catch(_e){xe=_e}(be=i())&&typeof be.catch=="function"&&be.catch(function(){})}}catch(_e){if(_e&&xe&&typeof _e.stack=="string")return[_e.stack,xe.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var v=h.DetermineComponentFrameRoot(),b=v[0],P=v[1];if(b&&P){var re=b.split(`
`),me=P.split(`
`);for(g=h=0;h<re.length&&!re[h].includes("DetermineComponentFrameRoot");)h++;for(;g<me.length&&!me[g].includes("DetermineComponentFrameRoot");)g++;if(h===re.length||g===me.length)for(h=re.length-1,g=me.length-1;1<=h&&0<=g&&re[h]!==me[g];)g--;for(;1<=h&&0<=g;h--,g--)if(re[h]!==me[g]){if(h!==1||g!==1)do if(h--,g--,0>g||re[h]!==me[g]){var Ee=`
`+re[h].replace(" at new "," at ");return i.displayName&&Ee.includes("<anonymous>")&&(Ee=Ee.replace("<anonymous>",i.displayName)),Ee}while(1<=h&&0<=g);break}}}finally{Rt=!1,Error.prepareStackTrace=c}return(c=i?i.displayName||i.name:"")?lt(c):""}function He(i,o){switch(i.tag){case 26:case 27:case 5:return lt(i.type);case 16:return lt("Lazy");case 13:return i.child!==o&&o!==null?lt("Suspense Fallback"):lt("Suspense");case 19:return lt("SuspenseList");case 0:case 15:return ct(i.type,!1);case 11:return ct(i.type.render,!1);case 1:return ct(i.type,!0);case 31:return lt("Activity");default:return""}}function sr(i){try{var o="",c=null;do o+=He(i,c),c=i,i=i.return;while(i);return o}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}var Dt=Object.prototype.hasOwnProperty,zt=r.unstable_scheduleCallback,rn=r.unstable_cancelCallback,Qi=r.unstable_shouldYield,sa=r.unstable_requestPaint,jt=r.unstable_now,un=r.unstable_getCurrentPriorityLevel,Xn=r.unstable_ImmediatePriority,ri=r.unstable_UserBlockingPriority,gr=r.unstable_NormalPriority,Wn=r.unstable_LowPriority,dt=r.unstable_IdlePriority,cr=r.log,fn=r.unstable_setDisableYieldValue,Vt=null,ur=null;function Ln(i){if(typeof cr=="function"&&fn(i),ur&&typeof ur.setStrictMode=="function")try{ur.setStrictMode(Vt,i)}catch{}}var Tr=Math.clz32?Math.clz32:Qo,_c=Math.log,Ji=Math.LN2;function Qo(i){return i>>>=0,i===0?32:31-(_c(i)/Ji|0)|0}var oa=256,Zi=262144,br=4194304;function Vn(i){var o=i&42;if(o!==0)return o;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function Ca(i,o,c){var h=i.pendingLanes;if(h===0)return 0;var g=0,v=i.suspendedLanes,b=i.pingedLanes;i=i.warmLanes;var P=h&134217727;return P!==0?(h=P&~v,h!==0?g=Vn(h):(b&=P,b!==0?g=Vn(b):c||(c=P&~i,c!==0&&(g=Vn(c))))):(P=h&~v,P!==0?g=Vn(P):b!==0?g=Vn(b):c||(c=h&~i,c!==0&&(g=Vn(c)))),g===0?0:o!==0&&o!==g&&(o&v)===0&&(v=g&-g,c=o&-o,v>=c||v===32&&(c&4194048)!==0)?o:g}function la(i,o){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&o)===0}function cf(i,o){switch(i){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function yc(){var i=br;return br<<=1,(br&62914560)===0&&(br=4194304),i}function Ra(i){for(var o=[],c=0;31>c;c++)o.push(i);return o}function es(i,o){i.pendingLanes|=o,o!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function uf(i,o,c,h,g,v){var b=i.pendingLanes;i.pendingLanes=c,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=c,i.entangledLanes&=c,i.errorRecoveryDisabledLanes&=c,i.shellSuspendCounter=0;var P=i.entanglements,re=i.expirationTimes,me=i.hiddenUpdates;for(c=b&~c;0<c;){var Ee=31-Tr(c),be=1<<Ee;P[Ee]=0,re[Ee]=-1;var xe=me[Ee];if(xe!==null)for(me[Ee]=null,Ee=0;Ee<xe.length;Ee++){var _e=xe[Ee];_e!==null&&(_e.lane&=-536870913)}c&=~be}h!==0&&ts(i,h,0),v!==0&&g===0&&i.tag!==0&&(i.suspendedLanes|=v&~(b&~o))}function ts(i,o,c){i.pendingLanes|=o,i.suspendedLanes&=~o;var h=31-Tr(o);i.entangledLanes|=o,i.entanglements[h]=i.entanglements[h]|1073741824|c&261930}function rs(i,o){var c=i.entangledLanes|=o;for(i=i.entanglements;c;){var h=31-Tr(c),g=1<<h;g&o|i[h]&o&&(i[h]|=o),c&=~g}}function Jo(i,o){var c=o&-o;return c=(c&42)!==0?1:ns(c),(c&(i.suspendedLanes|o))!==0?0:c}function ns(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function ni(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function D(){var i=le.p;return i!==0?i:(i=window.event,i===void 0?32:BE(i.type))}function K(i,o){var c=le.p;try{return le.p=i,o()}finally{le.p=c}}var z=Math.random().toString(36).slice(2),H="__reactFiber$"+z,q="__reactProps$"+z,W="__reactContainer$"+z,he="__reactEvents$"+z,Te="__reactListeners$"+z,de="__reactHandles$"+z,ge="__reactResources$"+z,pe="__reactMarker$"+z;function Pe(i){delete i[H],delete i[q],delete i[he],delete i[Te],delete i[de]}function Ve(i){var o=i[H];if(o)return o;for(var c=i.parentNode;c;){if(o=c[W]||c[H]){if(c=o.alternate,o.child!==null||c!==null&&c.child!==null)for(i=wE(i);i!==null;){if(c=i[H])return c;i=wE(i)}return o}i=c,c=i.parentNode}return null}function Ge(i){if(i=i[H]||i[W]){var o=i.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return i}return null}function Me(i){var o=i.tag;if(o===5||o===26||o===27||o===6)return i.stateNode;throw Error(n(33))}function je(i){var o=i[ge];return o||(o=i[ge]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function We(i){i[pe]=!0}var Ht=new Set,Gt={};function or(i,o){En(i,o),En(i+"Capture",o)}function En(i,o){for(Gt[i]=o,i=0;i<o.length;i++)Ht.add(o[i])}var ai=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ii={},ca={};function zs(i){return Dt.call(ca,i)?!0:Dt.call(ii,i)?!1:ai.test(i)?ca[i]=!0:(ii[i]=!0,!1)}function wn(i,o,c){if(zs(o))if(c===null)i.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":i.removeAttribute(o);return;case"boolean":var h=o.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){i.removeAttribute(o);return}}i.setAttribute(o,""+c)}}function ua(i,o,c){if(c===null)i.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(o);return}i.setAttribute(o,""+c)}}function Br(i,o,c,h){if(h===null)i.removeAttribute(c);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(c);return}i.setAttributeNS(o,c,""+h)}}function nn(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function js(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function ff(i,o,c){var h=Object.getOwnPropertyDescriptor(i.constructor.prototype,o);if(!i.hasOwnProperty(o)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var g=h.get,v=h.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return g.call(this)},set:function(b){c=""+b,v.call(this,b)}}),Object.defineProperty(i,o,{enumerable:h.enumerable}),{getValue:function(){return c},setValue:function(b){c=""+b},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function qt(i){if(!i._valueTracker){var o=js(i)?"checked":"value";i._valueTracker=ff(i,o,""+i[o])}}function Zo(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var c=o.getValue(),h="";return i&&(h=js(i)?i.checked?"true":"false":i.value),i=h,i!==c?(o.setValue(i),!0):!1}function Ai(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var el=/[\n"\\]/g;function Yn(i){return i.replace(el,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function Tc(i,o,c,h,g,v,b,P){i.name="",b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"?i.type=b:i.removeAttribute("type"),o!=null?b==="number"?(o===0&&i.value===""||i.value!=o)&&(i.value=""+nn(o)):i.value!==""+nn(o)&&(i.value=""+nn(o)):b!=="submit"&&b!=="reset"||i.removeAttribute("value"),o!=null?hf(i,b,nn(o)):c!=null?hf(i,b,nn(c)):h!=null&&i.removeAttribute("value"),g==null&&v!=null&&(i.defaultChecked=!!v),g!=null&&(i.checked=g&&typeof g!="function"&&typeof g!="symbol"),P!=null&&typeof P!="function"&&typeof P!="symbol"&&typeof P!="boolean"?i.name=""+nn(P):i.removeAttribute("name")}function O0(i,o,c,h,g,v,b,P){if(v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(i.type=v),o!=null||c!=null){if(!(v!=="submit"&&v!=="reset"||o!=null)){qt(i);return}c=c!=null?""+nn(c):"",o=o!=null?""+nn(o):c,P||o===i.value||(i.value=o),i.defaultValue=o}h=h??g,h=typeof h!="function"&&typeof h!="symbol"&&!!h,i.checked=P?i.checked:!!h,i.defaultChecked=!!h,b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(i.name=b),qt(i)}function hf(i,o,c){o==="number"&&Ai(i.ownerDocument)===i||i.defaultValue===""+c||(i.defaultValue=""+c)}function Hs(i,o,c,h){if(i=i.options,o){o={};for(var g=0;g<c.length;g++)o["$"+c[g]]=!0;for(c=0;c<i.length;c++)g=o.hasOwnProperty("$"+i[c].value),i[c].selected!==g&&(i[c].selected=g),g&&h&&(i[c].defaultSelected=!0)}else{for(c=""+nn(c),o=null,g=0;g<i.length;g++){if(i[g].value===c){i[g].selected=!0,h&&(i[g].defaultSelected=!0);return}o!==null||i[g].disabled||(o=i[g])}o!==null&&(o.selected=!0)}}function F0(i,o,c){if(o!=null&&(o=""+nn(o),o!==i.value&&(i.value=o),c==null)){i.defaultValue!==o&&(i.defaultValue=o);return}i.defaultValue=c!=null?""+nn(c):""}function Gs(i,o,c,h){if(o==null){if(h!=null){if(c!=null)throw Error(n(92));if(Re(h)){if(1<h.length)throw Error(n(93));h=h[0]}c=h}c==null&&(c=""),o=c}c=nn(o),i.defaultValue=c,h=i.textContent,h===c&&h!==""&&h!==null&&(i.value=h),qt(i)}function $n(i,o){if(o){var c=i.firstChild;if(c&&c===i.lastChild&&c.nodeType===3){c.nodeValue=o;return}}i.textContent=o}var M0=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function df(i,o,c){var h=o.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?h?i.setProperty(o,""):o==="float"?i.cssFloat="":i[o]="":h?i.setProperty(o,c):typeof c!="number"||c===0||M0.has(o)?o==="float"?i.cssFloat=c:i[o]=(""+c).trim():i[o]=c+"px"}function mf(i,o,c){if(o!=null&&typeof o!="object")throw Error(n(62));if(i=i.style,c!=null){for(var h in c)!c.hasOwnProperty(h)||o!=null&&o.hasOwnProperty(h)||(h.indexOf("--")===0?i.setProperty(h,""):h==="float"?i.cssFloat="":i[h]="");for(var g in o)h=o[g],o.hasOwnProperty(g)&&c[g]!==h&&df(i,g,h)}else for(var v in o)o.hasOwnProperty(v)&&df(i,v,o[v])}function Ec(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var P0=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),qs=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function wc(i){return qs.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function si(){}var pf=null;function Da(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Ks=null,bi=null;function tl(i){var o=Ge(i);if(o&&(i=o.stateNode)){var c=i[q]||null;e:switch(i=o.stateNode,o.type){case"input":if(Tc(i,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),o=c.name,c.type==="radio"&&o!=null){for(c=i;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+Yn(""+o)+'"][type="radio"]'),o=0;o<c.length;o++){var h=c[o];if(h!==i&&h.form===i.form){var g=h[q]||null;if(!g)throw Error(n(90));Tc(h,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(o=0;o<c.length;o++)h=c[o],h.form===i.form&&Zo(h)}break e;case"textarea":F0(i,c.value,c.defaultValue);break e;case"select":o=c.value,o!=null&&Hs(i,!!c.multiple,o,!1)}}}var Sc=!1;function Xs(i,o,c){if(Sc)return i(o,c);Sc=!0;try{var h=i(o);return h}finally{if(Sc=!1,(Ks!==null||bi!==null)&&(Cd(),Ks&&(o=Ks,i=bi,bi=Ks=null,tl(o),i)))for(o=0;o<i.length;o++)tl(i[o])}}function oi(i,o){var c=i.stateNode;if(c===null)return null;var h=c[q]||null;if(h===null)return null;c=h[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(i=i.type,h=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!h;break e;default:i=!1}if(i)return null;if(c&&typeof c!="function")throw Error(n(231,o,typeof c));return c}var Na=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),rl=!1;if(Na)try{var Zt={};Object.defineProperty(Zt,"passive",{get:function(){rl=!0}}),window.addEventListener("test",Zt,Zt),window.removeEventListener("test",Zt,Zt)}catch{rl=!1}var Ii=null,gf=null,nl=null;function xf(){if(nl)return nl;var i,o=gf,c=o.length,h,g="value"in Ii?Ii.value:Ii.textContent,v=g.length;for(i=0;i<c&&o[i]===g[i];i++);var b=c-i;for(h=1;h<=b&&o[c-h]===g[v-h];h++);return nl=g.slice(i,1<h?1-h:void 0)}function al(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function as(){return!0}function li(){return!1}function hn(i){function o(c,h,g,v,b){this._reactName=c,this._targetInst=g,this.type=h,this.nativeEvent=v,this.target=b,this.currentTarget=null;for(var P in i)i.hasOwnProperty(P)&&(c=i[P],this[P]=c?c(v):v[P]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?as:li,this.isPropagationStopped=li,this}return x(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=as)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=as)},persist:function(){},isPersistent:as}),o}var is={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ki=hn(is),Ws=x({},is,{view:0,detail:0}),vf=hn(Ws),Ys,Ac,Ci,bc=x({},Ws,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:$s,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Ci&&(Ci&&i.type==="mousemove"?(Ys=i.screenX-Ci.screenX,Ac=i.screenY-Ci.screenY):Ac=Ys=0,Ci=i),Ys)},movementY:function(i){return"movementY"in i?i.movementY:Ac}}),_f=hn(bc),il=x({},bc,{dataTransfer:0}),L0=hn(il),V0=x({},Ws,{relatedTarget:0}),sl=hn(V0),yf=x({},is,{animationName:0,elapsedTime:0,pseudoElement:0}),B0=hn(yf),Ic=x({},is,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),U0=hn(Ic),z0=x({},is,{data:0}),Ri=hn(z0),j0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},H0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},G0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function q0(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=G0[i])?!!o[i]:!1}function $s(){return q0}var Bn=x({},Ws,{key:function(i){if(i.key){var o=j0[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=al(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?H0[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:$s,charCode:function(i){return i.type==="keypress"?al(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?al(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),K0=hn(Bn),X0=x({},bc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ss=hn(X0),p=x({},Ws,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:$s}),E=hn(p),I=x({},is,{propertyName:0,elapsedTime:0,pseudoElement:0}),j=hn(I),ue=x({},bc,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),ve=hn(ue),ze=x({},is,{newState:0,oldState:0}),mt=hn(ze),Or=[9,13,27,32],Bt=Na&&"CompositionEvent"in window,xr=null;Na&&"documentMode"in document&&(xr=document.documentMode);var Oa=Na&&"TextEvent"in window&&!xr,Di=Na&&(!Bt||xr&&8<xr&&11>=xr),ci=" ",ui=!1;function ol(i,o){switch(i){case"keyup":return Or.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function kc(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Cc=!1;function pR(i,o){switch(i){case"compositionend":return kc(o);case"keypress":return o.which!==32?null:(ui=!0,ci);case"textInput":return i=o.data,i===ci&&ui?null:i;default:return null}}function gR(i,o){if(Cc)return i==="compositionend"||!Bt&&ol(i,o)?(i=xf(),nl=gf=Ii=null,Cc=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Di&&o.locale!=="ko"?null:o.data;default:return null}}var xR={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function by(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!xR[i.type]:o==="textarea"}function Iy(i,o,c,h){Ks?bi?bi.push(h):bi=[h]:Ks=h,o=Pd(o,"onChange"),0<o.length&&(c=new ki("onChange","change",null,c,h),i.push({event:c,listeners:o}))}var Tf=null,Ef=null;function vR(i){cE(i,0)}function W0(i){var o=Me(i);if(Zo(o))return i}function ky(i,o){if(i==="change")return o}var Cy=!1;if(Na){var rg;if(Na){var ng="oninput"in document;if(!ng){var Ry=document.createElement("div");Ry.setAttribute("oninput","return;"),ng=typeof Ry.oninput=="function"}rg=ng}else rg=!1;Cy=rg&&(!document.documentMode||9<document.documentMode)}function Dy(){Tf&&(Tf.detachEvent("onpropertychange",Ny),Ef=Tf=null)}function Ny(i){if(i.propertyName==="value"&&W0(Ef)){var o=[];Iy(o,Ef,i,Da(i)),Xs(vR,o)}}function _R(i,o,c){i==="focusin"?(Dy(),Tf=o,Ef=c,Tf.attachEvent("onpropertychange",Ny)):i==="focusout"&&Dy()}function yR(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return W0(Ef)}function TR(i,o){if(i==="click")return W0(o)}function ER(i,o){if(i==="input"||i==="change")return W0(o)}function wR(i,o){return i===o&&(i!==0||1/i===1/o)||i!==i&&o!==o}var fa=typeof Object.is=="function"?Object.is:wR;function wf(i,o){if(fa(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var c=Object.keys(i),h=Object.keys(o);if(c.length!==h.length)return!1;for(h=0;h<c.length;h++){var g=c[h];if(!Dt.call(o,g)||!fa(i[g],o[g]))return!1}return!0}function Oy(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Fy(i,o){var c=Oy(i);i=0;for(var h;c;){if(c.nodeType===3){if(h=i+c.textContent.length,i<=o&&h>=o)return{node:c,offset:o-i};i=h}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=Oy(c)}}function My(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?My(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function Py(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var o=Ai(i.document);o instanceof i.HTMLIFrameElement;){try{var c=typeof o.contentWindow.location.href=="string"}catch{c=!1}if(c)i=o.contentWindow;else break;o=Ai(i.document)}return o}function ag(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}var SR=Na&&"documentMode"in document&&11>=document.documentMode,Rc=null,ig=null,Sf=null,sg=!1;function Ly(i,o,c){var h=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;sg||Rc==null||Rc!==Ai(h)||(h=Rc,"selectionStart"in h&&ag(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Sf&&wf(Sf,h)||(Sf=h,h=Pd(ig,"onSelect"),0<h.length&&(o=new ki("onSelect","select",null,o,c),i.push({event:o,listeners:h}),o.target=Rc)))}function ll(i,o){var c={};return c[i.toLowerCase()]=o.toLowerCase(),c["Webkit"+i]="webkit"+o,c["Moz"+i]="moz"+o,c}var Dc={animationend:ll("Animation","AnimationEnd"),animationiteration:ll("Animation","AnimationIteration"),animationstart:ll("Animation","AnimationStart"),transitionrun:ll("Transition","TransitionRun"),transitionstart:ll("Transition","TransitionStart"),transitioncancel:ll("Transition","TransitionCancel"),transitionend:ll("Transition","TransitionEnd")},og={},Vy={};Na&&(Vy=document.createElement("div").style,"AnimationEvent"in window||(delete Dc.animationend.animation,delete Dc.animationiteration.animation,delete Dc.animationstart.animation),"TransitionEvent"in window||delete Dc.transitionend.transition);function cl(i){if(og[i])return og[i];if(!Dc[i])return i;var o=Dc[i],c;for(c in o)if(o.hasOwnProperty(c)&&c in Vy)return og[i]=o[c];return i}var By=cl("animationend"),Uy=cl("animationiteration"),zy=cl("animationstart"),AR=cl("transitionrun"),bR=cl("transitionstart"),IR=cl("transitioncancel"),jy=cl("transitionend"),Hy=new Map,lg="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");lg.push("scrollEnd");function fi(i,o){Hy.set(i,o),or(o,[i])}var Y0=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},Fa=[],Nc=0,cg=0;function $0(){for(var i=Nc,o=cg=Nc=0;o<i;){var c=Fa[o];Fa[o++]=null;var h=Fa[o];Fa[o++]=null;var g=Fa[o];Fa[o++]=null;var v=Fa[o];if(Fa[o++]=null,h!==null&&g!==null){var b=h.pending;b===null?g.next=g:(g.next=b.next,b.next=g),h.pending=g}v!==0&&Gy(c,g,v)}}function Q0(i,o,c,h){Fa[Nc++]=i,Fa[Nc++]=o,Fa[Nc++]=c,Fa[Nc++]=h,cg|=h,i.lanes|=h,i=i.alternate,i!==null&&(i.lanes|=h)}function ug(i,o,c,h){return Q0(i,o,c,h),J0(i)}function ul(i,o){return Q0(i,null,null,o),J0(i)}function Gy(i,o,c){i.lanes|=c;var h=i.alternate;h!==null&&(h.lanes|=c);for(var g=!1,v=i.return;v!==null;)v.childLanes|=c,h=v.alternate,h!==null&&(h.childLanes|=c),v.tag===22&&(i=v.stateNode,i===null||i._visibility&1||(g=!0)),i=v,v=v.return;return i.tag===3?(v=i.stateNode,g&&o!==null&&(g=31-Tr(c),i=v.hiddenUpdates,h=i[g],h===null?i[g]=[o]:h.push(o),o.lane=c|536870912),v):null}function J0(i){if(50<Kf)throw Kf=0,_1=null,Error(n(185));for(var o=i.return;o!==null;)i=o,o=i.return;return i.tag===3?i.stateNode:null}var Oc={};function kR(i,o,c,h){this.tag=i,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ha(i,o,c,h){return new kR(i,o,c,h)}function fg(i){return i=i.prototype,!(!i||!i.isReactComponent)}function os(i,o){var c=i.alternate;return c===null?(c=ha(i.tag,o,i.key,i.mode),c.elementType=i.elementType,c.type=i.type,c.stateNode=i.stateNode,c.alternate=i,i.alternate=c):(c.pendingProps=o,c.type=i.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=i.flags&65011712,c.childLanes=i.childLanes,c.lanes=i.lanes,c.child=i.child,c.memoizedProps=i.memoizedProps,c.memoizedState=i.memoizedState,c.updateQueue=i.updateQueue,o=i.dependencies,c.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},c.sibling=i.sibling,c.index=i.index,c.ref=i.ref,c.refCleanup=i.refCleanup,c}function qy(i,o){i.flags&=65011714;var c=i.alternate;return c===null?(i.childLanes=0,i.lanes=o,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=c.childLanes,i.lanes=c.lanes,i.child=c.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=c.memoizedProps,i.memoizedState=c.memoizedState,i.updateQueue=c.updateQueue,i.type=c.type,o=c.dependencies,i.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),i}function Z0(i,o,c,h,g,v){var b=0;if(h=i,typeof i=="function")fg(i)&&(b=1);else if(typeof i=="string")b=OD(i,c,X.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case k:return i=ha(31,c,o,g),i.elementType=k,i.lanes=v,i;case T:return fl(c.children,g,v,o);case S:b=8,g|=24;break;case O:return i=ha(12,c,o,g|2),i.elementType=O,i.lanes=v,i;case te:return i=ha(13,c,o,g),i.elementType=te,i.lanes=v,i;case G:return i=ha(19,c,o,g),i.elementType=G,i.lanes=v,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case R:b=10;break e;case U:b=9;break e;case Y:b=11;break e;case A:b=14;break e;case C:b=16,h=null;break e}b=29,c=Error(n(130,i===null?"null":typeof i,"")),h=null}return o=ha(b,c,o,g),o.elementType=i,o.type=h,o.lanes=v,o}function fl(i,o,c,h){return i=ha(7,i,h,o),i.lanes=c,i}function hg(i,o,c){return i=ha(6,i,null,o),i.lanes=c,i}function Ky(i){var o=ha(18,null,null,0);return o.stateNode=i,o}function dg(i,o,c){return o=ha(4,i.children!==null?i.children:[],i.key,o),o.lanes=c,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}var Xy=new WeakMap;function Ma(i,o){if(typeof i=="object"&&i!==null){var c=Xy.get(i);return c!==void 0?c:(o={value:i,source:o,stack:sr(o)},Xy.set(i,o),o)}return{value:i,source:o,stack:sr(o)}}var Fc=[],Mc=0,ed=null,Af=0,Pa=[],La=0,Qs=null,Ni=1,Oi="";function ls(i,o){Fc[Mc++]=Af,Fc[Mc++]=ed,ed=i,Af=o}function Wy(i,o,c){Pa[La++]=Ni,Pa[La++]=Oi,Pa[La++]=Qs,Qs=i;var h=Ni;i=Oi;var g=32-Tr(h)-1;h&=~(1<<g),c+=1;var v=32-Tr(o)+g;if(30<v){var b=g-g%5;v=(h&(1<<b)-1).toString(32),h>>=b,g-=b,Ni=1<<32-Tr(o)+g|c<<g|h,Oi=v+i}else Ni=1<<v|c<<g|h,Oi=i}function mg(i){i.return!==null&&(ls(i,1),Wy(i,1,0))}function pg(i){for(;i===ed;)ed=Fc[--Mc],Fc[Mc]=null,Af=Fc[--Mc],Fc[Mc]=null;for(;i===Qs;)Qs=Pa[--La],Pa[La]=null,Oi=Pa[--La],Pa[La]=null,Ni=Pa[--La],Pa[La]=null}function Yy(i,o){Pa[La++]=Ni,Pa[La++]=Oi,Pa[La++]=Qs,Ni=o.id,Oi=o.overflow,Qs=i}var dn=null,fr=null,It=!1,Js=null,Va=!1,gg=Error(n(519));function Zs(i){var o=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw bf(Ma(o,i)),gg}function $y(i){var o=i.stateNode,c=i.type,h=i.memoizedProps;switch(o[H]=i,o[q]=h,c){case"dialog":wt("cancel",o),wt("close",o);break;case"iframe":case"object":case"embed":wt("load",o);break;case"video":case"audio":for(c=0;c<Wf.length;c++)wt(Wf[c],o);break;case"source":wt("error",o);break;case"img":case"image":case"link":wt("error",o),wt("load",o);break;case"details":wt("toggle",o);break;case"input":wt("invalid",o),O0(o,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0);break;case"select":wt("invalid",o);break;case"textarea":wt("invalid",o),Gs(o,h.value,h.defaultValue,h.children)}c=h.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||o.textContent===""+c||h.suppressHydrationWarning===!0||dE(o.textContent,c)?(h.popover!=null&&(wt("beforetoggle",o),wt("toggle",o)),h.onScroll!=null&&wt("scroll",o),h.onScrollEnd!=null&&wt("scrollend",o),h.onClick!=null&&(o.onclick=si),o=!0):o=!1,o||Zs(i,!0)}function Qy(i){for(dn=i.return;dn;)switch(dn.tag){case 5:case 31:case 13:Va=!1;return;case 27:case 3:Va=!0;return;default:dn=dn.return}}function Pc(i){if(i!==dn)return!1;if(!It)return Qy(i),It=!0,!1;var o=i.tag,c;if((c=o!==3&&o!==27)&&((c=o===5)&&(c=i.type,c=!(c!=="form"&&c!=="button")||F1(i.type,i.memoizedProps)),c=!c),c&&fr&&Zs(i),Qy(i),o===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(317));fr=EE(i)}else if(o===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(317));fr=EE(i)}else o===27?(o=fr,mo(i.type)?(i=B1,B1=null,fr=i):fr=o):fr=dn?Ua(i.stateNode.nextSibling):null;return!0}function hl(){fr=dn=null,It=!1}function xg(){var i=Js;return i!==null&&(ea===null?ea=i:ea.push.apply(ea,i),Js=null),i}function bf(i){Js===null?Js=[i]:Js.push(i)}var vg=Q(null),dl=null,cs=null;function eo(i,o,c){J(vg,o._currentValue),o._currentValue=c}function us(i){i._currentValue=vg.current,N(vg)}function _g(i,o,c){for(;i!==null;){var h=i.alternate;if((i.childLanes&o)!==o?(i.childLanes|=o,h!==null&&(h.childLanes|=o)):h!==null&&(h.childLanes&o)!==o&&(h.childLanes|=o),i===c)break;i=i.return}}function yg(i,o,c,h){var g=i.child;for(g!==null&&(g.return=i);g!==null;){var v=g.dependencies;if(v!==null){var b=g.child;v=v.firstContext;e:for(;v!==null;){var P=v;v=g;for(var re=0;re<o.length;re++)if(P.context===o[re]){v.lanes|=c,P=v.alternate,P!==null&&(P.lanes|=c),_g(v.return,c,i),h||(b=null);break e}v=P.next}}else if(g.tag===18){if(b=g.return,b===null)throw Error(n(341));b.lanes|=c,v=b.alternate,v!==null&&(v.lanes|=c),_g(b,c,i),b=null}else b=g.child;if(b!==null)b.return=g;else for(b=g;b!==null;){if(b===i){b=null;break}if(g=b.sibling,g!==null){g.return=b.return,b=g;break}b=b.return}g=b}}function Lc(i,o,c,h){i=null;for(var g=o,v=!1;g!==null;){if(!v){if((g.flags&524288)!==0)v=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var b=g.alternate;if(b===null)throw Error(n(387));if(b=b.memoizedProps,b!==null){var P=g.type;fa(g.pendingProps.value,b.value)||(i!==null?i.push(P):i=[P])}}else if(g===we.current){if(b=g.alternate,b===null)throw Error(n(387));b.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(i!==null?i.push(Zf):i=[Zf])}g=g.return}i!==null&&yg(o,i,c,h),o.flags|=262144}function td(i){for(i=i.firstContext;i!==null;){if(!fa(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function ml(i){dl=i,cs=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function mn(i){return Jy(dl,i)}function rd(i,o){return dl===null&&ml(i),Jy(i,o)}function Jy(i,o){var c=o._currentValue;if(o={context:o,memoizedValue:c,next:null},cs===null){if(i===null)throw Error(n(308));cs=o,i.dependencies={lanes:0,firstContext:o},i.flags|=524288}else cs=cs.next=o;return c}var CR=typeof AbortController<"u"?AbortController:function(){var i=[],o=this.signal={aborted:!1,addEventListener:function(c,h){i.push(h)}};this.abort=function(){o.aborted=!0,i.forEach(function(c){return c()})}},RR=r.unstable_scheduleCallback,DR=r.unstable_NormalPriority,Ur={$$typeof:R,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Tg(){return{controller:new CR,data:new Map,refCount:0}}function If(i){i.refCount--,i.refCount===0&&RR(DR,function(){i.controller.abort()})}var kf=null,Eg=0,Vc=0,Bc=null;function NR(i,o){if(kf===null){var c=kf=[];Eg=0,Vc=A1(),Bc={status:"pending",value:void 0,then:function(h){c.push(h)}}}return Eg++,o.then(Zy,Zy),o}function Zy(){if(--Eg===0&&kf!==null){Bc!==null&&(Bc.status="fulfilled");var i=kf;kf=null,Vc=0,Bc=null;for(var o=0;o<i.length;o++)(0,i[o])()}}function OR(i,o){var c=[],h={status:"pending",value:null,reason:null,then:function(g){c.push(g)}};return i.then(function(){h.status="fulfilled",h.value=o;for(var g=0;g<c.length;g++)(0,c[g])(o)},function(g){for(h.status="rejected",h.reason=g,g=0;g<c.length;g++)(0,c[g])(void 0)}),h}var e2=ae.S;ae.S=function(i,o){LT=jt(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&NR(i,o),e2!==null&&e2(i,o)};var pl=Q(null);function wg(){var i=pl.current;return i!==null?i:lr.pooledCache}function nd(i,o){o===null?J(pl,pl.current):J(pl,o.pool)}function t2(){var i=wg();return i===null?null:{parent:Ur._currentValue,pool:i}}var Uc=Error(n(460)),Sg=Error(n(474)),ad=Error(n(542)),id={then:function(){}};function r2(i){return i=i.status,i==="fulfilled"||i==="rejected"}function n2(i,o,c){switch(c=i[c],c===void 0?i.push(o):c!==o&&(o.then(si,si),o=c),o.status){case"fulfilled":return o.value;case"rejected":throw i=o.reason,i2(i),i;default:if(typeof o.status=="string")o.then(si,si);else{if(i=lr,i!==null&&100<i.shellSuspendCounter)throw Error(n(482));i=o,i.status="pending",i.then(function(h){if(o.status==="pending"){var g=o;g.status="fulfilled",g.value=h}},function(h){if(o.status==="pending"){var g=o;g.status="rejected",g.reason=h}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw i=o.reason,i2(i),i}throw xl=o,Uc}}function gl(i){try{var o=i._init;return o(i._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(xl=c,Uc):c}}var xl=null;function a2(){if(xl===null)throw Error(n(459));var i=xl;return xl=null,i}function i2(i){if(i===Uc||i===ad)throw Error(n(483))}var zc=null,Cf=0;function sd(i){var o=Cf;return Cf+=1,zc===null&&(zc=[]),n2(zc,i,o)}function Rf(i,o){o=o.props.ref,i.ref=o!==void 0?o:null}function od(i,o){throw o.$$typeof===_?Error(n(525)):(i=Object.prototype.toString.call(o),Error(n(31,i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i)))}function s2(i){function o(se,ne){if(i){var fe=se.deletions;fe===null?(se.deletions=[ne],se.flags|=16):fe.push(ne)}}function c(se,ne){if(!i)return null;for(;ne!==null;)o(se,ne),ne=ne.sibling;return null}function h(se){for(var ne=new Map;se!==null;)se.key!==null?ne.set(se.key,se):ne.set(se.index,se),se=se.sibling;return ne}function g(se,ne){return se=os(se,ne),se.index=0,se.sibling=null,se}function v(se,ne,fe){return se.index=fe,i?(fe=se.alternate,fe!==null?(fe=fe.index,fe<ne?(se.flags|=67108866,ne):fe):(se.flags|=67108866,ne)):(se.flags|=1048576,ne)}function b(se){return i&&se.alternate===null&&(se.flags|=67108866),se}function P(se,ne,fe,Se){return ne===null||ne.tag!==6?(ne=hg(fe,se.mode,Se),ne.return=se,ne):(ne=g(ne,fe),ne.return=se,ne)}function re(se,ne,fe,Se){var Ze=fe.type;return Ze===T?Ee(se,ne,fe.props.children,Se,fe.key):ne!==null&&(ne.elementType===Ze||typeof Ze=="object"&&Ze!==null&&Ze.$$typeof===C&&gl(Ze)===ne.type)?(ne=g(ne,fe.props),Rf(ne,fe),ne.return=se,ne):(ne=Z0(fe.type,fe.key,fe.props,null,se.mode,Se),Rf(ne,fe),ne.return=se,ne)}function me(se,ne,fe,Se){return ne===null||ne.tag!==4||ne.stateNode.containerInfo!==fe.containerInfo||ne.stateNode.implementation!==fe.implementation?(ne=dg(fe,se.mode,Se),ne.return=se,ne):(ne=g(ne,fe.children||[]),ne.return=se,ne)}function Ee(se,ne,fe,Se,Ze){return ne===null||ne.tag!==7?(ne=fl(fe,se.mode,Se,Ze),ne.return=se,ne):(ne=g(ne,fe),ne.return=se,ne)}function be(se,ne,fe){if(typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint")return ne=hg(""+ne,se.mode,fe),ne.return=se,ne;if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case y:return fe=Z0(ne.type,ne.key,ne.props,null,se.mode,fe),Rf(fe,ne),fe.return=se,fe;case w:return ne=dg(ne,se.mode,fe),ne.return=se,ne;case C:return ne=gl(ne),be(se,ne,fe)}if(Re(ne)||M(ne))return ne=fl(ne,se.mode,fe,null),ne.return=se,ne;if(typeof ne.then=="function")return be(se,sd(ne),fe);if(ne.$$typeof===R)return be(se,rd(se,ne),fe);od(se,ne)}return null}function xe(se,ne,fe,Se){var Ze=ne!==null?ne.key:null;if(typeof fe=="string"&&fe!==""||typeof fe=="number"||typeof fe=="bigint")return Ze!==null?null:P(se,ne,""+fe,Se);if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case y:return fe.key===Ze?re(se,ne,fe,Se):null;case w:return fe.key===Ze?me(se,ne,fe,Se):null;case C:return fe=gl(fe),xe(se,ne,fe,Se)}if(Re(fe)||M(fe))return Ze!==null?null:Ee(se,ne,fe,Se,null);if(typeof fe.then=="function")return xe(se,ne,sd(fe),Se);if(fe.$$typeof===R)return xe(se,ne,rd(se,fe),Se);od(se,fe)}return null}function _e(se,ne,fe,Se,Ze){if(typeof Se=="string"&&Se!==""||typeof Se=="number"||typeof Se=="bigint")return se=se.get(fe)||null,P(ne,se,""+Se,Ze);if(typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case y:return se=se.get(Se.key===null?fe:Se.key)||null,re(ne,se,Se,Ze);case w:return se=se.get(Se.key===null?fe:Se.key)||null,me(ne,se,Se,Ze);case C:return Se=gl(Se),_e(se,ne,fe,Se,Ze)}if(Re(Se)||M(Se))return se=se.get(fe)||null,Ee(ne,se,Se,Ze,null);if(typeof Se.then=="function")return _e(se,ne,fe,sd(Se),Ze);if(Se.$$typeof===R)return _e(se,ne,fe,rd(ne,Se),Ze);od(ne,Se)}return null}function Xe(se,ne,fe,Se){for(var Ze=null,Mt=null,$e=ne,xt=ne=0,At=null;$e!==null&&xt<fe.length;xt++){$e.index>xt?(At=$e,$e=null):At=$e.sibling;var Pt=xe(se,$e,fe[xt],Se);if(Pt===null){$e===null&&($e=At);break}i&&$e&&Pt.alternate===null&&o(se,$e),ne=v(Pt,ne,xt),Mt===null?Ze=Pt:Mt.sibling=Pt,Mt=Pt,$e=At}if(xt===fe.length)return c(se,$e),It&&ls(se,xt),Ze;if($e===null){for(;xt<fe.length;xt++)$e=be(se,fe[xt],Se),$e!==null&&(ne=v($e,ne,xt),Mt===null?Ze=$e:Mt.sibling=$e,Mt=$e);return It&&ls(se,xt),Ze}for($e=h($e);xt<fe.length;xt++)At=_e($e,se,xt,fe[xt],Se),At!==null&&(i&&At.alternate!==null&&$e.delete(At.key===null?xt:At.key),ne=v(At,ne,xt),Mt===null?Ze=At:Mt.sibling=At,Mt=At);return i&&$e.forEach(function(_o){return o(se,_o)}),It&&ls(se,xt),Ze}function rt(se,ne,fe,Se){if(fe==null)throw Error(n(151));for(var Ze=null,Mt=null,$e=ne,xt=ne=0,At=null,Pt=fe.next();$e!==null&&!Pt.done;xt++,Pt=fe.next()){$e.index>xt?(At=$e,$e=null):At=$e.sibling;var _o=xe(se,$e,Pt.value,Se);if(_o===null){$e===null&&($e=At);break}i&&$e&&_o.alternate===null&&o(se,$e),ne=v(_o,ne,xt),Mt===null?Ze=_o:Mt.sibling=_o,Mt=_o,$e=At}if(Pt.done)return c(se,$e),It&&ls(se,xt),Ze;if($e===null){for(;!Pt.done;xt++,Pt=fe.next())Pt=be(se,Pt.value,Se),Pt!==null&&(ne=v(Pt,ne,xt),Mt===null?Ze=Pt:Mt.sibling=Pt,Mt=Pt);return It&&ls(se,xt),Ze}for($e=h($e);!Pt.done;xt++,Pt=fe.next())Pt=_e($e,se,xt,Pt.value,Se),Pt!==null&&(i&&Pt.alternate!==null&&$e.delete(Pt.key===null?xt:Pt.key),ne=v(Pt,ne,xt),Mt===null?Ze=Pt:Mt.sibling=Pt,Mt=Pt);return i&&$e.forEach(function(GD){return o(se,GD)}),It&&ls(se,xt),Ze}function rr(se,ne,fe,Se){if(typeof fe=="object"&&fe!==null&&fe.type===T&&fe.key===null&&(fe=fe.props.children),typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case y:e:{for(var Ze=fe.key;ne!==null;){if(ne.key===Ze){if(Ze=fe.type,Ze===T){if(ne.tag===7){c(se,ne.sibling),Se=g(ne,fe.props.children),Se.return=se,se=Se;break e}}else if(ne.elementType===Ze||typeof Ze=="object"&&Ze!==null&&Ze.$$typeof===C&&gl(Ze)===ne.type){c(se,ne.sibling),Se=g(ne,fe.props),Rf(Se,fe),Se.return=se,se=Se;break e}c(se,ne);break}else o(se,ne);ne=ne.sibling}fe.type===T?(Se=fl(fe.props.children,se.mode,Se,fe.key),Se.return=se,se=Se):(Se=Z0(fe.type,fe.key,fe.props,null,se.mode,Se),Rf(Se,fe),Se.return=se,se=Se)}return b(se);case w:e:{for(Ze=fe.key;ne!==null;){if(ne.key===Ze)if(ne.tag===4&&ne.stateNode.containerInfo===fe.containerInfo&&ne.stateNode.implementation===fe.implementation){c(se,ne.sibling),Se=g(ne,fe.children||[]),Se.return=se,se=Se;break e}else{c(se,ne);break}else o(se,ne);ne=ne.sibling}Se=dg(fe,se.mode,Se),Se.return=se,se=Se}return b(se);case C:return fe=gl(fe),rr(se,ne,fe,Se)}if(Re(fe))return Xe(se,ne,fe,Se);if(M(fe)){if(Ze=M(fe),typeof Ze!="function")throw Error(n(150));return fe=Ze.call(fe),rt(se,ne,fe,Se)}if(typeof fe.then=="function")return rr(se,ne,sd(fe),Se);if(fe.$$typeof===R)return rr(se,ne,rd(se,fe),Se);od(se,fe)}return typeof fe=="string"&&fe!==""||typeof fe=="number"||typeof fe=="bigint"?(fe=""+fe,ne!==null&&ne.tag===6?(c(se,ne.sibling),Se=g(ne,fe),Se.return=se,se=Se):(c(se,ne),Se=hg(fe,se.mode,Se),Se.return=se,se=Se),b(se)):c(se,ne)}return function(se,ne,fe,Se){try{Cf=0;var Ze=rr(se,ne,fe,Se);return zc=null,Ze}catch($e){if($e===Uc||$e===ad)throw $e;var Mt=ha(29,$e,null,se.mode);return Mt.lanes=Se,Mt.return=se,Mt}finally{}}}var vl=s2(!0),o2=s2(!1),to=!1;function Ag(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function bg(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function ro(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function no(i,o,c){var h=i.updateQueue;if(h===null)return null;if(h=h.shared,(Ut&2)!==0){var g=h.pending;return g===null?o.next=o:(o.next=g.next,g.next=o),h.pending=o,o=J0(i),Gy(i,null,c),o}return Q0(i,h,o,c),J0(i)}function Df(i,o,c){if(o=o.updateQueue,o!==null&&(o=o.shared,(c&4194048)!==0)){var h=o.lanes;h&=i.pendingLanes,c|=h,o.lanes=c,rs(i,c)}}function Ig(i,o){var c=i.updateQueue,h=i.alternate;if(h!==null&&(h=h.updateQueue,c===h)){var g=null,v=null;if(c=c.firstBaseUpdate,c!==null){do{var b={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};v===null?g=v=b:v=v.next=b,c=c.next}while(c!==null);v===null?g=v=o:v=v.next=o}else g=v=o;c={baseState:h.baseState,firstBaseUpdate:g,lastBaseUpdate:v,shared:h.shared,callbacks:h.callbacks},i.updateQueue=c;return}i=c.lastBaseUpdate,i===null?c.firstBaseUpdate=o:i.next=o,c.lastBaseUpdate=o}var kg=!1;function Nf(){if(kg){var i=Bc;if(i!==null)throw i}}function Of(i,o,c,h){kg=!1;var g=i.updateQueue;to=!1;var v=g.firstBaseUpdate,b=g.lastBaseUpdate,P=g.shared.pending;if(P!==null){g.shared.pending=null;var re=P,me=re.next;re.next=null,b===null?v=me:b.next=me,b=re;var Ee=i.alternate;Ee!==null&&(Ee=Ee.updateQueue,P=Ee.lastBaseUpdate,P!==b&&(P===null?Ee.firstBaseUpdate=me:P.next=me,Ee.lastBaseUpdate=re))}if(v!==null){var be=g.baseState;b=0,Ee=me=re=null,P=v;do{var xe=P.lane&-536870913,_e=xe!==P.lane;if(_e?(St&xe)===xe:(h&xe)===xe){xe!==0&&xe===Vc&&(kg=!0),Ee!==null&&(Ee=Ee.next={lane:0,tag:P.tag,payload:P.payload,callback:null,next:null});e:{var Xe=i,rt=P;xe=o;var rr=c;switch(rt.tag){case 1:if(Xe=rt.payload,typeof Xe=="function"){be=Xe.call(rr,be,xe);break e}be=Xe;break e;case 3:Xe.flags=Xe.flags&-65537|128;case 0:if(Xe=rt.payload,xe=typeof Xe=="function"?Xe.call(rr,be,xe):Xe,xe==null)break e;be=x({},be,xe);break e;case 2:to=!0}}xe=P.callback,xe!==null&&(i.flags|=64,_e&&(i.flags|=8192),_e=g.callbacks,_e===null?g.callbacks=[xe]:_e.push(xe))}else _e={lane:xe,tag:P.tag,payload:P.payload,callback:P.callback,next:null},Ee===null?(me=Ee=_e,re=be):Ee=Ee.next=_e,b|=xe;if(P=P.next,P===null){if(P=g.shared.pending,P===null)break;_e=P,P=_e.next,_e.next=null,g.lastBaseUpdate=_e,g.shared.pending=null}}while(!0);Ee===null&&(re=be),g.baseState=re,g.firstBaseUpdate=me,g.lastBaseUpdate=Ee,v===null&&(g.shared.lanes=0),lo|=b,i.lanes=b,i.memoizedState=be}}function l2(i,o){if(typeof i!="function")throw Error(n(191,i));i.call(o)}function c2(i,o){var c=i.callbacks;if(c!==null)for(i.callbacks=null,i=0;i<c.length;i++)l2(c[i],o)}var jc=Q(null),ld=Q(0);function u2(i,o){i=_s,J(ld,i),J(jc,o),_s=i|o.baseLanes}function Cg(){J(ld,_s),J(jc,jc.current)}function Rg(){_s=ld.current,N(jc),N(ld)}var da=Q(null),Ba=null;function ao(i){var o=i.alternate;J(Fr,Fr.current&1),J(da,i),Ba===null&&(o===null||jc.current!==null||o.memoizedState!==null)&&(Ba=i)}function Dg(i){J(Fr,Fr.current),J(da,i),Ba===null&&(Ba=i)}function f2(i){i.tag===22?(J(Fr,Fr.current),J(da,i),Ba===null&&(Ba=i)):io()}function io(){J(Fr,Fr.current),J(da,da.current)}function ma(i){N(da),Ba===i&&(Ba=null),N(Fr)}var Fr=Q(0);function cd(i){for(var o=i;o!==null;){if(o.tag===13){var c=o.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||L1(c)||V1(c)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var fs=0,pt=null,er=null,zr=null,ud=!1,Hc=!1,_l=!1,fd=0,Ff=0,Gc=null,FR=0;function Ir(){throw Error(n(321))}function Ng(i,o){if(o===null)return!1;for(var c=0;c<o.length&&c<i.length;c++)if(!fa(i[c],o[c]))return!1;return!0}function Og(i,o,c,h,g,v){return fs=v,pt=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,ae.H=i===null||i.memoizedState===null?W2:Wg,_l=!1,v=c(h,g),_l=!1,Hc&&(v=d2(o,c,h,g)),h2(i),v}function h2(i){ae.H=Lf;var o=er!==null&&er.next!==null;if(fs=0,zr=er=pt=null,ud=!1,Ff=0,Gc=null,o)throw Error(n(300));i===null||jr||(i=i.dependencies,i!==null&&td(i)&&(jr=!0))}function d2(i,o,c,h){pt=i;var g=0;do{if(Hc&&(Gc=null),Ff=0,Hc=!1,25<=g)throw Error(n(301));if(g+=1,zr=er=null,i.updateQueue!=null){var v=i.updateQueue;v.lastEffect=null,v.events=null,v.stores=null,v.memoCache!=null&&(v.memoCache.index=0)}ae.H=Y2,v=o(c,h)}while(Hc);return v}function MR(){var i=ae.H,o=i.useState()[0];return o=typeof o.then=="function"?Mf(o):o,i=i.useState()[0],(er!==null?er.memoizedState:null)!==i&&(pt.flags|=1024),o}function Fg(){var i=fd!==0;return fd=0,i}function Mg(i,o,c){o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~c}function Pg(i){if(ud){for(i=i.memoizedState;i!==null;){var o=i.queue;o!==null&&(o.pending=null),i=i.next}ud=!1}fs=0,zr=er=pt=null,Hc=!1,Ff=fd=0,Gc=null}function Un(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return zr===null?pt.memoizedState=zr=i:zr=zr.next=i,zr}function Mr(){if(er===null){var i=pt.alternate;i=i!==null?i.memoizedState:null}else i=er.next;var o=zr===null?pt.memoizedState:zr.next;if(o!==null)zr=o,er=i;else{if(i===null)throw pt.alternate===null?Error(n(467)):Error(n(310));er=i,i={memoizedState:er.memoizedState,baseState:er.baseState,baseQueue:er.baseQueue,queue:er.queue,next:null},zr===null?pt.memoizedState=zr=i:zr=zr.next=i}return zr}function hd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Mf(i){var o=Ff;return Ff+=1,Gc===null&&(Gc=[]),i=n2(Gc,i,o),o=pt,(zr===null?o.memoizedState:zr.next)===null&&(o=o.alternate,ae.H=o===null||o.memoizedState===null?W2:Wg),i}function dd(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return Mf(i);if(i.$$typeof===R)return mn(i)}throw Error(n(438,String(i)))}function Lg(i){var o=null,c=pt.updateQueue;if(c!==null&&(o=c.memoCache),o==null){var h=pt.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(o={data:h.data.map(function(g){return g.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),c===null&&(c=hd(),pt.updateQueue=c),c.memoCache=o,c=o.data[o.index],c===void 0)for(c=o.data[o.index]=Array(i),h=0;h<i;h++)c[h]=V;return o.index++,c}function hs(i,o){return typeof o=="function"?o(i):o}function md(i){var o=Mr();return Vg(o,er,i)}function Vg(i,o,c){var h=i.queue;if(h===null)throw Error(n(311));h.lastRenderedReducer=c;var g=i.baseQueue,v=h.pending;if(v!==null){if(g!==null){var b=g.next;g.next=v.next,v.next=b}o.baseQueue=g=v,h.pending=null}if(v=i.baseState,g===null)i.memoizedState=v;else{o=g.next;var P=b=null,re=null,me=o,Ee=!1;do{var be=me.lane&-536870913;if(be!==me.lane?(St&be)===be:(fs&be)===be){var xe=me.revertLane;if(xe===0)re!==null&&(re=re.next={lane:0,revertLane:0,gesture:null,action:me.action,hasEagerState:me.hasEagerState,eagerState:me.eagerState,next:null}),be===Vc&&(Ee=!0);else if((fs&xe)===xe){me=me.next,xe===Vc&&(Ee=!0);continue}else be={lane:0,revertLane:me.revertLane,gesture:null,action:me.action,hasEagerState:me.hasEagerState,eagerState:me.eagerState,next:null},re===null?(P=re=be,b=v):re=re.next=be,pt.lanes|=xe,lo|=xe;be=me.action,_l&&c(v,be),v=me.hasEagerState?me.eagerState:c(v,be)}else xe={lane:be,revertLane:me.revertLane,gesture:me.gesture,action:me.action,hasEagerState:me.hasEagerState,eagerState:me.eagerState,next:null},re===null?(P=re=xe,b=v):re=re.next=xe,pt.lanes|=be,lo|=be;me=me.next}while(me!==null&&me!==o);if(re===null?b=v:re.next=P,!fa(v,i.memoizedState)&&(jr=!0,Ee&&(c=Bc,c!==null)))throw c;i.memoizedState=v,i.baseState=b,i.baseQueue=re,h.lastRenderedState=v}return g===null&&(h.lanes=0),[i.memoizedState,h.dispatch]}function Bg(i){var o=Mr(),c=o.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=i;var h=c.dispatch,g=c.pending,v=o.memoizedState;if(g!==null){c.pending=null;var b=g=g.next;do v=i(v,b.action),b=b.next;while(b!==g);fa(v,o.memoizedState)||(jr=!0),o.memoizedState=v,o.baseQueue===null&&(o.baseState=v),c.lastRenderedState=v}return[v,h]}function m2(i,o,c){var h=pt,g=Mr(),v=It;if(v){if(c===void 0)throw Error(n(407));c=c()}else c=o();var b=!fa((er||g).memoizedState,c);if(b&&(g.memoizedState=c,jr=!0),g=g.queue,jg(x2.bind(null,h,g,i),[i]),g.getSnapshot!==o||b||zr!==null&&zr.memoizedState.tag&1){if(h.flags|=2048,qc(9,{destroy:void 0},g2.bind(null,h,g,c,o),null),lr===null)throw Error(n(349));v||(fs&127)!==0||p2(h,o,c)}return c}function p2(i,o,c){i.flags|=16384,i={getSnapshot:o,value:c},o=pt.updateQueue,o===null?(o=hd(),pt.updateQueue=o,o.stores=[i]):(c=o.stores,c===null?o.stores=[i]:c.push(i))}function g2(i,o,c,h){o.value=c,o.getSnapshot=h,v2(o)&&_2(i)}function x2(i,o,c){return c(function(){v2(o)&&_2(i)})}function v2(i){var o=i.getSnapshot;i=i.value;try{var c=o();return!fa(i,c)}catch{return!0}}function _2(i){var o=ul(i,2);o!==null&&ta(o,i,2)}function Ug(i){var o=Un();if(typeof i=="function"){var c=i;if(i=c(),_l){Ln(!0);try{c()}finally{Ln(!1)}}}return o.memoizedState=o.baseState=i,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:hs,lastRenderedState:i},o}function y2(i,o,c,h){return i.baseState=c,Vg(i,er,typeof h=="function"?h:hs)}function PR(i,o,c,h,g){if(xd(i))throw Error(n(485));if(i=o.action,i!==null){var v={payload:g,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(b){v.listeners.push(b)}};ae.T!==null?c(!0):v.isTransition=!1,h(v),c=o.pending,c===null?(v.next=o.pending=v,T2(o,v)):(v.next=c.next,o.pending=c.next=v)}}function T2(i,o){var c=o.action,h=o.payload,g=i.state;if(o.isTransition){var v=ae.T,b={};ae.T=b;try{var P=c(g,h),re=ae.S;re!==null&&re(b,P),E2(i,o,P)}catch(me){zg(i,o,me)}finally{v!==null&&b.types!==null&&(v.types=b.types),ae.T=v}}else try{v=c(g,h),E2(i,o,v)}catch(me){zg(i,o,me)}}function E2(i,o,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(h){w2(i,o,h)},function(h){return zg(i,o,h)}):w2(i,o,c)}function w2(i,o,c){o.status="fulfilled",o.value=c,S2(o),i.state=c,o=i.pending,o!==null&&(c=o.next,c===o?i.pending=null:(c=c.next,o.next=c,T2(i,c)))}function zg(i,o,c){var h=i.pending;if(i.pending=null,h!==null){h=h.next;do o.status="rejected",o.reason=c,S2(o),o=o.next;while(o!==h)}i.action=null}function S2(i){i=i.listeners;for(var o=0;o<i.length;o++)(0,i[o])()}function A2(i,o){return o}function b2(i,o){if(It){var c=lr.formState;if(c!==null){e:{var h=pt;if(It){if(fr){t:{for(var g=fr,v=Va;g.nodeType!==8;){if(!v){g=null;break t}if(g=Ua(g.nextSibling),g===null){g=null;break t}}v=g.data,g=v==="F!"||v==="F"?g:null}if(g){fr=Ua(g.nextSibling),h=g.data==="F!";break e}}Zs(h)}h=!1}h&&(o=c[0])}}return c=Un(),c.memoizedState=c.baseState=o,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:A2,lastRenderedState:o},c.queue=h,c=q2.bind(null,pt,h),h.dispatch=c,h=Ug(!1),v=Xg.bind(null,pt,!1,h.queue),h=Un(),g={state:o,dispatch:null,action:i,pending:null},h.queue=g,c=PR.bind(null,pt,g,v,c),g.dispatch=c,h.memoizedState=i,[o,c,!1]}function I2(i){var o=Mr();return k2(o,er,i)}function k2(i,o,c){if(o=Vg(i,o,A2)[0],i=md(hs)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var h=Mf(o)}catch(b){throw b===Uc?ad:b}else h=o;o=Mr();var g=o.queue,v=g.dispatch;return c!==o.memoizedState&&(pt.flags|=2048,qc(9,{destroy:void 0},LR.bind(null,g,c),null)),[h,v,i]}function LR(i,o){i.action=o}function C2(i){var o=Mr(),c=er;if(c!==null)return k2(o,c,i);Mr(),o=o.memoizedState,c=Mr();var h=c.queue.dispatch;return c.memoizedState=i,[o,h,!1]}function qc(i,o,c,h){return i={tag:i,create:c,deps:h,inst:o,next:null},o=pt.updateQueue,o===null&&(o=hd(),pt.updateQueue=o),c=o.lastEffect,c===null?o.lastEffect=i.next=i:(h=c.next,c.next=i,i.next=h,o.lastEffect=i),i}function R2(){return Mr().memoizedState}function pd(i,o,c,h){var g=Un();pt.flags|=i,g.memoizedState=qc(1|o,{destroy:void 0},c,h===void 0?null:h)}function gd(i,o,c,h){var g=Mr();h=h===void 0?null:h;var v=g.memoizedState.inst;er!==null&&h!==null&&Ng(h,er.memoizedState.deps)?g.memoizedState=qc(o,v,c,h):(pt.flags|=i,g.memoizedState=qc(1|o,v,c,h))}function D2(i,o){pd(8390656,8,i,o)}function jg(i,o){gd(2048,8,i,o)}function VR(i){pt.flags|=4;var o=pt.updateQueue;if(o===null)o=hd(),pt.updateQueue=o,o.events=[i];else{var c=o.events;c===null?o.events=[i]:c.push(i)}}function N2(i){var o=Mr().memoizedState;return VR({ref:o,nextImpl:i}),function(){if((Ut&2)!==0)throw Error(n(440));return o.impl.apply(void 0,arguments)}}function O2(i,o){return gd(4,2,i,o)}function F2(i,o){return gd(4,4,i,o)}function M2(i,o){if(typeof o=="function"){i=i();var c=o(i);return function(){typeof c=="function"?c():o(null)}}if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function P2(i,o,c){c=c!=null?c.concat([i]):null,gd(4,4,M2.bind(null,o,i),c)}function Hg(){}function L2(i,o){var c=Mr();o=o===void 0?null:o;var h=c.memoizedState;return o!==null&&Ng(o,h[1])?h[0]:(c.memoizedState=[i,o],i)}function V2(i,o){var c=Mr();o=o===void 0?null:o;var h=c.memoizedState;if(o!==null&&Ng(o,h[1]))return h[0];if(h=i(),_l){Ln(!0);try{i()}finally{Ln(!1)}}return c.memoizedState=[h,o],h}function Gg(i,o,c){return c===void 0||(fs&1073741824)!==0&&(St&261930)===0?i.memoizedState=o:(i.memoizedState=c,i=BT(),pt.lanes|=i,lo|=i,c)}function B2(i,o,c,h){return fa(c,o)?c:jc.current!==null?(i=Gg(i,c,h),fa(i,o)||(jr=!0),i):(fs&42)===0||(fs&1073741824)!==0&&(St&261930)===0?(jr=!0,i.memoizedState=c):(i=BT(),pt.lanes|=i,lo|=i,o)}function U2(i,o,c,h,g){var v=le.p;le.p=v!==0&&8>v?v:8;var b=ae.T,P={};ae.T=P,Xg(i,!1,o,c);try{var re=g(),me=ae.S;if(me!==null&&me(P,re),re!==null&&typeof re=="object"&&typeof re.then=="function"){var Ee=OR(re,h);Pf(i,o,Ee,xa(i))}else Pf(i,o,h,xa(i))}catch(be){Pf(i,o,{then:function(){},status:"rejected",reason:be},xa())}finally{le.p=v,b!==null&&P.types!==null&&(b.types=P.types),ae.T=b}}function BR(){}function qg(i,o,c,h){if(i.tag!==5)throw Error(n(476));var g=z2(i).queue;U2(i,g,o,Fe,c===null?BR:function(){return j2(i),c(h)})}function z2(i){var o=i.memoizedState;if(o!==null)return o;o={memoizedState:Fe,baseState:Fe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:hs,lastRenderedState:Fe},next:null};var c={};return o.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:hs,lastRenderedState:c},next:null},i.memoizedState=o,i=i.alternate,i!==null&&(i.memoizedState=o),o}function j2(i){var o=z2(i);o.next===null&&(o=i.alternate.memoizedState),Pf(i,o.next.queue,{},xa())}function Kg(){return mn(Zf)}function H2(){return Mr().memoizedState}function G2(){return Mr().memoizedState}function UR(i){for(var o=i.return;o!==null;){switch(o.tag){case 24:case 3:var c=xa();i=ro(c);var h=no(o,i,c);h!==null&&(ta(h,o,c),Df(h,o,c)),o={cache:Tg()},i.payload=o;return}o=o.return}}function zR(i,o,c){var h=xa();c={lane:h,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},xd(i)?K2(o,c):(c=ug(i,o,c,h),c!==null&&(ta(c,i,h),X2(c,o,h)))}function q2(i,o,c){var h=xa();Pf(i,o,c,h)}function Pf(i,o,c,h){var g={lane:h,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(xd(i))K2(o,g);else{var v=i.alternate;if(i.lanes===0&&(v===null||v.lanes===0)&&(v=o.lastRenderedReducer,v!==null))try{var b=o.lastRenderedState,P=v(b,c);if(g.hasEagerState=!0,g.eagerState=P,fa(P,b))return Q0(i,o,g,0),lr===null&&$0(),!1}catch{}finally{}if(c=ug(i,o,g,h),c!==null)return ta(c,i,h),X2(c,o,h),!0}return!1}function Xg(i,o,c,h){if(h={lane:2,revertLane:A1(),gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},xd(i)){if(o)throw Error(n(479))}else o=ug(i,c,h,2),o!==null&&ta(o,i,2)}function xd(i){var o=i.alternate;return i===pt||o!==null&&o===pt}function K2(i,o){Hc=ud=!0;var c=i.pending;c===null?o.next=o:(o.next=c.next,c.next=o),i.pending=o}function X2(i,o,c){if((c&4194048)!==0){var h=o.lanes;h&=i.pendingLanes,c|=h,o.lanes=c,rs(i,c)}}var Lf={readContext:mn,use:dd,useCallback:Ir,useContext:Ir,useEffect:Ir,useImperativeHandle:Ir,useLayoutEffect:Ir,useInsertionEffect:Ir,useMemo:Ir,useReducer:Ir,useRef:Ir,useState:Ir,useDebugValue:Ir,useDeferredValue:Ir,useTransition:Ir,useSyncExternalStore:Ir,useId:Ir,useHostTransitionStatus:Ir,useFormState:Ir,useActionState:Ir,useOptimistic:Ir,useMemoCache:Ir,useCacheRefresh:Ir};Lf.useEffectEvent=Ir;var W2={readContext:mn,use:dd,useCallback:function(i,o){return Un().memoizedState=[i,o===void 0?null:o],i},useContext:mn,useEffect:D2,useImperativeHandle:function(i,o,c){c=c!=null?c.concat([i]):null,pd(4194308,4,M2.bind(null,o,i),c)},useLayoutEffect:function(i,o){return pd(4194308,4,i,o)},useInsertionEffect:function(i,o){pd(4,2,i,o)},useMemo:function(i,o){var c=Un();o=o===void 0?null:o;var h=i();if(_l){Ln(!0);try{i()}finally{Ln(!1)}}return c.memoizedState=[h,o],h},useReducer:function(i,o,c){var h=Un();if(c!==void 0){var g=c(o);if(_l){Ln(!0);try{c(o)}finally{Ln(!1)}}}else g=o;return h.memoizedState=h.baseState=g,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:g},h.queue=i,i=i.dispatch=zR.bind(null,pt,i),[h.memoizedState,i]},useRef:function(i){var o=Un();return i={current:i},o.memoizedState=i},useState:function(i){i=Ug(i);var o=i.queue,c=q2.bind(null,pt,o);return o.dispatch=c,[i.memoizedState,c]},useDebugValue:Hg,useDeferredValue:function(i,o){var c=Un();return Gg(c,i,o)},useTransition:function(){var i=Ug(!1);return i=U2.bind(null,pt,i.queue,!0,!1),Un().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,o,c){var h=pt,g=Un();if(It){if(c===void 0)throw Error(n(407));c=c()}else{if(c=o(),lr===null)throw Error(n(349));(St&127)!==0||p2(h,o,c)}g.memoizedState=c;var v={value:c,getSnapshot:o};return g.queue=v,D2(x2.bind(null,h,v,i),[i]),h.flags|=2048,qc(9,{destroy:void 0},g2.bind(null,h,v,c,o),null),c},useId:function(){var i=Un(),o=lr.identifierPrefix;if(It){var c=Oi,h=Ni;c=(h&~(1<<32-Tr(h)-1)).toString(32)+c,o="_"+o+"R_"+c,c=fd++,0<c&&(o+="H"+c.toString(32)),o+="_"}else c=FR++,o="_"+o+"r_"+c.toString(32)+"_";return i.memoizedState=o},useHostTransitionStatus:Kg,useFormState:b2,useActionState:b2,useOptimistic:function(i){var o=Un();o.memoizedState=o.baseState=i;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=c,o=Xg.bind(null,pt,!0,c),c.dispatch=o,[i,o]},useMemoCache:Lg,useCacheRefresh:function(){return Un().memoizedState=UR.bind(null,pt)},useEffectEvent:function(i){var o=Un(),c={impl:i};return o.memoizedState=c,function(){if((Ut&2)!==0)throw Error(n(440));return c.impl.apply(void 0,arguments)}}},Wg={readContext:mn,use:dd,useCallback:L2,useContext:mn,useEffect:jg,useImperativeHandle:P2,useInsertionEffect:O2,useLayoutEffect:F2,useMemo:V2,useReducer:md,useRef:R2,useState:function(){return md(hs)},useDebugValue:Hg,useDeferredValue:function(i,o){var c=Mr();return B2(c,er.memoizedState,i,o)},useTransition:function(){var i=md(hs)[0],o=Mr().memoizedState;return[typeof i=="boolean"?i:Mf(i),o]},useSyncExternalStore:m2,useId:H2,useHostTransitionStatus:Kg,useFormState:I2,useActionState:I2,useOptimistic:function(i,o){var c=Mr();return y2(c,er,i,o)},useMemoCache:Lg,useCacheRefresh:G2};Wg.useEffectEvent=N2;var Y2={readContext:mn,use:dd,useCallback:L2,useContext:mn,useEffect:jg,useImperativeHandle:P2,useInsertionEffect:O2,useLayoutEffect:F2,useMemo:V2,useReducer:Bg,useRef:R2,useState:function(){return Bg(hs)},useDebugValue:Hg,useDeferredValue:function(i,o){var c=Mr();return er===null?Gg(c,i,o):B2(c,er.memoizedState,i,o)},useTransition:function(){var i=Bg(hs)[0],o=Mr().memoizedState;return[typeof i=="boolean"?i:Mf(i),o]},useSyncExternalStore:m2,useId:H2,useHostTransitionStatus:Kg,useFormState:C2,useActionState:C2,useOptimistic:function(i,o){var c=Mr();return er!==null?y2(c,er,i,o):(c.baseState=i,[i,c.queue.dispatch])},useMemoCache:Lg,useCacheRefresh:G2};Y2.useEffectEvent=N2;function Yg(i,o,c,h){o=i.memoizedState,c=c(h,o),c=c==null?o:x({},o,c),i.memoizedState=c,i.lanes===0&&(i.updateQueue.baseState=c)}var $g={enqueueSetState:function(i,o,c){i=i._reactInternals;var h=xa(),g=ro(h);g.payload=o,c!=null&&(g.callback=c),o=no(i,g,h),o!==null&&(ta(o,i,h),Df(o,i,h))},enqueueReplaceState:function(i,o,c){i=i._reactInternals;var h=xa(),g=ro(h);g.tag=1,g.payload=o,c!=null&&(g.callback=c),o=no(i,g,h),o!==null&&(ta(o,i,h),Df(o,i,h))},enqueueForceUpdate:function(i,o){i=i._reactInternals;var c=xa(),h=ro(c);h.tag=2,o!=null&&(h.callback=o),o=no(i,h,c),o!==null&&(ta(o,i,c),Df(o,i,c))}};function $2(i,o,c,h,g,v,b){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(h,v,b):o.prototype&&o.prototype.isPureReactComponent?!wf(c,h)||!wf(g,v):!0}function Q2(i,o,c,h){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(c,h),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(c,h),o.state!==i&&$g.enqueueReplaceState(o,o.state,null)}function yl(i,o){var c=o;if("ref"in o){c={};for(var h in o)h!=="ref"&&(c[h]=o[h])}if(i=i.defaultProps){c===o&&(c=x({},c));for(var g in i)c[g]===void 0&&(c[g]=i[g])}return c}function J2(i){Y0(i)}function Z2(i){console.error(i)}function eT(i){Y0(i)}function vd(i,o){try{var c=i.onUncaughtError;c(o.value,{componentStack:o.stack})}catch(h){setTimeout(function(){throw h})}}function tT(i,o,c){try{var h=i.onCaughtError;h(c.value,{componentStack:c.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function Qg(i,o,c){return c=ro(c),c.tag=3,c.payload={element:null},c.callback=function(){vd(i,o)},c}function rT(i){return i=ro(i),i.tag=3,i}function nT(i,o,c,h){var g=c.type.getDerivedStateFromError;if(typeof g=="function"){var v=h.value;i.payload=function(){return g(v)},i.callback=function(){tT(o,c,h)}}var b=c.stateNode;b!==null&&typeof b.componentDidCatch=="function"&&(i.callback=function(){tT(o,c,h),typeof g!="function"&&(co===null?co=new Set([this]):co.add(this));var P=h.stack;this.componentDidCatch(h.value,{componentStack:P!==null?P:""})})}function jR(i,o,c,h,g){if(c.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(o=c.alternate,o!==null&&Lc(o,c,g,!0),c=da.current,c!==null){switch(c.tag){case 31:case 13:return Ba===null?Rd():c.alternate===null&&kr===0&&(kr=3),c.flags&=-257,c.flags|=65536,c.lanes=g,h===id?c.flags|=16384:(o=c.updateQueue,o===null?c.updateQueue=new Set([h]):o.add(h),E1(i,h,g)),!1;case 22:return c.flags|=65536,h===id?c.flags|=16384:(o=c.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([h])},c.updateQueue=o):(c=o.retryQueue,c===null?o.retryQueue=new Set([h]):c.add(h)),E1(i,h,g)),!1}throw Error(n(435,c.tag))}return E1(i,h,g),Rd(),!1}if(It)return o=da.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=g,h!==gg&&(i=Error(n(422),{cause:h}),bf(Ma(i,c)))):(h!==gg&&(o=Error(n(423),{cause:h}),bf(Ma(o,c))),i=i.current.alternate,i.flags|=65536,g&=-g,i.lanes|=g,h=Ma(h,c),g=Qg(i.stateNode,h,g),Ig(i,g),kr!==4&&(kr=2)),!1;var v=Error(n(520),{cause:h});if(v=Ma(v,c),qf===null?qf=[v]:qf.push(v),kr!==4&&(kr=2),o===null)return!0;h=Ma(h,c),c=o;do{switch(c.tag){case 3:return c.flags|=65536,i=g&-g,c.lanes|=i,i=Qg(c.stateNode,h,i),Ig(c,i),!1;case 1:if(o=c.type,v=c.stateNode,(c.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(co===null||!co.has(v))))return c.flags|=65536,g&=-g,c.lanes|=g,g=rT(g),nT(g,i,c,h),Ig(c,g),!1}c=c.return}while(c!==null);return!1}var Jg=Error(n(461)),jr=!1;function pn(i,o,c,h){o.child=i===null?o2(o,null,c,h):vl(o,i.child,c,h)}function aT(i,o,c,h,g){c=c.render;var v=o.ref;if("ref"in h){var b={};for(var P in h)P!=="ref"&&(b[P]=h[P])}else b=h;return ml(o),h=Og(i,o,c,b,v,g),P=Fg(),i!==null&&!jr?(Mg(i,o,g),ds(i,o,g)):(It&&P&&mg(o),o.flags|=1,pn(i,o,h,g),o.child)}function iT(i,o,c,h,g){if(i===null){var v=c.type;return typeof v=="function"&&!fg(v)&&v.defaultProps===void 0&&c.compare===null?(o.tag=15,o.type=v,sT(i,o,v,h,g)):(i=Z0(c.type,null,h,o,o.mode,g),i.ref=o.ref,i.return=o,o.child=i)}if(v=i.child,!s1(i,g)){var b=v.memoizedProps;if(c=c.compare,c=c!==null?c:wf,c(b,h)&&i.ref===o.ref)return ds(i,o,g)}return o.flags|=1,i=os(v,h),i.ref=o.ref,i.return=o,o.child=i}function sT(i,o,c,h,g){if(i!==null){var v=i.memoizedProps;if(wf(v,h)&&i.ref===o.ref)if(jr=!1,o.pendingProps=h=v,s1(i,g))(i.flags&131072)!==0&&(jr=!0);else return o.lanes=i.lanes,ds(i,o,g)}return Zg(i,o,c,h,g)}function oT(i,o,c,h){var g=h.children,v=i!==null?i.memoizedState:null;if(i===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.mode==="hidden"){if((o.flags&128)!==0){if(v=v!==null?v.baseLanes|c:c,i!==null){for(h=o.child=i.child,g=0;h!==null;)g=g|h.lanes|h.childLanes,h=h.sibling;h=g&~v}else h=0,o.child=null;return lT(i,o,v,c,h)}if((c&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},i!==null&&nd(o,v!==null?v.cachePool:null),v!==null?u2(o,v):Cg(),f2(o);else return h=o.lanes=536870912,lT(i,o,v!==null?v.baseLanes|c:c,c,h)}else v!==null?(nd(o,v.cachePool),u2(o,v),io(),o.memoizedState=null):(i!==null&&nd(o,null),Cg(),io());return pn(i,o,g,c),o.child}function Vf(i,o){return i!==null&&i.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function lT(i,o,c,h,g){var v=wg();return v=v===null?null:{parent:Ur._currentValue,pool:v},o.memoizedState={baseLanes:c,cachePool:v},i!==null&&nd(o,null),Cg(),f2(o),i!==null&&Lc(i,o,h,!0),o.childLanes=g,null}function _d(i,o){return o=Td({mode:o.mode,children:o.children},i.mode),o.ref=i.ref,i.child=o,o.return=i,o}function cT(i,o,c){return vl(o,i.child,null,c),i=_d(o,o.pendingProps),i.flags|=2,ma(o),o.memoizedState=null,i}function HR(i,o,c){var h=o.pendingProps,g=(o.flags&128)!==0;if(o.flags&=-129,i===null){if(It){if(h.mode==="hidden")return i=_d(o,h),o.lanes=536870912,Vf(null,i);if(Dg(o),(i=fr)?(i=TE(i,Va),i=i!==null&&i.data==="&"?i:null,i!==null&&(o.memoizedState={dehydrated:i,treeContext:Qs!==null?{id:Ni,overflow:Oi}:null,retryLane:536870912,hydrationErrors:null},c=Ky(i),c.return=o,o.child=c,dn=o,fr=null)):i=null,i===null)throw Zs(o);return o.lanes=536870912,null}return _d(o,h)}var v=i.memoizedState;if(v!==null){var b=v.dehydrated;if(Dg(o),g)if(o.flags&256)o.flags&=-257,o=cT(i,o,c);else if(o.memoizedState!==null)o.child=i.child,o.flags|=128,o=null;else throw Error(n(558));else if(jr||Lc(i,o,c,!1),g=(c&i.childLanes)!==0,jr||g){if(h=lr,h!==null&&(b=Jo(h,c),b!==0&&b!==v.retryLane))throw v.retryLane=b,ul(i,b),ta(h,i,b),Jg;Rd(),o=cT(i,o,c)}else i=v.treeContext,fr=Ua(b.nextSibling),dn=o,It=!0,Js=null,Va=!1,i!==null&&Yy(o,i),o=_d(o,h),o.flags|=4096;return o}return i=os(i.child,{mode:h.mode,children:h.children}),i.ref=o.ref,o.child=i,i.return=o,i}function yd(i,o){var c=o.ref;if(c===null)i!==null&&i.ref!==null&&(o.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(n(284));(i===null||i.ref!==c)&&(o.flags|=4194816)}}function Zg(i,o,c,h,g){return ml(o),c=Og(i,o,c,h,void 0,g),h=Fg(),i!==null&&!jr?(Mg(i,o,g),ds(i,o,g)):(It&&h&&mg(o),o.flags|=1,pn(i,o,c,g),o.child)}function uT(i,o,c,h,g,v){return ml(o),o.updateQueue=null,c=d2(o,h,c,g),h2(i),h=Fg(),i!==null&&!jr?(Mg(i,o,v),ds(i,o,v)):(It&&h&&mg(o),o.flags|=1,pn(i,o,c,v),o.child)}function fT(i,o,c,h,g){if(ml(o),o.stateNode===null){var v=Oc,b=c.contextType;typeof b=="object"&&b!==null&&(v=mn(b)),v=new c(h,v),o.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=$g,o.stateNode=v,v._reactInternals=o,v=o.stateNode,v.props=h,v.state=o.memoizedState,v.refs={},Ag(o),b=c.contextType,v.context=typeof b=="object"&&b!==null?mn(b):Oc,v.state=o.memoizedState,b=c.getDerivedStateFromProps,typeof b=="function"&&(Yg(o,c,b,h),v.state=o.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(b=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),b!==v.state&&$g.enqueueReplaceState(v,v.state,null),Of(o,h,v,g),Nf(),v.state=o.memoizedState),typeof v.componentDidMount=="function"&&(o.flags|=4194308),h=!0}else if(i===null){v=o.stateNode;var P=o.memoizedProps,re=yl(c,P);v.props=re;var me=v.context,Ee=c.contextType;b=Oc,typeof Ee=="object"&&Ee!==null&&(b=mn(Ee));var be=c.getDerivedStateFromProps;Ee=typeof be=="function"||typeof v.getSnapshotBeforeUpdate=="function",P=o.pendingProps!==P,Ee||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(P||me!==b)&&Q2(o,v,h,b),to=!1;var xe=o.memoizedState;v.state=xe,Of(o,h,v,g),Nf(),me=o.memoizedState,P||xe!==me||to?(typeof be=="function"&&(Yg(o,c,be,h),me=o.memoizedState),(re=to||$2(o,c,re,h,xe,me,b))?(Ee||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(o.flags|=4194308)):(typeof v.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=h,o.memoizedState=me),v.props=h,v.state=me,v.context=b,h=re):(typeof v.componentDidMount=="function"&&(o.flags|=4194308),h=!1)}else{v=o.stateNode,bg(i,o),b=o.memoizedProps,Ee=yl(c,b),v.props=Ee,be=o.pendingProps,xe=v.context,me=c.contextType,re=Oc,typeof me=="object"&&me!==null&&(re=mn(me)),P=c.getDerivedStateFromProps,(me=typeof P=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(b!==be||xe!==re)&&Q2(o,v,h,re),to=!1,xe=o.memoizedState,v.state=xe,Of(o,h,v,g),Nf();var _e=o.memoizedState;b!==be||xe!==_e||to||i!==null&&i.dependencies!==null&&td(i.dependencies)?(typeof P=="function"&&(Yg(o,c,P,h),_e=o.memoizedState),(Ee=to||$2(o,c,Ee,h,xe,_e,re)||i!==null&&i.dependencies!==null&&td(i.dependencies))?(me||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(h,_e,re),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(h,_e,re)),typeof v.componentDidUpdate=="function"&&(o.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof v.componentDidUpdate!="function"||b===i.memoizedProps&&xe===i.memoizedState||(o.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||b===i.memoizedProps&&xe===i.memoizedState||(o.flags|=1024),o.memoizedProps=h,o.memoizedState=_e),v.props=h,v.state=_e,v.context=re,h=Ee):(typeof v.componentDidUpdate!="function"||b===i.memoizedProps&&xe===i.memoizedState||(o.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||b===i.memoizedProps&&xe===i.memoizedState||(o.flags|=1024),h=!1)}return v=h,yd(i,o),h=(o.flags&128)!==0,v||h?(v=o.stateNode,c=h&&typeof c.getDerivedStateFromError!="function"?null:v.render(),o.flags|=1,i!==null&&h?(o.child=vl(o,i.child,null,g),o.child=vl(o,null,c,g)):pn(i,o,c,g),o.memoizedState=v.state,i=o.child):i=ds(i,o,g),i}function hT(i,o,c,h){return hl(),o.flags|=256,pn(i,o,c,h),o.child}var e1={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function t1(i){return{baseLanes:i,cachePool:t2()}}function r1(i,o,c){return i=i!==null?i.childLanes&~c:0,o&&(i|=ga),i}function dT(i,o,c){var h=o.pendingProps,g=!1,v=(o.flags&128)!==0,b;if((b=v)||(b=i!==null&&i.memoizedState===null?!1:(Fr.current&2)!==0),b&&(g=!0,o.flags&=-129),b=(o.flags&32)!==0,o.flags&=-33,i===null){if(It){if(g?ao(o):io(),(i=fr)?(i=TE(i,Va),i=i!==null&&i.data!=="&"?i:null,i!==null&&(o.memoizedState={dehydrated:i,treeContext:Qs!==null?{id:Ni,overflow:Oi}:null,retryLane:536870912,hydrationErrors:null},c=Ky(i),c.return=o,o.child=c,dn=o,fr=null)):i=null,i===null)throw Zs(o);return V1(i)?o.lanes=32:o.lanes=536870912,null}var P=h.children;return h=h.fallback,g?(io(),g=o.mode,P=Td({mode:"hidden",children:P},g),h=fl(h,g,c,null),P.return=o,h.return=o,P.sibling=h,o.child=P,h=o.child,h.memoizedState=t1(c),h.childLanes=r1(i,b,c),o.memoizedState=e1,Vf(null,h)):(ao(o),n1(o,P))}var re=i.memoizedState;if(re!==null&&(P=re.dehydrated,P!==null)){if(v)o.flags&256?(ao(o),o.flags&=-257,o=a1(i,o,c)):o.memoizedState!==null?(io(),o.child=i.child,o.flags|=128,o=null):(io(),P=h.fallback,g=o.mode,h=Td({mode:"visible",children:h.children},g),P=fl(P,g,c,null),P.flags|=2,h.return=o,P.return=o,h.sibling=P,o.child=h,vl(o,i.child,null,c),h=o.child,h.memoizedState=t1(c),h.childLanes=r1(i,b,c),o.memoizedState=e1,o=Vf(null,h));else if(ao(o),V1(P)){if(b=P.nextSibling&&P.nextSibling.dataset,b)var me=b.dgst;b=me,h=Error(n(419)),h.stack="",h.digest=b,bf({value:h,source:null,stack:null}),o=a1(i,o,c)}else if(jr||Lc(i,o,c,!1),b=(c&i.childLanes)!==0,jr||b){if(b=lr,b!==null&&(h=Jo(b,c),h!==0&&h!==re.retryLane))throw re.retryLane=h,ul(i,h),ta(b,i,h),Jg;L1(P)||Rd(),o=a1(i,o,c)}else L1(P)?(o.flags|=192,o.child=i.child,o=null):(i=re.treeContext,fr=Ua(P.nextSibling),dn=o,It=!0,Js=null,Va=!1,i!==null&&Yy(o,i),o=n1(o,h.children),o.flags|=4096);return o}return g?(io(),P=h.fallback,g=o.mode,re=i.child,me=re.sibling,h=os(re,{mode:"hidden",children:h.children}),h.subtreeFlags=re.subtreeFlags&65011712,me!==null?P=os(me,P):(P=fl(P,g,c,null),P.flags|=2),P.return=o,h.return=o,h.sibling=P,o.child=h,Vf(null,h),h=o.child,P=i.child.memoizedState,P===null?P=t1(c):(g=P.cachePool,g!==null?(re=Ur._currentValue,g=g.parent!==re?{parent:re,pool:re}:g):g=t2(),P={baseLanes:P.baseLanes|c,cachePool:g}),h.memoizedState=P,h.childLanes=r1(i,b,c),o.memoizedState=e1,Vf(i.child,h)):(ao(o),c=i.child,i=c.sibling,c=os(c,{mode:"visible",children:h.children}),c.return=o,c.sibling=null,i!==null&&(b=o.deletions,b===null?(o.deletions=[i],o.flags|=16):b.push(i)),o.child=c,o.memoizedState=null,c)}function n1(i,o){return o=Td({mode:"visible",children:o},i.mode),o.return=i,i.child=o}function Td(i,o){return i=ha(22,i,null,o),i.lanes=0,i}function a1(i,o,c){return vl(o,i.child,null,c),i=n1(o,o.pendingProps.children),i.flags|=2,o.memoizedState=null,i}function mT(i,o,c){i.lanes|=o;var h=i.alternate;h!==null&&(h.lanes|=o),_g(i.return,o,c)}function i1(i,o,c,h,g,v){var b=i.memoizedState;b===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:h,tail:c,tailMode:g,treeForkCount:v}:(b.isBackwards=o,b.rendering=null,b.renderingStartTime=0,b.last=h,b.tail=c,b.tailMode=g,b.treeForkCount=v)}function pT(i,o,c){var h=o.pendingProps,g=h.revealOrder,v=h.tail;h=h.children;var b=Fr.current,P=(b&2)!==0;if(P?(b=b&1|2,o.flags|=128):b&=1,J(Fr,b),pn(i,o,h,c),h=It?Af:0,!P&&i!==null&&(i.flags&128)!==0)e:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&mT(i,c,o);else if(i.tag===19)mT(i,c,o);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break e;for(;i.sibling===null;){if(i.return===null||i.return===o)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(g){case"forwards":for(c=o.child,g=null;c!==null;)i=c.alternate,i!==null&&cd(i)===null&&(g=c),c=c.sibling;c=g,c===null?(g=o.child,o.child=null):(g=c.sibling,c.sibling=null),i1(o,!1,g,c,v,h);break;case"backwards":case"unstable_legacy-backwards":for(c=null,g=o.child,o.child=null;g!==null;){if(i=g.alternate,i!==null&&cd(i)===null){o.child=g;break}i=g.sibling,g.sibling=c,c=g,g=i}i1(o,!0,c,null,v,h);break;case"together":i1(o,!1,null,null,void 0,h);break;default:o.memoizedState=null}return o.child}function ds(i,o,c){if(i!==null&&(o.dependencies=i.dependencies),lo|=o.lanes,(c&o.childLanes)===0)if(i!==null){if(Lc(i,o,c,!1),(c&o.childLanes)===0)return null}else return null;if(i!==null&&o.child!==i.child)throw Error(n(153));if(o.child!==null){for(i=o.child,c=os(i,i.pendingProps),o.child=c,c.return=o;i.sibling!==null;)i=i.sibling,c=c.sibling=os(i,i.pendingProps),c.return=o;c.sibling=null}return o.child}function s1(i,o){return(i.lanes&o)!==0?!0:(i=i.dependencies,!!(i!==null&&td(i)))}function GR(i,o,c){switch(o.tag){case 3:De(o,o.stateNode.containerInfo),eo(o,Ur,i.memoizedState.cache),hl();break;case 27:case 5:Oe(o);break;case 4:De(o,o.stateNode.containerInfo);break;case 10:eo(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,Dg(o),null;break;case 13:var h=o.memoizedState;if(h!==null)return h.dehydrated!==null?(ao(o),o.flags|=128,null):(c&o.child.childLanes)!==0?dT(i,o,c):(ao(o),i=ds(i,o,c),i!==null?i.sibling:null);ao(o);break;case 19:var g=(i.flags&128)!==0;if(h=(c&o.childLanes)!==0,h||(Lc(i,o,c,!1),h=(c&o.childLanes)!==0),g){if(h)return pT(i,o,c);o.flags|=128}if(g=o.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),J(Fr,Fr.current),h)break;return null;case 22:return o.lanes=0,oT(i,o,c,o.pendingProps);case 24:eo(o,Ur,i.memoizedState.cache)}return ds(i,o,c)}function gT(i,o,c){if(i!==null)if(i.memoizedProps!==o.pendingProps)jr=!0;else{if(!s1(i,c)&&(o.flags&128)===0)return jr=!1,GR(i,o,c);jr=(i.flags&131072)!==0}else jr=!1,It&&(o.flags&1048576)!==0&&Wy(o,Af,o.index);switch(o.lanes=0,o.tag){case 16:e:{var h=o.pendingProps;if(i=gl(o.elementType),o.type=i,typeof i=="function")fg(i)?(h=yl(i,h),o.tag=1,o=fT(null,o,i,h,c)):(o.tag=0,o=Zg(null,o,i,h,c));else{if(i!=null){var g=i.$$typeof;if(g===Y){o.tag=11,o=aT(null,o,i,h,c);break e}else if(g===A){o.tag=14,o=iT(null,o,i,h,c);break e}}throw o=Ie(i)||i,Error(n(306,o,""))}}return o;case 0:return Zg(i,o,o.type,o.pendingProps,c);case 1:return h=o.type,g=yl(h,o.pendingProps),fT(i,o,h,g,c);case 3:e:{if(De(o,o.stateNode.containerInfo),i===null)throw Error(n(387));h=o.pendingProps;var v=o.memoizedState;g=v.element,bg(i,o),Of(o,h,null,c);var b=o.memoizedState;if(h=b.cache,eo(o,Ur,h),h!==v.cache&&yg(o,[Ur],c,!0),Nf(),h=b.element,v.isDehydrated)if(v={element:h,isDehydrated:!1,cache:b.cache},o.updateQueue.baseState=v,o.memoizedState=v,o.flags&256){o=hT(i,o,h,c);break e}else if(h!==g){g=Ma(Error(n(424)),o),bf(g),o=hT(i,o,h,c);break e}else{switch(i=o.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(fr=Ua(i.firstChild),dn=o,It=!0,Js=null,Va=!0,c=o2(o,null,h,c),o.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(hl(),h===g){o=ds(i,o,c);break e}pn(i,o,h,c)}o=o.child}return o;case 26:return yd(i,o),i===null?(c=IE(o.type,null,o.pendingProps,null))?o.memoizedState=c:It||(c=o.type,i=o.pendingProps,h=Ld(ce.current).createElement(c),h[H]=o,h[q]=i,gn(h,c,i),We(h),o.stateNode=h):o.memoizedState=IE(o.type,i.memoizedProps,o.pendingProps,i.memoizedState),null;case 27:return Oe(o),i===null&&It&&(h=o.stateNode=SE(o.type,o.pendingProps,ce.current),dn=o,Va=!0,g=fr,mo(o.type)?(B1=g,fr=Ua(h.firstChild)):fr=g),pn(i,o,o.pendingProps.children,c),yd(i,o),i===null&&(o.flags|=4194304),o.child;case 5:return i===null&&It&&((g=h=fr)&&(h=yD(h,o.type,o.pendingProps,Va),h!==null?(o.stateNode=h,dn=o,fr=Ua(h.firstChild),Va=!1,g=!0):g=!1),g||Zs(o)),Oe(o),g=o.type,v=o.pendingProps,b=i!==null?i.memoizedProps:null,h=v.children,F1(g,v)?h=null:b!==null&&F1(g,b)&&(o.flags|=32),o.memoizedState!==null&&(g=Og(i,o,MR,null,null,c),Zf._currentValue=g),yd(i,o),pn(i,o,h,c),o.child;case 6:return i===null&&It&&((i=c=fr)&&(c=TD(c,o.pendingProps,Va),c!==null?(o.stateNode=c,dn=o,fr=null,i=!0):i=!1),i||Zs(o)),null;case 13:return dT(i,o,c);case 4:return De(o,o.stateNode.containerInfo),h=o.pendingProps,i===null?o.child=vl(o,null,h,c):pn(i,o,h,c),o.child;case 11:return aT(i,o,o.type,o.pendingProps,c);case 7:return pn(i,o,o.pendingProps,c),o.child;case 8:return pn(i,o,o.pendingProps.children,c),o.child;case 12:return pn(i,o,o.pendingProps.children,c),o.child;case 10:return h=o.pendingProps,eo(o,o.type,h.value),pn(i,o,h.children,c),o.child;case 9:return g=o.type._context,h=o.pendingProps.children,ml(o),g=mn(g),h=h(g),o.flags|=1,pn(i,o,h,c),o.child;case 14:return iT(i,o,o.type,o.pendingProps,c);case 15:return sT(i,o,o.type,o.pendingProps,c);case 19:return pT(i,o,c);case 31:return HR(i,o,c);case 22:return oT(i,o,c,o.pendingProps);case 24:return ml(o),h=mn(Ur),i===null?(g=wg(),g===null&&(g=lr,v=Tg(),g.pooledCache=v,v.refCount++,v!==null&&(g.pooledCacheLanes|=c),g=v),o.memoizedState={parent:h,cache:g},Ag(o),eo(o,Ur,g)):((i.lanes&c)!==0&&(bg(i,o),Of(o,null,null,c),Nf()),g=i.memoizedState,v=o.memoizedState,g.parent!==h?(g={parent:h,cache:h},o.memoizedState=g,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=g),eo(o,Ur,h)):(h=v.cache,eo(o,Ur,h),h!==g.cache&&yg(o,[Ur],c,!0))),pn(i,o,o.pendingProps.children,c),o.child;case 29:throw o.pendingProps}throw Error(n(156,o.tag))}function ms(i){i.flags|=4}function o1(i,o,c,h,g){if((o=(i.mode&32)!==0)&&(o=!1),o){if(i.flags|=16777216,(g&335544128)===g)if(i.stateNode.complete)i.flags|=8192;else if(HT())i.flags|=8192;else throw xl=id,Sg}else i.flags&=-16777217}function xT(i,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!NE(o))if(HT())i.flags|=8192;else throw xl=id,Sg}function Ed(i,o){o!==null&&(i.flags|=4),i.flags&16384&&(o=i.tag!==22?yc():536870912,i.lanes|=o,Yc|=o)}function Bf(i,o){if(!It)switch(i.tailMode){case"hidden":o=i.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?i.tail=null:c.sibling=null;break;case"collapsed":c=i.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:h.sibling=null}}function hr(i){var o=i.alternate!==null&&i.alternate.child===i.child,c=0,h=0;if(o)for(var g=i.child;g!==null;)c|=g.lanes|g.childLanes,h|=g.subtreeFlags&65011712,h|=g.flags&65011712,g.return=i,g=g.sibling;else for(g=i.child;g!==null;)c|=g.lanes|g.childLanes,h|=g.subtreeFlags,h|=g.flags,g.return=i,g=g.sibling;return i.subtreeFlags|=h,i.childLanes=c,o}function qR(i,o,c){var h=o.pendingProps;switch(pg(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return hr(o),null;case 1:return hr(o),null;case 3:return c=o.stateNode,h=null,i!==null&&(h=i.memoizedState.cache),o.memoizedState.cache!==h&&(o.flags|=2048),us(Ur),Ae(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(i===null||i.child===null)&&(Pc(o)?ms(o):i===null||i.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,xg())),hr(o),null;case 26:var g=o.type,v=o.memoizedState;return i===null?(ms(o),v!==null?(hr(o),xT(o,v)):(hr(o),o1(o,g,null,h,c))):v?v!==i.memoizedState?(ms(o),hr(o),xT(o,v)):(hr(o),o.flags&=-16777217):(i=i.memoizedProps,i!==h&&ms(o),hr(o),o1(o,g,i,h,c)),null;case 27:if(st(o),c=ce.current,g=o.type,i!==null&&o.stateNode!=null)i.memoizedProps!==h&&ms(o);else{if(!h){if(o.stateNode===null)throw Error(n(166));return hr(o),null}i=X.current,Pc(o)?$y(o):(i=SE(g,h,c),o.stateNode=i,ms(o))}return hr(o),null;case 5:if(st(o),g=o.type,i!==null&&o.stateNode!=null)i.memoizedProps!==h&&ms(o);else{if(!h){if(o.stateNode===null)throw Error(n(166));return hr(o),null}if(v=X.current,Pc(o))$y(o);else{var b=Ld(ce.current);switch(v){case 1:v=b.createElementNS("http://www.w3.org/2000/svg",g);break;case 2:v=b.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;default:switch(g){case"svg":v=b.createElementNS("http://www.w3.org/2000/svg",g);break;case"math":v=b.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;case"script":v=b.createElement("div"),v.innerHTML="<script><\/script>",v=v.removeChild(v.firstChild);break;case"select":v=typeof h.is=="string"?b.createElement("select",{is:h.is}):b.createElement("select"),h.multiple?v.multiple=!0:h.size&&(v.size=h.size);break;default:v=typeof h.is=="string"?b.createElement(g,{is:h.is}):b.createElement(g)}}v[H]=o,v[q]=h;e:for(b=o.child;b!==null;){if(b.tag===5||b.tag===6)v.appendChild(b.stateNode);else if(b.tag!==4&&b.tag!==27&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===o)break e;for(;b.sibling===null;){if(b.return===null||b.return===o)break e;b=b.return}b.sibling.return=b.return,b=b.sibling}o.stateNode=v;e:switch(gn(v,g,h),g){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}h&&ms(o)}}return hr(o),o1(o,o.type,i===null?null:i.memoizedProps,o.pendingProps,c),null;case 6:if(i&&o.stateNode!=null)i.memoizedProps!==h&&ms(o);else{if(typeof h!="string"&&o.stateNode===null)throw Error(n(166));if(i=ce.current,Pc(o)){if(i=o.stateNode,c=o.memoizedProps,h=null,g=dn,g!==null)switch(g.tag){case 27:case 5:h=g.memoizedProps}i[H]=o,i=!!(i.nodeValue===c||h!==null&&h.suppressHydrationWarning===!0||dE(i.nodeValue,c)),i||Zs(o,!0)}else i=Ld(i).createTextNode(h),i[H]=o,o.stateNode=i}return hr(o),null;case 31:if(c=o.memoizedState,i===null||i.memoizedState!==null){if(h=Pc(o),c!==null){if(i===null){if(!h)throw Error(n(318));if(i=o.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(557));i[H]=o}else hl(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;hr(o),i=!1}else c=xg(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=c),i=!0;if(!i)return o.flags&256?(ma(o),o):(ma(o),null);if((o.flags&128)!==0)throw Error(n(558))}return hr(o),null;case 13:if(h=o.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(g=Pc(o),h!==null&&h.dehydrated!==null){if(i===null){if(!g)throw Error(n(318));if(g=o.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(n(317));g[H]=o}else hl(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;hr(o),g=!1}else g=xg(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=g),g=!0;if(!g)return o.flags&256?(ma(o),o):(ma(o),null)}return ma(o),(o.flags&128)!==0?(o.lanes=c,o):(c=h!==null,i=i!==null&&i.memoizedState!==null,c&&(h=o.child,g=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(g=h.alternate.memoizedState.cachePool.pool),v=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(v=h.memoizedState.cachePool.pool),v!==g&&(h.flags|=2048)),c!==i&&c&&(o.child.flags|=8192),Ed(o,o.updateQueue),hr(o),null);case 4:return Ae(),i===null&&C1(o.stateNode.containerInfo),hr(o),null;case 10:return us(o.type),hr(o),null;case 19:if(N(Fr),h=o.memoizedState,h===null)return hr(o),null;if(g=(o.flags&128)!==0,v=h.rendering,v===null)if(g)Bf(h,!1);else{if(kr!==0||i!==null&&(i.flags&128)!==0)for(i=o.child;i!==null;){if(v=cd(i),v!==null){for(o.flags|=128,Bf(h,!1),i=v.updateQueue,o.updateQueue=i,Ed(o,i),o.subtreeFlags=0,i=c,c=o.child;c!==null;)qy(c,i),c=c.sibling;return J(Fr,Fr.current&1|2),It&&ls(o,h.treeForkCount),o.child}i=i.sibling}h.tail!==null&&jt()>Id&&(o.flags|=128,g=!0,Bf(h,!1),o.lanes=4194304)}else{if(!g)if(i=cd(v),i!==null){if(o.flags|=128,g=!0,i=i.updateQueue,o.updateQueue=i,Ed(o,i),Bf(h,!0),h.tail===null&&h.tailMode==="hidden"&&!v.alternate&&!It)return hr(o),null}else 2*jt()-h.renderingStartTime>Id&&c!==536870912&&(o.flags|=128,g=!0,Bf(h,!1),o.lanes=4194304);h.isBackwards?(v.sibling=o.child,o.child=v):(i=h.last,i!==null?i.sibling=v:o.child=v,h.last=v)}return h.tail!==null?(i=h.tail,h.rendering=i,h.tail=i.sibling,h.renderingStartTime=jt(),i.sibling=null,c=Fr.current,J(Fr,g?c&1|2:c&1),It&&ls(o,h.treeForkCount),i):(hr(o),null);case 22:case 23:return ma(o),Rg(),h=o.memoizedState!==null,i!==null?i.memoizedState!==null!==h&&(o.flags|=8192):h&&(o.flags|=8192),h?(c&536870912)!==0&&(o.flags&128)===0&&(hr(o),o.subtreeFlags&6&&(o.flags|=8192)):hr(o),c=o.updateQueue,c!==null&&Ed(o,c.retryQueue),c=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),h=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(h=o.memoizedState.cachePool.pool),h!==c&&(o.flags|=2048),i!==null&&N(pl),null;case 24:return c=null,i!==null&&(c=i.memoizedState.cache),o.memoizedState.cache!==c&&(o.flags|=2048),us(Ur),hr(o),null;case 25:return null;case 30:return null}throw Error(n(156,o.tag))}function KR(i,o){switch(pg(o),o.tag){case 1:return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 3:return us(Ur),Ae(),i=o.flags,(i&65536)!==0&&(i&128)===0?(o.flags=i&-65537|128,o):null;case 26:case 27:case 5:return st(o),null;case 31:if(o.memoizedState!==null){if(ma(o),o.alternate===null)throw Error(n(340));hl()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 13:if(ma(o),i=o.memoizedState,i!==null&&i.dehydrated!==null){if(o.alternate===null)throw Error(n(340));hl()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 19:return N(Fr),null;case 4:return Ae(),null;case 10:return us(o.type),null;case 22:case 23:return ma(o),Rg(),i!==null&&N(pl),i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 24:return us(Ur),null;case 25:return null;default:return null}}function vT(i,o){switch(pg(o),o.tag){case 3:us(Ur),Ae();break;case 26:case 27:case 5:st(o);break;case 4:Ae();break;case 31:o.memoizedState!==null&&ma(o);break;case 13:ma(o);break;case 19:N(Fr);break;case 10:us(o.type);break;case 22:case 23:ma(o),Rg(),i!==null&&N(pl);break;case 24:us(Ur)}}function Uf(i,o){try{var c=o.updateQueue,h=c!==null?c.lastEffect:null;if(h!==null){var g=h.next;c=g;do{if((c.tag&i)===i){h=void 0;var v=c.create,b=c.inst;h=v(),b.destroy=h}c=c.next}while(c!==g)}}catch(P){Xt(o,o.return,P)}}function so(i,o,c){try{var h=o.updateQueue,g=h!==null?h.lastEffect:null;if(g!==null){var v=g.next;h=v;do{if((h.tag&i)===i){var b=h.inst,P=b.destroy;if(P!==void 0){b.destroy=void 0,g=o;var re=c,me=P;try{me()}catch(Ee){Xt(g,re,Ee)}}}h=h.next}while(h!==v)}}catch(Ee){Xt(o,o.return,Ee)}}function _T(i){var o=i.updateQueue;if(o!==null){var c=i.stateNode;try{c2(o,c)}catch(h){Xt(i,i.return,h)}}}function yT(i,o,c){c.props=yl(i.type,i.memoizedProps),c.state=i.memoizedState;try{c.componentWillUnmount()}catch(h){Xt(i,o,h)}}function zf(i,o){try{var c=i.ref;if(c!==null){switch(i.tag){case 26:case 27:case 5:var h=i.stateNode;break;case 30:h=i.stateNode;break;default:h=i.stateNode}typeof c=="function"?i.refCleanup=c(h):c.current=h}}catch(g){Xt(i,o,g)}}function Fi(i,o){var c=i.ref,h=i.refCleanup;if(c!==null)if(typeof h=="function")try{h()}catch(g){Xt(i,o,g)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(g){Xt(i,o,g)}else c.current=null}function TT(i){var o=i.type,c=i.memoizedProps,h=i.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":c.autoFocus&&h.focus();break e;case"img":c.src?h.src=c.src:c.srcSet&&(h.srcset=c.srcSet)}}catch(g){Xt(i,i.return,g)}}function l1(i,o,c){try{var h=i.stateNode;mD(h,i.type,c,o),h[q]=o}catch(g){Xt(i,i.return,g)}}function ET(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&mo(i.type)||i.tag===4}function c1(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||ET(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&mo(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function u1(i,o,c){var h=i.tag;if(h===5||h===6)i=i.stateNode,o?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(i,o):(o=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,o.appendChild(i),c=c._reactRootContainer,c!=null||o.onclick!==null||(o.onclick=si));else if(h!==4&&(h===27&&mo(i.type)&&(c=i.stateNode,o=null),i=i.child,i!==null))for(u1(i,o,c),i=i.sibling;i!==null;)u1(i,o,c),i=i.sibling}function wd(i,o,c){var h=i.tag;if(h===5||h===6)i=i.stateNode,o?c.insertBefore(i,o):c.appendChild(i);else if(h!==4&&(h===27&&mo(i.type)&&(c=i.stateNode),i=i.child,i!==null))for(wd(i,o,c),i=i.sibling;i!==null;)wd(i,o,c),i=i.sibling}function wT(i){var o=i.stateNode,c=i.memoizedProps;try{for(var h=i.type,g=o.attributes;g.length;)o.removeAttributeNode(g[0]);gn(o,h,c),o[H]=i,o[q]=c}catch(v){Xt(i,i.return,v)}}var ps=!1,Hr=!1,f1=!1,ST=typeof WeakSet=="function"?WeakSet:Set,an=null;function XR(i,o){if(i=i.containerInfo,N1=Gd,i=Py(i),ag(i)){if("selectionStart"in i)var c={start:i.selectionStart,end:i.selectionEnd};else e:{c=(c=i.ownerDocument)&&c.defaultView||window;var h=c.getSelection&&c.getSelection();if(h&&h.rangeCount!==0){c=h.anchorNode;var g=h.anchorOffset,v=h.focusNode;h=h.focusOffset;try{c.nodeType,v.nodeType}catch{c=null;break e}var b=0,P=-1,re=-1,me=0,Ee=0,be=i,xe=null;t:for(;;){for(var _e;be!==c||g!==0&&be.nodeType!==3||(P=b+g),be!==v||h!==0&&be.nodeType!==3||(re=b+h),be.nodeType===3&&(b+=be.nodeValue.length),(_e=be.firstChild)!==null;)xe=be,be=_e;for(;;){if(be===i)break t;if(xe===c&&++me===g&&(P=b),xe===v&&++Ee===h&&(re=b),(_e=be.nextSibling)!==null)break;be=xe,xe=be.parentNode}be=_e}c=P===-1||re===-1?null:{start:P,end:re}}else c=null}c=c||{start:0,end:0}}else c=null;for(O1={focusedElem:i,selectionRange:c},Gd=!1,an=o;an!==null;)if(o=an,i=o.child,(o.subtreeFlags&1028)!==0&&i!==null)i.return=o,an=i;else for(;an!==null;){switch(o=an,v=o.alternate,i=o.flags,o.tag){case 0:if((i&4)!==0&&(i=o.updateQueue,i=i!==null?i.events:null,i!==null))for(c=0;c<i.length;c++)g=i[c],g.ref.impl=g.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&v!==null){i=void 0,c=o,g=v.memoizedProps,v=v.memoizedState,h=c.stateNode;try{var Xe=yl(c.type,g);i=h.getSnapshotBeforeUpdate(Xe,v),h.__reactInternalSnapshotBeforeUpdate=i}catch(rt){Xt(c,c.return,rt)}}break;case 3:if((i&1024)!==0){if(i=o.stateNode.containerInfo,c=i.nodeType,c===9)P1(i);else if(c===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":P1(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(n(163))}if(i=o.sibling,i!==null){i.return=o.return,an=i;break}an=o.return}}function AT(i,o,c){var h=c.flags;switch(c.tag){case 0:case 11:case 15:xs(i,c),h&4&&Uf(5,c);break;case 1:if(xs(i,c),h&4)if(i=c.stateNode,o===null)try{i.componentDidMount()}catch(b){Xt(c,c.return,b)}else{var g=yl(c.type,o.memoizedProps);o=o.memoizedState;try{i.componentDidUpdate(g,o,i.__reactInternalSnapshotBeforeUpdate)}catch(b){Xt(c,c.return,b)}}h&64&&_T(c),h&512&&zf(c,c.return);break;case 3:if(xs(i,c),h&64&&(i=c.updateQueue,i!==null)){if(o=null,c.child!==null)switch(c.child.tag){case 27:case 5:o=c.child.stateNode;break;case 1:o=c.child.stateNode}try{c2(i,o)}catch(b){Xt(c,c.return,b)}}break;case 27:o===null&&h&4&&wT(c);case 26:case 5:xs(i,c),o===null&&h&4&&TT(c),h&512&&zf(c,c.return);break;case 12:xs(i,c);break;case 31:xs(i,c),h&4&&kT(i,c);break;case 13:xs(i,c),h&4&&CT(i,c),h&64&&(i=c.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(c=rD.bind(null,c),ED(i,c))));break;case 22:if(h=c.memoizedState!==null||ps,!h){o=o!==null&&o.memoizedState!==null||Hr,g=ps;var v=Hr;ps=h,(Hr=o)&&!v?vs(i,c,(c.subtreeFlags&8772)!==0):xs(i,c),ps=g,Hr=v}break;case 30:break;default:xs(i,c)}}function bT(i){var o=i.alternate;o!==null&&(i.alternate=null,bT(o)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(o=i.stateNode,o!==null&&Pe(o)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var vr=null,Qn=!1;function gs(i,o,c){for(c=c.child;c!==null;)IT(i,o,c),c=c.sibling}function IT(i,o,c){if(ur&&typeof ur.onCommitFiberUnmount=="function")try{ur.onCommitFiberUnmount(Vt,c)}catch{}switch(c.tag){case 26:Hr||Fi(c,o),gs(i,o,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:Hr||Fi(c,o);var h=vr,g=Qn;mo(c.type)&&(vr=c.stateNode,Qn=!1),gs(i,o,c),$f(c.stateNode),vr=h,Qn=g;break;case 5:Hr||Fi(c,o);case 6:if(h=vr,g=Qn,vr=null,gs(i,o,c),vr=h,Qn=g,vr!==null)if(Qn)try{(vr.nodeType===9?vr.body:vr.nodeName==="HTML"?vr.ownerDocument.body:vr).removeChild(c.stateNode)}catch(v){Xt(c,o,v)}else try{vr.removeChild(c.stateNode)}catch(v){Xt(c,o,v)}break;case 18:vr!==null&&(Qn?(i=vr,_E(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,c.stateNode),nu(i)):_E(vr,c.stateNode));break;case 4:h=vr,g=Qn,vr=c.stateNode.containerInfo,Qn=!0,gs(i,o,c),vr=h,Qn=g;break;case 0:case 11:case 14:case 15:so(2,c,o),Hr||so(4,c,o),gs(i,o,c);break;case 1:Hr||(Fi(c,o),h=c.stateNode,typeof h.componentWillUnmount=="function"&&yT(c,o,h)),gs(i,o,c);break;case 21:gs(i,o,c);break;case 22:Hr=(h=Hr)||c.memoizedState!==null,gs(i,o,c),Hr=h;break;default:gs(i,o,c)}}function kT(i,o){if(o.memoizedState===null&&(i=o.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{nu(i)}catch(c){Xt(o,o.return,c)}}}function CT(i,o){if(o.memoizedState===null&&(i=o.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{nu(i)}catch(c){Xt(o,o.return,c)}}function WR(i){switch(i.tag){case 31:case 13:case 19:var o=i.stateNode;return o===null&&(o=i.stateNode=new ST),o;case 22:return i=i.stateNode,o=i._retryCache,o===null&&(o=i._retryCache=new ST),o;default:throw Error(n(435,i.tag))}}function Sd(i,o){var c=WR(i);o.forEach(function(h){if(!c.has(h)){c.add(h);var g=nD.bind(null,i,h);h.then(g,g)}})}function Jn(i,o){var c=o.deletions;if(c!==null)for(var h=0;h<c.length;h++){var g=c[h],v=i,b=o,P=b;e:for(;P!==null;){switch(P.tag){case 27:if(mo(P.type)){vr=P.stateNode,Qn=!1;break e}break;case 5:vr=P.stateNode,Qn=!1;break e;case 3:case 4:vr=P.stateNode.containerInfo,Qn=!0;break e}P=P.return}if(vr===null)throw Error(n(160));IT(v,b,g),vr=null,Qn=!1,v=g.alternate,v!==null&&(v.return=null),g.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)RT(o,i),o=o.sibling}var hi=null;function RT(i,o){var c=i.alternate,h=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:Jn(o,i),Zn(i),h&4&&(so(3,i,i.return),Uf(3,i),so(5,i,i.return));break;case 1:Jn(o,i),Zn(i),h&512&&(Hr||c===null||Fi(c,c.return)),h&64&&ps&&(i=i.updateQueue,i!==null&&(h=i.callbacks,h!==null&&(c=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=c===null?h:c.concat(h))));break;case 26:var g=hi;if(Jn(o,i),Zn(i),h&512&&(Hr||c===null||Fi(c,c.return)),h&4){var v=c!==null?c.memoizedState:null;if(h=i.memoizedState,c===null)if(h===null)if(i.stateNode===null){e:{h=i.type,c=i.memoizedProps,g=g.ownerDocument||g;t:switch(h){case"title":v=g.getElementsByTagName("title")[0],(!v||v[pe]||v[H]||v.namespaceURI==="http://www.w3.org/2000/svg"||v.hasAttribute("itemprop"))&&(v=g.createElement(h),g.head.insertBefore(v,g.querySelector("head > title"))),gn(v,h,c),v[H]=i,We(v),h=v;break e;case"link":var b=RE("link","href",g).get(h+(c.href||""));if(b){for(var P=0;P<b.length;P++)if(v=b[P],v.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&v.getAttribute("rel")===(c.rel==null?null:c.rel)&&v.getAttribute("title")===(c.title==null?null:c.title)&&v.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){b.splice(P,1);break t}}v=g.createElement(h),gn(v,h,c),g.head.appendChild(v);break;case"meta":if(b=RE("meta","content",g).get(h+(c.content||""))){for(P=0;P<b.length;P++)if(v=b[P],v.getAttribute("content")===(c.content==null?null:""+c.content)&&v.getAttribute("name")===(c.name==null?null:c.name)&&v.getAttribute("property")===(c.property==null?null:c.property)&&v.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&v.getAttribute("charset")===(c.charSet==null?null:c.charSet)){b.splice(P,1);break t}}v=g.createElement(h),gn(v,h,c),g.head.appendChild(v);break;default:throw Error(n(468,h))}v[H]=i,We(v),h=v}i.stateNode=h}else DE(g,i.type,i.stateNode);else i.stateNode=CE(g,h,i.memoizedProps);else v!==h?(v===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):v.count--,h===null?DE(g,i.type,i.stateNode):CE(g,h,i.memoizedProps)):h===null&&i.stateNode!==null&&l1(i,i.memoizedProps,c.memoizedProps)}break;case 27:Jn(o,i),Zn(i),h&512&&(Hr||c===null||Fi(c,c.return)),c!==null&&h&4&&l1(i,i.memoizedProps,c.memoizedProps);break;case 5:if(Jn(o,i),Zn(i),h&512&&(Hr||c===null||Fi(c,c.return)),i.flags&32){g=i.stateNode;try{$n(g,"")}catch(Xe){Xt(i,i.return,Xe)}}h&4&&i.stateNode!=null&&(g=i.memoizedProps,l1(i,g,c!==null?c.memoizedProps:g)),h&1024&&(f1=!0);break;case 6:if(Jn(o,i),Zn(i),h&4){if(i.stateNode===null)throw Error(n(162));h=i.memoizedProps,c=i.stateNode;try{c.nodeValue=h}catch(Xe){Xt(i,i.return,Xe)}}break;case 3:if(Ud=null,g=hi,hi=Vd(o.containerInfo),Jn(o,i),hi=g,Zn(i),h&4&&c!==null&&c.memoizedState.isDehydrated)try{nu(o.containerInfo)}catch(Xe){Xt(i,i.return,Xe)}f1&&(f1=!1,DT(i));break;case 4:h=hi,hi=Vd(i.stateNode.containerInfo),Jn(o,i),Zn(i),hi=h;break;case 12:Jn(o,i),Zn(i);break;case 31:Jn(o,i),Zn(i),h&4&&(h=i.updateQueue,h!==null&&(i.updateQueue=null,Sd(i,h)));break;case 13:Jn(o,i),Zn(i),i.child.flags&8192&&i.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(bd=jt()),h&4&&(h=i.updateQueue,h!==null&&(i.updateQueue=null,Sd(i,h)));break;case 22:g=i.memoizedState!==null;var re=c!==null&&c.memoizedState!==null,me=ps,Ee=Hr;if(ps=me||g,Hr=Ee||re,Jn(o,i),Hr=Ee,ps=me,Zn(i),h&8192)e:for(o=i.stateNode,o._visibility=g?o._visibility&-2:o._visibility|1,g&&(c===null||re||ps||Hr||Tl(i)),c=null,o=i;;){if(o.tag===5||o.tag===26){if(c===null){re=c=o;try{if(v=re.stateNode,g)b=v.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none";else{P=re.stateNode;var be=re.memoizedProps.style,xe=be!=null&&be.hasOwnProperty("display")?be.display:null;P.style.display=xe==null||typeof xe=="boolean"?"":(""+xe).trim()}}catch(Xe){Xt(re,re.return,Xe)}}}else if(o.tag===6){if(c===null){re=o;try{re.stateNode.nodeValue=g?"":re.memoizedProps}catch(Xe){Xt(re,re.return,Xe)}}}else if(o.tag===18){if(c===null){re=o;try{var _e=re.stateNode;g?yE(_e,!0):yE(re.stateNode,!1)}catch(Xe){Xt(re,re.return,Xe)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===i)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break e;for(;o.sibling===null;){if(o.return===null||o.return===i)break e;c===o&&(c=null),o=o.return}c===o&&(c=null),o.sibling.return=o.return,o=o.sibling}h&4&&(h=i.updateQueue,h!==null&&(c=h.retryQueue,c!==null&&(h.retryQueue=null,Sd(i,c))));break;case 19:Jn(o,i),Zn(i),h&4&&(h=i.updateQueue,h!==null&&(i.updateQueue=null,Sd(i,h)));break;case 30:break;case 21:break;default:Jn(o,i),Zn(i)}}function Zn(i){var o=i.flags;if(o&2){try{for(var c,h=i.return;h!==null;){if(ET(h)){c=h;break}h=h.return}if(c==null)throw Error(n(160));switch(c.tag){case 27:var g=c.stateNode,v=c1(i);wd(i,v,g);break;case 5:var b=c.stateNode;c.flags&32&&($n(b,""),c.flags&=-33);var P=c1(i);wd(i,P,b);break;case 3:case 4:var re=c.stateNode.containerInfo,me=c1(i);u1(i,me,re);break;default:throw Error(n(161))}}catch(Ee){Xt(i,i.return,Ee)}i.flags&=-3}o&4096&&(i.flags&=-4097)}function DT(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var o=i;DT(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),i=i.sibling}}function xs(i,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)AT(i,o.alternate,o),o=o.sibling}function Tl(i){for(i=i.child;i!==null;){var o=i;switch(o.tag){case 0:case 11:case 14:case 15:so(4,o,o.return),Tl(o);break;case 1:Fi(o,o.return);var c=o.stateNode;typeof c.componentWillUnmount=="function"&&yT(o,o.return,c),Tl(o);break;case 27:$f(o.stateNode);case 26:case 5:Fi(o,o.return),Tl(o);break;case 22:o.memoizedState===null&&Tl(o);break;case 30:Tl(o);break;default:Tl(o)}i=i.sibling}}function vs(i,o,c){for(c=c&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var h=o.alternate,g=i,v=o,b=v.flags;switch(v.tag){case 0:case 11:case 15:vs(g,v,c),Uf(4,v);break;case 1:if(vs(g,v,c),h=v,g=h.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(me){Xt(h,h.return,me)}if(h=v,g=h.updateQueue,g!==null){var P=h.stateNode;try{var re=g.shared.hiddenCallbacks;if(re!==null)for(g.shared.hiddenCallbacks=null,g=0;g<re.length;g++)l2(re[g],P)}catch(me){Xt(h,h.return,me)}}c&&b&64&&_T(v),zf(v,v.return);break;case 27:wT(v);case 26:case 5:vs(g,v,c),c&&h===null&&b&4&&TT(v),zf(v,v.return);break;case 12:vs(g,v,c);break;case 31:vs(g,v,c),c&&b&4&&kT(g,v);break;case 13:vs(g,v,c),c&&b&4&&CT(g,v);break;case 22:v.memoizedState===null&&vs(g,v,c),zf(v,v.return);break;case 30:break;default:vs(g,v,c)}o=o.sibling}}function h1(i,o){var c=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),i=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(i=o.memoizedState.cachePool.pool),i!==c&&(i!=null&&i.refCount++,c!=null&&If(c))}function d1(i,o){i=null,o.alternate!==null&&(i=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==i&&(o.refCount++,i!=null&&If(i))}function di(i,o,c,h){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)NT(i,o,c,h),o=o.sibling}function NT(i,o,c,h){var g=o.flags;switch(o.tag){case 0:case 11:case 15:di(i,o,c,h),g&2048&&Uf(9,o);break;case 1:di(i,o,c,h);break;case 3:di(i,o,c,h),g&2048&&(i=null,o.alternate!==null&&(i=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==i&&(o.refCount++,i!=null&&If(i)));break;case 12:if(g&2048){di(i,o,c,h),i=o.stateNode;try{var v=o.memoizedProps,b=v.id,P=v.onPostCommit;typeof P=="function"&&P(b,o.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(re){Xt(o,o.return,re)}}else di(i,o,c,h);break;case 31:di(i,o,c,h);break;case 13:di(i,o,c,h);break;case 23:break;case 22:v=o.stateNode,b=o.alternate,o.memoizedState!==null?v._visibility&2?di(i,o,c,h):jf(i,o):v._visibility&2?di(i,o,c,h):(v._visibility|=2,Kc(i,o,c,h,(o.subtreeFlags&10256)!==0||!1)),g&2048&&h1(b,o);break;case 24:di(i,o,c,h),g&2048&&d1(o.alternate,o);break;default:di(i,o,c,h)}}function Kc(i,o,c,h,g){for(g=g&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var v=i,b=o,P=c,re=h,me=b.flags;switch(b.tag){case 0:case 11:case 15:Kc(v,b,P,re,g),Uf(8,b);break;case 23:break;case 22:var Ee=b.stateNode;b.memoizedState!==null?Ee._visibility&2?Kc(v,b,P,re,g):jf(v,b):(Ee._visibility|=2,Kc(v,b,P,re,g)),g&&me&2048&&h1(b.alternate,b);break;case 24:Kc(v,b,P,re,g),g&&me&2048&&d1(b.alternate,b);break;default:Kc(v,b,P,re,g)}o=o.sibling}}function jf(i,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var c=i,h=o,g=h.flags;switch(h.tag){case 22:jf(c,h),g&2048&&h1(h.alternate,h);break;case 24:jf(c,h),g&2048&&d1(h.alternate,h);break;default:jf(c,h)}o=o.sibling}}var Hf=8192;function Xc(i,o,c){if(i.subtreeFlags&Hf)for(i=i.child;i!==null;)OT(i,o,c),i=i.sibling}function OT(i,o,c){switch(i.tag){case 26:Xc(i,o,c),i.flags&Hf&&i.memoizedState!==null&&FD(c,hi,i.memoizedState,i.memoizedProps);break;case 5:Xc(i,o,c);break;case 3:case 4:var h=hi;hi=Vd(i.stateNode.containerInfo),Xc(i,o,c),hi=h;break;case 22:i.memoizedState===null&&(h=i.alternate,h!==null&&h.memoizedState!==null?(h=Hf,Hf=16777216,Xc(i,o,c),Hf=h):Xc(i,o,c));break;default:Xc(i,o,c)}}function FT(i){var o=i.alternate;if(o!==null&&(i=o.child,i!==null)){o.child=null;do o=i.sibling,i.sibling=null,i=o;while(i!==null)}}function Gf(i){var o=i.deletions;if((i.flags&16)!==0){if(o!==null)for(var c=0;c<o.length;c++){var h=o[c];an=h,PT(h,i)}FT(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)MT(i),i=i.sibling}function MT(i){switch(i.tag){case 0:case 11:case 15:Gf(i),i.flags&2048&&so(9,i,i.return);break;case 3:Gf(i);break;case 12:Gf(i);break;case 22:var o=i.stateNode;i.memoizedState!==null&&o._visibility&2&&(i.return===null||i.return.tag!==13)?(o._visibility&=-3,Ad(i)):Gf(i);break;default:Gf(i)}}function Ad(i){var o=i.deletions;if((i.flags&16)!==0){if(o!==null)for(var c=0;c<o.length;c++){var h=o[c];an=h,PT(h,i)}FT(i)}for(i=i.child;i!==null;){switch(o=i,o.tag){case 0:case 11:case 15:so(8,o,o.return),Ad(o);break;case 22:c=o.stateNode,c._visibility&2&&(c._visibility&=-3,Ad(o));break;default:Ad(o)}i=i.sibling}}function PT(i,o){for(;an!==null;){var c=an;switch(c.tag){case 0:case 11:case 15:so(8,c,o);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var h=c.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:If(c.memoizedState.cache)}if(h=c.child,h!==null)h.return=c,an=h;else e:for(c=i;an!==null;){h=an;var g=h.sibling,v=h.return;if(bT(h),h===c){an=null;break e}if(g!==null){g.return=v,an=g;break e}an=v}}}var YR={getCacheForType:function(i){var o=mn(Ur),c=o.data.get(i);return c===void 0&&(c=i(),o.data.set(i,c)),c},cacheSignal:function(){return mn(Ur).controller.signal}},$R=typeof WeakMap=="function"?WeakMap:Map,Ut=0,lr=null,Et=null,St=0,Kt=0,pa=null,oo=!1,Wc=!1,m1=!1,_s=0,kr=0,lo=0,El=0,p1=0,ga=0,Yc=0,qf=null,ea=null,g1=!1,bd=0,LT=0,Id=1/0,kd=null,co=null,$r=0,uo=null,$c=null,ys=0,x1=0,v1=null,VT=null,Kf=0,_1=null;function xa(){return(Ut&2)!==0&&St!==0?St&-St:ae.T!==null?A1():D()}function BT(){if(ga===0)if((St&536870912)===0||It){var i=Zi;Zi<<=1,(Zi&3932160)===0&&(Zi=262144),ga=i}else ga=536870912;return i=da.current,i!==null&&(i.flags|=32),ga}function ta(i,o,c){(i===lr&&(Kt===2||Kt===9)||i.cancelPendingCommit!==null)&&(Qc(i,0),fo(i,St,ga,!1)),es(i,c),((Ut&2)===0||i!==lr)&&(i===lr&&((Ut&2)===0&&(El|=c),kr===4&&fo(i,St,ga,!1)),Mi(i))}function UT(i,o,c){if((Ut&6)!==0)throw Error(n(327));var h=!c&&(o&127)===0&&(o&i.expiredLanes)===0||la(i,o),g=h?ZR(i,o):T1(i,o,!0),v=h;do{if(g===0){Wc&&!h&&fo(i,o,0,!1);break}else{if(c=i.current.alternate,v&&!QR(c)){g=T1(i,o,!1),v=!1;continue}if(g===2){if(v=o,i.errorRecoveryDisabledLanes&v)var b=0;else b=i.pendingLanes&-536870913,b=b!==0?b:b&536870912?536870912:0;if(b!==0){o=b;e:{var P=i;g=qf;var re=P.current.memoizedState.isDehydrated;if(re&&(Qc(P,b).flags|=256),b=T1(P,b,!1),b!==2){if(m1&&!re){P.errorRecoveryDisabledLanes|=v,El|=v,g=4;break e}v=ea,ea=g,v!==null&&(ea===null?ea=v:ea.push.apply(ea,v))}g=b}if(v=!1,g!==2)continue}}if(g===1){Qc(i,0),fo(i,o,0,!0);break}e:{switch(h=i,v=g,v){case 0:case 1:throw Error(n(345));case 4:if((o&4194048)!==o)break;case 6:fo(h,o,ga,!oo);break e;case 2:ea=null;break;case 3:case 5:break;default:throw Error(n(329))}if((o&62914560)===o&&(g=bd+300-jt(),10<g)){if(fo(h,o,ga,!oo),Ca(h,0,!0)!==0)break e;ys=o,h.timeoutHandle=xE(zT.bind(null,h,c,ea,kd,g1,o,ga,El,Yc,oo,v,"Throttled",-0,0),g);break e}zT(h,c,ea,kd,g1,o,ga,El,Yc,oo,v,null,-0,0)}}break}while(!0);Mi(i)}function zT(i,o,c,h,g,v,b,P,re,me,Ee,be,xe,_e){if(i.timeoutHandle=-1,be=o.subtreeFlags,be&8192||(be&16785408)===16785408){be={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:si},OT(o,v,be);var Xe=(v&62914560)===v?bd-jt():(v&4194048)===v?LT-jt():0;if(Xe=MD(be,Xe),Xe!==null){ys=v,i.cancelPendingCommit=Xe(YT.bind(null,i,o,v,c,h,g,b,P,re,Ee,be,null,xe,_e)),fo(i,v,b,!me);return}}YT(i,o,v,c,h,g,b,P,re)}function QR(i){for(var o=i;;){var c=o.tag;if((c===0||c===11||c===15)&&o.flags&16384&&(c=o.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var h=0;h<c.length;h++){var g=c[h],v=g.getSnapshot;g=g.value;try{if(!fa(v(),g))return!1}catch{return!1}}if(c=o.child,o.subtreeFlags&16384&&c!==null)c.return=o,o=c;else{if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function fo(i,o,c,h){o&=~p1,o&=~El,i.suspendedLanes|=o,i.pingedLanes&=~o,h&&(i.warmLanes|=o),h=i.expirationTimes;for(var g=o;0<g;){var v=31-Tr(g),b=1<<v;h[v]=-1,g&=~b}c!==0&&ts(i,c,o)}function Cd(){return(Ut&6)===0?(Xf(0),!1):!0}function y1(){if(Et!==null){if(Kt===0)var i=Et.return;else i=Et,cs=dl=null,Pg(i),zc=null,Cf=0,i=Et;for(;i!==null;)vT(i.alternate,i),i=i.return;Et=null}}function Qc(i,o){var c=i.timeoutHandle;c!==-1&&(i.timeoutHandle=-1,xD(c)),c=i.cancelPendingCommit,c!==null&&(i.cancelPendingCommit=null,c()),ys=0,y1(),lr=i,Et=c=os(i.current,null),St=o,Kt=0,pa=null,oo=!1,Wc=la(i,o),m1=!1,Yc=ga=p1=El=lo=kr=0,ea=qf=null,g1=!1,(o&8)!==0&&(o|=o&32);var h=i.entangledLanes;if(h!==0)for(i=i.entanglements,h&=o;0<h;){var g=31-Tr(h),v=1<<g;o|=i[g],h&=~v}return _s=o,$0(),c}function jT(i,o){pt=null,ae.H=Lf,o===Uc||o===ad?(o=a2(),Kt=3):o===Sg?(o=a2(),Kt=4):Kt=o===Jg?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,pa=o,Et===null&&(kr=1,vd(i,Ma(o,i.current)))}function HT(){var i=da.current;return i===null?!0:(St&4194048)===St?Ba===null:(St&62914560)===St||(St&536870912)!==0?i===Ba:!1}function GT(){var i=ae.H;return ae.H=Lf,i===null?Lf:i}function qT(){var i=ae.A;return ae.A=YR,i}function Rd(){kr=4,oo||(St&4194048)!==St&&da.current!==null||(Wc=!0),(lo&134217727)===0&&(El&134217727)===0||lr===null||fo(lr,St,ga,!1)}function T1(i,o,c){var h=Ut;Ut|=2;var g=GT(),v=qT();(lr!==i||St!==o)&&(kd=null,Qc(i,o)),o=!1;var b=kr;e:do try{if(Kt!==0&&Et!==null){var P=Et,re=pa;switch(Kt){case 8:y1(),b=6;break e;case 3:case 2:case 9:case 6:da.current===null&&(o=!0);var me=Kt;if(Kt=0,pa=null,Jc(i,P,re,me),c&&Wc){b=0;break e}break;default:me=Kt,Kt=0,pa=null,Jc(i,P,re,me)}}JR(),b=kr;break}catch(Ee){jT(i,Ee)}while(!0);return o&&i.shellSuspendCounter++,cs=dl=null,Ut=h,ae.H=g,ae.A=v,Et===null&&(lr=null,St=0,$0()),b}function JR(){for(;Et!==null;)KT(Et)}function ZR(i,o){var c=Ut;Ut|=2;var h=GT(),g=qT();lr!==i||St!==o?(kd=null,Id=jt()+500,Qc(i,o)):Wc=la(i,o);e:do try{if(Kt!==0&&Et!==null){o=Et;var v=pa;t:switch(Kt){case 1:Kt=0,pa=null,Jc(i,o,v,1);break;case 2:case 9:if(r2(v)){Kt=0,pa=null,XT(o);break}o=function(){Kt!==2&&Kt!==9||lr!==i||(Kt=7),Mi(i)},v.then(o,o);break e;case 3:Kt=7;break e;case 4:Kt=5;break e;case 7:r2(v)?(Kt=0,pa=null,XT(o)):(Kt=0,pa=null,Jc(i,o,v,7));break;case 5:var b=null;switch(Et.tag){case 26:b=Et.memoizedState;case 5:case 27:var P=Et;if(b?NE(b):P.stateNode.complete){Kt=0,pa=null;var re=P.sibling;if(re!==null)Et=re;else{var me=P.return;me!==null?(Et=me,Dd(me)):Et=null}break t}}Kt=0,pa=null,Jc(i,o,v,5);break;case 6:Kt=0,pa=null,Jc(i,o,v,6);break;case 8:y1(),kr=6;break e;default:throw Error(n(462))}}eD();break}catch(Ee){jT(i,Ee)}while(!0);return cs=dl=null,ae.H=h,ae.A=g,Ut=c,Et!==null?0:(lr=null,St=0,$0(),kr)}function eD(){for(;Et!==null&&!Qi();)KT(Et)}function KT(i){var o=gT(i.alternate,i,_s);i.memoizedProps=i.pendingProps,o===null?Dd(i):Et=o}function XT(i){var o=i,c=o.alternate;switch(o.tag){case 15:case 0:o=uT(c,o,o.pendingProps,o.type,void 0,St);break;case 11:o=uT(c,o,o.pendingProps,o.type.render,o.ref,St);break;case 5:Pg(o);default:vT(c,o),o=Et=qy(o,_s),o=gT(c,o,_s)}i.memoizedProps=i.pendingProps,o===null?Dd(i):Et=o}function Jc(i,o,c,h){cs=dl=null,Pg(o),zc=null,Cf=0;var g=o.return;try{if(jR(i,g,o,c,St)){kr=1,vd(i,Ma(c,i.current)),Et=null;return}}catch(v){if(g!==null)throw Et=g,v;kr=1,vd(i,Ma(c,i.current)),Et=null;return}o.flags&32768?(It||h===1?i=!0:Wc||(St&536870912)!==0?i=!1:(oo=i=!0,(h===2||h===9||h===3||h===6)&&(h=da.current,h!==null&&h.tag===13&&(h.flags|=16384))),WT(o,i)):Dd(o)}function Dd(i){var o=i;do{if((o.flags&32768)!==0){WT(o,oo);return}i=o.return;var c=qR(o.alternate,o,_s);if(c!==null){Et=c;return}if(o=o.sibling,o!==null){Et=o;return}Et=o=i}while(o!==null);kr===0&&(kr=5)}function WT(i,o){do{var c=KR(i.alternate,i);if(c!==null){c.flags&=32767,Et=c;return}if(c=i.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!o&&(i=i.sibling,i!==null)){Et=i;return}Et=i=c}while(i!==null);kr=6,Et=null}function YT(i,o,c,h,g,v,b,P,re){i.cancelPendingCommit=null;do Nd();while($r!==0);if((Ut&6)!==0)throw Error(n(327));if(o!==null){if(o===i.current)throw Error(n(177));if(v=o.lanes|o.childLanes,v|=cg,uf(i,c,v,b,P,re),i===lr&&(Et=lr=null,St=0),$c=o,uo=i,ys=c,x1=v,v1=g,VT=h,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,aD(gr,function(){return eE(),null})):(i.callbackNode=null,i.callbackPriority=0),h=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||h){h=ae.T,ae.T=null,g=le.p,le.p=2,b=Ut,Ut|=4;try{XR(i,o,c)}finally{Ut=b,le.p=g,ae.T=h}}$r=1,$T(),QT(),JT()}}function $T(){if($r===1){$r=0;var i=uo,o=$c,c=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||c){c=ae.T,ae.T=null;var h=le.p;le.p=2;var g=Ut;Ut|=4;try{RT(o,i);var v=O1,b=Py(i.containerInfo),P=v.focusedElem,re=v.selectionRange;if(b!==P&&P&&P.ownerDocument&&My(P.ownerDocument.documentElement,P)){if(re!==null&&ag(P)){var me=re.start,Ee=re.end;if(Ee===void 0&&(Ee=me),"selectionStart"in P)P.selectionStart=me,P.selectionEnd=Math.min(Ee,P.value.length);else{var be=P.ownerDocument||document,xe=be&&be.defaultView||window;if(xe.getSelection){var _e=xe.getSelection(),Xe=P.textContent.length,rt=Math.min(re.start,Xe),rr=re.end===void 0?rt:Math.min(re.end,Xe);!_e.extend&&rt>rr&&(b=rr,rr=rt,rt=b);var se=Fy(P,rt),ne=Fy(P,rr);if(se&&ne&&(_e.rangeCount!==1||_e.anchorNode!==se.node||_e.anchorOffset!==se.offset||_e.focusNode!==ne.node||_e.focusOffset!==ne.offset)){var fe=be.createRange();fe.setStart(se.node,se.offset),_e.removeAllRanges(),rt>rr?(_e.addRange(fe),_e.extend(ne.node,ne.offset)):(fe.setEnd(ne.node,ne.offset),_e.addRange(fe))}}}}for(be=[],_e=P;_e=_e.parentNode;)_e.nodeType===1&&be.push({element:_e,left:_e.scrollLeft,top:_e.scrollTop});for(typeof P.focus=="function"&&P.focus(),P=0;P<be.length;P++){var Se=be[P];Se.element.scrollLeft=Se.left,Se.element.scrollTop=Se.top}}Gd=!!N1,O1=N1=null}finally{Ut=g,le.p=h,ae.T=c}}i.current=o,$r=2}}function QT(){if($r===2){$r=0;var i=uo,o=$c,c=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||c){c=ae.T,ae.T=null;var h=le.p;le.p=2;var g=Ut;Ut|=4;try{AT(i,o.alternate,o)}finally{Ut=g,le.p=h,ae.T=c}}$r=3}}function JT(){if($r===4||$r===3){$r=0,sa();var i=uo,o=$c,c=ys,h=VT;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?$r=5:($r=0,$c=uo=null,ZT(i,i.pendingLanes));var g=i.pendingLanes;if(g===0&&(co=null),ni(c),o=o.stateNode,ur&&typeof ur.onCommitFiberRoot=="function")try{ur.onCommitFiberRoot(Vt,o,void 0,(o.current.flags&128)===128)}catch{}if(h!==null){o=ae.T,g=le.p,le.p=2,ae.T=null;try{for(var v=i.onRecoverableError,b=0;b<h.length;b++){var P=h[b];v(P.value,{componentStack:P.stack})}}finally{ae.T=o,le.p=g}}(ys&3)!==0&&Nd(),Mi(i),g=i.pendingLanes,(c&261930)!==0&&(g&42)!==0?i===_1?Kf++:(Kf=0,_1=i):Kf=0,Xf(0)}}function ZT(i,o){(i.pooledCacheLanes&=o)===0&&(o=i.pooledCache,o!=null&&(i.pooledCache=null,If(o)))}function Nd(){return $T(),QT(),JT(),eE()}function eE(){if($r!==5)return!1;var i=uo,o=x1;x1=0;var c=ni(ys),h=ae.T,g=le.p;try{le.p=32>c?32:c,ae.T=null,c=v1,v1=null;var v=uo,b=ys;if($r=0,$c=uo=null,ys=0,(Ut&6)!==0)throw Error(n(331));var P=Ut;if(Ut|=4,MT(v.current),NT(v,v.current,b,c),Ut=P,Xf(0,!1),ur&&typeof ur.onPostCommitFiberRoot=="function")try{ur.onPostCommitFiberRoot(Vt,v)}catch{}return!0}finally{le.p=g,ae.T=h,ZT(i,o)}}function tE(i,o,c){o=Ma(c,o),o=Qg(i.stateNode,o,2),i=no(i,o,2),i!==null&&(es(i,2),Mi(i))}function Xt(i,o,c){if(i.tag===3)tE(i,i,c);else for(;o!==null;){if(o.tag===3){tE(o,i,c);break}else if(o.tag===1){var h=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(co===null||!co.has(h))){i=Ma(c,i),c=rT(2),h=no(o,c,2),h!==null&&(nT(c,h,o,i),es(h,2),Mi(h));break}}o=o.return}}function E1(i,o,c){var h=i.pingCache;if(h===null){h=i.pingCache=new $R;var g=new Set;h.set(o,g)}else g=h.get(o),g===void 0&&(g=new Set,h.set(o,g));g.has(c)||(m1=!0,g.add(c),i=tD.bind(null,i,o,c),o.then(i,i))}function tD(i,o,c){var h=i.pingCache;h!==null&&h.delete(o),i.pingedLanes|=i.suspendedLanes&c,i.warmLanes&=~c,lr===i&&(St&c)===c&&(kr===4||kr===3&&(St&62914560)===St&&300>jt()-bd?(Ut&2)===0&&Qc(i,0):p1|=c,Yc===St&&(Yc=0)),Mi(i)}function rE(i,o){o===0&&(o=yc()),i=ul(i,o),i!==null&&(es(i,o),Mi(i))}function rD(i){var o=i.memoizedState,c=0;o!==null&&(c=o.retryLane),rE(i,c)}function nD(i,o){var c=0;switch(i.tag){case 31:case 13:var h=i.stateNode,g=i.memoizedState;g!==null&&(c=g.retryLane);break;case 19:h=i.stateNode;break;case 22:h=i.stateNode._retryCache;break;default:throw Error(n(314))}h!==null&&h.delete(o),rE(i,c)}function aD(i,o){return zt(i,o)}var Od=null,Zc=null,w1=!1,Fd=!1,S1=!1,ho=0;function Mi(i){i!==Zc&&i.next===null&&(Zc===null?Od=Zc=i:Zc=Zc.next=i),Fd=!0,w1||(w1=!0,sD())}function Xf(i,o){if(!S1&&Fd){S1=!0;do for(var c=!1,h=Od;h!==null;){if(i!==0){var g=h.pendingLanes;if(g===0)var v=0;else{var b=h.suspendedLanes,P=h.pingedLanes;v=(1<<31-Tr(42|i)+1)-1,v&=g&~(b&~P),v=v&201326741?v&201326741|1:v?v|2:0}v!==0&&(c=!0,sE(h,v))}else v=St,v=Ca(h,h===lr?v:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(v&3)===0||la(h,v)||(c=!0,sE(h,v));h=h.next}while(c);S1=!1}}function iD(){nE()}function nE(){Fd=w1=!1;var i=0;ho!==0&&gD()&&(i=ho);for(var o=jt(),c=null,h=Od;h!==null;){var g=h.next,v=aE(h,o);v===0?(h.next=null,c===null?Od=g:c.next=g,g===null&&(Zc=c)):(c=h,(i!==0||(v&3)!==0)&&(Fd=!0)),h=g}$r!==0&&$r!==5||Xf(i),ho!==0&&(ho=0)}function aE(i,o){for(var c=i.suspendedLanes,h=i.pingedLanes,g=i.expirationTimes,v=i.pendingLanes&-62914561;0<v;){var b=31-Tr(v),P=1<<b,re=g[b];re===-1?((P&c)===0||(P&h)!==0)&&(g[b]=cf(P,o)):re<=o&&(i.expiredLanes|=P),v&=~P}if(o=lr,c=St,c=Ca(i,i===o?c:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),h=i.callbackNode,c===0||i===o&&(Kt===2||Kt===9)||i.cancelPendingCommit!==null)return h!==null&&h!==null&&rn(h),i.callbackNode=null,i.callbackPriority=0;if((c&3)===0||la(i,c)){if(o=c&-c,o===i.callbackPriority)return o;switch(h!==null&&rn(h),ni(c)){case 2:case 8:c=ri;break;case 32:c=gr;break;case 268435456:c=dt;break;default:c=gr}return h=iE.bind(null,i),c=zt(c,h),i.callbackPriority=o,i.callbackNode=c,o}return h!==null&&h!==null&&rn(h),i.callbackPriority=2,i.callbackNode=null,2}function iE(i,o){if($r!==0&&$r!==5)return i.callbackNode=null,i.callbackPriority=0,null;var c=i.callbackNode;if(Nd()&&i.callbackNode!==c)return null;var h=St;return h=Ca(i,i===lr?h:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),h===0?null:(UT(i,h,o),aE(i,jt()),i.callbackNode!=null&&i.callbackNode===c?iE.bind(null,i):null)}function sE(i,o){if(Nd())return null;UT(i,o,!0)}function sD(){vD(function(){(Ut&6)!==0?zt(Xn,iD):nE()})}function A1(){if(ho===0){var i=Vc;i===0&&(i=oa,oa<<=1,(oa&261888)===0&&(oa=256)),ho=i}return ho}function oE(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:wc(""+i)}function lE(i,o){var c=o.ownerDocument.createElement("input");return c.name=o.name,c.value=o.value,i.id&&c.setAttribute("form",i.id),o.parentNode.insertBefore(c,o),i=new FormData(i),c.parentNode.removeChild(c),i}function oD(i,o,c,h,g){if(o==="submit"&&c&&c.stateNode===g){var v=oE((g[q]||null).action),b=h.submitter;b&&(o=(o=b[q]||null)?oE(o.formAction):b.getAttribute("formAction"),o!==null&&(v=o,b=null));var P=new ki("action","action",null,h,g);i.push({event:P,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(ho!==0){var re=b?lE(g,b):new FormData(g);qg(c,{pending:!0,data:re,method:g.method,action:v},null,re)}}else typeof v=="function"&&(P.preventDefault(),re=b?lE(g,b):new FormData(g),qg(c,{pending:!0,data:re,method:g.method,action:v},v,re))},currentTarget:g}]})}}for(var b1=0;b1<lg.length;b1++){var I1=lg[b1],lD=I1.toLowerCase(),cD=I1[0].toUpperCase()+I1.slice(1);fi(lD,"on"+cD)}fi(By,"onAnimationEnd"),fi(Uy,"onAnimationIteration"),fi(zy,"onAnimationStart"),fi("dblclick","onDoubleClick"),fi("focusin","onFocus"),fi("focusout","onBlur"),fi(AR,"onTransitionRun"),fi(bR,"onTransitionStart"),fi(IR,"onTransitionCancel"),fi(jy,"onTransitionEnd"),En("onMouseEnter",["mouseout","mouseover"]),En("onMouseLeave",["mouseout","mouseover"]),En("onPointerEnter",["pointerout","pointerover"]),En("onPointerLeave",["pointerout","pointerover"]),or("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),or("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),or("onBeforeInput",["compositionend","keypress","textInput","paste"]),or("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),or("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),or("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Wf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),uD=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Wf));function cE(i,o){o=(o&4)!==0;for(var c=0;c<i.length;c++){var h=i[c],g=h.event;h=h.listeners;e:{var v=void 0;if(o)for(var b=h.length-1;0<=b;b--){var P=h[b],re=P.instance,me=P.currentTarget;if(P=P.listener,re!==v&&g.isPropagationStopped())break e;v=P,g.currentTarget=me;try{v(g)}catch(Ee){Y0(Ee)}g.currentTarget=null,v=re}else for(b=0;b<h.length;b++){if(P=h[b],re=P.instance,me=P.currentTarget,P=P.listener,re!==v&&g.isPropagationStopped())break e;v=P,g.currentTarget=me;try{v(g)}catch(Ee){Y0(Ee)}g.currentTarget=null,v=re}}}}function wt(i,o){var c=o[he];c===void 0&&(c=o[he]=new Set);var h=i+"__bubble";c.has(h)||(uE(o,i,2,!1),c.add(h))}function k1(i,o,c){var h=0;o&&(h|=4),uE(c,i,h,o)}var Md="_reactListening"+Math.random().toString(36).slice(2);function C1(i){if(!i[Md]){i[Md]=!0,Ht.forEach(function(c){c!=="selectionchange"&&(uD.has(c)||k1(c,!1,i),k1(c,!0,i))});var o=i.nodeType===9?i:i.ownerDocument;o===null||o[Md]||(o[Md]=!0,k1("selectionchange",!1,o))}}function uE(i,o,c,h){switch(BE(o)){case 2:var g=VD;break;case 8:g=BD;break;default:g=G1}c=g.bind(null,o,c,i),g=void 0,!rl||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(g=!0),h?g!==void 0?i.addEventListener(o,c,{capture:!0,passive:g}):i.addEventListener(o,c,!0):g!==void 0?i.addEventListener(o,c,{passive:g}):i.addEventListener(o,c,!1)}function R1(i,o,c,h,g){var v=h;if((o&1)===0&&(o&2)===0&&h!==null)e:for(;;){if(h===null)return;var b=h.tag;if(b===3||b===4){var P=h.stateNode.containerInfo;if(P===g)break;if(b===4)for(b=h.return;b!==null;){var re=b.tag;if((re===3||re===4)&&b.stateNode.containerInfo===g)return;b=b.return}for(;P!==null;){if(b=Ve(P),b===null)return;if(re=b.tag,re===5||re===6||re===26||re===27){h=v=b;continue e}P=P.parentNode}}h=h.return}Xs(function(){var me=v,Ee=Da(c),be=[];e:{var xe=Hy.get(i);if(xe!==void 0){var _e=ki,Xe=i;switch(i){case"keypress":if(al(c)===0)break e;case"keydown":case"keyup":_e=K0;break;case"focusin":Xe="focus",_e=sl;break;case"focusout":Xe="blur",_e=sl;break;case"beforeblur":case"afterblur":_e=sl;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_e=_f;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_e=L0;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_e=E;break;case By:case Uy:case zy:_e=B0;break;case jy:_e=j;break;case"scroll":case"scrollend":_e=vf;break;case"wheel":_e=ve;break;case"copy":case"cut":case"paste":_e=U0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_e=ss;break;case"toggle":case"beforetoggle":_e=mt}var rt=(o&4)!==0,rr=!rt&&(i==="scroll"||i==="scrollend"),se=rt?xe!==null?xe+"Capture":null:xe;rt=[];for(var ne=me,fe;ne!==null;){var Se=ne;if(fe=Se.stateNode,Se=Se.tag,Se!==5&&Se!==26&&Se!==27||fe===null||se===null||(Se=oi(ne,se),Se!=null&&rt.push(Yf(ne,Se,fe))),rr)break;ne=ne.return}0<rt.length&&(xe=new _e(xe,Xe,null,c,Ee),be.push({event:xe,listeners:rt}))}}if((o&7)===0){e:{if(xe=i==="mouseover"||i==="pointerover",_e=i==="mouseout"||i==="pointerout",xe&&c!==pf&&(Xe=c.relatedTarget||c.fromElement)&&(Ve(Xe)||Xe[W]))break e;if((_e||xe)&&(xe=Ee.window===Ee?Ee:(xe=Ee.ownerDocument)?xe.defaultView||xe.parentWindow:window,_e?(Xe=c.relatedTarget||c.toElement,_e=me,Xe=Xe?Ve(Xe):null,Xe!==null&&(rr=s(Xe),rt=Xe.tag,Xe!==rr||rt!==5&&rt!==27&&rt!==6)&&(Xe=null)):(_e=null,Xe=me),_e!==Xe)){if(rt=_f,Se="onMouseLeave",se="onMouseEnter",ne="mouse",(i==="pointerout"||i==="pointerover")&&(rt=ss,Se="onPointerLeave",se="onPointerEnter",ne="pointer"),rr=_e==null?xe:Me(_e),fe=Xe==null?xe:Me(Xe),xe=new rt(Se,ne+"leave",_e,c,Ee),xe.target=rr,xe.relatedTarget=fe,Se=null,Ve(Ee)===me&&(rt=new rt(se,ne+"enter",Xe,c,Ee),rt.target=fe,rt.relatedTarget=rr,Se=rt),rr=Se,_e&&Xe)t:{for(rt=fD,se=_e,ne=Xe,fe=0,Se=se;Se;Se=rt(Se))fe++;Se=0;for(var Ze=ne;Ze;Ze=rt(Ze))Se++;for(;0<fe-Se;)se=rt(se),fe--;for(;0<Se-fe;)ne=rt(ne),Se--;for(;fe--;){if(se===ne||ne!==null&&se===ne.alternate){rt=se;break t}se=rt(se),ne=rt(ne)}rt=null}else rt=null;_e!==null&&fE(be,xe,_e,rt,!1),Xe!==null&&rr!==null&&fE(be,rr,Xe,rt,!0)}}e:{if(xe=me?Me(me):window,_e=xe.nodeName&&xe.nodeName.toLowerCase(),_e==="select"||_e==="input"&&xe.type==="file")var Mt=ky;else if(by(xe))if(Cy)Mt=ER;else{Mt=yR;var $e=_R}else _e=xe.nodeName,!_e||_e.toLowerCase()!=="input"||xe.type!=="checkbox"&&xe.type!=="radio"?me&&Ec(me.elementType)&&(Mt=ky):Mt=TR;if(Mt&&(Mt=Mt(i,me))){Iy(be,Mt,c,Ee);break e}$e&&$e(i,xe,me),i==="focusout"&&me&&xe.type==="number"&&me.memoizedProps.value!=null&&hf(xe,"number",xe.value)}switch($e=me?Me(me):window,i){case"focusin":(by($e)||$e.contentEditable==="true")&&(Rc=$e,ig=me,Sf=null);break;case"focusout":Sf=ig=Rc=null;break;case"mousedown":sg=!0;break;case"contextmenu":case"mouseup":case"dragend":sg=!1,Ly(be,c,Ee);break;case"selectionchange":if(SR)break;case"keydown":case"keyup":Ly(be,c,Ee)}var xt;if(Bt)e:{switch(i){case"compositionstart":var At="onCompositionStart";break e;case"compositionend":At="onCompositionEnd";break e;case"compositionupdate":At="onCompositionUpdate";break e}At=void 0}else Cc?ol(i,c)&&(At="onCompositionEnd"):i==="keydown"&&c.keyCode===229&&(At="onCompositionStart");At&&(Di&&c.locale!=="ko"&&(Cc||At!=="onCompositionStart"?At==="onCompositionEnd"&&Cc&&(xt=xf()):(Ii=Ee,gf="value"in Ii?Ii.value:Ii.textContent,Cc=!0)),$e=Pd(me,At),0<$e.length&&(At=new Ri(At,i,null,c,Ee),be.push({event:At,listeners:$e}),xt?At.data=xt:(xt=kc(c),xt!==null&&(At.data=xt)))),(xt=Oa?pR(i,c):gR(i,c))&&(At=Pd(me,"onBeforeInput"),0<At.length&&($e=new Ri("onBeforeInput","beforeinput",null,c,Ee),be.push({event:$e,listeners:At}),$e.data=xt)),oD(be,i,me,c,Ee)}cE(be,o)})}function Yf(i,o,c){return{instance:i,listener:o,currentTarget:c}}function Pd(i,o){for(var c=o+"Capture",h=[];i!==null;){var g=i,v=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||v===null||(g=oi(i,c),g!=null&&h.unshift(Yf(i,g,v)),g=oi(i,o),g!=null&&h.push(Yf(i,g,v))),i.tag===3)return h;i=i.return}return[]}function fD(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function fE(i,o,c,h,g){for(var v=o._reactName,b=[];c!==null&&c!==h;){var P=c,re=P.alternate,me=P.stateNode;if(P=P.tag,re!==null&&re===h)break;P!==5&&P!==26&&P!==27||me===null||(re=me,g?(me=oi(c,v),me!=null&&b.unshift(Yf(c,me,re))):g||(me=oi(c,v),me!=null&&b.push(Yf(c,me,re)))),c=c.return}b.length!==0&&i.push({event:o,listeners:b})}var hD=/\r\n?/g,dD=/\u0000|\uFFFD/g;function hE(i){return(typeof i=="string"?i:""+i).replace(hD,`
`).replace(dD,"")}function dE(i,o){return o=hE(o),hE(i)===o}function tr(i,o,c,h,g,v){switch(c){case"children":typeof h=="string"?o==="body"||o==="textarea"&&h===""||$n(i,h):(typeof h=="number"||typeof h=="bigint")&&o!=="body"&&$n(i,""+h);break;case"className":ua(i,"class",h);break;case"tabIndex":ua(i,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":ua(i,c,h);break;case"style":mf(i,h,v);break;case"data":if(o!=="object"){ua(i,"data",h);break}case"src":case"href":if(h===""&&(o!=="a"||c!=="href")){i.removeAttribute(c);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){i.removeAttribute(c);break}h=wc(""+h),i.setAttribute(c,h);break;case"action":case"formAction":if(typeof h=="function"){i.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof v=="function"&&(c==="formAction"?(o!=="input"&&tr(i,o,"name",g.name,g,null),tr(i,o,"formEncType",g.formEncType,g,null),tr(i,o,"formMethod",g.formMethod,g,null),tr(i,o,"formTarget",g.formTarget,g,null)):(tr(i,o,"encType",g.encType,g,null),tr(i,o,"method",g.method,g,null),tr(i,o,"target",g.target,g,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){i.removeAttribute(c);break}h=wc(""+h),i.setAttribute(c,h);break;case"onClick":h!=null&&(i.onclick=si);break;case"onScroll":h!=null&&wt("scroll",i);break;case"onScrollEnd":h!=null&&wt("scrollend",i);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(n(61));if(c=h.__html,c!=null){if(g.children!=null)throw Error(n(60));i.innerHTML=c}}break;case"multiple":i.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":i.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){i.removeAttribute("xlink:href");break}c=wc(""+h),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?i.setAttribute(c,""+h):i.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?i.setAttribute(c,""):i.removeAttribute(c);break;case"capture":case"download":h===!0?i.setAttribute(c,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?i.setAttribute(c,h):i.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?i.setAttribute(c,h):i.removeAttribute(c);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?i.removeAttribute(c):i.setAttribute(c,h);break;case"popover":wt("beforetoggle",i),wt("toggle",i),wn(i,"popover",h);break;case"xlinkActuate":Br(i,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":Br(i,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":Br(i,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":Br(i,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":Br(i,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":Br(i,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":Br(i,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":Br(i,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":Br(i,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":wn(i,"is",h);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=P0.get(c)||c,wn(i,c,h))}}function D1(i,o,c,h,g,v){switch(c){case"style":mf(i,h,v);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(n(61));if(c=h.__html,c!=null){if(g.children!=null)throw Error(n(60));i.innerHTML=c}}break;case"children":typeof h=="string"?$n(i,h):(typeof h=="number"||typeof h=="bigint")&&$n(i,""+h);break;case"onScroll":h!=null&&wt("scroll",i);break;case"onScrollEnd":h!=null&&wt("scrollend",i);break;case"onClick":h!=null&&(i.onclick=si);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Gt.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(g=c.endsWith("Capture"),o=c.slice(2,g?c.length-7:void 0),v=i[q]||null,v=v!=null?v[c]:null,typeof v=="function"&&i.removeEventListener(o,v,g),typeof h=="function")){typeof v!="function"&&v!==null&&(c in i?i[c]=null:i.hasAttribute(c)&&i.removeAttribute(c)),i.addEventListener(o,h,g);break e}c in i?i[c]=h:h===!0?i.setAttribute(c,""):wn(i,c,h)}}}function gn(i,o,c){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":wt("error",i),wt("load",i);var h=!1,g=!1,v;for(v in c)if(c.hasOwnProperty(v)){var b=c[v];if(b!=null)switch(v){case"src":h=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:tr(i,o,v,b,c,null)}}g&&tr(i,o,"srcSet",c.srcSet,c,null),h&&tr(i,o,"src",c.src,c,null);return;case"input":wt("invalid",i);var P=v=b=g=null,re=null,me=null;for(h in c)if(c.hasOwnProperty(h)){var Ee=c[h];if(Ee!=null)switch(h){case"name":g=Ee;break;case"type":b=Ee;break;case"checked":re=Ee;break;case"defaultChecked":me=Ee;break;case"value":v=Ee;break;case"defaultValue":P=Ee;break;case"children":case"dangerouslySetInnerHTML":if(Ee!=null)throw Error(n(137,o));break;default:tr(i,o,h,Ee,c,null)}}O0(i,v,P,re,me,b,g,!1);return;case"select":wt("invalid",i),h=b=v=null;for(g in c)if(c.hasOwnProperty(g)&&(P=c[g],P!=null))switch(g){case"value":v=P;break;case"defaultValue":b=P;break;case"multiple":h=P;default:tr(i,o,g,P,c,null)}o=v,c=b,i.multiple=!!h,o!=null?Hs(i,!!h,o,!1):c!=null&&Hs(i,!!h,c,!0);return;case"textarea":wt("invalid",i),v=g=h=null;for(b in c)if(c.hasOwnProperty(b)&&(P=c[b],P!=null))switch(b){case"value":h=P;break;case"defaultValue":g=P;break;case"children":v=P;break;case"dangerouslySetInnerHTML":if(P!=null)throw Error(n(91));break;default:tr(i,o,b,P,c,null)}Gs(i,h,g,v);return;case"option":for(re in c)if(c.hasOwnProperty(re)&&(h=c[re],h!=null))switch(re){case"selected":i.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:tr(i,o,re,h,c,null)}return;case"dialog":wt("beforetoggle",i),wt("toggle",i),wt("cancel",i),wt("close",i);break;case"iframe":case"object":wt("load",i);break;case"video":case"audio":for(h=0;h<Wf.length;h++)wt(Wf[h],i);break;case"image":wt("error",i),wt("load",i);break;case"details":wt("toggle",i);break;case"embed":case"source":case"link":wt("error",i),wt("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(me in c)if(c.hasOwnProperty(me)&&(h=c[me],h!=null))switch(me){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:tr(i,o,me,h,c,null)}return;default:if(Ec(o)){for(Ee in c)c.hasOwnProperty(Ee)&&(h=c[Ee],h!==void 0&&D1(i,o,Ee,h,c,void 0));return}}for(P in c)c.hasOwnProperty(P)&&(h=c[P],h!=null&&tr(i,o,P,h,c,null))}function mD(i,o,c,h){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,v=null,b=null,P=null,re=null,me=null,Ee=null;for(_e in c){var be=c[_e];if(c.hasOwnProperty(_e)&&be!=null)switch(_e){case"checked":break;case"value":break;case"defaultValue":re=be;default:h.hasOwnProperty(_e)||tr(i,o,_e,null,h,be)}}for(var xe in h){var _e=h[xe];if(be=c[xe],h.hasOwnProperty(xe)&&(_e!=null||be!=null))switch(xe){case"type":v=_e;break;case"name":g=_e;break;case"checked":me=_e;break;case"defaultChecked":Ee=_e;break;case"value":b=_e;break;case"defaultValue":P=_e;break;case"children":case"dangerouslySetInnerHTML":if(_e!=null)throw Error(n(137,o));break;default:_e!==be&&tr(i,o,xe,_e,h,be)}}Tc(i,b,P,re,me,Ee,v,g);return;case"select":_e=b=P=xe=null;for(v in c)if(re=c[v],c.hasOwnProperty(v)&&re!=null)switch(v){case"value":break;case"multiple":_e=re;default:h.hasOwnProperty(v)||tr(i,o,v,null,h,re)}for(g in h)if(v=h[g],re=c[g],h.hasOwnProperty(g)&&(v!=null||re!=null))switch(g){case"value":xe=v;break;case"defaultValue":P=v;break;case"multiple":b=v;default:v!==re&&tr(i,o,g,v,h,re)}o=P,c=b,h=_e,xe!=null?Hs(i,!!c,xe,!1):!!h!=!!c&&(o!=null?Hs(i,!!c,o,!0):Hs(i,!!c,c?[]:"",!1));return;case"textarea":_e=xe=null;for(P in c)if(g=c[P],c.hasOwnProperty(P)&&g!=null&&!h.hasOwnProperty(P))switch(P){case"value":break;case"children":break;default:tr(i,o,P,null,h,g)}for(b in h)if(g=h[b],v=c[b],h.hasOwnProperty(b)&&(g!=null||v!=null))switch(b){case"value":xe=g;break;case"defaultValue":_e=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(n(91));break;default:g!==v&&tr(i,o,b,g,h,v)}F0(i,xe,_e);return;case"option":for(var Xe in c)if(xe=c[Xe],c.hasOwnProperty(Xe)&&xe!=null&&!h.hasOwnProperty(Xe))switch(Xe){case"selected":i.selected=!1;break;default:tr(i,o,Xe,null,h,xe)}for(re in h)if(xe=h[re],_e=c[re],h.hasOwnProperty(re)&&xe!==_e&&(xe!=null||_e!=null))switch(re){case"selected":i.selected=xe&&typeof xe!="function"&&typeof xe!="symbol";break;default:tr(i,o,re,xe,h,_e)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var rt in c)xe=c[rt],c.hasOwnProperty(rt)&&xe!=null&&!h.hasOwnProperty(rt)&&tr(i,o,rt,null,h,xe);for(me in h)if(xe=h[me],_e=c[me],h.hasOwnProperty(me)&&xe!==_e&&(xe!=null||_e!=null))switch(me){case"children":case"dangerouslySetInnerHTML":if(xe!=null)throw Error(n(137,o));break;default:tr(i,o,me,xe,h,_e)}return;default:if(Ec(o)){for(var rr in c)xe=c[rr],c.hasOwnProperty(rr)&&xe!==void 0&&!h.hasOwnProperty(rr)&&D1(i,o,rr,void 0,h,xe);for(Ee in h)xe=h[Ee],_e=c[Ee],!h.hasOwnProperty(Ee)||xe===_e||xe===void 0&&_e===void 0||D1(i,o,Ee,xe,h,_e);return}}for(var se in c)xe=c[se],c.hasOwnProperty(se)&&xe!=null&&!h.hasOwnProperty(se)&&tr(i,o,se,null,h,xe);for(be in h)xe=h[be],_e=c[be],!h.hasOwnProperty(be)||xe===_e||xe==null&&_e==null||tr(i,o,be,xe,h,_e)}function mE(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function pD(){if(typeof performance.getEntriesByType=="function"){for(var i=0,o=0,c=performance.getEntriesByType("resource"),h=0;h<c.length;h++){var g=c[h],v=g.transferSize,b=g.initiatorType,P=g.duration;if(v&&P&&mE(b)){for(b=0,P=g.responseEnd,h+=1;h<c.length;h++){var re=c[h],me=re.startTime;if(me>P)break;var Ee=re.transferSize,be=re.initiatorType;Ee&&mE(be)&&(re=re.responseEnd,b+=Ee*(re<P?1:(P-me)/(re-me)))}if(--h,o+=8*(v+b)/(g.duration/1e3),i++,10<i)break}}if(0<i)return o/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var N1=null,O1=null;function Ld(i){return i.nodeType===9?i:i.ownerDocument}function pE(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function gE(i,o){if(i===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&o==="foreignObject"?0:i}function F1(i,o){return i==="textarea"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var M1=null;function gD(){var i=window.event;return i&&i.type==="popstate"?i===M1?!1:(M1=i,!0):(M1=null,!1)}var xE=typeof setTimeout=="function"?setTimeout:void 0,xD=typeof clearTimeout=="function"?clearTimeout:void 0,vE=typeof Promise=="function"?Promise:void 0,vD=typeof queueMicrotask=="function"?queueMicrotask:typeof vE<"u"?function(i){return vE.resolve(null).then(i).catch(_D)}:xE;function _D(i){setTimeout(function(){throw i})}function mo(i){return i==="head"}function _E(i,o){var c=o,h=0;do{var g=c.nextSibling;if(i.removeChild(c),g&&g.nodeType===8)if(c=g.data,c==="/$"||c==="/&"){if(h===0){i.removeChild(g),nu(o);return}h--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")h++;else if(c==="html")$f(i.ownerDocument.documentElement);else if(c==="head"){c=i.ownerDocument.head,$f(c);for(var v=c.firstChild;v;){var b=v.nextSibling,P=v.nodeName;v[pe]||P==="SCRIPT"||P==="STYLE"||P==="LINK"&&v.rel.toLowerCase()==="stylesheet"||c.removeChild(v),v=b}}else c==="body"&&$f(i.ownerDocument.body);c=g}while(c);nu(o)}function yE(i,o){var c=i;i=0;do{var h=c.nextSibling;if(c.nodeType===1?o?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(o?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),h&&h.nodeType===8)if(c=h.data,c==="/$"){if(i===0)break;i--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||i++;c=h}while(c)}function P1(i){var o=i.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var c=o;switch(o=o.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":P1(c),Pe(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}i.removeChild(c)}}function yD(i,o,c,h){for(;i.nodeType===1;){var g=c;if(i.nodeName.toLowerCase()!==o.toLowerCase()){if(!h&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(h){if(!i[pe])switch(o){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(v=i.getAttribute("rel"),v==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(v!==g.rel||i.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||i.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||i.getAttribute("title")!==(g.title==null?null:g.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(v=i.getAttribute("src"),(v!==(g.src==null?null:g.src)||i.getAttribute("type")!==(g.type==null?null:g.type)||i.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&v&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(o==="input"&&i.type==="hidden"){var v=g.name==null?null:""+g.name;if(g.type==="hidden"&&i.getAttribute("name")===v)return i}else return i;if(i=Ua(i.nextSibling),i===null)break}return null}function TD(i,o,c){if(o==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!c||(i=Ua(i.nextSibling),i===null))return null;return i}function TE(i,o){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!o||(i=Ua(i.nextSibling),i===null))return null;return i}function L1(i){return i.data==="$?"||i.data==="$~"}function V1(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function ED(i,o){var c=i.ownerDocument;if(i.data==="$~")i._reactRetry=o;else if(i.data!=="$?"||c.readyState!=="loading")o();else{var h=function(){o(),c.removeEventListener("DOMContentLoaded",h)};c.addEventListener("DOMContentLoaded",h),i._reactRetry=h}}function Ua(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break;if(o===8){if(o=i.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return i}var B1=null;function EE(i){i=i.nextSibling;for(var o=0;i;){if(i.nodeType===8){var c=i.data;if(c==="/$"||c==="/&"){if(o===0)return Ua(i.nextSibling);o--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||o++}i=i.nextSibling}return null}function wE(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var c=i.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(o===0)return i;o--}else c!=="/$"&&c!=="/&"||o++}i=i.previousSibling}return null}function SE(i,o,c){switch(o=Ld(c),i){case"html":if(i=o.documentElement,!i)throw Error(n(452));return i;case"head":if(i=o.head,!i)throw Error(n(453));return i;case"body":if(i=o.body,!i)throw Error(n(454));return i;default:throw Error(n(451))}}function $f(i){for(var o=i.attributes;o.length;)i.removeAttributeNode(o[0]);Pe(i)}var za=new Map,AE=new Set;function Vd(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var Ts=le.d;le.d={f:wD,r:SD,D:AD,C:bD,L:ID,m:kD,X:RD,S:CD,M:DD};function wD(){var i=Ts.f(),o=Cd();return i||o}function SD(i){var o=Ge(i);o!==null&&o.tag===5&&o.type==="form"?j2(o):Ts.r(i)}var eu=typeof document>"u"?null:document;function bE(i,o,c){var h=eu;if(h&&typeof o=="string"&&o){var g=Yn(o);g='link[rel="'+i+'"][href="'+g+'"]',typeof c=="string"&&(g+='[crossorigin="'+c+'"]'),AE.has(g)||(AE.add(g),i={rel:i,crossOrigin:c,href:o},h.querySelector(g)===null&&(o=h.createElement("link"),gn(o,"link",i),We(o),h.head.appendChild(o)))}}function AD(i){Ts.D(i),bE("dns-prefetch",i,null)}function bD(i,o){Ts.C(i,o),bE("preconnect",i,o)}function ID(i,o,c){Ts.L(i,o,c);var h=eu;if(h&&i&&o){var g='link[rel="preload"][as="'+Yn(o)+'"]';o==="image"&&c&&c.imageSrcSet?(g+='[imagesrcset="'+Yn(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(g+='[imagesizes="'+Yn(c.imageSizes)+'"]')):g+='[href="'+Yn(i)+'"]';var v=g;switch(o){case"style":v=tu(i);break;case"script":v=ru(i)}za.has(v)||(i=x({rel:"preload",href:o==="image"&&c&&c.imageSrcSet?void 0:i,as:o},c),za.set(v,i),h.querySelector(g)!==null||o==="style"&&h.querySelector(Qf(v))||o==="script"&&h.querySelector(Jf(v))||(o=h.createElement("link"),gn(o,"link",i),We(o),h.head.appendChild(o)))}}function kD(i,o){Ts.m(i,o);var c=eu;if(c&&i){var h=o&&typeof o.as=="string"?o.as:"script",g='link[rel="modulepreload"][as="'+Yn(h)+'"][href="'+Yn(i)+'"]',v=g;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":v=ru(i)}if(!za.has(v)&&(i=x({rel:"modulepreload",href:i},o),za.set(v,i),c.querySelector(g)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(Jf(v)))return}h=c.createElement("link"),gn(h,"link",i),We(h),c.head.appendChild(h)}}}function CD(i,o,c){Ts.S(i,o,c);var h=eu;if(h&&i){var g=je(h).hoistableStyles,v=tu(i);o=o||"default";var b=g.get(v);if(!b){var P={loading:0,preload:null};if(b=h.querySelector(Qf(v)))P.loading=5;else{i=x({rel:"stylesheet",href:i,"data-precedence":o},c),(c=za.get(v))&&U1(i,c);var re=b=h.createElement("link");We(re),gn(re,"link",i),re._p=new Promise(function(me,Ee){re.onload=me,re.onerror=Ee}),re.addEventListener("load",function(){P.loading|=1}),re.addEventListener("error",function(){P.loading|=2}),P.loading|=4,Bd(b,o,h)}b={type:"stylesheet",instance:b,count:1,state:P},g.set(v,b)}}}function RD(i,o){Ts.X(i,o);var c=eu;if(c&&i){var h=je(c).hoistableScripts,g=ru(i),v=h.get(g);v||(v=c.querySelector(Jf(g)),v||(i=x({src:i,async:!0},o),(o=za.get(g))&&z1(i,o),v=c.createElement("script"),We(v),gn(v,"link",i),c.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},h.set(g,v))}}function DD(i,o){Ts.M(i,o);var c=eu;if(c&&i){var h=je(c).hoistableScripts,g=ru(i),v=h.get(g);v||(v=c.querySelector(Jf(g)),v||(i=x({src:i,async:!0,type:"module"},o),(o=za.get(g))&&z1(i,o),v=c.createElement("script"),We(v),gn(v,"link",i),c.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},h.set(g,v))}}function IE(i,o,c,h){var g=(g=ce.current)?Vd(g):null;if(!g)throw Error(n(446));switch(i){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(o=tu(c.href),c=je(g).hoistableStyles,h=c.get(o),h||(h={type:"style",instance:null,count:0,state:null},c.set(o,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){i=tu(c.href);var v=je(g).hoistableStyles,b=v.get(i);if(b||(g=g.ownerDocument||g,b={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},v.set(i,b),(v=g.querySelector(Qf(i)))&&!v._p&&(b.instance=v,b.state.loading=5),za.has(i)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},za.set(i,c),v||ND(g,i,c,b.state))),o&&h===null)throw Error(n(528,""));return b}if(o&&h!==null)throw Error(n(529,""));return null;case"script":return o=c.async,c=c.src,typeof c=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=ru(c),c=je(g).hoistableScripts,h=c.get(o),h||(h={type:"script",instance:null,count:0,state:null},c.set(o,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,i))}}function tu(i){return'href="'+Yn(i)+'"'}function Qf(i){return'link[rel="stylesheet"]['+i+"]"}function kE(i){return x({},i,{"data-precedence":i.precedence,precedence:null})}function ND(i,o,c,h){i.querySelector('link[rel="preload"][as="style"]['+o+"]")?h.loading=1:(o=i.createElement("link"),h.preload=o,o.addEventListener("load",function(){return h.loading|=1}),o.addEventListener("error",function(){return h.loading|=2}),gn(o,"link",c),We(o),i.head.appendChild(o))}function ru(i){return'[src="'+Yn(i)+'"]'}function Jf(i){return"script[async]"+i}function CE(i,o,c){if(o.count++,o.instance===null)switch(o.type){case"style":var h=i.querySelector('style[data-href~="'+Yn(c.href)+'"]');if(h)return o.instance=h,We(h),h;var g=x({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return h=(i.ownerDocument||i).createElement("style"),We(h),gn(h,"style",g),Bd(h,c.precedence,i),o.instance=h;case"stylesheet":g=tu(c.href);var v=i.querySelector(Qf(g));if(v)return o.state.loading|=4,o.instance=v,We(v),v;h=kE(c),(g=za.get(g))&&U1(h,g),v=(i.ownerDocument||i).createElement("link"),We(v);var b=v;return b._p=new Promise(function(P,re){b.onload=P,b.onerror=re}),gn(v,"link",h),o.state.loading|=4,Bd(v,c.precedence,i),o.instance=v;case"script":return v=ru(c.src),(g=i.querySelector(Jf(v)))?(o.instance=g,We(g),g):(h=c,(g=za.get(v))&&(h=x({},c),z1(h,g)),i=i.ownerDocument||i,g=i.createElement("script"),We(g),gn(g,"link",h),i.head.appendChild(g),o.instance=g);case"void":return null;default:throw Error(n(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(h=o.instance,o.state.loading|=4,Bd(h,c.precedence,i));return o.instance}function Bd(i,o,c){for(var h=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=h.length?h[h.length-1]:null,v=g,b=0;b<h.length;b++){var P=h[b];if(P.dataset.precedence===o)v=P;else if(v!==g)break}v?v.parentNode.insertBefore(i,v.nextSibling):(o=c.nodeType===9?c.head:c,o.insertBefore(i,o.firstChild))}function U1(i,o){i.crossOrigin==null&&(i.crossOrigin=o.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=o.referrerPolicy),i.title==null&&(i.title=o.title)}function z1(i,o){i.crossOrigin==null&&(i.crossOrigin=o.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=o.referrerPolicy),i.integrity==null&&(i.integrity=o.integrity)}var Ud=null;function RE(i,o,c){if(Ud===null){var h=new Map,g=Ud=new Map;g.set(c,h)}else g=Ud,h=g.get(c),h||(h=new Map,g.set(c,h));if(h.has(i))return h;for(h.set(i,null),c=c.getElementsByTagName(i),g=0;g<c.length;g++){var v=c[g];if(!(v[pe]||v[H]||i==="link"&&v.getAttribute("rel")==="stylesheet")&&v.namespaceURI!=="http://www.w3.org/2000/svg"){var b=v.getAttribute(o)||"";b=i+b;var P=h.get(b);P?P.push(v):h.set(b,[v])}}return h}function DE(i,o,c){i=i.ownerDocument||i,i.head.insertBefore(c,o==="title"?i.querySelector("head > title"):null)}function OD(i,o,c){if(c===1||o.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return i=o.disabled,typeof o.precedence=="string"&&i==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function NE(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function FD(i,o,c,h){if(c.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var g=tu(h.href),v=o.querySelector(Qf(g));if(v){o=v._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(i.count++,i=zd.bind(i),o.then(i,i)),c.state.loading|=4,c.instance=v,We(v);return}v=o.ownerDocument||o,h=kE(h),(g=za.get(g))&&U1(h,g),v=v.createElement("link"),We(v);var b=v;b._p=new Promise(function(P,re){b.onload=P,b.onerror=re}),gn(v,"link",h),c.instance=v}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(c,o),(o=c.state.preload)&&(c.state.loading&3)===0&&(i.count++,c=zd.bind(i),o.addEventListener("load",c),o.addEventListener("error",c))}}var j1=0;function MD(i,o){return i.stylesheets&&i.count===0&&Hd(i,i.stylesheets),0<i.count||0<i.imgCount?function(c){var h=setTimeout(function(){if(i.stylesheets&&Hd(i,i.stylesheets),i.unsuspend){var v=i.unsuspend;i.unsuspend=null,v()}},6e4+o);0<i.imgBytes&&j1===0&&(j1=62500*pD());var g=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&Hd(i,i.stylesheets),i.unsuspend)){var v=i.unsuspend;i.unsuspend=null,v()}},(i.imgBytes>j1?50:800)+o);return i.unsuspend=c,function(){i.unsuspend=null,clearTimeout(h),clearTimeout(g)}}:null}function zd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Hd(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var jd=null;function Hd(i,o){i.stylesheets=null,i.unsuspend!==null&&(i.count++,jd=new Map,o.forEach(PD,i),jd=null,zd.call(i))}function PD(i,o){if(!(o.state.loading&4)){var c=jd.get(i);if(c)var h=c.get(null);else{c=new Map,jd.set(i,c);for(var g=i.querySelectorAll("link[data-precedence],style[data-precedence]"),v=0;v<g.length;v++){var b=g[v];(b.nodeName==="LINK"||b.getAttribute("media")!=="not all")&&(c.set(b.dataset.precedence,b),h=b)}h&&c.set(null,h)}g=o.instance,b=g.getAttribute("data-precedence"),v=c.get(b)||h,v===h&&c.set(null,g),c.set(b,g),this.count++,h=zd.bind(this),g.addEventListener("load",h),g.addEventListener("error",h),v?v.parentNode.insertBefore(g,v.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(g,i.firstChild)),o.state.loading|=4}}var Zf={$$typeof:R,Provider:null,Consumer:null,_currentValue:Fe,_currentValue2:Fe,_threadCount:0};function LD(i,o,c,h,g,v,b,P,re){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ra(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ra(0),this.hiddenUpdates=Ra(null),this.identifierPrefix=h,this.onUncaughtError=g,this.onCaughtError=v,this.onRecoverableError=b,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=re,this.incompleteTransitions=new Map}function OE(i,o,c,h,g,v,b,P,re,me,Ee,be){return i=new LD(i,o,c,b,re,me,Ee,be,P),o=1,v===!0&&(o|=24),v=ha(3,null,null,o),i.current=v,v.stateNode=i,o=Tg(),o.refCount++,i.pooledCache=o,o.refCount++,v.memoizedState={element:h,isDehydrated:c,cache:o},Ag(v),i}function FE(i){return i?(i=Oc,i):Oc}function ME(i,o,c,h,g,v){g=FE(g),h.context===null?h.context=g:h.pendingContext=g,h=ro(o),h.payload={element:c},v=v===void 0?null:v,v!==null&&(h.callback=v),c=no(i,h,o),c!==null&&(ta(c,i,o),Df(c,i,o))}function PE(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var c=i.retryLane;i.retryLane=c!==0&&c<o?c:o}}function H1(i,o){PE(i,o),(i=i.alternate)&&PE(i,o)}function LE(i){if(i.tag===13||i.tag===31){var o=ul(i,67108864);o!==null&&ta(o,i,67108864),H1(i,67108864)}}function VE(i){if(i.tag===13||i.tag===31){var o=xa();o=ns(o);var c=ul(i,o);c!==null&&ta(c,i,o),H1(i,o)}}var Gd=!0;function VD(i,o,c,h){var g=ae.T;ae.T=null;var v=le.p;try{le.p=2,G1(i,o,c,h)}finally{le.p=v,ae.T=g}}function BD(i,o,c,h){var g=ae.T;ae.T=null;var v=le.p;try{le.p=8,G1(i,o,c,h)}finally{le.p=v,ae.T=g}}function G1(i,o,c,h){if(Gd){var g=q1(h);if(g===null)R1(i,o,h,qd,c),UE(i,h);else if(zD(g,i,o,c,h))h.stopPropagation();else if(UE(i,h),o&4&&-1<UD.indexOf(i)){for(;g!==null;){var v=Ge(g);if(v!==null)switch(v.tag){case 3:if(v=v.stateNode,v.current.memoizedState.isDehydrated){var b=Vn(v.pendingLanes);if(b!==0){var P=v;for(P.pendingLanes|=2,P.entangledLanes|=2;b;){var re=1<<31-Tr(b);P.entanglements[1]|=re,b&=~re}Mi(v),(Ut&6)===0&&(Id=jt()+500,Xf(0))}}break;case 31:case 13:P=ul(v,2),P!==null&&ta(P,v,2),Cd(),H1(v,2)}if(v=q1(h),v===null&&R1(i,o,h,qd,c),v===g)break;g=v}g!==null&&h.stopPropagation()}else R1(i,o,h,null,c)}}function q1(i){return i=Da(i),K1(i)}var qd=null;function K1(i){if(qd=null,i=Ve(i),i!==null){var o=s(i);if(o===null)i=null;else{var c=o.tag;if(c===13){if(i=l(o),i!==null)return i;i=null}else if(c===31){if(i=u(o),i!==null)return i;i=null}else if(c===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null)}}return qd=i,null}function BE(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(un()){case Xn:return 2;case ri:return 8;case gr:case Wn:return 32;case dt:return 268435456;default:return 32}default:return 32}}var X1=!1,po=null,go=null,xo=null,eh=new Map,th=new Map,vo=[],UD="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function UE(i,o){switch(i){case"focusin":case"focusout":po=null;break;case"dragenter":case"dragleave":go=null;break;case"mouseover":case"mouseout":xo=null;break;case"pointerover":case"pointerout":eh.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":th.delete(o.pointerId)}}function rh(i,o,c,h,g,v){return i===null||i.nativeEvent!==v?(i={blockedOn:o,domEventName:c,eventSystemFlags:h,nativeEvent:v,targetContainers:[g]},o!==null&&(o=Ge(o),o!==null&&LE(o)),i):(i.eventSystemFlags|=h,o=i.targetContainers,g!==null&&o.indexOf(g)===-1&&o.push(g),i)}function zD(i,o,c,h,g){switch(o){case"focusin":return po=rh(po,i,o,c,h,g),!0;case"dragenter":return go=rh(go,i,o,c,h,g),!0;case"mouseover":return xo=rh(xo,i,o,c,h,g),!0;case"pointerover":var v=g.pointerId;return eh.set(v,rh(eh.get(v)||null,i,o,c,h,g)),!0;case"gotpointercapture":return v=g.pointerId,th.set(v,rh(th.get(v)||null,i,o,c,h,g)),!0}return!1}function zE(i){var o=Ve(i.target);if(o!==null){var c=s(o);if(c!==null){if(o=c.tag,o===13){if(o=l(c),o!==null){i.blockedOn=o,K(i.priority,function(){VE(c)});return}}else if(o===31){if(o=u(c),o!==null){i.blockedOn=o,K(i.priority,function(){VE(c)});return}}else if(o===3&&c.stateNode.current.memoizedState.isDehydrated){i.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Kd(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var c=q1(i.nativeEvent);if(c===null){c=i.nativeEvent;var h=new c.constructor(c.type,c);pf=h,c.target.dispatchEvent(h),pf=null}else return o=Ge(c),o!==null&&LE(o),i.blockedOn=c,!1;o.shift()}return!0}function jE(i,o,c){Kd(i)&&c.delete(o)}function jD(){X1=!1,po!==null&&Kd(po)&&(po=null),go!==null&&Kd(go)&&(go=null),xo!==null&&Kd(xo)&&(xo=null),eh.forEach(jE),th.forEach(jE)}function Xd(i,o){i.blockedOn===o&&(i.blockedOn=null,X1||(X1=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,jD)))}var Wd=null;function HE(i){Wd!==i&&(Wd=i,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){Wd===i&&(Wd=null);for(var o=0;o<i.length;o+=3){var c=i[o],h=i[o+1],g=i[o+2];if(typeof h!="function"){if(K1(h||c)===null)continue;break}var v=Ge(c);v!==null&&(i.splice(o,3),o-=3,qg(v,{pending:!0,data:g,method:c.method,action:h},h,g))}}))}function nu(i){function o(re){return Xd(re,i)}po!==null&&Xd(po,i),go!==null&&Xd(go,i),xo!==null&&Xd(xo,i),eh.forEach(o),th.forEach(o);for(var c=0;c<vo.length;c++){var h=vo[c];h.blockedOn===i&&(h.blockedOn=null)}for(;0<vo.length&&(c=vo[0],c.blockedOn===null);)zE(c),c.blockedOn===null&&vo.shift();if(c=(i.ownerDocument||i).$$reactFormReplay,c!=null)for(h=0;h<c.length;h+=3){var g=c[h],v=c[h+1],b=g[q]||null;if(typeof v=="function")b||HE(c);else if(b){var P=null;if(v&&v.hasAttribute("formAction")){if(g=v,b=v[q]||null)P=b.formAction;else if(K1(g)!==null)continue}else P=b.action;typeof P=="function"?c[h+1]=P:(c.splice(h,3),h-=3),HE(c)}}}function GE(){function i(v){v.canIntercept&&v.info==="react-transition"&&v.intercept({handler:function(){return new Promise(function(b){return g=b})},focusReset:"manual",scroll:"manual"})}function o(){g!==null&&(g(),g=null),h||setTimeout(c,20)}function c(){if(!h&&!navigation.transition){var v=navigation.currentEntry;v&&v.url!=null&&navigation.navigate(v.url,{state:v.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var h=!1,g=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(c,100),function(){h=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),g!==null&&(g(),g=null)}}}function W1(i){this._internalRoot=i}Yd.prototype.render=W1.prototype.render=function(i){var o=this._internalRoot;if(o===null)throw Error(n(409));var c=o.current,h=xa();ME(c,h,i,o,null,null)},Yd.prototype.unmount=W1.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var o=i.containerInfo;ME(i.current,2,null,i,null,null),Cd(),o[W]=null}};function Yd(i){this._internalRoot=i}Yd.prototype.unstable_scheduleHydration=function(i){if(i){var o=D();i={blockedOn:null,target:i,priority:o};for(var c=0;c<vo.length&&o!==0&&o<vo[c].priority;c++);vo.splice(c,0,i),c===0&&zE(i)}};var qE=e.version;if(qE!=="19.2.3")throw Error(n(527,qE,"19.2.3"));le.findDOMNode=function(i){var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error(n(188)):(i=Object.keys(i).join(","),Error(n(268,i)));return i=d(o),i=i!==null?m(i):null,i=i===null?null:i.stateNode,i};var HD={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:ae,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var $d=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$d.isDisabled&&$d.supportsFiber)try{Vt=$d.inject(HD),ur=$d}catch{}}return ah.createRoot=function(i,o){if(!a(i))throw Error(n(299));var c=!1,h="",g=J2,v=Z2,b=eT;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(h=o.identifierPrefix),o.onUncaughtError!==void 0&&(g=o.onUncaughtError),o.onCaughtError!==void 0&&(v=o.onCaughtError),o.onRecoverableError!==void 0&&(b=o.onRecoverableError)),o=OE(i,1,!1,null,null,c,h,null,g,v,b,GE),i[W]=o.current,C1(i),new W1(o)},ah.hydrateRoot=function(i,o,c){if(!a(i))throw Error(n(299));var h=!1,g="",v=J2,b=Z2,P=eT,re=null;return c!=null&&(c.unstable_strictMode===!0&&(h=!0),c.identifierPrefix!==void 0&&(g=c.identifierPrefix),c.onUncaughtError!==void 0&&(v=c.onUncaughtError),c.onCaughtError!==void 0&&(b=c.onCaughtError),c.onRecoverableError!==void 0&&(P=c.onRecoverableError),c.formState!==void 0&&(re=c.formState)),o=OE(i,1,!0,o,c??null,h,g,re,v,b,P,GE),o.context=FE(null),c=o.current,h=xa(),h=ns(h),g=ro(h),g.callback=null,no(c,g,h),c=h,o.current.lanes=c,es(o,c),Mi(o),i[W]=o.current,C1(i),new Yd(o)},ah.version="19.2.3",ah}var tw;function ZD(){if(tw)return Q1.exports;tw=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),Q1.exports=JD(),Q1.exports}var eN=ZD();const tN=()=>{};var rw={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vb=function(r){const e=[];let t=0;for(let n=0;n<r.length;n++){let a=r.charCodeAt(n);a<128?e[t++]=a:a<2048?(e[t++]=a>>6|192,e[t++]=a&63|128):(a&64512)===55296&&n+1<r.length&&(r.charCodeAt(n+1)&64512)===56320?(a=65536+((a&1023)<<10)+(r.charCodeAt(++n)&1023),e[t++]=a>>18|240,e[t++]=a>>12&63|128,e[t++]=a>>6&63|128,e[t++]=a&63|128):(e[t++]=a>>12|224,e[t++]=a>>6&63|128,e[t++]=a&63|128)}return e},rN=function(r){const e=[];let t=0,n=0;for(;t<r.length;){const a=r[t++];if(a<128)e[n++]=String.fromCharCode(a);else if(a>191&&a<224){const s=r[t++];e[n++]=String.fromCharCode((a&31)<<6|s&63)}else if(a>239&&a<365){const s=r[t++],l=r[t++],u=r[t++],f=((a&7)<<18|(s&63)<<12|(l&63)<<6|u&63)-65536;e[n++]=String.fromCharCode(55296+(f>>10)),e[n++]=String.fromCharCode(56320+(f&1023))}else{const s=r[t++],l=r[t++];e[n++]=String.fromCharCode((a&15)<<12|(s&63)<<6|l&63)}}return e.join("")},_b={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(r,e){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let a=0;a<r.length;a+=3){const s=r[a],l=a+1<r.length,u=l?r[a+1]:0,f=a+2<r.length,d=f?r[a+2]:0,m=s>>2,x=(s&3)<<4|u>>4;let _=(u&15)<<2|d>>6,y=d&63;f||(y=64,l||(_=64)),n.push(t[m],t[x],t[_],t[y])}return n.join("")},encodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(r):this.encodeByteArray(vb(r),e)},decodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(r):rN(this.decodeStringToByteArray(r,e))},decodeStringToByteArray(r,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let a=0;a<r.length;){const s=t[r.charAt(a++)],u=a<r.length?t[r.charAt(a)]:0;++a;const d=a<r.length?t[r.charAt(a)]:64;++a;const x=a<r.length?t[r.charAt(a)]:64;if(++a,s==null||u==null||d==null||x==null)throw new nN;const _=s<<2|u>>4;if(n.push(_),d!==64){const y=u<<4&240|d>>2;if(n.push(y),x!==64){const w=d<<6&192|x;n.push(w)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};class nN extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const aN=function(r){const e=vb(r);return _b.encodeByteArray(e,!0)},Fm=function(r){return aN(r).replace(/\./g,"")},yb=function(r){try{return _b.decodeString(r,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tb(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iN=()=>Tb().__FIREBASE_DEFAULTS__,sN=()=>{if(typeof process>"u"||typeof rw>"u")return;const r=rw.__FIREBASE_DEFAULTS__;if(r)return JSON.parse(r)},oN=()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=r&&yb(r[1]);return e&&JSON.parse(e)},Tp=()=>{try{return tN()||iN()||sN()||oN()}catch(r){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`);return}},Eb=r=>{var e,t;return(t=(e=Tp())==null?void 0:e.emulatorHosts)==null?void 0:t[r]},lN=r=>{const e=Eb(r);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),n]:[e.substring(0,t),n]},wb=()=>{var r;return(r=Tp())==null?void 0:r.config},Sb=r=>{var e;return(e=Tp())==null?void 0:e[`_${r}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cN{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qu(r){try{return(r.startsWith("http://")||r.startsWith("https://")?new URL(r).hostname:r).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Ab(r){return(await fetch(r,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uN(r,e){if(r.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},n=e||"demo-project",a=r.iat||0,s=r.sub||r.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l={iss:`https://securetoken.google.com/${n}`,aud:n,iat:a,exp:a+3600,auth_time:a,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...r};return[Fm(JSON.stringify(t)),Fm(JSON.stringify(l)),""].join(".")}const yh={};function fN(){const r={prod:[],emulator:[]};for(const e of Object.keys(yh))yh[e]?r.emulator.push(e):r.prod.push(e);return r}function hN(r){let e=document.getElementById(r),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",r),t=!0),{created:t,element:e}}let nw=!1;function bb(r,e){if(typeof window>"u"||typeof document>"u"||!Qu(window.location.host)||yh[r]===e||yh[r]||nw)return;yh[r]=e;function t(_){return`__firebase__banner__${_}`}const n="__firebase__banner",s=fN().prod.length>0;function l(){const _=document.getElementById(n);_&&_.remove()}function u(_){_.style.display="flex",_.style.background="#7faaf0",_.style.position="fixed",_.style.bottom="5px",_.style.left="5px",_.style.padding=".5em",_.style.borderRadius="5px",_.style.alignItems="center"}function f(_,y){_.setAttribute("width","24"),_.setAttribute("id",y),_.setAttribute("height","24"),_.setAttribute("viewBox","0 0 24 24"),_.setAttribute("fill","none"),_.style.marginLeft="-6px"}function d(){const _=document.createElement("span");return _.style.cursor="pointer",_.style.marginLeft="16px",_.style.fontSize="24px",_.innerHTML=" &times;",_.onclick=()=>{nw=!0,l()},_}function m(_,y){_.setAttribute("id",y),_.innerText="Learn more",_.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",_.setAttribute("target","__blank"),_.style.paddingLeft="5px",_.style.textDecoration="underline"}function x(){const _=hN(n),y=t("text"),w=document.getElementById(y)||document.createElement("span"),T=t("learnmore"),S=document.getElementById(T)||document.createElement("a"),O=t("preprendIcon"),U=document.getElementById(O)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(_.created){const R=_.element;u(R),m(S,T);const Y=d();f(U,O),R.append(U,w,S,Y),document.body.appendChild(R)}s?(w.innerText="Preview backend disconnected.",U.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(U.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,w.innerText="Preview backend running in this workspace."),w.setAttribute("id",y)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",x):x()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function dN(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Zr())}function Ib(){var e;const r=(e=Tp())==null?void 0:e.forceEnvironment;if(r==="node")return!0;if(r==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function mN(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function kb(){const r=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof r=="object"&&r.id!==void 0}function pN(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function gN(){const r=Zr();return r.indexOf("MSIE ")>=0||r.indexOf("Trident/")>=0}function Cb(){return!Ib()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Rb(){return!Ib()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function bv(){try{return typeof indexedDB=="object"}catch{return!1}}function Db(){return new Promise((r,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(n);a.onsuccess=()=>{a.result.close(),t||self.indexedDB.deleteDatabase(n),r(!0)},a.onupgradeneeded=()=>{t=!1},a.onerror=()=>{var s;e(((s=a.error)==null?void 0:s.message)||"")}}catch(t){e(t)}})}function xN(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vN="FirebaseError";class Si extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=vN,Object.setPrototypeOf(this,Si.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,lc.prototype.create)}}class lc{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},a=`${this.service}/${e}`,s=this.errors[e],l=s?_N(s,n):"Error",u=`${this.serviceName}: ${l} (${a}).`;return new Si(a,u,n)}}function _N(r,e){return r.replace(yN,(t,n)=>{const a=e[n];return a!=null?String(a):`<${n}?>`})}const yN=/\{\$([^}]+)}/g;function TN(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}function Lo(r,e){if(r===e)return!0;const t=Object.keys(r),n=Object.keys(e);for(const a of t){if(!n.includes(a))return!1;const s=r[a],l=e[a];if(aw(s)&&aw(l)){if(!Lo(s,l))return!1}else if(s!==l)return!1}for(const a of n)if(!t.includes(a))return!1;return!0}function aw(r){return r!==null&&typeof r=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h0(r){const e=[];for(const[t,n]of Object.entries(r))Array.isArray(n)?n.forEach(a=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function EN(r,e){const t=new wN(r,e);return t.subscribe.bind(t)}class wN{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let a;if(e===void 0&&t===void 0&&n===void 0)throw new Error("Missing Observer.");SN(e,["next","error","complete"])?a=e:a={next:e,error:t,complete:n},a.next===void 0&&(a.next=tx),a.error===void 0&&(a.error=tx),a.complete===void 0&&(a.complete=tx);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function SN(r,e){if(typeof r!="object"||r===null)return!1;for(const t of e)if(t in r&&typeof r[t]=="function")return!0;return!1}function tx(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AN=1e3,bN=2,IN=14400*1e3,kN=.5;function iw(r,e=AN,t=bN){const n=e*Math.pow(t,r),a=Math.round(kN*n*(Math.random()-.5)*2);return Math.min(IN,n+a)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fn(r){return r&&r._delegate?r._delegate:r}class wi{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sl="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CN{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new cN;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:t});a&&n.resolve(a)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),n=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(a){if(n)return null;throw a}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(DN(e))try{this.getOrInitializeService({instanceIdentifier:Sl})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:a});n.resolve(s)}catch{}}}}clearInstance(e=Sl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Sl){return this.instances.has(e)}getOptions(e=Sl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[s,l]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(s);n===u&&l.resolve(a)}return a}onInit(e,t){const n=this.normalizeInstanceIdentifier(t),a=this.onInitCallbacks.get(n)??new Set;a.add(e),this.onInitCallbacks.set(n,a);const s=this.instances.get(n);return s&&e(s,n),()=>{a.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const a of n)try{a(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:RN(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Sl){return this.component?this.component.multipleInstances?e:Sl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function RN(r){return r===Sl?void 0:r}function DN(r){return r.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NN{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new CN(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var bt;(function(r){r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT"})(bt||(bt={}));const ON={debug:bt.DEBUG,verbose:bt.VERBOSE,info:bt.INFO,warn:bt.WARN,error:bt.ERROR,silent:bt.SILENT},FN=bt.INFO,MN={[bt.DEBUG]:"log",[bt.VERBOSE]:"log",[bt.INFO]:"info",[bt.WARN]:"warn",[bt.ERROR]:"error"},PN=(r,e,...t)=>{if(e<r.logLevel)return;const n=new Date().toISOString(),a=MN[e];if(a)console[a](`[${n}]  ${r.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ep{constructor(e){this.name=e,this._logLevel=FN,this._logHandler=PN,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in bt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?ON[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,bt.DEBUG,...e),this._logHandler(this,bt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,bt.VERBOSE,...e),this._logHandler(this,bt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,bt.INFO,...e),this._logHandler(this,bt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,bt.WARN,...e),this._logHandler(this,bt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,bt.ERROR,...e),this._logHandler(this,bt.ERROR,...e)}}const LN=(r,e)=>e.some(t=>r instanceof t);let sw,ow;function VN(){return sw||(sw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function BN(){return ow||(ow=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Nb=new WeakMap,Nx=new WeakMap,Ob=new WeakMap,rx=new WeakMap,Iv=new WeakMap;function UN(r){const e=new Promise((t,n)=>{const a=()=>{r.removeEventListener("success",s),r.removeEventListener("error",l)},s=()=>{t(Oo(r.result)),a()},l=()=>{n(r.error),a()};r.addEventListener("success",s),r.addEventListener("error",l)});return e.then(t=>{t instanceof IDBCursor&&Nb.set(t,r)}).catch(()=>{}),Iv.set(e,r),e}function zN(r){if(Nx.has(r))return;const e=new Promise((t,n)=>{const a=()=>{r.removeEventListener("complete",s),r.removeEventListener("error",l),r.removeEventListener("abort",l)},s=()=>{t(),a()},l=()=>{n(r.error||new DOMException("AbortError","AbortError")),a()};r.addEventListener("complete",s),r.addEventListener("error",l),r.addEventListener("abort",l)});Nx.set(r,e)}let Ox={get(r,e,t){if(r instanceof IDBTransaction){if(e==="done")return Nx.get(r);if(e==="objectStoreNames")return r.objectStoreNames||Ob.get(r);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Oo(r[e])},set(r,e,t){return r[e]=t,!0},has(r,e){return r instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in r}};function jN(r){Ox=r(Ox)}function HN(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=r.call(nx(this),e,...t);return Ob.set(n,e.sort?e.sort():[e]),Oo(n)}:BN().includes(r)?function(...e){return r.apply(nx(this),e),Oo(Nb.get(this))}:function(...e){return Oo(r.apply(nx(this),e))}}function GN(r){return typeof r=="function"?HN(r):(r instanceof IDBTransaction&&zN(r),LN(r,VN())?new Proxy(r,Ox):r)}function Oo(r){if(r instanceof IDBRequest)return UN(r);if(rx.has(r))return rx.get(r);const e=GN(r);return e!==r&&(rx.set(r,e),Iv.set(e,r)),e}const nx=r=>Iv.get(r);function Fb(r,e,{blocked:t,upgrade:n,blocking:a,terminated:s}={}){const l=indexedDB.open(r,e),u=Oo(l);return n&&l.addEventListener("upgradeneeded",f=>{n(Oo(l.result),f.oldVersion,f.newVersion,Oo(l.transaction),f)}),t&&l.addEventListener("blocked",f=>t(f.oldVersion,f.newVersion,f)),u.then(f=>{s&&f.addEventListener("close",()=>s()),a&&f.addEventListener("versionchange",d=>a(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}const qN=["get","getKey","getAll","getAllKeys","count"],KN=["put","add","delete","clear"],ax=new Map;function lw(r,e){if(!(r instanceof IDBDatabase&&!(e in r)&&typeof e=="string"))return;if(ax.get(e))return ax.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,a=KN.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(a||qN.includes(t)))return;const s=async function(l,...u){const f=this.transaction(l,a?"readwrite":"readonly");let d=f.store;return n&&(d=d.index(u.shift())),(await Promise.all([d[t](...u),a&&f.done]))[0]};return ax.set(e,s),s}jN(r=>({...r,get:(e,t,n)=>lw(e,t)||r.get(e,t,n),has:(e,t)=>!!lw(e,t)||r.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XN{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(WN(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function WN(r){const e=r.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Fx="@firebase/app",cw="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ns=new Ep("@firebase/app"),YN="@firebase/app-compat",$N="@firebase/analytics-compat",QN="@firebase/analytics",JN="@firebase/app-check-compat",ZN="@firebase/app-check",e6="@firebase/auth",t6="@firebase/auth-compat",r6="@firebase/database",n6="@firebase/data-connect",a6="@firebase/database-compat",i6="@firebase/functions",s6="@firebase/functions-compat",o6="@firebase/installations",l6="@firebase/installations-compat",c6="@firebase/messaging",u6="@firebase/messaging-compat",f6="@firebase/performance",h6="@firebase/performance-compat",d6="@firebase/remote-config",m6="@firebase/remote-config-compat",p6="@firebase/storage",g6="@firebase/storage-compat",x6="@firebase/firestore",v6="@firebase/ai",_6="@firebase/firestore-compat",y6="firebase",T6="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mx="[DEFAULT]",E6={[Fx]:"fire-core",[YN]:"fire-core-compat",[QN]:"fire-analytics",[$N]:"fire-analytics-compat",[ZN]:"fire-app-check",[JN]:"fire-app-check-compat",[e6]:"fire-auth",[t6]:"fire-auth-compat",[r6]:"fire-rtdb",[n6]:"fire-data-connect",[a6]:"fire-rtdb-compat",[i6]:"fire-fn",[s6]:"fire-fn-compat",[o6]:"fire-iid",[l6]:"fire-iid-compat",[c6]:"fire-fcm",[u6]:"fire-fcm-compat",[f6]:"fire-perf",[h6]:"fire-perf-compat",[d6]:"fire-rc",[m6]:"fire-rc-compat",[p6]:"fire-gcs",[g6]:"fire-gcs-compat",[x6]:"fire-fst",[_6]:"fire-fst-compat",[v6]:"fire-vertex","fire-js":"fire-js",[y6]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mm=new Map,w6=new Map,Px=new Map;function uw(r,e){try{r.container.addComponent(e)}catch(t){Ns.debug(`Component ${e.name} failed to register with FirebaseApp ${r.name}`,t)}}function Ki(r){const e=r.name;if(Px.has(e))return Ns.debug(`There were multiple attempts to register component ${e}.`),!1;Px.set(e,r);for(const t of Mm.values())uw(t,r);for(const t of w6.values())uw(t,r);return!0}function cc(r,e){const t=r.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),r.container.getProvider(e)}function gi(r){return r==null?!1:r.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S6={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Fo=new lc("app","Firebase",S6);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A6{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new wi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Fo.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ju=T6;function Mb(r,e={}){let t=r;typeof e!="object"&&(e={name:e});const n={name:Mx,automaticDataCollectionEnabled:!0,...e},a=n.name;if(typeof a!="string"||!a)throw Fo.create("bad-app-name",{appName:String(a)});if(t||(t=wb()),!t)throw Fo.create("no-options");const s=Mm.get(a);if(s){if(Lo(t,s.options)&&Lo(n,s.config))return s;throw Fo.create("duplicate-app",{appName:a})}const l=new NN(a);for(const f of Px.values())l.addComponent(f);const u=new A6(t,n,l);return Mm.set(a,u),u}function kv(r=Mx){const e=Mm.get(r);if(!e&&r===Mx&&wb())return Mb();if(!e)throw Fo.create("no-app",{appName:r});return e}function Qa(r,e,t){let n=E6[r]??r;t&&(n+=`-${t}`);const a=n.match(/\s|\//),s=e.match(/\s|\//);if(a||s){const l=[`Unable to register library "${n}" with version "${e}":`];a&&l.push(`library name "${n}" contains illegal characters (whitespace or "/")`),a&&s&&l.push("and"),s&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ns.warn(l.join(" "));return}Ki(new wi(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b6="firebase-heartbeat-database",I6=1,Vh="firebase-heartbeat-store";let ix=null;function Pb(){return ix||(ix=Fb(b6,I6,{upgrade:(r,e)=>{switch(e){case 0:try{r.createObjectStore(Vh)}catch(t){console.warn(t)}}}}).catch(r=>{throw Fo.create("idb-open",{originalErrorMessage:r.message})})),ix}async function k6(r){try{const t=(await Pb()).transaction(Vh),n=await t.objectStore(Vh).get(Lb(r));return await t.done,n}catch(e){if(e instanceof Si)Ns.warn(e.message);else{const t=Fo.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ns.warn(t.message)}}}async function fw(r,e){try{const n=(await Pb()).transaction(Vh,"readwrite");await n.objectStore(Vh).put(e,Lb(r)),await n.done}catch(t){if(t instanceof Si)Ns.warn(t.message);else{const n=Fo.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Ns.warn(n.message)}}}function Lb(r){return`${r.name}!${r.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C6=1024,R6=30;class D6{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new O6(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,t;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=hw();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(l=>l.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:a}),this._heartbeatsCache.heartbeats.length>R6){const l=F6(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){Ns.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=hw(),{heartbeatsToSend:n,unsentEntries:a}=N6(this._heartbeatsCache.heartbeats),s=Fm(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return Ns.warn(t),""}}}function hw(){return new Date().toISOString().substring(0,10)}function N6(r,e=C6){const t=[];let n=r.slice();for(const a of r){const s=t.find(l=>l.agent===a.agent);if(s){if(s.dates.push(a.date),dw(t)>e){s.dates.pop();break}}else if(t.push({agent:a.agent,dates:[a.date]}),dw(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class O6{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return bv()?Db().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await k6(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return fw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return fw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function dw(r){return Fm(JSON.stringify({version:2,heartbeats:r})).length}function F6(r){if(r.length===0)return-1;let e=0,t=r[0].date;for(let n=1;n<r.length;n++)r[n].date<t&&(t=r[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M6(r){Ki(new wi("platform-logger",e=>new XN(e),"PRIVATE")),Ki(new wi("heartbeat",e=>new D6(e),"PRIVATE")),Qa(Fx,cw,r),Qa(Fx,cw,"esm2020"),Qa("fire-js","")}M6("");function Vb(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const P6=Vb,Bb=new lc("auth","Firebase",Vb());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pm=new Ep("@firebase/auth");function L6(r,...e){Pm.logLevel<=bt.WARN&&Pm.warn(`Auth (${Ju}): ${r}`,...e)}function vm(r,...e){Pm.logLevel<=bt.ERROR&&Pm.error(`Auth (${Ju}): ${r}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xi(r,...e){throw Rv(r,...e)}function yi(r,...e){return Rv(r,...e)}function Cv(r,e,t){const n={...P6(),[e]:t};return new lc("auth","Firebase",n).create(e,{appName:r.name})}function Pl(r){return Cv(r,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function V6(r,e,t){const n=t;if(!(e instanceof n))throw n.name!==e.constructor.name&&Xi(r,"argument-error"),Cv(r,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Rv(r,...e){if(typeof r!="string"){const t=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=r.name),r._errorFactory.create(t,...n)}return Bb.create(r,...e)}function ot(r,e,...t){if(!r)throw Rv(e,...t)}function ws(r){const e="INTERNAL ASSERTION FAILED: "+r;throw vm(e),new Error(e)}function Os(r,e){r||ws(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lx(){var r;return typeof self<"u"&&((r=self.location)==null?void 0:r.href)||""}function B6(){return mw()==="http:"||mw()==="https:"}function mw(){var r;return typeof self<"u"&&((r=self.location)==null?void 0:r.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U6(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(B6()||kb()||"connection"in navigator)?navigator.onLine:!0}function z6(){if(typeof navigator>"u")return null;const r=navigator;return r.languages&&r.languages[0]||r.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d0{constructor(e,t){this.shortDelay=e,this.longDelay=t,Os(t>e,"Short delay should be less than long delay!"),this.isMobile=dN()||pN()}get(){return U6()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dv(r,e){Os(r.emulator,"Emulator should always be set here");const{url:t}=r.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ub{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ws("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ws("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ws("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j6={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H6=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],G6=new d0(3e4,6e4);function Nv(r,e){return r.tenantId&&!e.tenantId?{...e,tenantId:r.tenantId}:e}async function Zu(r,e,t,n,a={}){return zb(r,a,async()=>{let s={},l={};n&&(e==="GET"?l=n:s={body:JSON.stringify(n)});const u=h0({key:r.config.apiKey,...l}).slice(1),f=await r._getAdditionalHeaders();f["Content-Type"]="application/json",r.languageCode&&(f["X-Firebase-Locale"]=r.languageCode);const d={method:e,headers:f,...s};return mN()||(d.referrerPolicy="no-referrer"),r.emulatorConfig&&Qu(r.emulatorConfig.host)&&(d.credentials="include"),Ub.fetch()(await jb(r,r.config.apiHost,t,u),d)})}async function zb(r,e,t){r._canInitEmulator=!1;const n={...j6,...e};try{const a=new K6(r),s=await Promise.race([t(),a.promise]);a.clearNetworkTimeout();const l=await s.json();if("needConfirmation"in l)throw Qd(r,"account-exists-with-different-credential",l);if(s.ok&&!("errorMessage"in l))return l;{const u=s.ok?l.errorMessage:l.error.message,[f,d]=u.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw Qd(r,"credential-already-in-use",l);if(f==="EMAIL_EXISTS")throw Qd(r,"email-already-in-use",l);if(f==="USER_DISABLED")throw Qd(r,"user-disabled",l);const m=n[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw Cv(r,m,d);Xi(r,m)}}catch(a){if(a instanceof Si)throw a;Xi(r,"network-request-failed",{message:String(a)})}}async function q6(r,e,t,n,a={}){const s=await Zu(r,e,t,n,a);return"mfaPendingCredential"in s&&Xi(r,"multi-factor-auth-required",{_serverResponse:s}),s}async function jb(r,e,t,n){const a=`${e}${t}?${n}`,s=r,l=s.config.emulator?Dv(r.config,a):`${r.config.apiScheme}://${a}`;return H6.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(l).toString():l}class K6{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,n)=>{this.timer=setTimeout(()=>n(yi(this.auth,"network-request-failed")),G6.get())})}}function Qd(r,e,t){const n={appName:r.name};t.email&&(n.email=t.email),t.phoneNumber&&(n.phoneNumber=t.phoneNumber);const a=yi(r,e,n);return a.customData._tokenResponse=t,a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function X6(r,e){return Zu(r,"POST","/v1/accounts:delete",e)}async function Lm(r,e){return Zu(r,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Th(r){if(r)try{const e=new Date(Number(r));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function W6(r,e=!1){const t=Fn(r),n=await t.getIdToken(e),a=Ov(n);ot(a&&a.exp&&a.auth_time&&a.iat,t.auth,"internal-error");const s=typeof a.firebase=="object"?a.firebase:void 0,l=s==null?void 0:s.sign_in_provider;return{claims:a,token:n,authTime:Th(sx(a.auth_time)),issuedAtTime:Th(sx(a.iat)),expirationTime:Th(sx(a.exp)),signInProvider:l||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function sx(r){return Number(r)*1e3}function Ov(r){const[e,t,n]=r.split(".");if(e===void 0||t===void 0||n===void 0)return vm("JWT malformed, contained fewer than 3 sections"),null;try{const a=yb(t);return a?JSON.parse(a):(vm("Failed to decode base64 JWT payload"),null)}catch(a){return vm("Caught error parsing JWT payload as JSON",a==null?void 0:a.toString()),null}}function pw(r){const e=Ov(r);return ot(e,"internal-error"),ot(typeof e.exp<"u","internal-error"),ot(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bh(r,e,t=!1){if(t)return e;try{return await e}catch(n){throw n instanceof Si&&Y6(n)&&r.auth.currentUser===r&&await r.auth.signOut(),n}}function Y6({code:r}){return r==="auth/user-disabled"||r==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $6{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vx{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Th(this.lastLoginAt),this.creationTime=Th(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vm(r){var x;const e=r.auth,t=await r.getIdToken(),n=await Bh(r,Lm(e,{idToken:t}));ot(n==null?void 0:n.users.length,e,"internal-error");const a=n.users[0];r._notifyReloadListener(a);const s=(x=a.providerUserInfo)!=null&&x.length?Hb(a.providerUserInfo):[],l=J6(r.providerData,s),u=r.isAnonymous,f=!(r.email&&a.passwordHash)&&!(l!=null&&l.length),d=u?f:!1,m={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new Vx(a.createdAt,a.lastLoginAt),isAnonymous:d};Object.assign(r,m)}async function Q6(r){const e=Fn(r);await Vm(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function J6(r,e){return[...r.filter(n=>!e.some(a=>a.providerId===n.providerId)),...e]}function Hb(r){return r.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Z6(r,e){const t=await zb(r,{},async()=>{const n=h0({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:s}=r.config,l=await jb(r,a,"/v1/token",`key=${s}`),u=await r._getAdditionalHeaders();u["Content-Type"]="application/x-www-form-urlencoded";const f={method:"POST",headers:u,body:n};return r.emulatorConfig&&Qu(r.emulatorConfig.host)&&(f.credentials="include"),Ub.fetch()(l,f)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function eO(r,e){return Zu(r,"POST","/v2/accounts:revokeToken",Nv(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eu{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ot(e.idToken,"internal-error"),ot(typeof e.idToken<"u","internal-error"),ot(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):pw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ot(e.length!==0,"internal-error");const t=pw(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ot(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:a,expiresIn:s}=await Z6(e,t);this.updateTokensAndExpiration(n,a,Number(s))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,t){const{refreshToken:n,accessToken:a,expirationTime:s}=t,l=new Eu;return n&&(ot(typeof n=="string","internal-error",{appName:e}),l.refreshToken=n),a&&(ot(typeof a=="string","internal-error",{appName:e}),l.accessToken=a),s&&(ot(typeof s=="number","internal-error",{appName:e}),l.expirationTime=s),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Eu,this.toJSON())}_performRefresh(){return ws("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yo(r,e){ot(typeof r=="string"||typeof r>"u","internal-error",{appName:e})}class xi{constructor({uid:e,auth:t,stsTokenManager:n,...a}){this.providerId="firebase",this.proactiveRefresh=new $6(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new Vx(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const t=await Bh(this,this.stsTokenManager.getToken(this.auth,e));return ot(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return W6(this,e)}reload(){return Q6(this)}_assign(e){this!==e&&(ot(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new xi({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){ot(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await Vm(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(gi(this.auth.app))return Promise.reject(Pl(this.auth));const e=await this.getIdToken();return await Bh(this,X6(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const n=t.displayName??void 0,a=t.email??void 0,s=t.phoneNumber??void 0,l=t.photoURL??void 0,u=t.tenantId??void 0,f=t._redirectEventId??void 0,d=t.createdAt??void 0,m=t.lastLoginAt??void 0,{uid:x,emailVerified:_,isAnonymous:y,providerData:w,stsTokenManager:T}=t;ot(x&&T,e,"internal-error");const S=Eu.fromJSON(this.name,T);ot(typeof x=="string",e,"internal-error"),yo(n,e.name),yo(a,e.name),ot(typeof _=="boolean",e,"internal-error"),ot(typeof y=="boolean",e,"internal-error"),yo(s,e.name),yo(l,e.name),yo(u,e.name),yo(f,e.name),yo(d,e.name),yo(m,e.name);const O=new xi({uid:x,auth:e,email:a,emailVerified:_,displayName:n,isAnonymous:y,photoURL:l,phoneNumber:s,tenantId:u,stsTokenManager:S,createdAt:d,lastLoginAt:m});return w&&Array.isArray(w)&&(O.providerData=w.map(U=>({...U}))),f&&(O._redirectEventId=f),O}static async _fromIdTokenResponse(e,t,n=!1){const a=new Eu;a.updateFromServerResponse(t);const s=new xi({uid:t.localId,auth:e,stsTokenManager:a,isAnonymous:n});return await Vm(s),s}static async _fromGetAccountInfoResponse(e,t,n){const a=t.users[0];ot(a.localId!==void 0,"internal-error");const s=a.providerUserInfo!==void 0?Hb(a.providerUserInfo):[],l=!(a.email&&a.passwordHash)&&!(s!=null&&s.length),u=new Eu;u.updateFromIdToken(n);const f=new xi({uid:a.localId,auth:e,stsTokenManager:u,isAnonymous:l}),d={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:s,metadata:new Vx(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!(s!=null&&s.length)};return Object.assign(f,d),f}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gw=new Map;function Ss(r){Os(r instanceof Function,"Expected a class definition");let e=gw.get(r);return e?(Os(e instanceof r,"Instance stored in cache mismatched with class"),e):(e=new r,gw.set(r,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gb{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Gb.type="NONE";const xw=Gb;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _m(r,e,t){return`firebase:${r}:${e}:${t}`}class wu{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:a,name:s}=this.auth;this.fullUserKey=_m(this.userKey,a.apiKey,s),this.fullPersistenceKey=_m("persistence",a.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Lm(this.auth,{idToken:e}).catch(()=>{});return t?xi._fromGetAccountInfoResponse(this.auth,t,e):null}return xi._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new wu(Ss(xw),e,n);const a=(await Promise.all(t.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let s=a[0]||Ss(xw);const l=_m(n,e.config.apiKey,e.name);let u=null;for(const d of t)try{const m=await d._get(l);if(m){let x;if(typeof m=="string"){const _=await Lm(e,{idToken:m}).catch(()=>{});if(!_)break;x=await xi._fromGetAccountInfoResponse(e,_,m)}else x=xi._fromJSON(e,m);d!==s&&(u=x),s=d;break}}catch{}const f=a.filter(d=>d._shouldAllowMigration);return!s._shouldAllowMigration||!f.length?new wu(s,e,n):(s=f[0],u&&await s._set(l,u.toJSON()),await Promise.all(t.map(async d=>{if(d!==s)try{await d._remove(l)}catch{}})),new wu(s,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vw(r){const e=r.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Wb(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(qb(e))return"Firefox";if(e.includes("silk/"))return"Silk";if($b(e))return"Blackberry";if(Qb(e))return"Webos";if(Kb(e))return"Safari";if((e.includes("chrome/")||Xb(e))&&!e.includes("edge/"))return"Chrome";if(Yb(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=r.match(t);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function qb(r=Zr()){return/firefox\//i.test(r)}function Kb(r=Zr()){const e=r.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Xb(r=Zr()){return/crios\//i.test(r)}function Wb(r=Zr()){return/iemobile/i.test(r)}function Yb(r=Zr()){return/android/i.test(r)}function $b(r=Zr()){return/blackberry/i.test(r)}function Qb(r=Zr()){return/webos/i.test(r)}function Fv(r=Zr()){return/iphone|ipad|ipod/i.test(r)||/macintosh/i.test(r)&&/mobile/i.test(r)}function tO(r=Zr()){var e;return Fv(r)&&!!((e=window.navigator)!=null&&e.standalone)}function rO(){return gN()&&document.documentMode===10}function Jb(r=Zr()){return Fv(r)||Yb(r)||Qb(r)||$b(r)||/windows phone/i.test(r)||Wb(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zb(r,e=[]){let t;switch(r){case"Browser":t=vw(Zr());break;case"Worker":t=`${vw(Zr())}-${r}`;break;default:t=r}const n=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ju}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nO{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=s=>new Promise((l,u)=>{try{const f=e(s);l(f)}catch(f){u(f)}});n.onAbort=t,this.queue.push(n);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const a of t)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aO(r,e={}){return Zu(r,"GET","/v2/passwordPolicy",Nv(r,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iO=6;class sO{constructor(e){var n;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??iO,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((n=e.allowedNonAlphanumericCharacters)==null?void 0:n.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),a&&(t.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let n;for(let a=0;a<e.length;a++)n=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,a,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oO{constructor(e,t,n,a){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new _w(this),this.idTokenSubscription=new _w(this),this.beforeStateQueue=new nO(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Bb,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ss(t)),this._initializationPromise=this.queue(async()=>{var n,a,s;if(!this._deleted&&(this.persistenceManager=await wu.create(this,e),(n=this._resolvePersistenceManagerAvailable)==null||n.call(this),!this._deleted)){if((a=this._popupRedirectResolver)!=null&&a._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)==null?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Lm(this,{idToken:e}),n=await xi._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var s;if(gi(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(u,u))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let n=t,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=(s=this.redirectUser)==null?void 0:s._redirectEventId,u=n==null?void 0:n._redirectEventId,f=await this.tryRedirectSignIn(e);(!l||l===u)&&(f!=null&&f.user)&&(n=f.user,a=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(n)}catch(l){n=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return ot(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Vm(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=z6()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(gi(this.app))return Promise.reject(Pl(this));const t=e?Fn(e):null;return t&&ot(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ot(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return gi(this.app)?Promise.reject(Pl(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return gi(this.app)?Promise.reject(Pl(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ss(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await aO(this),t=new sO(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new lc("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(n.tenantId=this.tenantId),await eO(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ss(e)||this._popupRedirectResolver;ot(t,this,"argument-error"),this.redirectPersistenceManager=await wu.create(this,[Ss(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((n=this.redirectUser)==null?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,a){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let l=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(ot(u,this,"internal-error"),u.then(()=>{l||s(this.currentUser)}),typeof t=="function"){const f=e.addObserver(t,n,a);return()=>{l=!0,f()}}else{const f=e.addObserver(t);return()=>{l=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ot(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Zb(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var a;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((a=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:a.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){var t;if(gi(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&L6(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function wp(r){return Fn(r)}class _w{constructor(e){this.auth=e,this.observer=null,this.addObserver=EN(t=>this.observer=t)}get next(){return ot(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Mv={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function lO(r){Mv=r}function cO(r){return Mv.loadJS(r)}function uO(){return Mv.gapiScript}function fO(r){return`__${r}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hO(r,e){const t=cc(r,"auth");if(t.isInitialized()){const a=t.getImmediate(),s=t.getOptions();if(Lo(s,e??{}))return a;Xi(a,"already-initialized")}return t.initialize({options:e})}function dO(r,e){const t=(e==null?void 0:e.persistence)||[],n=(Array.isArray(t)?t:[t]).map(Ss);e!=null&&e.errorMap&&r._updateErrorMap(e.errorMap),r._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function mO(r,e,t){const n=wp(r);ot(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const a=!1,s=e4(e),{host:l,port:u}=pO(e),f=u===null?"":`:${u}`,d={url:`${s}//${l}${f}/`},m=Object.freeze({host:l,port:u,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!n._canInitEmulator){ot(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),ot(Lo(d,n.config.emulator)&&Lo(m,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=d,n.emulatorConfig=m,n.settings.appVerificationDisabledForTesting=!0,Qu(l)?(Ab(`${s}//${l}${f}`),bb("Auth",!0)):gO()}function e4(r){const e=r.indexOf(":");return e<0?"":r.substr(0,e+1)}function pO(r){const e=e4(r),t=/(\/\/)?([^?#/]+)/.exec(r.substr(e.length));if(!t)return{host:"",port:null};const n=t[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(n);if(a){const s=a[1];return{host:s,port:yw(n.substr(s.length+1))}}else{const[s,l]=n.split(":");return{host:s,port:yw(l)}}}function yw(r){if(!r)return null;const e=Number(r);return isNaN(e)?null:e}function gO(){function r(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",r):r())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t4{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ws("not implemented")}_getIdTokenResponse(e){return ws("not implemented")}_linkToIdToken(e,t){return ws("not implemented")}_getReauthenticationResolver(e){return ws("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Su(r,e){return q6(r,"POST","/v1/accounts:signInWithIdp",Nv(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xO="http://localhost";class ql extends t4{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new ql(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Xi("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:a,...s}=t;if(!n||!a)return null;const l=new ql(n,a);return l.idToken=s.idToken||void 0,l.accessToken=s.accessToken||void 0,l.secret=s.secret,l.nonce=s.nonce,l.pendingToken=s.pendingToken||null,l}_getIdTokenResponse(e){const t=this.buildRequest();return Su(e,t)}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Su(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Su(e,t)}buildRequest(){const e={requestUri:xO,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=h0(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pv{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m0 extends Pv{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo extends m0{constructor(){super("facebook.com")}static credential(e){return ql._fromParams({providerId:bo.PROVIDER_ID,signInMethod:bo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return bo.credentialFromTaggedObject(e)}static credentialFromError(e){return bo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return bo.credential(e.oauthAccessToken)}catch{return null}}}bo.FACEBOOK_SIGN_IN_METHOD="facebook.com";bo.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es extends m0{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return ql._fromParams({providerId:Es.PROVIDER_ID,signInMethod:Es.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Es.credentialFromTaggedObject(e)}static credentialFromError(e){return Es.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return Es.credential(t,n)}catch{return null}}}Es.GOOGLE_SIGN_IN_METHOD="google.com";Es.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Io extends m0{constructor(){super("github.com")}static credential(e){return ql._fromParams({providerId:Io.PROVIDER_ID,signInMethod:Io.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Io.credentialFromTaggedObject(e)}static credentialFromError(e){return Io.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Io.credential(e.oauthAccessToken)}catch{return null}}}Io.GITHUB_SIGN_IN_METHOD="github.com";Io.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ko extends m0{constructor(){super("twitter.com")}static credential(e,t){return ql._fromParams({providerId:ko.PROVIDER_ID,signInMethod:ko.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ko.credentialFromTaggedObject(e)}static credentialFromError(e){return ko.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return ko.credential(t,n)}catch{return null}}}ko.TWITTER_SIGN_IN_METHOD="twitter.com";ko.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,a=!1){const s=await xi._fromIdTokenResponse(e,n,a),l=Tw(n);return new Nu({user:s,providerId:l,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const a=Tw(n);return new Nu({user:e,providerId:a,_tokenResponse:n,operationType:t})}}function Tw(r){return r.providerId?r.providerId:"phoneNumber"in r?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bm extends Si{constructor(e,t,n,a){super(t.code,t.message),this.operationType=n,this.user=a,Object.setPrototypeOf(this,Bm.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,a){return new Bm(e,t,n,a)}}function r4(r,e,t,n){return(e==="reauthenticate"?t._getReauthenticationResolver(r):t._getIdTokenResponse(r)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Bm._fromErrorAndOperation(r,s,e,n):s})}async function vO(r,e,t=!1){const n=await Bh(r,e._linkToIdToken(r.auth,await r.getIdToken()),t);return Nu._forOperation(r,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _O(r,e,t=!1){const{auth:n}=r;if(gi(n.app))return Promise.reject(Pl(n));const a="reauthenticate";try{const s=await Bh(r,r4(n,a,e,r),t);ot(s.idToken,n,"internal-error");const l=Ov(s.idToken);ot(l,n,"internal-error");const{sub:u}=l;return ot(r.uid===u,n,"user-mismatch"),Nu._forOperation(r,a,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Xi(n,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yO(r,e,t=!1){if(gi(r.app))return Promise.reject(Pl(r));const n="signIn",a=await r4(r,n,e),s=await Nu._fromIdTokenResponse(r,n,a);return t||await r._updateCurrentUser(s.user),s}function TO(r,e,t,n){return Fn(r).onIdTokenChanged(e,t,n)}function EO(r,e,t){return Fn(r).beforeAuthStateChanged(e,t)}function wO(r,e,t,n){return Fn(r).onAuthStateChanged(e,t,n)}function SO(r){return Fn(r).signOut()}const Um="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n4{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Um,"1"),this.storage.removeItem(Um),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AO=1e3,bO=10;class a4 extends n4{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Jb(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),a=this.localCache[t];n!==a&&e(t,a,n)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((l,u,f)=>{this.notifyListeners(l,f)});return}const n=e.key;t?this.detachListener():this.stopPolling();const a=()=>{const l=this.storage.getItem(n);!t&&this.localCache[n]===l||this.notifyListeners(n,l)},s=this.storage.getItem(n);rO()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,bO):a()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},AO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}a4.type="LOCAL";const IO=a4;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i4 extends n4{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}i4.type="SESSION";const s4=i4;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kO(r){return Promise.all(r.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(a=>a.isListeningto(e));if(t)return t;const n=new Sp(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:a,data:s}=t.data,l=this.handlersMap[a];if(!(l!=null&&l.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:a});const u=Array.from(l).map(async d=>d(t.origin,s)),f=await kO(u);t.ports[0].postMessage({status:"done",eventId:n,eventType:a,response:f})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Sp.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lv(r="",e=10){let t="";for(let n=0;n<e;n++)t+=Math.floor(Math.random()*10);return r+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CO{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let s,l;return new Promise((u,f)=>{const d=Lv("",20);a.port1.start();const m=setTimeout(()=>{f(new Error("unsupported_event"))},n);l={messageChannel:a,onMessage(x){const _=x;if(_.data.eventId===d)switch(_.data.status){case"ack":clearTimeout(m),s=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),u(_.data.response);break;default:clearTimeout(m),clearTimeout(s),f(new Error("invalid_response"));break}}},this.handlers.add(l),a.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[a.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hi(){return window}function RO(r){Hi().location.href=r}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o4(){return typeof Hi().WorkerGlobalScope<"u"&&typeof Hi().importScripts=="function"}async function DO(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function NO(){var r;return((r=navigator==null?void 0:navigator.serviceWorker)==null?void 0:r.controller)||null}function OO(){return o4()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l4="firebaseLocalStorageDb",FO=1,zm="firebaseLocalStorage",c4="fbase_key";class p0{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Ap(r,e){return r.transaction([zm],e?"readwrite":"readonly").objectStore(zm)}function MO(){const r=indexedDB.deleteDatabase(l4);return new p0(r).toPromise()}function Bx(){const r=indexedDB.open(l4,FO);return new Promise((e,t)=>{r.addEventListener("error",()=>{t(r.error)}),r.addEventListener("upgradeneeded",()=>{const n=r.result;try{n.createObjectStore(zm,{keyPath:c4})}catch(a){t(a)}}),r.addEventListener("success",async()=>{const n=r.result;n.objectStoreNames.contains(zm)?e(n):(n.close(),await MO(),e(await Bx()))})})}async function Ew(r,e,t){const n=Ap(r,!0).put({[c4]:e,value:t});return new p0(n).toPromise()}async function PO(r,e){const t=Ap(r,!1).get(e),n=await new p0(t).toPromise();return n===void 0?null:n.value}function ww(r,e){const t=Ap(r,!0).delete(e);return new p0(t).toPromise()}const LO=800,VO=3;class u4{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Bx(),this.db)}async _withRetries(e){let t=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(t++>VO)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return o4()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Sp._getInstance(OO()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,n;if(this.activeServiceWorker=await DO(),!this.activeServiceWorker)return;this.sender=new CO(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(n=e[0])!=null&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||NO()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Bx();return await Ew(e,Um,"1"),await ww(e,Um),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>Ew(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(n=>PO(n,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>ww(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const s=Ap(a,!1).getAll();return new p0(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],n=new Set;if(e.length!==0)for(const{fbase_key:a,value:s}of e)n.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(s)&&(this.notifyListeners(a,s),t.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!n.has(a)&&(this.notifyListeners(a,null),t.push(a));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),LO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}u4.type="LOCAL";const BO=u4;new d0(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f4(r,e){return e?Ss(e):(ot(r._popupRedirectResolver,r,"argument-error"),r._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vv extends t4{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Su(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Su(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Su(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function UO(r){return yO(r.auth,new Vv(r),r.bypassAuthState)}function zO(r){const{auth:e,user:t}=r;return ot(t,e,"internal-error"),_O(t,new Vv(r),r.bypassAuthState)}async function jO(r){const{auth:e,user:t}=r;return ot(t,e,"internal-error"),vO(t,new Vv(r),r.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h4{constructor(e,t,n,a,s=!1){this.auth=e,this.resolver=n,this.user=a,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:a,tenantId:s,error:l,type:u}=e;if(l){this.reject(l);return}const f={auth:this.auth,requestUri:t,sessionId:n,tenantId:s||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(f))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return UO;case"linkViaPopup":case"linkViaRedirect":return jO;case"reauthViaPopup":case"reauthViaRedirect":return zO;default:Xi(this.auth,"internal-error")}}resolve(e){Os(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Os(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HO=new d0(2e3,1e4);async function GO(r,e,t){if(gi(r.app))return Promise.reject(yi(r,"operation-not-supported-in-this-environment"));const n=wp(r);V6(r,e,Pv);const a=f4(n,t);return new Nl(n,"signInViaPopup",e,a).executeNotNull()}class Nl extends h4{constructor(e,t,n,a,s){super(e,t,a,s),this.provider=n,this.authWindow=null,this.pollId=null,Nl.currentPopupAction&&Nl.currentPopupAction.cancel(),Nl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ot(e,this.auth,"internal-error"),e}async onExecution(){Os(this.filter.length===1,"Popup operations only handle one event");const e=Lv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(yi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(yi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Nl.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;if((n=(t=this.authWindow)==null?void 0:t.window)!=null&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(yi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,HO.get())};e()}}Nl.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qO="pendingRedirect",ym=new Map;class KO extends h4{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=ym.get(this.auth._key());if(!e){try{const n=await XO(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}ym.set(this.auth._key(),e)}return this.bypassAuthState||ym.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function XO(r,e){const t=$O(e),n=YO(r);if(!await n._isAvailable())return!1;const a=await n._get(t)==="true";return await n._remove(t),a}function WO(r,e){ym.set(r._key(),e)}function YO(r){return Ss(r._redirectPersistence)}function $O(r){return _m(qO,r.config.apiKey,r.name)}async function QO(r,e,t=!1){if(gi(r.app))return Promise.reject(Pl(r));const n=wp(r),a=f4(n,e),l=await new KO(n,a,t).execute();return l&&!t&&(delete l.user._redirectEventId,await n._persistUserIfCurrent(l.user),await n._setRedirectUser(null,e)),l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JO=600*1e3;class ZO{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!e5(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!d4(e)){const a=((n=e.error.code)==null?void 0:n.split("auth/")[1])||"internal-error";t.onError(yi(this.auth,a))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=JO&&this.cachedEventUids.clear(),this.cachedEventUids.has(Sw(e))}saveEventToCache(e){this.cachedEventUids.add(Sw(e)),this.lastProcessedEventTime=Date.now()}}function Sw(r){return[r.type,r.eventId,r.sessionId,r.tenantId].filter(e=>e).join("-")}function d4({type:r,error:e}){return r==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function e5(r){switch(r.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return d4(r);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function t5(r,e={}){return Zu(r,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r5=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,n5=/^https?/;async function a5(r){if(r.config.emulator)return;const{authorizedDomains:e}=await t5(r);for(const t of e)try{if(i5(t))return}catch{}Xi(r,"unauthorized-domain")}function i5(r){const e=Lx(),{protocol:t,hostname:n}=new URL(e);if(r.startsWith("chrome-extension://")){const l=new URL(r);return l.hostname===""&&n===""?t==="chrome-extension:"&&r.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&l.hostname===n}if(!n5.test(t))return!1;if(r5.test(r))return n===r;const a=r.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s5=new d0(3e4,6e4);function Aw(){const r=Hi().___jsl;if(r!=null&&r.H){for(const e of Object.keys(r.H))if(r.H[e].r=r.H[e].r||[],r.H[e].L=r.H[e].L||[],r.H[e].r=[...r.H[e].L],r.CP)for(let t=0;t<r.CP.length;t++)r.CP[t]=null}}function o5(r){return new Promise((e,t)=>{var a,s,l;function n(){Aw(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Aw(),t(yi(r,"network-request-failed"))},timeout:s5.get()})}if((s=(a=Hi().gapi)==null?void 0:a.iframes)!=null&&s.Iframe)e(gapi.iframes.getContext());else if((l=Hi().gapi)!=null&&l.load)n();else{const u=fO("iframefcb");return Hi()[u]=()=>{gapi.load?n():t(yi(r,"network-request-failed"))},cO(`${uO()}?onload=${u}`).catch(f=>t(f))}}).catch(e=>{throw Tm=null,e})}let Tm=null;function l5(r){return Tm=Tm||o5(r),Tm}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c5=new d0(5e3,15e3),u5="__/auth/iframe",f5="emulator/auth/iframe",h5={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},d5=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function m5(r){const e=r.config;ot(e.authDomain,r,"auth-domain-config-required");const t=e.emulator?Dv(e,f5):`https://${r.config.authDomain}/${u5}`,n={apiKey:e.apiKey,appName:r.name,v:Ju},a=d5.get(r.config.apiHost);a&&(n.eid=a);const s=r._getFrameworks();return s.length&&(n.fw=s.join(",")),`${t}?${h0(n).slice(1)}`}async function p5(r){const e=await l5(r),t=Hi().gapi;return ot(t,r,"internal-error"),e.open({where:document.body,url:m5(r),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:h5,dontclear:!0},n=>new Promise(async(a,s)=>{await n.restyle({setHideOnLeave:!1});const l=yi(r,"network-request-failed"),u=Hi().setTimeout(()=>{s(l)},c5.get());function f(){Hi().clearTimeout(u),a(n)}n.ping(f).then(f,()=>{s(l)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g5={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},x5=500,v5=600,_5="_blank",y5="http://localhost";class bw{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function T5(r,e,t,n=x5,a=v5){const s=Math.max((window.screen.availHeight-a)/2,0).toString(),l=Math.max((window.screen.availWidth-n)/2,0).toString();let u="";const f={...g5,width:n.toString(),height:a.toString(),top:s,left:l},d=Zr().toLowerCase();t&&(u=Xb(d)?_5:t),qb(d)&&(e=e||y5,f.scrollbars="yes");const m=Object.entries(f).reduce((_,[y,w])=>`${_}${y}=${w},`,"");if(tO(d)&&u!=="_self")return E5(e||"",u),new bw(null);const x=window.open(e||"",u,m);ot(x,r,"popup-blocked");try{x.focus()}catch{}return new bw(x)}function E5(r,e){const t=document.createElement("a");t.href=r,t.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w5="__/auth/handler",S5="emulator/auth/handler",A5=encodeURIComponent("fac");async function Iw(r,e,t,n,a,s){ot(r.config.authDomain,r,"auth-domain-config-required"),ot(r.config.apiKey,r,"invalid-api-key");const l={apiKey:r.config.apiKey,appName:r.name,authType:t,redirectUrl:n,v:Ju,eventId:a};if(e instanceof Pv){e.setDefaultLanguage(r.languageCode),l.providerId=e.providerId||"",TN(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[m,x]of Object.entries({}))l[m]=x}if(e instanceof m0){const m=e.getScopes().filter(x=>x!=="");m.length>0&&(l.scopes=m.join(","))}r.tenantId&&(l.tid=r.tenantId);const u=l;for(const m of Object.keys(u))u[m]===void 0&&delete u[m];const f=await r._getAppCheckToken(),d=f?`#${A5}=${encodeURIComponent(f)}`:"";return`${b5(r)}?${h0(u).slice(1)}${d}`}function b5({config:r}){return r.emulator?Dv(r,S5):`https://${r.authDomain}/${w5}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ox="webStorageSupport";class I5{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=s4,this._completeRedirectFn=QO,this._overrideRedirectResult=WO}async _openPopup(e,t,n,a){var l;Os((l=this.eventManagers[e._key()])==null?void 0:l.manager,"_initialize() not called before _openPopup()");const s=await Iw(e,t,n,Lx(),a);return T5(e,s,Lv())}async _openRedirect(e,t,n,a){await this._originValidation(e);const s=await Iw(e,t,n,Lx(),a);return RO(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:a,promise:s}=this.eventManagers[t];return a?Promise.resolve(a):(Os(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await p5(e),n=new ZO(e);return t.register("authEvent",a=>(ot(a==null?void 0:a.authEvent,e,"invalid-auth-event"),{status:n.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(ox,{type:ox},a=>{var l;const s=(l=a==null?void 0:a[0])==null?void 0:l[ox];s!==void 0&&t(!!s),Xi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=a5(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Jb()||Kb()||Fv()}}const k5=I5;var kw="@firebase/auth",Cw="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C5{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ot(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R5(r){switch(r){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function D5(r){Ki(new wi("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:l,authDomain:u}=n.options;ot(l&&!l.includes(":"),"invalid-api-key",{appName:n.name});const f={apiKey:l,authDomain:u,clientPlatform:r,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Zb(r)},d=new oO(n,a,s,f);return dO(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),Ki(new wi("auth-internal",e=>{const t=wp(e.getProvider("auth").getImmediate());return(n=>new C5(n))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Qa(kw,Cw,R5(r)),Qa(kw,Cw,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N5=300,O5=Sb("authIdTokenMaxAge")||N5;let Rw=null;const F5=r=>async e=>{const t=e&&await e.getIdTokenResult(),n=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>O5)return;const a=t==null?void 0:t.token;Rw!==a&&(Rw=a,await fetch(r,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function M5(r=kv()){const e=cc(r,"auth");if(e.isInitialized())return e.getImmediate();const t=hO(r,{popupRedirectResolver:k5,persistence:[BO,IO,s4]}),n=Sb("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const l=F5(s.toString());EO(t,l,()=>l(t.currentUser)),TO(t,u=>l(u))}}const a=Eb("auth");return a&&mO(t,`http://${a}`),t}function P5(){var r;return((r=document.getElementsByTagName("head"))==null?void 0:r[0])??document}lO({loadJS(r){return new Promise((e,t)=>{const n=document.createElement("script");n.setAttribute("src",r),n.onload=e,n.onerror=a=>{const s=yi("internal-error");s.customData=a,t(s)},n.type="text/javascript",n.charset="UTF-8",P5().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});D5("Browser");var L5="firebase",V5="12.7.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Qa(L5,V5,"app");const m4="@firebase/installations",Bv="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p4=1e4,g4=`w:${Bv}`,x4="FIS_v2",B5="https://firebaseinstallations.googleapis.com/v1",U5=3600*1e3,z5="installations",j5="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H5={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Kl=new lc(z5,j5,H5);function v4(r){return r instanceof Si&&r.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _4({projectId:r}){return`${B5}/projects/${r}/installations`}function y4(r){return{token:r.token,requestStatus:2,expiresIn:q5(r.expiresIn),creationTime:Date.now()}}async function T4(r,e){const n=(await e.json()).error;return Kl.create("request-failed",{requestName:r,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function E4({apiKey:r}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":r})}function G5(r,{refreshToken:e}){const t=E4(r);return t.append("Authorization",K5(e)),t}async function w4(r){const e=await r();return e.status>=500&&e.status<600?r():e}function q5(r){return Number(r.replace("s","000"))}function K5(r){return`${x4} ${r}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function X5({appConfig:r,heartbeatServiceProvider:e},{fid:t}){const n=_4(r),a=E4(r),s=e.getImmediate({optional:!0});if(s){const d=await s.getHeartbeatsHeader();d&&a.append("x-firebase-client",d)}const l={fid:t,authVersion:x4,appId:r.appId,sdkVersion:g4},u={method:"POST",headers:a,body:JSON.stringify(l)},f=await w4(()=>fetch(n,u));if(f.ok){const d=await f.json();return{fid:d.fid||t,registrationStatus:2,refreshToken:d.refreshToken,authToken:y4(d.authToken)}}else throw await T4("Create Installation",f)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S4(r){return new Promise(e=>{setTimeout(e,r)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W5(r){return btoa(String.fromCharCode(...r)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y5=/^[cdef][\w-]{21}$/,Ux="";function $5(){try{const r=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(r),r[0]=112+r[0]%16;const t=Q5(r);return Y5.test(t)?t:Ux}catch{return Ux}}function Q5(r){return W5(r).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bp(r){return`${r.appName}!${r.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A4=new Map;function b4(r,e){const t=bp(r);I4(t,e),J5(t,e)}function I4(r,e){const t=A4.get(r);if(t)for(const n of t)n(e)}function J5(r,e){const t=Z5();t&&t.postMessage({key:r,fid:e}),e8()}let Ol=null;function Z5(){return!Ol&&"BroadcastChannel"in self&&(Ol=new BroadcastChannel("[Firebase] FID Change"),Ol.onmessage=r=>{I4(r.data.key,r.data.fid)}),Ol}function e8(){A4.size===0&&Ol&&(Ol.close(),Ol=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t8="firebase-installations-database",r8=1,Xl="firebase-installations-store";let lx=null;function Uv(){return lx||(lx=Fb(t8,r8,{upgrade:(r,e)=>{switch(e){case 0:r.createObjectStore(Xl)}}})),lx}async function jm(r,e){const t=bp(r),a=(await Uv()).transaction(Xl,"readwrite"),s=a.objectStore(Xl),l=await s.get(t);return await s.put(e,t),await a.done,(!l||l.fid!==e.fid)&&b4(r,e.fid),e}async function k4(r){const e=bp(r),n=(await Uv()).transaction(Xl,"readwrite");await n.objectStore(Xl).delete(e),await n.done}async function Ip(r,e){const t=bp(r),a=(await Uv()).transaction(Xl,"readwrite"),s=a.objectStore(Xl),l=await s.get(t),u=e(l);return u===void 0?await s.delete(t):await s.put(u,t),await a.done,u&&(!l||l.fid!==u.fid)&&b4(r,u.fid),u}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zv(r){let e;const t=await Ip(r.appConfig,n=>{const a=n8(n),s=a8(r,a);return e=s.registrationPromise,s.installationEntry});return t.fid===Ux?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function n8(r){const e=r||{fid:$5(),registrationStatus:0};return C4(e)}function a8(r,e){if(e.registrationStatus===0){if(!navigator.onLine){const a=Promise.reject(Kl.create("app-offline"));return{installationEntry:e,registrationPromise:a}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},n=i8(r,t);return{installationEntry:t,registrationPromise:n}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:s8(r)}:{installationEntry:e}}async function i8(r,e){try{const t=await X5(r,e);return jm(r.appConfig,t)}catch(t){throw v4(t)&&t.customData.serverCode===409?await k4(r.appConfig):await jm(r.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function s8(r){let e=await Dw(r.appConfig);for(;e.registrationStatus===1;)await S4(100),e=await Dw(r.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:n}=await zv(r);return n||t}return e}function Dw(r){return Ip(r,e=>{if(!e)throw Kl.create("installation-not-found");return C4(e)})}function C4(r){return o8(r)?{fid:r.fid,registrationStatus:0}:r}function o8(r){return r.registrationStatus===1&&r.registrationTime+p4<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function l8({appConfig:r,heartbeatServiceProvider:e},t){const n=c8(r,t),a=G5(r,t),s=e.getImmediate({optional:!0});if(s){const d=await s.getHeartbeatsHeader();d&&a.append("x-firebase-client",d)}const l={installation:{sdkVersion:g4,appId:r.appId}},u={method:"POST",headers:a,body:JSON.stringify(l)},f=await w4(()=>fetch(n,u));if(f.ok){const d=await f.json();return y4(d)}else throw await T4("Generate Auth Token",f)}function c8(r,{fid:e}){return`${_4(r)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jv(r,e=!1){let t;const n=await Ip(r.appConfig,s=>{if(!R4(s))throw Kl.create("not-registered");const l=s.authToken;if(!e&&h8(l))return s;if(l.requestStatus===1)return t=u8(r,e),s;{if(!navigator.onLine)throw Kl.create("app-offline");const u=m8(s);return t=f8(r,u),u}});return t?await t:n.authToken}async function u8(r,e){let t=await Nw(r.appConfig);for(;t.authToken.requestStatus===1;)await S4(100),t=await Nw(r.appConfig);const n=t.authToken;return n.requestStatus===0?jv(r,e):n}function Nw(r){return Ip(r,e=>{if(!R4(e))throw Kl.create("not-registered");const t=e.authToken;return p8(t)?{...e,authToken:{requestStatus:0}}:e})}async function f8(r,e){try{const t=await l8(r,e),n={...e,authToken:t};return await jm(r.appConfig,n),t}catch(t){if(v4(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await k4(r.appConfig);else{const n={...e,authToken:{requestStatus:0}};await jm(r.appConfig,n)}throw t}}function R4(r){return r!==void 0&&r.registrationStatus===2}function h8(r){return r.requestStatus===2&&!d8(r)}function d8(r){const e=Date.now();return e<r.creationTime||r.creationTime+r.expiresIn<e+U5}function m8(r){const e={requestStatus:1,requestTime:Date.now()};return{...r,authToken:e}}function p8(r){return r.requestStatus===1&&r.requestTime+p4<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function g8(r){const e=r,{installationEntry:t,registrationPromise:n}=await zv(e);return n?n.catch(console.error):jv(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function x8(r,e=!1){const t=r;return await v8(t),(await jv(t,e)).token}async function v8(r){const{registrationPromise:e}=await zv(r);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _8(r){if(!r||!r.options)throw cx("App Configuration");if(!r.name)throw cx("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!r.options[t])throw cx(t);return{appName:r.name,projectId:r.options.projectId,apiKey:r.options.apiKey,appId:r.options.appId}}function cx(r){return Kl.create("missing-app-config-values",{valueName:r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D4="installations",y8="installations-internal",T8=r=>{const e=r.getProvider("app").getImmediate(),t=_8(e),n=cc(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:n,_delete:()=>Promise.resolve()}},E8=r=>{const e=r.getProvider("app").getImmediate(),t=cc(e,D4).getImmediate();return{getId:()=>g8(t),getToken:a=>x8(t,a)}};function w8(){Ki(new wi(D4,T8,"PUBLIC")),Ki(new wi(y8,E8,"PRIVATE"))}w8();Qa(m4,Bv);Qa(m4,Bv,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hm="analytics",S8="firebase_id",A8="origin",b8=60*1e3,I8="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Hv="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gn=new Ep("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k8={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Aa=new lc("analytics","Analytics",k8);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C8(r){if(!r.startsWith(Hv)){const e=Aa.create("invalid-gtag-resource",{gtagURL:r});return Gn.warn(e.message),""}return r}function N4(r){return Promise.all(r.map(e=>e.catch(t=>t)))}function R8(r,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(r,e)),t}function D8(r,e){const t=R8("firebase-js-sdk-policy",{createScriptURL:C8}),n=document.createElement("script"),a=`${Hv}?l=${r}&id=${e}`;n.src=t?t==null?void 0:t.createScriptURL(a):a,n.async=!0,document.head.appendChild(n)}function N8(r){let e=[];return Array.isArray(window[r])?e=window[r]:window[r]=e,e}async function O8(r,e,t,n,a,s){const l=n[a];try{if(l)await e[l];else{const f=(await N4(t)).find(d=>d.measurementId===a);f&&await e[f.appId]}}catch(u){Gn.error(u)}r("config",a,s)}async function F8(r,e,t,n,a){try{let s=[];if(a&&a.send_to){let l=a.send_to;Array.isArray(l)||(l=[l]);const u=await N4(t);for(const f of l){const d=u.find(x=>x.measurementId===f),m=d&&e[d.appId];if(m)s.push(m);else{s=[];break}}}s.length===0&&(s=Object.values(e)),await Promise.all(s),r("event",n,a||{})}catch(s){Gn.error(s)}}function M8(r,e,t,n){async function a(s,...l){try{if(s==="event"){const[u,f]=l;await F8(r,e,t,u,f)}else if(s==="config"){const[u,f]=l;await O8(r,e,t,n,u,f)}else if(s==="consent"){const[u,f]=l;r("consent",u,f)}else if(s==="get"){const[u,f,d]=l;r("get",u,f,d)}else if(s==="set"){const[u]=l;r("set",u)}else r(s,...l)}catch(u){Gn.error(u)}}return a}function P8(r,e,t,n,a){let s=function(...l){window[n].push(arguments)};return window[a]&&typeof window[a]=="function"&&(s=window[a]),window[a]=M8(s,r,e,t),{gtagCore:s,wrappedGtag:window[a]}}function L8(r){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(Hv)&&t.src.includes(r))return t;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V8=30,B8=1e3;class U8{constructor(e={},t=B8){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const O4=new U8;function z8(r){return new Headers({Accept:"application/json","x-goog-api-key":r})}async function j8(r){var l;const{appId:e,apiKey:t}=r,n={method:"GET",headers:z8(t)},a=I8.replace("{app-id}",e),s=await fetch(a,n);if(s.status!==200&&s.status!==304){let u="";try{const f=await s.json();(l=f.error)!=null&&l.message&&(u=f.error.message)}catch{}throw Aa.create("config-fetch-failed",{httpStatus:s.status,responseMessage:u})}return s.json()}async function H8(r,e=O4,t){const{appId:n,apiKey:a,measurementId:s}=r.options;if(!n)throw Aa.create("no-app-id");if(!a){if(s)return{measurementId:s,appId:n};throw Aa.create("no-api-key")}const l=e.getThrottleMetadata(n)||{backoffCount:0,throttleEndTimeMillis:Date.now()},u=new K8;return setTimeout(async()=>{u.abort()},b8),F4({appId:n,apiKey:a,measurementId:s},l,u,e)}async function F4(r,{throttleEndTimeMillis:e,backoffCount:t},n,a=O4){var u;const{appId:s,measurementId:l}=r;try{await G8(n,e)}catch(f){if(l)return Gn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${f==null?void 0:f.message}]`),{appId:s,measurementId:l};throw f}try{const f=await j8(r);return a.deleteThrottleMetadata(s),f}catch(f){const d=f;if(!q8(d)){if(a.deleteThrottleMetadata(s),l)return Gn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${d==null?void 0:d.message}]`),{appId:s,measurementId:l};throw f}const m=Number((u=d==null?void 0:d.customData)==null?void 0:u.httpStatus)===503?iw(t,a.intervalMillis,V8):iw(t,a.intervalMillis),x={throttleEndTimeMillis:Date.now()+m,backoffCount:t+1};return a.setThrottleMetadata(s,x),Gn.debug(`Calling attemptFetch again in ${m} millis`),F4(r,x,n,a)}}function G8(r,e){return new Promise((t,n)=>{const a=Math.max(e-Date.now(),0),s=setTimeout(t,a);r.addEventListener(()=>{clearTimeout(s),n(Aa.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function q8(r){if(!(r instanceof Si)||!r.customData)return!1;const e=Number(r.customData.httpStatus);return e===429||e===500||e===503||e===504}class K8{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function X8(r,e,t,n,a){if(a&&a.global){r("event",t,n);return}else{const s=await e,l={...n,send_to:s};r("event",t,l)}}async function W8(r,e,t,n){if(n&&n.global){const a={};for(const s of Object.keys(t))a[`user_properties.${s}`]=t[s];return r("set",a),Promise.resolve()}else{const a=await e;r("config",a,{update:!0,user_properties:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Y8(){if(bv())try{await Db()}catch(r){return Gn.warn(Aa.create("indexeddb-unavailable",{errorInfo:r==null?void 0:r.toString()}).message),!1}else return Gn.warn(Aa.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function $8(r,e,t,n,a,s,l){const u=H8(r);u.then(_=>{t[_.measurementId]=_.appId,r.options.measurementId&&_.measurementId!==r.options.measurementId&&Gn.warn(`The measurement ID in the local Firebase config (${r.options.measurementId}) does not match the measurement ID fetched from the server (${_.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(_=>Gn.error(_)),e.push(u);const f=Y8().then(_=>{if(_)return n.getId()}),[d,m]=await Promise.all([u,f]);L8(s)||D8(s,d.measurementId),a("js",new Date);const x=(l==null?void 0:l.config)??{};return x[A8]="firebase",x.update=!0,m!=null&&(x[S8]=m),a("config",d.measurementId,x),d.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q8{constructor(e){this.app=e}_delete(){return delete Au[this.app.options.appId],Promise.resolve()}}let Au={},Ow=[];const Fw={};let ux="dataLayer",J8="gtag",Mw,Gv,Pw=!1;function Z8(){const r=[];if(kb()&&r.push("This is a browser extension environment."),xN()||r.push("Cookies are not available."),r.length>0){const e=r.map((n,a)=>`(${a+1}) ${n}`).join(" "),t=Aa.create("invalid-analytics-context",{errorInfo:e});Gn.warn(t.message)}}function eF(r,e,t){Z8();const n=r.options.appId;if(!n)throw Aa.create("no-app-id");if(!r.options.apiKey)if(r.options.measurementId)Gn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${r.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Aa.create("no-api-key");if(Au[n]!=null)throw Aa.create("already-exists",{id:n});if(!Pw){N8(ux);const{wrappedGtag:s,gtagCore:l}=P8(Au,Ow,Fw,ux,J8);Gv=s,Mw=l,Pw=!0}return Au[n]=$8(r,Ow,Fw,e,Mw,ux,t),new Q8(r)}function tF(r=kv()){r=Fn(r);const e=cc(r,Hm);return e.isInitialized()?e.getImmediate():rF(r)}function rF(r,e={}){const t=cc(r,Hm);if(t.isInitialized()){const a=t.getImmediate();if(Lo(e,t.getOptions()))return a;throw Aa.create("already-initialized")}return t.initialize({options:e})}function nF(r,e,t){r=Fn(r),W8(Gv,Au[r.app.options.appId],e,t).catch(n=>Gn.error(n))}function aF(r,e,t,n){r=Fn(r),X8(Gv,Au[r.app.options.appId],e,t,n).catch(a=>Gn.error(a))}const Lw="@firebase/analytics",Vw="0.10.19";function iF(){Ki(new wi(Hm,(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),a=e.getProvider("installations-internal").getImmediate();return eF(n,a,t)},"PUBLIC")),Ki(new wi("analytics-internal",r,"PRIVATE")),Qa(Lw,Vw),Qa(Lw,Vw,"esm2020");function r(e){try{const t=e.getProvider(Hm).getImmediate();return{logEvent:(n,a,s)=>aF(t,n,a,s),setUserProperties:(n,a)=>nF(t,n,a)}}catch(t){throw Aa.create("interop-component-reg-failed",{reason:t})}}}iF();var Bw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Mo,M4;(function(){var r;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(A,C){function k(){}k.prototype=C.prototype,A.F=C.prototype,A.prototype=new k,A.prototype.constructor=A,A.D=function(V,F,M){for(var L=Array(arguments.length-2),Ie=2;Ie<arguments.length;Ie++)L[Ie-2]=arguments[Ie];return C.prototype[F].apply(V,L)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(n,t),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(A,C,k){k||(k=0);const V=Array(16);if(typeof C=="string")for(var F=0;F<16;++F)V[F]=C.charCodeAt(k++)|C.charCodeAt(k++)<<8|C.charCodeAt(k++)<<16|C.charCodeAt(k++)<<24;else for(F=0;F<16;++F)V[F]=C[k++]|C[k++]<<8|C[k++]<<16|C[k++]<<24;C=A.g[0],k=A.g[1],F=A.g[2];let M=A.g[3],L;L=C+(M^k&(F^M))+V[0]+3614090360&4294967295,C=k+(L<<7&4294967295|L>>>25),L=M+(F^C&(k^F))+V[1]+3905402710&4294967295,M=C+(L<<12&4294967295|L>>>20),L=F+(k^M&(C^k))+V[2]+606105819&4294967295,F=M+(L<<17&4294967295|L>>>15),L=k+(C^F&(M^C))+V[3]+3250441966&4294967295,k=F+(L<<22&4294967295|L>>>10),L=C+(M^k&(F^M))+V[4]+4118548399&4294967295,C=k+(L<<7&4294967295|L>>>25),L=M+(F^C&(k^F))+V[5]+1200080426&4294967295,M=C+(L<<12&4294967295|L>>>20),L=F+(k^M&(C^k))+V[6]+2821735955&4294967295,F=M+(L<<17&4294967295|L>>>15),L=k+(C^F&(M^C))+V[7]+4249261313&4294967295,k=F+(L<<22&4294967295|L>>>10),L=C+(M^k&(F^M))+V[8]+1770035416&4294967295,C=k+(L<<7&4294967295|L>>>25),L=M+(F^C&(k^F))+V[9]+2336552879&4294967295,M=C+(L<<12&4294967295|L>>>20),L=F+(k^M&(C^k))+V[10]+4294925233&4294967295,F=M+(L<<17&4294967295|L>>>15),L=k+(C^F&(M^C))+V[11]+2304563134&4294967295,k=F+(L<<22&4294967295|L>>>10),L=C+(M^k&(F^M))+V[12]+1804603682&4294967295,C=k+(L<<7&4294967295|L>>>25),L=M+(F^C&(k^F))+V[13]+4254626195&4294967295,M=C+(L<<12&4294967295|L>>>20),L=F+(k^M&(C^k))+V[14]+2792965006&4294967295,F=M+(L<<17&4294967295|L>>>15),L=k+(C^F&(M^C))+V[15]+1236535329&4294967295,k=F+(L<<22&4294967295|L>>>10),L=C+(F^M&(k^F))+V[1]+4129170786&4294967295,C=k+(L<<5&4294967295|L>>>27),L=M+(k^F&(C^k))+V[6]+3225465664&4294967295,M=C+(L<<9&4294967295|L>>>23),L=F+(C^k&(M^C))+V[11]+643717713&4294967295,F=M+(L<<14&4294967295|L>>>18),L=k+(M^C&(F^M))+V[0]+3921069994&4294967295,k=F+(L<<20&4294967295|L>>>12),L=C+(F^M&(k^F))+V[5]+3593408605&4294967295,C=k+(L<<5&4294967295|L>>>27),L=M+(k^F&(C^k))+V[10]+38016083&4294967295,M=C+(L<<9&4294967295|L>>>23),L=F+(C^k&(M^C))+V[15]+3634488961&4294967295,F=M+(L<<14&4294967295|L>>>18),L=k+(M^C&(F^M))+V[4]+3889429448&4294967295,k=F+(L<<20&4294967295|L>>>12),L=C+(F^M&(k^F))+V[9]+568446438&4294967295,C=k+(L<<5&4294967295|L>>>27),L=M+(k^F&(C^k))+V[14]+3275163606&4294967295,M=C+(L<<9&4294967295|L>>>23),L=F+(C^k&(M^C))+V[3]+4107603335&4294967295,F=M+(L<<14&4294967295|L>>>18),L=k+(M^C&(F^M))+V[8]+1163531501&4294967295,k=F+(L<<20&4294967295|L>>>12),L=C+(F^M&(k^F))+V[13]+2850285829&4294967295,C=k+(L<<5&4294967295|L>>>27),L=M+(k^F&(C^k))+V[2]+4243563512&4294967295,M=C+(L<<9&4294967295|L>>>23),L=F+(C^k&(M^C))+V[7]+1735328473&4294967295,F=M+(L<<14&4294967295|L>>>18),L=k+(M^C&(F^M))+V[12]+2368359562&4294967295,k=F+(L<<20&4294967295|L>>>12),L=C+(k^F^M)+V[5]+4294588738&4294967295,C=k+(L<<4&4294967295|L>>>28),L=M+(C^k^F)+V[8]+2272392833&4294967295,M=C+(L<<11&4294967295|L>>>21),L=F+(M^C^k)+V[11]+1839030562&4294967295,F=M+(L<<16&4294967295|L>>>16),L=k+(F^M^C)+V[14]+4259657740&4294967295,k=F+(L<<23&4294967295|L>>>9),L=C+(k^F^M)+V[1]+2763975236&4294967295,C=k+(L<<4&4294967295|L>>>28),L=M+(C^k^F)+V[4]+1272893353&4294967295,M=C+(L<<11&4294967295|L>>>21),L=F+(M^C^k)+V[7]+4139469664&4294967295,F=M+(L<<16&4294967295|L>>>16),L=k+(F^M^C)+V[10]+3200236656&4294967295,k=F+(L<<23&4294967295|L>>>9),L=C+(k^F^M)+V[13]+681279174&4294967295,C=k+(L<<4&4294967295|L>>>28),L=M+(C^k^F)+V[0]+3936430074&4294967295,M=C+(L<<11&4294967295|L>>>21),L=F+(M^C^k)+V[3]+3572445317&4294967295,F=M+(L<<16&4294967295|L>>>16),L=k+(F^M^C)+V[6]+76029189&4294967295,k=F+(L<<23&4294967295|L>>>9),L=C+(k^F^M)+V[9]+3654602809&4294967295,C=k+(L<<4&4294967295|L>>>28),L=M+(C^k^F)+V[12]+3873151461&4294967295,M=C+(L<<11&4294967295|L>>>21),L=F+(M^C^k)+V[15]+530742520&4294967295,F=M+(L<<16&4294967295|L>>>16),L=k+(F^M^C)+V[2]+3299628645&4294967295,k=F+(L<<23&4294967295|L>>>9),L=C+(F^(k|~M))+V[0]+4096336452&4294967295,C=k+(L<<6&4294967295|L>>>26),L=M+(k^(C|~F))+V[7]+1126891415&4294967295,M=C+(L<<10&4294967295|L>>>22),L=F+(C^(M|~k))+V[14]+2878612391&4294967295,F=M+(L<<15&4294967295|L>>>17),L=k+(M^(F|~C))+V[5]+4237533241&4294967295,k=F+(L<<21&4294967295|L>>>11),L=C+(F^(k|~M))+V[12]+1700485571&4294967295,C=k+(L<<6&4294967295|L>>>26),L=M+(k^(C|~F))+V[3]+2399980690&4294967295,M=C+(L<<10&4294967295|L>>>22),L=F+(C^(M|~k))+V[10]+4293915773&4294967295,F=M+(L<<15&4294967295|L>>>17),L=k+(M^(F|~C))+V[1]+2240044497&4294967295,k=F+(L<<21&4294967295|L>>>11),L=C+(F^(k|~M))+V[8]+1873313359&4294967295,C=k+(L<<6&4294967295|L>>>26),L=M+(k^(C|~F))+V[15]+4264355552&4294967295,M=C+(L<<10&4294967295|L>>>22),L=F+(C^(M|~k))+V[6]+2734768916&4294967295,F=M+(L<<15&4294967295|L>>>17),L=k+(M^(F|~C))+V[13]+1309151649&4294967295,k=F+(L<<21&4294967295|L>>>11),L=C+(F^(k|~M))+V[4]+4149444226&4294967295,C=k+(L<<6&4294967295|L>>>26),L=M+(k^(C|~F))+V[11]+3174756917&4294967295,M=C+(L<<10&4294967295|L>>>22),L=F+(C^(M|~k))+V[2]+718787259&4294967295,F=M+(L<<15&4294967295|L>>>17),L=k+(M^(F|~C))+V[9]+3951481745&4294967295,A.g[0]=A.g[0]+C&4294967295,A.g[1]=A.g[1]+(F+(L<<21&4294967295|L>>>11))&4294967295,A.g[2]=A.g[2]+F&4294967295,A.g[3]=A.g[3]+M&4294967295}n.prototype.v=function(A,C){C===void 0&&(C=A.length);const k=C-this.blockSize,V=this.C;let F=this.h,M=0;for(;M<C;){if(F==0)for(;M<=k;)a(this,A,M),M+=this.blockSize;if(typeof A=="string"){for(;M<C;)if(V[F++]=A.charCodeAt(M++),F==this.blockSize){a(this,V),F=0;break}}else for(;M<C;)if(V[F++]=A[M++],F==this.blockSize){a(this,V),F=0;break}}this.h=F,this.o+=C},n.prototype.A=function(){var A=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);A[0]=128;for(var C=1;C<A.length-8;++C)A[C]=0;C=this.o*8;for(var k=A.length-8;k<A.length;++k)A[k]=C&255,C/=256;for(this.v(A),A=Array(16),C=0,k=0;k<4;++k)for(let V=0;V<32;V+=8)A[C++]=this.g[k]>>>V&255;return A};function s(A,C){var k=u;return Object.prototype.hasOwnProperty.call(k,A)?k[A]:k[A]=C(A)}function l(A,C){this.h=C;const k=[];let V=!0;for(let F=A.length-1;F>=0;F--){const M=A[F]|0;V&&M==C||(k[F]=M,V=!1)}this.g=k}var u={};function f(A){return-128<=A&&A<128?s(A,function(C){return new l([C|0],C<0?-1:0)}):new l([A|0],A<0?-1:0)}function d(A){if(isNaN(A)||!isFinite(A))return x;if(A<0)return S(d(-A));const C=[];let k=1;for(let V=0;A>=k;V++)C[V]=A/k|0,k*=4294967296;return new l(C,0)}function m(A,C){if(A.length==0)throw Error("number format error: empty string");if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(A.charAt(0)=="-")return S(m(A.substring(1),C));if(A.indexOf("-")>=0)throw Error('number format error: interior "-" character');const k=d(Math.pow(C,8));let V=x;for(let M=0;M<A.length;M+=8){var F=Math.min(8,A.length-M);const L=parseInt(A.substring(M,M+F),C);F<8?(F=d(Math.pow(C,F)),V=V.j(F).add(d(L))):(V=V.j(k),V=V.add(d(L)))}return V}var x=f(0),_=f(1),y=f(16777216);r=l.prototype,r.m=function(){if(T(this))return-S(this).m();let A=0,C=1;for(let k=0;k<this.g.length;k++){const V=this.i(k);A+=(V>=0?V:4294967296+V)*C,C*=4294967296}return A},r.toString=function(A){if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(w(this))return"0";if(T(this))return"-"+S(this).toString(A);const C=d(Math.pow(A,6));var k=this;let V="";for(;;){const F=Y(k,C).g;k=O(k,F.j(C));let M=((k.g.length>0?k.g[0]:k.h)>>>0).toString(A);if(k=F,w(k))return M+V;for(;M.length<6;)M="0"+M;V=M+V}},r.i=function(A){return A<0?0:A<this.g.length?this.g[A]:this.h};function w(A){if(A.h!=0)return!1;for(let C=0;C<A.g.length;C++)if(A.g[C]!=0)return!1;return!0}function T(A){return A.h==-1}r.l=function(A){return A=O(this,A),T(A)?-1:w(A)?0:1};function S(A){const C=A.g.length,k=[];for(let V=0;V<C;V++)k[V]=~A.g[V];return new l(k,~A.h).add(_)}r.abs=function(){return T(this)?S(this):this},r.add=function(A){const C=Math.max(this.g.length,A.g.length),k=[];let V=0;for(let F=0;F<=C;F++){let M=V+(this.i(F)&65535)+(A.i(F)&65535),L=(M>>>16)+(this.i(F)>>>16)+(A.i(F)>>>16);V=L>>>16,M&=65535,L&=65535,k[F]=L<<16|M}return new l(k,k[k.length-1]&-2147483648?-1:0)};function O(A,C){return A.add(S(C))}r.j=function(A){if(w(this)||w(A))return x;if(T(this))return T(A)?S(this).j(S(A)):S(S(this).j(A));if(T(A))return S(this.j(S(A)));if(this.l(y)<0&&A.l(y)<0)return d(this.m()*A.m());const C=this.g.length+A.g.length,k=[];for(var V=0;V<2*C;V++)k[V]=0;for(V=0;V<this.g.length;V++)for(let F=0;F<A.g.length;F++){const M=this.i(V)>>>16,L=this.i(V)&65535,Ie=A.i(F)>>>16,Re=A.i(F)&65535;k[2*V+2*F]+=L*Re,U(k,2*V+2*F),k[2*V+2*F+1]+=M*Re,U(k,2*V+2*F+1),k[2*V+2*F+1]+=L*Ie,U(k,2*V+2*F+1),k[2*V+2*F+2]+=M*Ie,U(k,2*V+2*F+2)}for(A=0;A<C;A++)k[A]=k[2*A+1]<<16|k[2*A];for(A=C;A<2*C;A++)k[A]=0;return new l(k,0)};function U(A,C){for(;(A[C]&65535)!=A[C];)A[C+1]+=A[C]>>>16,A[C]&=65535,C++}function R(A,C){this.g=A,this.h=C}function Y(A,C){if(w(C))throw Error("division by zero");if(w(A))return new R(x,x);if(T(A))return C=Y(S(A),C),new R(S(C.g),S(C.h));if(T(C))return C=Y(A,S(C)),new R(S(C.g),C.h);if(A.g.length>30){if(T(A)||T(C))throw Error("slowDivide_ only works with positive integers.");for(var k=_,V=C;V.l(A)<=0;)k=te(k),V=te(V);var F=G(k,1),M=G(V,1);for(V=G(V,2),k=G(k,2);!w(V);){var L=M.add(V);L.l(A)<=0&&(F=F.add(k),M=L),V=G(V,1),k=G(k,1)}return C=O(A,F.j(C)),new R(F,C)}for(F=x;A.l(C)>=0;){for(k=Math.max(1,Math.floor(A.m()/C.m())),V=Math.ceil(Math.log(k)/Math.LN2),V=V<=48?1:Math.pow(2,V-48),M=d(k),L=M.j(C);T(L)||L.l(A)>0;)k-=V,M=d(k),L=M.j(C);w(M)&&(M=_),F=F.add(M),A=O(A,L)}return new R(F,A)}r.B=function(A){return Y(this,A).h},r.and=function(A){const C=Math.max(this.g.length,A.g.length),k=[];for(let V=0;V<C;V++)k[V]=this.i(V)&A.i(V);return new l(k,this.h&A.h)},r.or=function(A){const C=Math.max(this.g.length,A.g.length),k=[];for(let V=0;V<C;V++)k[V]=this.i(V)|A.i(V);return new l(k,this.h|A.h)},r.xor=function(A){const C=Math.max(this.g.length,A.g.length),k=[];for(let V=0;V<C;V++)k[V]=this.i(V)^A.i(V);return new l(k,this.h^A.h)};function te(A){const C=A.g.length+1,k=[];for(let V=0;V<C;V++)k[V]=A.i(V)<<1|A.i(V-1)>>>31;return new l(k,A.h)}function G(A,C){const k=C>>5;C%=32;const V=A.g.length-k,F=[];for(let M=0;M<V;M++)F[M]=C>0?A.i(M+k)>>>C|A.i(M+k+1)<<32-C:A.i(M+k);return new l(F,A.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,M4=n,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.B,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=d,l.fromString=m,Mo=l}).apply(typeof Bw<"u"?Bw:typeof self<"u"?self:typeof window<"u"?window:{});var Jd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var P4,hh,L4,Em,zx,V4,B4,U4;(function(){var r,e=Object.defineProperty;function t(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof Jd=="object"&&Jd];for(var E=0;E<p.length;++E){var I=p[E];if(I&&I.Math==Math)return I}throw Error("Cannot find global object")}var n=t(this);function a(p,E){if(E)e:{var I=n;p=p.split(".");for(var j=0;j<p.length-1;j++){var ue=p[j];if(!(ue in I))break e;I=I[ue]}p=p[p.length-1],j=I[p],E=E(j),E!=j&&E!=null&&e(I,p,{configurable:!0,writable:!0,value:E})}}a("Symbol.dispose",function(p){return p||Symbol("Symbol.dispose")}),a("Array.prototype.values",function(p){return p||function(){return this[Symbol.iterator]()}}),a("Object.entries",function(p){return p||function(E){var I=[],j;for(j in E)Object.prototype.hasOwnProperty.call(E,j)&&I.push([j,E[j]]);return I}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},l=this||self;function u(p){var E=typeof p;return E=="object"&&p!=null||E=="function"}function f(p,E,I){return p.call.apply(p.bind,arguments)}function d(p,E,I){return d=f,d.apply(null,arguments)}function m(p,E){var I=Array.prototype.slice.call(arguments,1);return function(){var j=I.slice();return j.push.apply(j,arguments),p.apply(this,j)}}function x(p,E){function I(){}I.prototype=E.prototype,p.Z=E.prototype,p.prototype=new I,p.prototype.constructor=p,p.Ob=function(j,ue,ve){for(var ze=Array(arguments.length-2),mt=2;mt<arguments.length;mt++)ze[mt-2]=arguments[mt];return E.prototype[ue].apply(j,ze)}}var _=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?p=>p&&AsyncContext.Snapshot.wrap(p):p=>p;function y(p){const E=p.length;if(E>0){const I=Array(E);for(let j=0;j<E;j++)I[j]=p[j];return I}return[]}function w(p,E){for(let j=1;j<arguments.length;j++){const ue=arguments[j];var I=typeof ue;if(I=I!="object"?I:ue?Array.isArray(ue)?"array":I:"null",I=="array"||I=="object"&&typeof ue.length=="number"){I=p.length||0;const ve=ue.length||0;p.length=I+ve;for(let ze=0;ze<ve;ze++)p[I+ze]=ue[ze]}else p.push(ue)}}class T{constructor(E,I){this.i=E,this.j=I,this.h=0,this.g=null}get(){let E;return this.h>0?(this.h--,E=this.g,this.g=E.next,E.next=null):E=this.i(),E}}function S(p){l.setTimeout(()=>{throw p},0)}function O(){var p=A;let E=null;return p.g&&(E=p.g,p.g=p.g.next,p.g||(p.h=null),E.next=null),E}class U{constructor(){this.h=this.g=null}add(E,I){const j=R.get();j.set(E,I),this.h?this.h.next=j:this.g=j,this.h=j}}var R=new T(()=>new Y,p=>p.reset());class Y{constructor(){this.next=this.g=this.h=null}set(E,I){this.h=E,this.g=I,this.next=null}reset(){this.next=this.g=this.h=null}}let te,G=!1,A=new U,C=()=>{const p=Promise.resolve(void 0);te=()=>{p.then(k)}};function k(){for(var p;p=O();){try{p.h.call(p.g)}catch(I){S(I)}var E=R;E.j(p),E.h<100&&(E.h++,p.next=E.g,E.g=p)}G=!1}function V(){this.u=this.u,this.C=this.C}V.prototype.u=!1,V.prototype.dispose=function(){this.u||(this.u=!0,this.N())},V.prototype[Symbol.dispose]=function(){this.dispose()},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function F(p,E){this.type=p,this.g=this.target=E,this.defaultPrevented=!1}F.prototype.h=function(){this.defaultPrevented=!0};var M=(function(){if(!l.addEventListener||!Object.defineProperty)return!1;var p=!1,E=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const I=()=>{};l.addEventListener("test",I,E),l.removeEventListener("test",I,E)}catch{}return p})();function L(p){return/^[\s\xa0]*$/.test(p)}function Ie(p,E){F.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p&&this.init(p,E)}x(Ie,F),Ie.prototype.init=function(p,E){const I=this.type=p.type,j=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;this.target=p.target||p.srcElement,this.g=E,E=p.relatedTarget,E||(I=="mouseover"?E=p.fromElement:I=="mouseout"&&(E=p.toElement)),this.relatedTarget=E,j?(this.clientX=j.clientX!==void 0?j.clientX:j.pageX,this.clientY=j.clientY!==void 0?j.clientY:j.pageY,this.screenX=j.screenX||0,this.screenY=j.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=p.pointerType,this.state=p.state,this.i=p,p.defaultPrevented&&Ie.Z.h.call(this)},Ie.prototype.h=function(){Ie.Z.h.call(this);const p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var Re="closure_listenable_"+(Math.random()*1e6|0),ae=0;function le(p,E,I,j,ue){this.listener=p,this.proxy=null,this.src=E,this.type=I,this.capture=!!j,this.ha=ue,this.key=++ae,this.da=this.fa=!1}function Fe(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function ie(p,E,I){for(const j in p)E.call(I,p[j],j,p)}function Ne(p,E){for(const I in p)E.call(void 0,p[I],I,p)}function Q(p){const E={};for(const I in p)E[I]=p[I];return E}const N="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function J(p,E){let I,j;for(let ue=1;ue<arguments.length;ue++){j=arguments[ue];for(I in j)p[I]=j[I];for(let ve=0;ve<N.length;ve++)I=N[ve],Object.prototype.hasOwnProperty.call(j,I)&&(p[I]=j[I])}}function X(p){this.src=p,this.g={},this.h=0}X.prototype.add=function(p,E,I,j,ue){const ve=p.toString();p=this.g[ve],p||(p=this.g[ve]=[],this.h++);const ze=ce(p,E,j,ue);return ze>-1?(E=p[ze],I||(E.fa=!1)):(E=new le(E,this.src,ve,!!j,ue),E.fa=I,p.push(E)),E};function ee(p,E){const I=E.type;if(I in p.g){var j=p.g[I],ue=Array.prototype.indexOf.call(j,E,void 0),ve;(ve=ue>=0)&&Array.prototype.splice.call(j,ue,1),ve&&(Fe(E),p.g[I].length==0&&(delete p.g[I],p.h--))}}function ce(p,E,I,j){for(let ue=0;ue<p.length;++ue){const ve=p[ue];if(!ve.da&&ve.listener==E&&ve.capture==!!I&&ve.ha==j)return ue}return-1}var we="closure_lm_"+(Math.random()*1e6|0),De={};function Ae(p,E,I,j,ue){if(Array.isArray(E)){for(let ve=0;ve<E.length;ve++)Ae(p,E[ve],I,j,ue);return null}return I=sr(I),p&&p[Re]?p.J(E,I,u(j)?!!j.capture:!1,ue):Oe(p,E,I,!1,j,ue)}function Oe(p,E,I,j,ue,ve){if(!E)throw Error("Invalid event type");const ze=u(ue)?!!ue.capture:!!ue;let mt=ct(p);if(mt||(p[we]=mt=new X(p)),I=mt.add(E,I,j,ze,ve),I.proxy)return I;if(j=st(),I.proxy=j,j.src=p,j.listener=I,p.addEventListener)M||(ue=ze),ue===void 0&&(ue=!1),p.addEventListener(E.toString(),j,ue);else if(p.attachEvent)p.attachEvent(lt(E.toString()),j);else if(p.addListener&&p.removeListener)p.addListener(j);else throw Error("addEventListener and attachEvent are unavailable.");return I}function st(){function p(I){return E.call(p.src,p.listener,I)}const E=Rt;return p}function Z(p,E,I,j,ue){if(Array.isArray(E))for(var ve=0;ve<E.length;ve++)Z(p,E[ve],I,j,ue);else j=u(j)?!!j.capture:!!j,I=sr(I),p&&p[Re]?(p=p.i,ve=String(E).toString(),ve in p.g&&(E=p.g[ve],I=ce(E,I,j,ue),I>-1&&(Fe(E[I]),Array.prototype.splice.call(E,I,1),E.length==0&&(delete p.g[ve],p.h--)))):p&&(p=ct(p))&&(E=p.g[E.toString()],p=-1,E&&(p=ce(E,I,j,ue)),(I=p>-1?E[p]:null)&&Ft(I))}function Ft(p){if(typeof p!="number"&&p&&!p.da){var E=p.src;if(E&&E[Re])ee(E.i,p);else{var I=p.type,j=p.proxy;E.removeEventListener?E.removeEventListener(I,j,p.capture):E.detachEvent?E.detachEvent(lt(I),j):E.addListener&&E.removeListener&&E.removeListener(j),(I=ct(E))?(ee(I,p),I.h==0&&(I.src=null,E[we]=null)):Fe(p)}}}function lt(p){return p in De?De[p]:De[p]="on"+p}function Rt(p,E){if(p.da)p=!0;else{E=new Ie(E,this);const I=p.listener,j=p.ha||p.src;p.fa&&Ft(p),p=I.call(j,E)}return p}function ct(p){return p=p[we],p instanceof X?p:null}var He="__closure_events_fn_"+(Math.random()*1e9>>>0);function sr(p){return typeof p=="function"?p:(p[He]||(p[He]=function(E){return p.handleEvent(E)}),p[He])}function Dt(){V.call(this),this.i=new X(this),this.M=this,this.G=null}x(Dt,V),Dt.prototype[Re]=!0,Dt.prototype.removeEventListener=function(p,E,I,j){Z(this,p,E,I,j)};function zt(p,E){var I,j=p.G;if(j)for(I=[];j;j=j.G)I.push(j);if(p=p.M,j=E.type||E,typeof E=="string")E=new F(E,p);else if(E instanceof F)E.target=E.target||p;else{var ue=E;E=new F(j,p),J(E,ue)}ue=!0;let ve,ze;if(I)for(ze=I.length-1;ze>=0;ze--)ve=E.g=I[ze],ue=rn(ve,j,!0,E)&&ue;if(ve=E.g=p,ue=rn(ve,j,!0,E)&&ue,ue=rn(ve,j,!1,E)&&ue,I)for(ze=0;ze<I.length;ze++)ve=E.g=I[ze],ue=rn(ve,j,!1,E)&&ue}Dt.prototype.N=function(){if(Dt.Z.N.call(this),this.i){var p=this.i;for(const E in p.g){const I=p.g[E];for(let j=0;j<I.length;j++)Fe(I[j]);delete p.g[E],p.h--}}this.G=null},Dt.prototype.J=function(p,E,I,j){return this.i.add(String(p),E,!1,I,j)},Dt.prototype.K=function(p,E,I,j){return this.i.add(String(p),E,!0,I,j)};function rn(p,E,I,j){if(E=p.i.g[String(E)],!E)return!0;E=E.concat();let ue=!0;for(let ve=0;ve<E.length;++ve){const ze=E[ve];if(ze&&!ze.da&&ze.capture==I){const mt=ze.listener,Or=ze.ha||ze.src;ze.fa&&ee(p.i,ze),ue=mt.call(Or,j)!==!1&&ue}}return ue&&!j.defaultPrevented}function Qi(p,E){if(typeof p!="function")if(p&&typeof p.handleEvent=="function")p=d(p.handleEvent,p);else throw Error("Invalid listener argument");return Number(E)>2147483647?-1:l.setTimeout(p,E||0)}function sa(p){p.g=Qi(()=>{p.g=null,p.i&&(p.i=!1,sa(p))},p.l);const E=p.h;p.h=null,p.m.apply(null,E)}class jt extends V{constructor(E,I){super(),this.m=E,this.l=I,this.h=null,this.i=!1,this.g=null}j(E){this.h=arguments,this.g?this.i=!0:sa(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function un(p){V.call(this),this.h=p,this.g={}}x(un,V);var Xn=[];function ri(p){ie(p.g,function(E,I){this.g.hasOwnProperty(I)&&Ft(E)},p),p.g={}}un.prototype.N=function(){un.Z.N.call(this),ri(this)},un.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var gr=l.JSON.stringify,Wn=l.JSON.parse,dt=class{stringify(p){return l.JSON.stringify(p,void 0)}parse(p){return l.JSON.parse(p,void 0)}};function cr(){}function fn(){}var Vt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function ur(){F.call(this,"d")}x(ur,F);function Ln(){F.call(this,"c")}x(Ln,F);var Tr={},_c=null;function Ji(){return _c=_c||new Dt}Tr.Ia="serverreachability";function Qo(p){F.call(this,Tr.Ia,p)}x(Qo,F);function oa(p){const E=Ji();zt(E,new Qo(E))}Tr.STAT_EVENT="statevent";function Zi(p,E){F.call(this,Tr.STAT_EVENT,p),this.stat=E}x(Zi,F);function br(p){const E=Ji();zt(E,new Zi(E,p))}Tr.Ja="timingevent";function Vn(p,E){F.call(this,Tr.Ja,p),this.size=E}x(Vn,F);function Ca(p,E){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){p()},E)}function la(){this.g=!0}la.prototype.ua=function(){this.g=!1};function cf(p,E,I,j,ue,ve){p.info(function(){if(p.g)if(ve){var ze="",mt=ve.split("&");for(let Bt=0;Bt<mt.length;Bt++){var Or=mt[Bt].split("=");if(Or.length>1){const xr=Or[0];Or=Or[1];const Oa=xr.split("_");ze=Oa.length>=2&&Oa[1]=="type"?ze+(xr+"="+Or+"&"):ze+(xr+"=redacted&")}}}else ze=null;else ze=ve;return"XMLHTTP REQ ("+j+") [attempt "+ue+"]: "+E+`
`+I+`
`+ze})}function yc(p,E,I,j,ue,ve,ze){p.info(function(){return"XMLHTTP RESP ("+j+") [ attempt "+ue+"]: "+E+`
`+I+`
`+ve+" "+ze})}function Ra(p,E,I,j){p.info(function(){return"XMLHTTP TEXT ("+E+"): "+uf(p,I)+(j?" "+j:"")})}function es(p,E){p.info(function(){return"TIMEOUT: "+E})}la.prototype.info=function(){};function uf(p,E){if(!p.g)return E;if(!E)return null;try{const ve=JSON.parse(E);if(ve){for(p=0;p<ve.length;p++)if(Array.isArray(ve[p])){var I=ve[p];if(!(I.length<2)){var j=I[1];if(Array.isArray(j)&&!(j.length<1)){var ue=j[0];if(ue!="noop"&&ue!="stop"&&ue!="close")for(let ze=1;ze<j.length;ze++)j[ze]=""}}}}return gr(ve)}catch{return E}}var ts={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},rs={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Jo;function ns(){}x(ns,cr),ns.prototype.g=function(){return new XMLHttpRequest},Jo=new ns;function ni(p){return encodeURIComponent(String(p))}function D(p){var E=1;p=p.split(":");const I=[];for(;E>0&&p.length;)I.push(p.shift()),E--;return p.length&&I.push(p.join(":")),I}function K(p,E,I,j){this.j=p,this.i=E,this.l=I,this.S=j||1,this.V=new un(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new z}function z(){this.i=null,this.g="",this.h=!1}var H={},q={};function W(p,E,I){p.M=1,p.A=Zo(Br(E)),p.u=I,p.R=!0,he(p,null)}function he(p,E){p.F=Date.now(),pe(p),p.B=Br(p.A);var I=p.B,j=p.S;Array.isArray(j)||(j=[String(j)]),Ec(I.i,"t",j),p.C=0,I=p.j.L,p.h=new z,p.g=G0(p.j,I?E:null,!p.u),p.P>0&&(p.O=new jt(d(p.Y,p,p.g),p.P)),E=p.V,I=p.g,j=p.ba;var ue="readystatechange";Array.isArray(ue)||(ue&&(Xn[0]=ue.toString()),ue=Xn);for(let ve=0;ve<ue.length;ve++){const ze=Ae(I,ue[ve],j||E.handleEvent,!1,E.h||E);if(!ze)break;E.g[ze.key]=ze}E=p.J?Q(p.J):{},p.u?(p.v||(p.v="POST"),E["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.B,p.v,p.u,E)):(p.v="GET",p.g.ea(p.B,p.v,null,E)),oa(),cf(p.i,p.v,p.B,p.l,p.S,p.u)}K.prototype.ba=function(p){p=p.target;const E=this.O;E&&li(p)==3?E.j():this.Y(p)},K.prototype.Y=function(p){try{if(p==this.g)e:{const mt=li(this.g),Or=this.g.ya(),Bt=this.g.ca();if(!(mt<3)&&(mt!=3||this.g&&(this.h.h||this.g.la()||hn(this.g)))){this.K||mt!=4||Or==7||(Or==8||Bt<=0?oa(3):oa(2)),Ve(this);var E=this.g.ca();this.X=E;var I=Te(this);if(this.o=E==200,yc(this.i,this.v,this.B,this.l,this.S,mt,E),this.o){if(this.U&&!this.L){t:{if(this.g){var j,ue=this.g;if((j=ue.g?ue.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!L(j)){var ve=j;break t}}ve=null}if(p=ve)Ra(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,je(this,p);else{this.o=!1,this.m=3,br(12),Me(this),Ge(this);break e}}if(this.R){p=!0;let xr;for(;!this.K&&this.C<I.length;)if(xr=ge(this,I),xr==q){mt==4&&(this.m=4,br(14),p=!1),Ra(this.i,this.l,null,"[Incomplete Response]");break}else if(xr==H){this.m=4,br(15),Ra(this.i,this.l,I,"[Invalid Chunk]"),p=!1;break}else Ra(this.i,this.l,xr,null),je(this,xr);if(de(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),mt!=4||I.length!=0||this.h.h||(this.m=1,br(16),p=!1),this.o=this.o&&p,!p)Ra(this.i,this.l,I,"[Invalid Chunked Response]"),Me(this),Ge(this);else if(I.length>0&&!this.W){this.W=!0;var ze=this.j;ze.g==this&&ze.aa&&!ze.P&&(ze.j.info("Great, no buffering proxy detected. Bytes received: "+I.length),yf(ze),ze.P=!0,br(11))}}else Ra(this.i,this.l,I,null),je(this,I);mt==4&&Me(this),this.o&&!this.K&&(mt==4?U0(this.j,this):(this.o=!1,pe(this)))}else is(this.g),E==400&&I.indexOf("Unknown SID")>0?(this.m=3,br(12)):(this.m=0,br(13)),Me(this),Ge(this)}}}catch{}finally{}};function Te(p){if(!de(p))return p.g.la();const E=hn(p.g);if(E==="")return"";let I="";const j=E.length,ue=li(p.g)==4;if(!p.h.i){if(typeof TextDecoder>"u")return Me(p),Ge(p),"";p.h.i=new l.TextDecoder}for(let ve=0;ve<j;ve++)p.h.h=!0,I+=p.h.i.decode(E[ve],{stream:!(ue&&ve==j-1)});return E.length=0,p.h.g+=I,p.C=0,p.h.g}function de(p){return p.g?p.v=="GET"&&p.M!=2&&p.j.Aa:!1}function ge(p,E){var I=p.C,j=E.indexOf(`
`,I);return j==-1?q:(I=Number(E.substring(I,j)),isNaN(I)?H:(j+=1,j+I>E.length?q:(E=E.slice(j,j+I),p.C=j+I,E)))}K.prototype.cancel=function(){this.K=!0,Me(this)};function pe(p){p.T=Date.now()+p.H,Pe(p,p.H)}function Pe(p,E){if(p.D!=null)throw Error("WatchDog timer not null");p.D=Ca(d(p.aa,p),E)}function Ve(p){p.D&&(l.clearTimeout(p.D),p.D=null)}K.prototype.aa=function(){this.D=null;const p=Date.now();p-this.T>=0?(es(this.i,this.B),this.M!=2&&(oa(),br(17)),Me(this),this.m=2,Ge(this)):Pe(this,this.T-p)};function Ge(p){p.j.I==0||p.K||U0(p.j,p)}function Me(p){Ve(p);var E=p.O;E&&typeof E.dispose=="function"&&E.dispose(),p.O=null,ri(p.V),p.g&&(E=p.g,p.g=null,E.abort(),E.dispose())}function je(p,E){try{var I=p.j;if(I.I!=0&&(I.g==p||En(I.h,p))){if(!p.L&&En(I.h,p)&&I.I==3){try{var j=I.Ba.g.parse(E)}catch{j=null}if(Array.isArray(j)&&j.length==3){var ue=j;if(ue[0]==0){e:if(!I.v){if(I.g)if(I.g.F+3e3<p.F)Ic(I),Ys(I);else break e;sl(I),br(18)}}else I.xa=ue[1],0<I.xa-I.K&&ue[2]<37500&&I.F&&I.A==0&&!I.C&&(I.C=Ca(d(I.Va,I),6e3));or(I.h)<=1&&I.ta&&(I.ta=void 0)}else Ri(I,11)}else if((p.L||I.g==p)&&Ic(I),!L(E))for(ue=I.Ba.g.parse(E),E=0;E<ue.length;E++){let Bt=ue[E];const xr=Bt[0];if(!(xr<=I.K))if(I.K=xr,Bt=Bt[1],I.I==2)if(Bt[0]=="c"){I.M=Bt[1],I.ba=Bt[2];const Oa=Bt[3];Oa!=null&&(I.ka=Oa,I.j.info("VER="+I.ka));const Di=Bt[4];Di!=null&&(I.za=Di,I.j.info("SVER="+I.za));const ci=Bt[5];ci!=null&&typeof ci=="number"&&ci>0&&(j=1.5*ci,I.O=j,I.j.info("backChannelRequestTimeoutMs_="+j)),j=I;const ui=p.g;if(ui){const ol=ui.g?ui.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ol){var ve=j.h;ve.g||ol.indexOf("spdy")==-1&&ol.indexOf("quic")==-1&&ol.indexOf("h2")==-1||(ve.j=ve.l,ve.g=new Set,ve.h&&(ai(ve,ve.h),ve.h=null))}if(j.G){const kc=ui.g?ui.g.getResponseHeader("X-HTTP-Session-Id"):null;kc&&(j.wa=kc,qt(j.J,j.G,kc))}}I.I=3,I.l&&I.l.ra(),I.aa&&(I.T=Date.now()-p.F,I.j.info("Handshake RTT: "+I.T+"ms")),j=I;var ze=p;if(j.na=H0(j,j.L?j.ba:null,j.W),ze.L){ii(j.h,ze);var mt=ze,Or=j.O;Or&&(mt.H=Or),mt.D&&(Ve(mt),pe(mt)),j.g=ze}else V0(j);I.i.length>0&&Ci(I)}else Bt[0]!="stop"&&Bt[0]!="close"||Ri(I,7);else I.I==3&&(Bt[0]=="stop"||Bt[0]=="close"?Bt[0]=="stop"?Ri(I,7):vf(I):Bt[0]!="noop"&&I.l&&I.l.qa(Bt),I.A=0)}}oa(4)}catch{}}var We=class{constructor(p,E){this.g=p,this.map=E}};function Ht(p){this.l=p||10,l.PerformanceNavigationTiming?(p=l.performance.getEntriesByType("navigation"),p=p.length>0&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Gt(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function or(p){return p.h?1:p.g?p.g.size:0}function En(p,E){return p.h?p.h==E:p.g?p.g.has(E):!1}function ai(p,E){p.g?p.g.add(E):p.h=E}function ii(p,E){p.h&&p.h==E?p.h=null:p.g&&p.g.has(E)&&p.g.delete(E)}Ht.prototype.cancel=function(){if(this.i=ca(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function ca(p){if(p.h!=null)return p.i.concat(p.h.G);if(p.g!=null&&p.g.size!==0){let E=p.i;for(const I of p.g.values())E=E.concat(I.G);return E}return y(p.i)}var zs=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function wn(p,E){if(p){p=p.split("&");for(let I=0;I<p.length;I++){const j=p[I].indexOf("=");let ue,ve=null;j>=0?(ue=p[I].substring(0,j),ve=p[I].substring(j+1)):ue=p[I],E(ue,ve?decodeURIComponent(ve.replace(/\+/g," ")):"")}}}function ua(p){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let E;p instanceof ua?(this.l=p.l,nn(this,p.j),this.o=p.o,this.g=p.g,js(this,p.u),this.h=p.h,ff(this,P0(p.i)),this.m=p.m):p&&(E=String(p).match(zs))?(this.l=!1,nn(this,E[1]||"",!0),this.o=Ai(E[2]||""),this.g=Ai(E[3]||"",!0),js(this,E[4]),this.h=Ai(E[5]||"",!0),ff(this,E[6]||"",!0),this.m=Ai(E[7]||"")):(this.l=!1,this.i=new Gs(null,this.l))}ua.prototype.toString=function(){const p=[];var E=this.j;E&&p.push(el(E,Tc,!0),":");var I=this.g;return(I||E=="file")&&(p.push("//"),(E=this.o)&&p.push(el(E,Tc,!0),"@"),p.push(ni(I).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),I=this.u,I!=null&&p.push(":",String(I))),(I=this.h)&&(this.g&&I.charAt(0)!="/"&&p.push("/"),p.push(el(I,I.charAt(0)=="/"?hf:O0,!0))),(I=this.i.toString())&&p.push("?",I),(I=this.m)&&p.push("#",el(I,F0)),p.join("")},ua.prototype.resolve=function(p){const E=Br(this);let I=!!p.j;I?nn(E,p.j):I=!!p.o,I?E.o=p.o:I=!!p.g,I?E.g=p.g:I=p.u!=null;var j=p.h;if(I)js(E,p.u);else if(I=!!p.h){if(j.charAt(0)!="/")if(this.g&&!this.h)j="/"+j;else{var ue=E.h.lastIndexOf("/");ue!=-1&&(j=E.h.slice(0,ue+1)+j)}if(ue=j,ue==".."||ue==".")j="";else if(ue.indexOf("./")!=-1||ue.indexOf("/.")!=-1){j=ue.lastIndexOf("/",0)==0,ue=ue.split("/");const ve=[];for(let ze=0;ze<ue.length;){const mt=ue[ze++];mt=="."?j&&ze==ue.length&&ve.push(""):mt==".."?((ve.length>1||ve.length==1&&ve[0]!="")&&ve.pop(),j&&ze==ue.length&&ve.push("")):(ve.push(mt),j=!0)}j=ve.join("/")}else j=ue}return I?E.h=j:I=p.i.toString()!=="",I?ff(E,P0(p.i)):I=!!p.m,I&&(E.m=p.m),E};function Br(p){return new ua(p)}function nn(p,E,I){p.j=I?Ai(E,!0):E,p.j&&(p.j=p.j.replace(/:$/,""))}function js(p,E){if(E){if(E=Number(E),isNaN(E)||E<0)throw Error("Bad port number "+E);p.u=E}else p.u=null}function ff(p,E,I){E instanceof Gs?(p.i=E,wc(p.i,p.l)):(I||(E=el(E,Hs)),p.i=new Gs(E,p.l))}function qt(p,E,I){p.i.set(E,I)}function Zo(p){return qt(p,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),p}function Ai(p,E){return p?E?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function el(p,E,I){return typeof p=="string"?(p=encodeURI(p).replace(E,Yn),I&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function Yn(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var Tc=/[#\/\?@]/g,O0=/[#\?:]/g,hf=/[#\?]/g,Hs=/[#\?@]/g,F0=/#/g;function Gs(p,E){this.h=this.g=null,this.i=p||null,this.j=!!E}function $n(p){p.g||(p.g=new Map,p.h=0,p.i&&wn(p.i,function(E,I){p.add(decodeURIComponent(E.replace(/\+/g," ")),I)}))}r=Gs.prototype,r.add=function(p,E){$n(this),this.i=null,p=qs(this,p);let I=this.g.get(p);return I||this.g.set(p,I=[]),I.push(E),this.h+=1,this};function M0(p,E){$n(p),E=qs(p,E),p.g.has(E)&&(p.i=null,p.h-=p.g.get(E).length,p.g.delete(E))}function df(p,E){return $n(p),E=qs(p,E),p.g.has(E)}r.forEach=function(p,E){$n(this),this.g.forEach(function(I,j){I.forEach(function(ue){p.call(E,ue,j,this)},this)},this)};function mf(p,E){$n(p);let I=[];if(typeof E=="string")df(p,E)&&(I=I.concat(p.g.get(qs(p,E))));else for(p=Array.from(p.g.values()),E=0;E<p.length;E++)I=I.concat(p[E]);return I}r.set=function(p,E){return $n(this),this.i=null,p=qs(this,p),df(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[E]),this.h+=1,this},r.get=function(p,E){return p?(p=mf(this,p),p.length>0?String(p[0]):E):E};function Ec(p,E,I){M0(p,E),I.length>0&&(p.i=null,p.g.set(qs(p,E),y(I)),p.h+=I.length)}r.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],E=Array.from(this.g.keys());for(let j=0;j<E.length;j++){var I=E[j];const ue=ni(I);I=mf(this,I);for(let ve=0;ve<I.length;ve++){let ze=ue;I[ve]!==""&&(ze+="="+ni(I[ve])),p.push(ze)}}return this.i=p.join("&")};function P0(p){const E=new Gs;return E.i=p.i,p.g&&(E.g=new Map(p.g),E.h=p.h),E}function qs(p,E){return E=String(E),p.j&&(E=E.toLowerCase()),E}function wc(p,E){E&&!p.j&&($n(p),p.i=null,p.g.forEach(function(I,j){const ue=j.toLowerCase();j!=ue&&(M0(this,j),Ec(this,ue,I))},p)),p.j=E}function si(p,E){const I=new la;if(l.Image){const j=new Image;j.onload=m(Da,I,"TestLoadImage: loaded",!0,E,j),j.onerror=m(Da,I,"TestLoadImage: error",!1,E,j),j.onabort=m(Da,I,"TestLoadImage: abort",!1,E,j),j.ontimeout=m(Da,I,"TestLoadImage: timeout",!1,E,j),l.setTimeout(function(){j.ontimeout&&j.ontimeout()},1e4),j.src=p}else E(!1)}function pf(p,E){const I=new la,j=new AbortController,ue=setTimeout(()=>{j.abort(),Da(I,"TestPingServer: timeout",!1,E)},1e4);fetch(p,{signal:j.signal}).then(ve=>{clearTimeout(ue),ve.ok?Da(I,"TestPingServer: ok",!0,E):Da(I,"TestPingServer: server error",!1,E)}).catch(()=>{clearTimeout(ue),Da(I,"TestPingServer: error",!1,E)})}function Da(p,E,I,j,ue){try{ue&&(ue.onload=null,ue.onerror=null,ue.onabort=null,ue.ontimeout=null),j(I)}catch{}}function Ks(){this.g=new dt}function bi(p){this.i=p.Sb||null,this.h=p.ab||!1}x(bi,cr),bi.prototype.g=function(){return new tl(this.i,this.h)};function tl(p,E){Dt.call(this),this.H=p,this.o=E,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}x(tl,Dt),r=tl.prototype,r.open=function(p,E){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=p,this.D=E,this.readyState=1,oi(this)},r.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const E={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};p&&(E.body=p),(this.H||l).fetch(new Request(this.D,E)).then(this.Pa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Xs(this)),this.readyState=0},r.Pa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,oi(this)),this.g&&(this.readyState=3,oi(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Sc(this)}else p.text().then(this.Oa.bind(this),this.ga.bind(this))};function Sc(p){p.j.read().then(p.Ma.bind(p)).catch(p.ga.bind(p))}r.Ma=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var E=p.value?p.value:new Uint8Array(0);(E=this.B.decode(E,{stream:!p.done}))&&(this.response=this.responseText+=E)}p.done?Xs(this):oi(this),this.readyState==3&&Sc(this)}},r.Oa=function(p){this.g&&(this.response=this.responseText=p,Xs(this))},r.Na=function(p){this.g&&(this.response=p,Xs(this))},r.ga=function(){this.g&&Xs(this)};function Xs(p){p.readyState=4,p.l=null,p.j=null,p.B=null,oi(p)}r.setRequestHeader=function(p,E){this.A.append(p,E)},r.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],E=this.h.entries();for(var I=E.next();!I.done;)I=I.value,p.push(I[0]+": "+I[1]),I=E.next();return p.join(`\r
`)};function oi(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(tl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function Na(p){let E="";return ie(p,function(I,j){E+=j,E+=":",E+=I,E+=`\r
`}),E}function rl(p,E,I){e:{for(j in I){var j=!1;break e}j=!0}j||(I=Na(I),typeof p=="string"?I!=null&&ni(I):qt(p,E,I))}function Zt(p){Dt.call(this),this.headers=new Map,this.L=p||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}x(Zt,Dt);var Ii=/^https?$/i,gf=["POST","PUT"];r=Zt.prototype,r.Fa=function(p){this.H=p},r.ea=function(p,E,I,j){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);E=E?E.toUpperCase():"GET",this.D=p,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Jo.g(),this.g.onreadystatechange=_(d(this.Ca,this));try{this.B=!0,this.g.open(E,String(p),!0),this.B=!1}catch(ve){nl(this,ve);return}if(p=I||"",I=new Map(this.headers),j)if(Object.getPrototypeOf(j)===Object.prototype)for(var ue in j)I.set(ue,j[ue]);else if(typeof j.keys=="function"&&typeof j.get=="function")for(const ve of j.keys())I.set(ve,j.get(ve));else throw Error("Unknown input type for opt_headers: "+String(j));j=Array.from(I.keys()).find(ve=>ve.toLowerCase()=="content-type"),ue=l.FormData&&p instanceof l.FormData,!(Array.prototype.indexOf.call(gf,E,void 0)>=0)||j||ue||I.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ve,ze]of I)this.g.setRequestHeader(ve,ze);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(p),this.v=!1}catch(ve){nl(this,ve)}};function nl(p,E){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=E,p.o=5,xf(p),as(p)}function xf(p){p.A||(p.A=!0,zt(p,"complete"),zt(p,"error"))}r.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=p||7,zt(this,"complete"),zt(this,"abort"),as(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),as(this,!0)),Zt.Z.N.call(this)},r.Ca=function(){this.u||(this.B||this.v||this.j?al(this):this.Xa())},r.Xa=function(){al(this)};function al(p){if(p.h&&typeof s<"u"){if(p.v&&li(p)==4)setTimeout(p.Ca.bind(p),0);else if(zt(p,"readystatechange"),li(p)==4){p.h=!1;try{const ve=p.ca();e:switch(ve){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var E=!0;break e;default:E=!1}var I;if(!(I=E)){var j;if(j=ve===0){let ze=String(p.D).match(zs)[1]||null;!ze&&l.self&&l.self.location&&(ze=l.self.location.protocol.slice(0,-1)),j=!Ii.test(ze?ze.toLowerCase():"")}I=j}if(I)zt(p,"complete"),zt(p,"success");else{p.o=6;try{var ue=li(p)>2?p.g.statusText:""}catch{ue=""}p.l=ue+" ["+p.ca()+"]",xf(p)}}finally{as(p)}}}}function as(p,E){if(p.g){p.m&&(clearTimeout(p.m),p.m=null);const I=p.g;p.g=null,E||zt(p,"ready");try{I.onreadystatechange=null}catch{}}}r.isActive=function(){return!!this.g};function li(p){return p.g?p.g.readyState:0}r.ca=function(){try{return li(this)>2?this.g.status:-1}catch{return-1}},r.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},r.La=function(p){if(this.g){var E=this.g.responseText;return p&&E.indexOf(p)==0&&(E=E.substring(p.length)),Wn(E)}};function hn(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.F){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function is(p){const E={};p=(p.g&&li(p)>=2&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let j=0;j<p.length;j++){if(L(p[j]))continue;var I=D(p[j]);const ue=I[0];if(I=I[1],typeof I!="string")continue;I=I.trim();const ve=E[ue]||[];E[ue]=ve,ve.push(I)}Ne(E,function(j){return j.join(", ")})}r.ya=function(){return this.o},r.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function ki(p,E,I){return I&&I.internalChannelParams&&I.internalChannelParams[p]||E}function Ws(p){this.za=0,this.i=[],this.j=new la,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=ki("failFast",!1,p),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=ki("baseRetryDelayMs",5e3,p),this.Za=ki("retryDelaySeedMs",1e4,p),this.Ta=ki("forwardChannelMaxRetries",2,p),this.va=ki("forwardChannelRequestTimeoutMs",2e4,p),this.ma=p&&p.xmlHttpFactory||void 0,this.Ua=p&&p.Rb||void 0,this.Aa=p&&p.useFetchStreams||!1,this.O=void 0,this.L=p&&p.supportsCrossDomainXhr||!1,this.M="",this.h=new Ht(p&&p.concurrentRequestLimit),this.Ba=new Ks,this.S=p&&p.fastHandshake||!1,this.R=p&&p.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=p&&p.Pb||!1,p&&p.ua&&this.j.ua(),p&&p.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&p&&p.detectBufferingProxy||!1,this.ia=void 0,p&&p.longPollingTimeout&&p.longPollingTimeout>0&&(this.ia=p.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}r=Ws.prototype,r.ka=8,r.I=1,r.connect=function(p,E,I,j){br(0),this.W=p,this.H=E||{},I&&j!==void 0&&(this.H.OSID=I,this.H.OAID=j),this.F=this.X,this.J=H0(this,null,this.W),Ci(this)};function vf(p){if(Ac(p),p.I==3){var E=p.V++,I=Br(p.J);if(qt(I,"SID",p.M),qt(I,"RID",E),qt(I,"TYPE","terminate"),il(p,I),E=new K(p,p.j,E),E.M=2,E.A=Zo(Br(I)),I=!1,l.navigator&&l.navigator.sendBeacon)try{I=l.navigator.sendBeacon(E.A.toString(),"")}catch{}!I&&l.Image&&(new Image().src=E.A,I=!0),I||(E.g=G0(E.j,null),E.g.ea(E.A)),E.F=Date.now(),pe(E)}j0(p)}function Ys(p){p.g&&(yf(p),p.g.cancel(),p.g=null)}function Ac(p){Ys(p),p.v&&(l.clearTimeout(p.v),p.v=null),Ic(p),p.h.cancel(),p.m&&(typeof p.m=="number"&&l.clearTimeout(p.m),p.m=null)}function Ci(p){if(!Gt(p.h)&&!p.m){p.m=!0;var E=p.Ea;te||C(),G||(te(),G=!0),A.add(E,p),p.D=0}}function bc(p,E){return or(p.h)>=p.h.j-(p.m?1:0)?!1:p.m?(p.i=E.G.concat(p.i),!0):p.I==1||p.I==2||p.D>=(p.Sa?0:p.Ta)?!1:(p.m=Ca(d(p.Ea,p,E),z0(p,p.D)),p.D++,!0)}r.Ea=function(p){if(this.m)if(this.m=null,this.I==1){if(!p){this.V=Math.floor(Math.random()*1e5),p=this.V++;const ue=new K(this,this.j,p);let ve=this.o;if(this.U&&(ve?(ve=Q(ve),J(ve,this.U)):ve=this.U),this.u!==null||this.R||(ue.J=ve,ve=null),this.S)e:{for(var E=0,I=0;I<this.i.length;I++){t:{var j=this.i[I];if("__data__"in j.map&&(j=j.map.__data__,typeof j=="string")){j=j.length;break t}j=void 0}if(j===void 0)break;if(E+=j,E>4096){E=I;break e}if(E===4096||I===this.i.length-1){E=I+1;break e}}E=1e3}else E=1e3;E=L0(this,ue,E),I=Br(this.J),qt(I,"RID",p),qt(I,"CVER",22),this.G&&qt(I,"X-HTTP-Session-Id",this.G),il(this,I),ve&&(this.R?E="headers="+ni(Na(ve))+"&"+E:this.u&&rl(I,this.u,ve)),ai(this.h,ue),this.Ra&&qt(I,"TYPE","init"),this.S?(qt(I,"$req",E),qt(I,"SID","null"),ue.U=!0,W(ue,I,null)):W(ue,I,E),this.I=2}}else this.I==3&&(p?_f(this,p):this.i.length==0||Gt(this.h)||_f(this))};function _f(p,E){var I;E?I=E.l:I=p.V++;const j=Br(p.J);qt(j,"SID",p.M),qt(j,"RID",I),qt(j,"AID",p.K),il(p,j),p.u&&p.o&&rl(j,p.u,p.o),I=new K(p,p.j,I,p.D+1),p.u===null&&(I.J=p.o),E&&(p.i=E.G.concat(p.i)),E=L0(p,I,1e3),I.H=Math.round(p.va*.5)+Math.round(p.va*.5*Math.random()),ai(p.h,I),W(I,j,E)}function il(p,E){p.H&&ie(p.H,function(I,j){qt(E,j,I)}),p.l&&ie({},function(I,j){qt(E,j,I)})}function L0(p,E,I){I=Math.min(p.i.length,I);const j=p.l?d(p.l.Ka,p.l,p):null;e:{var ue=p.i;let mt=-1;for(;;){const Or=["count="+I];mt==-1?I>0?(mt=ue[0].g,Or.push("ofs="+mt)):mt=0:Or.push("ofs="+mt);let Bt=!0;for(let xr=0;xr<I;xr++){var ve=ue[xr].g;const Oa=ue[xr].map;if(ve-=mt,ve<0)mt=Math.max(0,ue[xr].g-100),Bt=!1;else try{ve="req"+ve+"_"||"";try{var ze=Oa instanceof Map?Oa:Object.entries(Oa);for(const[Di,ci]of ze){let ui=ci;u(ci)&&(ui=gr(ci)),Or.push(ve+Di+"="+encodeURIComponent(ui))}}catch(Di){throw Or.push(ve+"type="+encodeURIComponent("_badmap")),Di}}catch{j&&j(Oa)}}if(Bt){ze=Or.join("&");break e}}ze=void 0}return p=p.i.splice(0,I),E.G=p,ze}function V0(p){if(!p.g&&!p.v){p.Y=1;var E=p.Da;te||C(),G||(te(),G=!0),A.add(E,p),p.A=0}}function sl(p){return p.g||p.v||p.A>=3?!1:(p.Y++,p.v=Ca(d(p.Da,p),z0(p,p.A)),p.A++,!0)}r.Da=function(){if(this.v=null,B0(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var p=4*this.T;this.j.info("BP detection timer enabled: "+p),this.B=Ca(d(this.Wa,this),p)}},r.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,br(10),Ys(this),B0(this))};function yf(p){p.B!=null&&(l.clearTimeout(p.B),p.B=null)}function B0(p){p.g=new K(p,p.j,"rpc",p.Y),p.u===null&&(p.g.J=p.o),p.g.P=0;var E=Br(p.na);qt(E,"RID","rpc"),qt(E,"SID",p.M),qt(E,"AID",p.K),qt(E,"CI",p.F?"0":"1"),!p.F&&p.ia&&qt(E,"TO",p.ia),qt(E,"TYPE","xmlhttp"),il(p,E),p.u&&p.o&&rl(E,p.u,p.o),p.O&&(p.g.H=p.O);var I=p.g;p=p.ba,I.M=1,I.A=Zo(Br(E)),I.u=null,I.R=!0,he(I,p)}r.Va=function(){this.C!=null&&(this.C=null,Ys(this),sl(this),br(19))};function Ic(p){p.C!=null&&(l.clearTimeout(p.C),p.C=null)}function U0(p,E){var I=null;if(p.g==E){Ic(p),yf(p),p.g=null;var j=2}else if(En(p.h,E))I=E.G,ii(p.h,E),j=1;else return;if(p.I!=0){if(E.o)if(j==1){I=E.u?E.u.length:0,E=Date.now()-E.F;var ue=p.D;j=Ji(),zt(j,new Vn(j,I)),Ci(p)}else V0(p);else if(ue=E.m,ue==3||ue==0&&E.X>0||!(j==1&&bc(p,E)||j==2&&sl(p)))switch(I&&I.length>0&&(E=p.h,E.i=E.i.concat(I)),ue){case 1:Ri(p,5);break;case 4:Ri(p,10);break;case 3:Ri(p,6);break;default:Ri(p,2)}}}function z0(p,E){let I=p.Qa+Math.floor(Math.random()*p.Za);return p.isActive()||(I*=2),I*E}function Ri(p,E){if(p.j.info("Error code "+E),E==2){var I=d(p.bb,p),j=p.Ua;const ue=!j;j=new ua(j||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||nn(j,"https"),Zo(j),ue?si(j.toString(),I):pf(j.toString(),I)}else br(2);p.I=0,p.l&&p.l.pa(E),j0(p),Ac(p)}r.bb=function(p){p?(this.j.info("Successfully pinged google.com"),br(2)):(this.j.info("Failed to ping google.com"),br(1))};function j0(p){if(p.I=0,p.ja=[],p.l){const E=ca(p.h);(E.length!=0||p.i.length!=0)&&(w(p.ja,E),w(p.ja,p.i),p.h.i.length=0,y(p.i),p.i.length=0),p.l.oa()}}function H0(p,E,I){var j=I instanceof ua?Br(I):new ua(I);if(j.g!="")E&&(j.g=E+"."+j.g),js(j,j.u);else{var ue=l.location;j=ue.protocol,E=E?E+"."+ue.hostname:ue.hostname,ue=+ue.port;const ve=new ua(null);j&&nn(ve,j),E&&(ve.g=E),ue&&js(ve,ue),I&&(ve.h=I),j=ve}return I=p.G,E=p.wa,I&&E&&qt(j,I,E),qt(j,"VER",p.ka),il(p,j),j}function G0(p,E,I){if(E&&!p.L)throw Error("Can't create secondary domain capable XhrIo object.");return E=p.Aa&&!p.ma?new Zt(new bi({ab:I})):new Zt(p.ma),E.Fa(p.L),E}r.isActive=function(){return!!this.l&&this.l.isActive(this)};function q0(){}r=q0.prototype,r.ra=function(){},r.qa=function(){},r.pa=function(){},r.oa=function(){},r.isActive=function(){return!0},r.Ka=function(){};function $s(){}$s.prototype.g=function(p,E){return new Bn(p,E)};function Bn(p,E){Dt.call(this),this.g=new Ws(E),this.l=p,this.h=E&&E.messageUrlParams||null,p=E&&E.messageHeaders||null,E&&E.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=E&&E.initMessageHeaders||null,E&&E.messageContentType&&(p?p["X-WebChannel-Content-Type"]=E.messageContentType:p={"X-WebChannel-Content-Type":E.messageContentType}),E&&E.sa&&(p?p["X-WebChannel-Client-Profile"]=E.sa:p={"X-WebChannel-Client-Profile":E.sa}),this.g.U=p,(p=E&&E.Qb)&&!L(p)&&(this.g.u=p),this.A=E&&E.supportsCrossDomainXhr||!1,this.v=E&&E.sendRawJson||!1,(E=E&&E.httpSessionIdParam)&&!L(E)&&(this.g.G=E,p=this.h,p!==null&&E in p&&(p=this.h,E in p&&delete p[E])),this.j=new ss(this)}x(Bn,Dt),Bn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Bn.prototype.close=function(){vf(this.g)},Bn.prototype.o=function(p){var E=this.g;if(typeof p=="string"){var I={};I.__data__=p,p=I}else this.v&&(I={},I.__data__=gr(p),p=I);E.i.push(new We(E.Ya++,p)),E.I==3&&Ci(E)},Bn.prototype.N=function(){this.g.l=null,delete this.j,vf(this.g),delete this.g,Bn.Z.N.call(this)};function K0(p){ur.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var E=p.__sm__;if(E){e:{for(const I in E){p=I;break e}p=void 0}(this.i=p)&&(p=this.i,E=E!==null&&p in E?E[p]:void 0),this.data=E}else this.data=p}x(K0,ur);function X0(){Ln.call(this),this.status=1}x(X0,Ln);function ss(p){this.g=p}x(ss,q0),ss.prototype.ra=function(){zt(this.g,"a")},ss.prototype.qa=function(p){zt(this.g,new K0(p))},ss.prototype.pa=function(p){zt(this.g,new X0)},ss.prototype.oa=function(){zt(this.g,"b")},$s.prototype.createWebChannel=$s.prototype.g,Bn.prototype.send=Bn.prototype.o,Bn.prototype.open=Bn.prototype.m,Bn.prototype.close=Bn.prototype.close,U4=function(){return new $s},B4=function(){return Ji()},V4=Tr,zx={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ts.NO_ERROR=0,ts.TIMEOUT=8,ts.HTTP_ERROR=6,Em=ts,rs.COMPLETE="complete",L4=rs,fn.EventType=Vt,Vt.OPEN="a",Vt.CLOSE="b",Vt.ERROR="c",Vt.MESSAGE="d",Dt.prototype.listen=Dt.prototype.J,hh=fn,Zt.prototype.listenOnce=Zt.prototype.K,Zt.prototype.getLastError=Zt.prototype.Ha,Zt.prototype.getLastErrorCode=Zt.prototype.ya,Zt.prototype.getStatus=Zt.prototype.ca,Zt.prototype.getResponseJson=Zt.prototype.La,Zt.prototype.getResponseText=Zt.prototype.la,Zt.prototype.send=Zt.prototype.ea,Zt.prototype.setWithCredentials=Zt.prototype.Fa,P4=Zt}).apply(typeof Jd<"u"?Jd:typeof self<"u"?self:typeof window<"u"?window:{});const Uw="@firebase/firestore",zw="4.9.3";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};vn.UNAUTHENTICATED=new vn(null),vn.GOOGLE_CREDENTIALS=new vn("google-credentials-uid"),vn.FIRST_PARTY=new vn("first-party-uid"),vn.MOCK_USER=new vn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ef="12.7.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wl=new Ep("@firebase/firestore");function du(){return Wl.logLevel}function Le(r,...e){if(Wl.logLevel<=bt.DEBUG){const t=e.map(qv);Wl.debug(`Firestore (${ef}): ${r}`,...t)}}function Hn(r,...e){if(Wl.logLevel<=bt.ERROR){const t=e.map(qv);Wl.error(`Firestore (${ef}): ${r}`,...t)}}function Yl(r,...e){if(Wl.logLevel<=bt.WARN){const t=e.map(qv);Wl.warn(`Firestore (${ef}): ${r}`,...t)}}function qv(r){if(typeof r=="string")return r;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(r)}catch{return r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ye(r,e,t){let n="Unexpected state";typeof e=="string"?n=e:t=e,z4(r,n,t)}function z4(r,e,t){let n=`FIRESTORE (${ef}) INTERNAL ASSERTION FAILED: ${e} (ID: ${r.toString(16)})`;if(t!==void 0)try{n+=" CONTEXT: "+JSON.stringify(t)}catch{n+=" CONTEXT: "+t}throw Hn(n),new Error(n)}function Je(r,e,t,n){let a="Unexpected state";typeof t=="string"?a=t:n=t,r||z4(e,a,n)}function ft(r,e){return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ke={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ke extends Si{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Is{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j4{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class sF{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(vn.UNAUTHENTICATED)))}shutdown(){}}class oF{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class lF{constructor(e){this.t=e,this.currentUser=vn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Je(this.o===void 0,42304);let n=this.i;const a=f=>this.i!==n?(n=this.i,t(f)):Promise.resolve();let s=new Is;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Is,e.enqueueRetryable((()=>a(this.currentUser)))};const l=()=>{const f=s;e.enqueueRetryable((async()=>{await f.promise,await a(this.currentUser)}))},u=f=>{Le("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit((f=>u(f))),setTimeout((()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?u(f):(Le("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Is)}}),0),l()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((n=>this.i!==e?(Le("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Je(typeof n.accessToken=="string",31837,{l:n}),new j4(n.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Je(e===null||typeof e=="string",2055,{h:e}),new vn(e)}}class cF{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=vn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class uF{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new cF(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(vn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class jw{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class fF{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,gi(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Je(this.o===void 0,3512);const n=s=>{s.error!=null&&Le("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const l=s.token!==this.m;return this.m=s.token,Le("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>n(s)))};const a=s=>{Le("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>a(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?a(s):Le("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new jw(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Je(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new jw(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hF(r){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<r;n++)t[n]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kv{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const a=hF(40);for(let s=0;s<a.length;++s)n.length<20&&a[s]<t&&(n+=e.charAt(a[s]%62))}return n}}function ut(r,e){return r<e?-1:r>e?1:0}function jx(r,e){const t=Math.min(r.length,e.length);for(let n=0;n<t;n++){const a=r.charAt(n),s=e.charAt(n);if(a!==s)return fx(a)===fx(s)?ut(a,s):fx(a)?1:-1}return ut(r.length,e.length)}const dF=55296,mF=57343;function fx(r){const e=r.charCodeAt(0);return e>=dF&&e<=mF}function Ou(r,e,t){return r.length===e.length&&r.every(((n,a)=>t(n,e[a])))}function H4(r){return r+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hw="__name__";class Bi{constructor(e,t,n){t===void 0?t=0:t>e.length&&Ye(637,{offset:t,range:e.length}),n===void 0?n=e.length-t:n>e.length-t&&Ye(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return Bi.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Bi?e.forEach((n=>{t.push(n)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let a=0;a<n;a++){const s=Bi.compareSegments(e.get(a),t.get(a));if(s!==0)return s}return ut(e.length,t.length)}static compareSegments(e,t){const n=Bi.isNumericId(e),a=Bi.isNumericId(t);return n&&!a?-1:!n&&a?1:n&&a?Bi.extractNumericId(e).compare(Bi.extractNumericId(t)):jx(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Mo.fromString(e.substring(4,e.length-2))}}class nr extends Bi{construct(e,t,n){return new nr(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Ke(ke.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((a=>a.length>0)))}return new nr(t)}static emptyPath(){return new nr([])}}const pF=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Er extends Bi{construct(e,t,n){return new Er(e,t,n)}static isValidIdentifier(e){return pF.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Er.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Hw}static keyField(){return new Er([Hw])}static fromServerFormat(e){const t=[];let n="",a=0;const s=()=>{if(n.length===0)throw new Ke(ke.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let l=!1;for(;a<e.length;){const u=e[a];if(u==="\\"){if(a+1===e.length)throw new Ke(ke.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[a+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new Ke(ke.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=f,a+=2}else u==="`"?(l=!l,a++):u!=="."||l?(n+=u,a++):(s(),a++)}if(s(),l)throw new Ke(ke.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Er(t)}static emptyPath(){return new Er([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qe{constructor(e){this.path=e}static fromPath(e){return new qe(nr.fromString(e))}static fromName(e){return new qe(nr.fromString(e).popFirst(5))}static empty(){return new qe(nr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&nr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return nr.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new qe(new nr(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gF(r,e,t){if(!t)throw new Ke(ke.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function xF(r,e,t,n){if(e===!0&&n===!0)throw new Ke(ke.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)}function Gw(r){if(!qe.isDocumentKey(r))throw new Ke(ke.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function G4(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}function Xv(r){if(r===void 0)return"undefined";if(r===null)return"null";if(typeof r=="string")return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if(typeof r=="number"||typeof r=="boolean")return""+r;if(typeof r=="object"){if(r instanceof Array)return"an array";{const e=(function(n){return n.constructor?n.constructor.name:null})(r);return e?`a custom ${e} object`:"an object"}}return typeof r=="function"?"a function":Ye(12329,{type:typeof r})}function ks(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new Ke(ke.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Xv(r);throw new Ke(ke.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wr(r,e){const t={typeString:r};return e&&(t.value=e),t}function g0(r,e){if(!G4(r))throw new Ke(ke.INVALID_ARGUMENT,"JSON must be an object");let t;for(const n in e)if(e[n]){const a=e[n].typeString,s="value"in e[n]?{value:e[n].value}:void 0;if(!(n in r)){t=`JSON missing required field: '${n}'`;break}const l=r[n];if(a&&typeof l!==a){t=`JSON field '${n}' must be a ${a}.`;break}if(s!==void 0&&l!==s.value){t=`Expected '${n}' field to equal '${s.value}'`;break}}if(t)throw new Ke(ke.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qw=-62135596800,Kw=1e6;class $t{static now(){return $t.fromMillis(Date.now())}static fromDate(e){return $t.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*Kw);return new $t(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ke(ke.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ke(ke.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<qw)throw new Ke(ke.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ke(ke.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Kw}_compareTo(e){return this.seconds===e.seconds?ut(this.nanoseconds,e.nanoseconds):ut(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:$t._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(g0(e,$t._jsonSchema))return new $t(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-qw;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}$t._jsonSchemaVersion="firestore/timestamp/1.0",$t._jsonSchema={type:Wr("string",$t._jsonSchemaVersion),seconds:Wr("number"),nanoseconds:Wr("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tt{static fromTimestamp(e){return new tt(e)}static min(){return new tt(new $t(0,0))}static max(){return new tt(new $t(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uh=-1;class Gm{constructor(e,t,n,a){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=a}}function Hx(r){return r.fields.find((e=>e.kind===2))}function Al(r){return r.fields.filter((e=>e.kind!==2))}Gm.UNKNOWN_ID=-1;class wm{constructor(e,t){this.fieldPath=e,this.kind=t}}class zh{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new zh(0,ba.min())}}function vF(r,e){const t=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,a=tt.fromTimestamp(n===1e9?new $t(t+1,0):new $t(t,n));return new ba(a,qe.empty(),e)}function q4(r){return new ba(r.readTime,r.key,Uh)}class ba{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new ba(tt.min(),qe.empty(),Uh)}static max(){return new ba(tt.max(),qe.empty(),Uh)}}function Wv(r,e){let t=r.readTime.compareTo(e.readTime);return t!==0?t:(t=qe.comparator(r.documentKey,e.documentKey),t!==0?t:ut(r.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K4="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class X4{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uc(r){if(r.code!==ke.FAILED_PRECONDITION||r.message!==K4)throw r;Le("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ye(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new oe(((n,a)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,a)},this.catchCallback=s=>{this.wrapFailure(t,s).next(n,a)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof oe?t:oe.resolve(t)}catch(t){return oe.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):oe.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):oe.reject(t)}static resolve(e){return new oe(((t,n)=>{t(e)}))}static reject(e){return new oe(((t,n)=>{n(e)}))}static waitFor(e){return new oe(((t,n)=>{let a=0,s=0,l=!1;e.forEach((u=>{++a,u.next((()=>{++s,l&&s===a&&t()}),(f=>n(f)))})),l=!0,s===a&&t()}))}static or(e){let t=oe.resolve(!1);for(const n of e)t=t.next((a=>a?oe.resolve(a):n()));return t}static forEach(e,t){const n=[];return e.forEach(((a,s)=>{n.push(t.call(this,a,s))})),this.waitFor(n)}static mapArray(e,t){return new oe(((n,a)=>{const s=e.length,l=new Array(s);let u=0;for(let f=0;f<s;f++){const d=f;t(e[d]).next((m=>{l[d]=m,++u,u===s&&n(l)}),(m=>a(m)))}}))}static doWhile(e,t){return new oe(((n,a)=>{const s=()=>{e()===!0?t().next((()=>{s()}),a):n()};s()}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const va="SimpleDb";class kp{static open(e,t,n,a){try{return new kp(t,e.transaction(a,n))}catch(s){throw new Eh(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Is,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new Eh(e,t.error)):this.S.resolve()},this.transaction.onerror=n=>{const a=Yv(n.target.error);this.S.reject(new Eh(e,a))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Le(va,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new yF(t)}}class Po{static delete(e){return Le(va,"Removing database:",e),Il(Tb().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!bv())return!1;if(Po.F())return!0;const e=Zr(),t=Po.M(e),n=0<t&&t<10,a=W4(e),s=0<a&&a<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||s)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}constructor(e,t,n){this.name=e,this.version=t,this.N=n,this.B=null,Po.M(Zr())===12.2&&Hn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(Le(va,"Opening database:",this.name),this.db=await new Promise(((t,n)=>{const a=indexedDB.open(this.name,this.version);a.onsuccess=s=>{const l=s.target.result;t(l)},a.onblocked=()=>{n(new Eh(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=s=>{const l=s.target.error;l.name==="VersionError"?n(new Ke(ke.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):l.name==="InvalidStateError"?n(new Ke(ke.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+l)):n(new Eh(e,l))},a.onupgradeneeded=s=>{Le(va,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const l=s.target.result;this.N.k(l,a.transaction,s.oldVersion,this.version).next((()=>{Le(va,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,a){const s=t==="readonly";let l=0;for(;;){++l;try{this.db=await this.L(e);const u=kp.open(this.db,e,s?"readonly":"readwrite",n),f=a(u).next((d=>(u.C(),d))).catch((d=>(u.abort(d),oe.reject(d)))).toPromise();return f.catch((()=>{})),await u.D,f}catch(u){const f=u,d=f.name!=="FirebaseError"&&l<3;if(Le(va,"Transaction failed with error:",f.message,"Retrying:",d),this.close(),!d)return Promise.reject(f)}}}close(){this.db&&this.db.close(),this.db=void 0}}function W4(r){const e=r.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class _F{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Il(this.U.delete())}}class Eh extends Ke{constructor(e,t){super(ke.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Ko(r){return r.name==="IndexedDbTransactionError"}class yF{constructor(e){this.store=e}put(e,t){let n;return t!==void 0?(Le(va,"PUT",this.store.name,e,t),n=this.store.put(t,e)):(Le(va,"PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Il(n)}add(e){return Le(va,"ADD",this.store.name,e,e),Il(this.store.add(e))}get(e){return Il(this.store.get(e)).next((t=>(t===void 0&&(t=null),Le(va,"GET",this.store.name,e,t),t)))}delete(e){return Le(va,"DELETE",this.store.name,e),Il(this.store.delete(e))}count(){return Le(va,"COUNT",this.store.name),Il(this.store.count())}J(e,t){const n=this.options(e,t),a=n.index?this.store.index(n.index):this.store;if(typeof a.getAll=="function"){const s=a.getAll(n.range);return new oe(((l,u)=>{s.onerror=f=>{u(f.target.error)},s.onsuccess=f=>{l(f.target.result)}}))}{const s=this.cursor(n),l=[];return this.H(s,((u,f)=>{l.push(f)})).next((()=>l))}}Y(e,t){const n=this.store.getAll(e,t===null?void 0:t);return new oe(((a,s)=>{n.onerror=l=>{s(l.target.error)},n.onsuccess=l=>{a(l.target.result)}}))}Z(e,t){Le(va,"DELETE ALL",this.store.name);const n=this.options(e,t);n.X=!1;const a=this.cursor(n);return this.H(a,((s,l,u)=>u.delete()))}ee(e,t){let n;t?n=e:(n={},t=e);const a=this.cursor(n);return this.H(a,t)}te(e){const t=this.cursor({});return new oe(((n,a)=>{t.onerror=s=>{const l=Yv(s.target.error);a(l)},t.onsuccess=s=>{const l=s.target.result;l?e(l.primaryKey,l.value).next((u=>{u?l.continue():n()})):n()}}))}H(e,t){const n=[];return new oe(((a,s)=>{e.onerror=l=>{s(l.target.error)},e.onsuccess=l=>{const u=l.target.result;if(!u)return void a();const f=new _F(u),d=t(u.primaryKey,u.value,f);if(d instanceof oe){const m=d.catch((x=>(f.done(),oe.reject(x))));n.push(m)}f.isDone?a():f.G===null?u.continue():u.continue(f.G)}})).next((()=>oe.waitFor(n)))}options(e,t){let n;return e!==void 0&&(typeof e=="string"?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.X?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Il(r){return new oe(((e,t)=>{r.onsuccess=n=>{const a=n.target.result;e(a)},r.onerror=n=>{const a=Yv(n.target.error);t(a)}}))}let Xw=!1;function Yv(r){const e=Po.M(Zr());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(r.message.indexOf(t)>=0){const n=new Ke("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Xw||(Xw=!0,setTimeout((()=>{throw n}),0)),n}}return r}const wh="IndexBackfiller";class TF{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){Le(wh,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();Le(wh,`Documents written: ${t}`)}catch(t){Ko(t)?Le(wh,"Ignoring IndexedDB error during index backfill: ",t):await uc(t)}await this.re(6e4)}))}}class EF{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const n=new Set;let a=t,s=!0;return oe.doWhile((()=>s===!0&&a>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((l=>{if(l!==null&&!n.has(l))return Le(wh,`Processing collection: ${l}`),this.oe(e,l,a).next((u=>{a-=u,n.add(l)}));s=!1})))).next((()=>t-a))}oe(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((a=>this.localStore.localDocuments.getNextDocuments(e,t,a,n).next((s=>{const l=s.changes;return this.localStore.indexManager.updateIndexEntries(e,l).next((()=>this._e(a,s))).next((u=>(Le(wh,`Updating offset: ${u}`),this.localStore.indexManager.updateCollectionGroup(e,t,u)))).next((()=>l.size))}))))}_e(e,t){let n=e;return t.changes.forEach(((a,s)=>{const l=q4(s);Wv(l,n)>0&&(n=l)})),new ba(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ya{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>t.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Ya.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ll=-1;function Cp(r){return r==null}function jh(r){return r===0&&1/r==-1/0}function wF(r){return typeof r=="number"&&Number.isInteger(r)&&!jh(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qm="";function Nn(r){let e="";for(let t=0;t<r.length;t++)e.length>0&&(e=Ww(e)),e=SF(r.get(t),e);return Ww(e)}function SF(r,e){let t=e;const n=r.length;for(let a=0;a<n;a++){const s=r.charAt(a);switch(s){case"\0":t+="";break;case qm:t+="";break;default:t+=s}}return t}function Ww(r){return r+qm+""}function Ui(r){const e=r.length;if(Je(e>=2,64408,{path:r}),e===2)return Je(r.charAt(0)===qm&&r.charAt(1)==="",56145,{path:r}),nr.emptyPath();const t=e-2,n=[];let a="";for(let s=0;s<e;){const l=r.indexOf(qm,s);switch((l<0||l>t)&&Ye(50515,{path:r}),r.charAt(l+1)){case"":const u=r.substring(s,l);let f;a.length===0?f=u:(a+=u,f=a,a=""),n.push(f);break;case"":a+=r.substring(s,l),a+="\0";break;case"":a+=r.substring(s,l+1);break;default:Ye(61167,{path:r})}s=l+2}return new nr(n)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bl="remoteDocuments",x0="owner",au="owner",Hh="mutationQueues",AF="userId",pi="mutations",Yw="batchId",Fl="userMutationsIndex",$w=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sm(r,e){return[r,Nn(e)]}function Y4(r,e,t){return[r,Nn(e),t]}const bF={},Fu="documentMutations",Km="remoteDocumentsV14",IF=["prefixPath","collectionGroup","readTime","documentId"],Am="documentKeyIndex",kF=["prefixPath","collectionGroup","documentId"],$4="collectionGroupIndex",CF=["collectionGroup","readTime","prefixPath","documentId"],Gh="remoteDocumentGlobal",Gx="remoteDocumentGlobalKey",Mu="targets",Q4="queryTargetsIndex",RF=["canonicalId","targetId"],Pu="targetDocuments",DF=["targetId","path"],$v="documentTargetsIndex",NF=["path","targetId"],Xm="targetGlobalKey",Vl="targetGlobal",qh="collectionParents",OF=["collectionId","parent"],Lu="clientMetadata",FF="clientId",Rp="bundles",MF="bundleId",Dp="namedQueries",PF="name",Qv="indexConfiguration",LF="indexId",qx="collectionGroupIndex",VF="collectionGroup",Sh="indexState",BF=["indexId","uid"],J4="sequenceNumberIndex",UF=["uid","sequenceNumber"],Ah="indexEntries",zF=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Z4="documentKeyIndex",jF=["indexId","uid","orderedDocumentKey"],Np="documentOverlays",HF=["userId","collectionPath","documentId"],Kx="collectionPathOverlayIndex",GF=["userId","collectionPath","largestBatchId"],eI="collectionGroupOverlayIndex",qF=["userId","collectionGroup","largestBatchId"],Jv="globals",KF="name",tI=[Hh,pi,Fu,bl,Mu,x0,Vl,Pu,Lu,Gh,qh,Rp,Dp],XF=[...tI,Np],rI=[Hh,pi,Fu,Km,Mu,x0,Vl,Pu,Lu,Gh,qh,Rp,Dp,Np],nI=rI,Zv=[...nI,Qv,Sh,Ah],WF=Zv,aI=[...Zv,Jv],YF=aI;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xx extends X4{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function tn(r,e){const t=ft(r);return Po.O(t.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qw(r){let e=0;for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function fc(r,e){for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function iI(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yr{constructor(e,t){this.comparator=e,this.root=t||_n.EMPTY}insert(e,t){return new yr(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,_n.BLACK,null,null))}remove(e){return new yr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,_n.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const a=this.comparator(e,n.key);if(a===0)return t+n.left.size;a<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Zd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Zd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Zd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Zd(this.root,e,this.comparator,!0)}}class Zd{constructor(e,t,n,a){this.isReverse=a,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&a&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class _n{constructor(e,t,n,a,s){this.key=e,this.value=t,this.color=n??_n.RED,this.left=a??_n.EMPTY,this.right=s??_n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,a,s){return new _n(e??this.key,t??this.value,n??this.color,a??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let a=this;const s=n(e,a.key);return a=s<0?a.copy(null,null,null,a.left.insert(e,t,n),null):s===0?a.copy(null,t,null,null,null):a.copy(null,null,null,null,a.right.insert(e,t,n)),a.fixUp()}removeMin(){if(this.left.isEmpty())return _n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,a=this;if(t(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,t),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),t(e,a.key)===0){if(a.right.isEmpty())return _n.EMPTY;n=a.right.min(),a=a.copy(n.key,n.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,t))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,_n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,_n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ye(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ye(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ye(27949);return e+(this.isRed()?0:1)}}_n.EMPTY=null,_n.RED=!0,_n.BLACK=!1;_n.EMPTY=new class{constructor(){this.size=0}get key(){throw Ye(57766)}get value(){throw Ye(16141)}get color(){throw Ye(16727)}get left(){throw Ye(29726)}get right(){throw Ye(36894)}copy(e,t,n,a,s){return this}insert(e,t,n){return new _n(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jt{constructor(e){this.comparator=e,this.data=new yr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const a=n.getNext();if(this.comparator(a.key,e[1])>=0)return;t(a.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Jw(this.data.getIterator())}getIteratorFrom(e){return new Jw(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((n=>{t=t.add(n)})),t}isEqual(e){if(!(e instanceof Jt)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const a=t.getNext().key,s=n.getNext().key;if(this.comparator(a,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Jt(this.comparator);return t.data=e,t}}class Jw{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function iu(r){return r.hasNext()?r.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $a{constructor(e){this.fields=e,e.sort(Er.comparator)}static empty(){return new $a([])}unionWith(e){let t=new Jt(Er.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new $a(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ou(this.fields,e.fields,((t,n)=>t.isEqual(n)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sI extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yr{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(a){try{return atob(a)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new sI("Invalid base64 string: "+s):s}})(e);return new Yr(t)}static fromUint8Array(e){const t=(function(a){let s="";for(let l=0;l<a.length;++l)s+=String.fromCharCode(a[l]);return s})(e);return new Yr(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const n=new Uint8Array(t.length);for(let a=0;a<t.length;a++)n[a]=t.charCodeAt(a);return n})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ut(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Yr.EMPTY_BYTE_STRING=new Yr("");const $F=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Fs(r){if(Je(!!r,39018),typeof r=="string"){let e=0;const t=$F.exec(r);if(Je(!!t,46558,{timestamp:r}),t[1]){let a=t[1];a=(a+"000000000").substr(0,9),e=Number(a)}const n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:_r(r.seconds),nanos:_r(r.nanos)}}function _r(r){return typeof r=="number"?r:typeof r=="string"?Number(r):0}function Ms(r){return typeof r=="string"?Yr.fromBase64String(r):Yr.fromUint8Array(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oI="server_timestamp",lI="__type__",cI="__previous_value__",uI="__local_write_time__";function e_(r){var t,n;return((n=(((t=r==null?void 0:r.mapValue)==null?void 0:t.fields)||{})[lI])==null?void 0:n.stringValue)===oI}function Op(r){const e=r.mapValue.fields[cI];return e_(e)?Op(e):e}function Kh(r){const e=Fs(r.mapValue.fields[uI].timestampValue);return new $t(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QF{constructor(e,t,n,a,s,l,u,f,d,m){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=a,this.ssl=s,this.forceLongPolling=l,this.autoDetectLongPolling=u,this.longPollingOptions=f,this.useFetchStreams=d,this.isUsingEmulator=m}}const Wm="(default)";class $l{constructor(e,t){this.projectId=e,this.database=t||Wm}static empty(){return new $l("","")}get isDefaultDatabase(){return this.database===Wm}isEqual(e){return e instanceof $l&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t_="__type__",fI="__max__",Ro={mapValue:{fields:{__type__:{stringValue:fI}}}},r_="__vector__",Vu="value",bm={nullValue:"NULL_VALUE"};function Vo(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?e_(r)?4:hI(r)?9007199254740991:Fp(r)?10:11:Ye(28295,{value:r})}function Wi(r,e){if(r===e)return!0;const t=Vo(r);if(t!==Vo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return Kh(r).isEqual(Kh(e));case 3:return(function(a,s){if(typeof a.timestampValue=="string"&&typeof s.timestampValue=="string"&&a.timestampValue.length===s.timestampValue.length)return a.timestampValue===s.timestampValue;const l=Fs(a.timestampValue),u=Fs(s.timestampValue);return l.seconds===u.seconds&&l.nanos===u.nanos})(r,e);case 5:return r.stringValue===e.stringValue;case 6:return(function(a,s){return Ms(a.bytesValue).isEqual(Ms(s.bytesValue))})(r,e);case 7:return r.referenceValue===e.referenceValue;case 8:return(function(a,s){return _r(a.geoPointValue.latitude)===_r(s.geoPointValue.latitude)&&_r(a.geoPointValue.longitude)===_r(s.geoPointValue.longitude)})(r,e);case 2:return(function(a,s){if("integerValue"in a&&"integerValue"in s)return _r(a.integerValue)===_r(s.integerValue);if("doubleValue"in a&&"doubleValue"in s){const l=_r(a.doubleValue),u=_r(s.doubleValue);return l===u?jh(l)===jh(u):isNaN(l)&&isNaN(u)}return!1})(r,e);case 9:return Ou(r.arrayValue.values||[],e.arrayValue.values||[],Wi);case 10:case 11:return(function(a,s){const l=a.mapValue.fields||{},u=s.mapValue.fields||{};if(Qw(l)!==Qw(u))return!1;for(const f in l)if(l.hasOwnProperty(f)&&(u[f]===void 0||!Wi(l[f],u[f])))return!1;return!0})(r,e);default:return Ye(52216,{left:r})}}function Xh(r,e){return(r.values||[]).find((t=>Wi(t,e)))!==void 0}function Bo(r,e){if(r===e)return 0;const t=Vo(r),n=Vo(e);if(t!==n)return ut(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return ut(r.booleanValue,e.booleanValue);case 2:return(function(s,l){const u=_r(s.integerValue||s.doubleValue),f=_r(l.integerValue||l.doubleValue);return u<f?-1:u>f?1:u===f?0:isNaN(u)?isNaN(f)?0:-1:1})(r,e);case 3:return Zw(r.timestampValue,e.timestampValue);case 4:return Zw(Kh(r),Kh(e));case 5:return jx(r.stringValue,e.stringValue);case 6:return(function(s,l){const u=Ms(s),f=Ms(l);return u.compareTo(f)})(r.bytesValue,e.bytesValue);case 7:return(function(s,l){const u=s.split("/"),f=l.split("/");for(let d=0;d<u.length&&d<f.length;d++){const m=ut(u[d],f[d]);if(m!==0)return m}return ut(u.length,f.length)})(r.referenceValue,e.referenceValue);case 8:return(function(s,l){const u=ut(_r(s.latitude),_r(l.latitude));return u!==0?u:ut(_r(s.longitude),_r(l.longitude))})(r.geoPointValue,e.geoPointValue);case 9:return eS(r.arrayValue,e.arrayValue);case 10:return(function(s,l){var _,y,w,T;const u=s.fields||{},f=l.fields||{},d=(_=u[Vu])==null?void 0:_.arrayValue,m=(y=f[Vu])==null?void 0:y.arrayValue,x=ut(((w=d==null?void 0:d.values)==null?void 0:w.length)||0,((T=m==null?void 0:m.values)==null?void 0:T.length)||0);return x!==0?x:eS(d,m)})(r.mapValue,e.mapValue);case 11:return(function(s,l){if(s===Ro.mapValue&&l===Ro.mapValue)return 0;if(s===Ro.mapValue)return 1;if(l===Ro.mapValue)return-1;const u=s.fields||{},f=Object.keys(u),d=l.fields||{},m=Object.keys(d);f.sort(),m.sort();for(let x=0;x<f.length&&x<m.length;++x){const _=jx(f[x],m[x]);if(_!==0)return _;const y=Bo(u[f[x]],d[m[x]]);if(y!==0)return y}return ut(f.length,m.length)})(r.mapValue,e.mapValue);default:throw Ye(23264,{he:t})}}function Zw(r,e){if(typeof r=="string"&&typeof e=="string"&&r.length===e.length)return ut(r,e);const t=Fs(r),n=Fs(e),a=ut(t.seconds,n.seconds);return a!==0?a:ut(t.nanos,n.nanos)}function eS(r,e){const t=r.values||[],n=e.values||[];for(let a=0;a<t.length&&a<n.length;++a){const s=Bo(t[a],n[a]);if(s)return s}return ut(t.length,n.length)}function Bu(r){return Wx(r)}function Wx(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?(function(t){const n=Fs(t);return`time(${n.seconds},${n.nanos})`})(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?(function(t){return Ms(t).toBase64()})(r.bytesValue):"referenceValue"in r?(function(t){return qe.fromName(t).toString()})(r.referenceValue):"geoPointValue"in r?(function(t){return`geo(${t.latitude},${t.longitude})`})(r.geoPointValue):"arrayValue"in r?(function(t){let n="[",a=!0;for(const s of t.values||[])a?a=!1:n+=",",n+=Wx(s);return n+"]"})(r.arrayValue):"mapValue"in r?(function(t){const n=Object.keys(t.fields||{}).sort();let a="{",s=!0;for(const l of n)s?s=!1:a+=",",a+=`${l}:${Wx(t.fields[l])}`;return a+"}"})(r.mapValue):Ye(61005,{value:r})}function Im(r){switch(Vo(r)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Op(r);return e?16+Im(e):16;case 5:return 2*r.stringValue.length;case 6:return Ms(r.bytesValue).approximateByteSize();case 7:return r.referenceValue.length;case 9:return(function(n){return(n.values||[]).reduce(((a,s)=>a+Im(s)),0)})(r.arrayValue);case 10:case 11:return(function(n){let a=0;return fc(n.fields,((s,l)=>{a+=s.length+Im(l)})),a})(r.mapValue);default:throw Ye(13486,{value:r})}}function n_(r,e){return{referenceValue:`projects/${r.projectId}/databases/${r.database}/documents/${e.path.canonicalString()}`}}function Yx(r){return!!r&&"integerValue"in r}function Wh(r){return!!r&&"arrayValue"in r}function tS(r){return!!r&&"nullValue"in r}function rS(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function km(r){return!!r&&"mapValue"in r}function Fp(r){var t,n;return((n=(((t=r==null?void 0:r.mapValue)==null?void 0:t.fields)||{})[t_])==null?void 0:n.stringValue)===r_}function bh(r){if(r.geoPointValue)return{geoPointValue:{...r.geoPointValue}};if(r.timestampValue&&typeof r.timestampValue=="object")return{timestampValue:{...r.timestampValue}};if(r.mapValue){const e={mapValue:{fields:{}}};return fc(r.mapValue.fields,((t,n)=>e.mapValue.fields[t]=bh(n))),e}if(r.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=bh(r.arrayValue.values[t]);return e}return{...r}}function hI(r){return(((r.mapValue||{}).fields||{}).__type__||{}).stringValue===fI}const dI={mapValue:{fields:{[t_]:{stringValue:r_},[Vu]:{arrayValue:{}}}}};function JF(r){return"nullValue"in r?bm:"booleanValue"in r?{booleanValue:!1}:"integerValue"in r||"doubleValue"in r?{doubleValue:NaN}:"timestampValue"in r?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in r?{stringValue:""}:"bytesValue"in r?{bytesValue:""}:"referenceValue"in r?n_($l.empty(),qe.empty()):"geoPointValue"in r?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in r?{arrayValue:{}}:"mapValue"in r?Fp(r)?dI:{mapValue:{}}:Ye(35942,{value:r})}function ZF(r){return"nullValue"in r?{booleanValue:!1}:"booleanValue"in r?{doubleValue:NaN}:"integerValue"in r||"doubleValue"in r?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in r?{stringValue:""}:"stringValue"in r?{bytesValue:""}:"bytesValue"in r?n_($l.empty(),qe.empty()):"referenceValue"in r?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in r?{arrayValue:{}}:"arrayValue"in r?dI:"mapValue"in r?Fp(r)?{mapValue:{}}:Ro:Ye(61959,{value:r})}function nS(r,e){const t=Bo(r.value,e.value);return t!==0?t:r.inclusive&&!e.inclusive?-1:!r.inclusive&&e.inclusive?1:0}function aS(r,e){const t=Bo(r.value,e.value);return t!==0?t:r.inclusive&&!e.inclusive?1:!r.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class na{constructor(e){this.value=e}static empty(){return new na({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!km(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=bh(t)}setAll(e){let t=Er.emptyPath(),n={},a=[];e.forEach(((l,u)=>{if(!t.isImmediateParentOf(u)){const f=this.getFieldsMap(t);this.applyChanges(f,n,a),n={},a=[],t=u.popLast()}l?n[u.lastSegment()]=bh(l):a.push(u.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,n,a)}delete(e){const t=this.field(e.popLast());km(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Wi(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let a=t.mapValue.fields[e.get(n)];km(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=a),t=a}return t.mapValue.fields}applyChanges(e,t,n){fc(t,((a,s)=>e[a]=s));for(const a of n)delete e[a]}clone(){return new na(bh(this.value))}}function mI(r){const e=[];return fc(r.fields,((t,n)=>{const a=new Er([t]);if(km(n)){const s=mI(n.mapValue).fields;if(s.length===0)e.push(a);else for(const l of s)e.push(a.child(l))}else e.push(a)})),new $a(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rr{constructor(e,t,n,a,s,l,u){this.key=e,this.documentType=t,this.version=n,this.readTime=a,this.createTime=s,this.data=l,this.documentState=u}static newInvalidDocument(e){return new Rr(e,0,tt.min(),tt.min(),tt.min(),na.empty(),0)}static newFoundDocument(e,t,n,a){return new Rr(e,1,t,tt.min(),n,a,0)}static newNoDocument(e,t){return new Rr(e,2,t,tt.min(),tt.min(),na.empty(),0)}static newUnknownDocument(e,t){return new Rr(e,3,t,tt.min(),tt.min(),na.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(tt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=na.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=na.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=tt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Rr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Rr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uu{constructor(e,t){this.position=e,this.inclusive=t}}function iS(r,e,t){let n=0;for(let a=0;a<r.position.length;a++){const s=e[a],l=r.position[a];if(s.field.isKeyField()?n=qe.comparator(qe.fromName(l.referenceValue),t.key):n=Bo(l,t.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function sS(r,e){if(r===null)return e===null;if(e===null||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!Wi(r.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ym{constructor(e,t="asc"){this.field=e,this.dir=t}}function eM(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pI{}class kt extends pI{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new tM(e,t,n):t==="array-contains"?new aM(e,n):t==="in"?new TI(e,n):t==="not-in"?new iM(e,n):t==="array-contains-any"?new sM(e,n):new kt(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new rM(e,n):new nM(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Bo(t,this.value)):t!==null&&Vo(this.value)===Vo(t)&&this.matchesComparison(Bo(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ye(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ar extends pI{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new ar(e,t)}matches(e){return zu(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function zu(r){return r.op==="and"}function $x(r){return r.op==="or"}function a_(r){return gI(r)&&zu(r)}function gI(r){for(const e of r.filters)if(e instanceof ar)return!1;return!0}function Qx(r){if(r instanceof kt)return r.field.canonicalString()+r.op.toString()+Bu(r.value);if(a_(r))return r.filters.map((e=>Qx(e))).join(",");{const e=r.filters.map((t=>Qx(t))).join(",");return`${r.op}(${e})`}}function xI(r,e){return r instanceof kt?(function(n,a){return a instanceof kt&&n.op===a.op&&n.field.isEqual(a.field)&&Wi(n.value,a.value)})(r,e):r instanceof ar?(function(n,a){return a instanceof ar&&n.op===a.op&&n.filters.length===a.filters.length?n.filters.reduce(((s,l,u)=>s&&xI(l,a.filters[u])),!0):!1})(r,e):void Ye(19439)}function vI(r,e){const t=r.filters.concat(e);return ar.create(t,r.op)}function _I(r){return r instanceof kt?(function(t){return`${t.field.canonicalString()} ${t.op} ${Bu(t.value)}`})(r):r instanceof ar?(function(t){return t.op.toString()+" {"+t.getFilters().map(_I).join(" ,")+"}"})(r):"Filter"}class tM extends kt{constructor(e,t,n){super(e,t,n),this.key=qe.fromName(n.referenceValue)}matches(e){const t=qe.comparator(e.key,this.key);return this.matchesComparison(t)}}class rM extends kt{constructor(e,t){super(e,"in",t),this.keys=yI("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class nM extends kt{constructor(e,t){super(e,"not-in",t),this.keys=yI("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function yI(r,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((n=>qe.fromName(n.referenceValue)))}class aM extends kt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Wh(t)&&Xh(t.arrayValue,this.value)}}class TI extends kt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Xh(this.value.arrayValue,t)}}class iM extends kt{constructor(e,t){super(e,"not-in",t)}matches(e){if(Xh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Xh(this.value.arrayValue,t)}}class sM extends kt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Wh(t)||!t.arrayValue.values)&&t.arrayValue.values.some((n=>Xh(this.value.arrayValue,n)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oM{constructor(e,t=null,n=[],a=[],s=null,l=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=a,this.limit=s,this.startAt=l,this.endAt=u,this.Te=null}}function Jx(r,e=null,t=[],n=[],a=null,s=null,l=null){return new oM(r,e,t,n,a,s,l)}function Ql(r){const e=ft(r);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((n=>Qx(n))).join(","),t+="|ob:",t+=e.orderBy.map((n=>(function(s){return s.field.canonicalString()+s.dir})(n))).join(","),Cp(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((n=>Bu(n))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((n=>Bu(n))).join(",")),e.Te=t}return e.Te}function v0(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!eM(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!xI(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!sS(r.startAt,e.startAt)&&sS(r.endAt,e.endAt)}function $m(r){return qe.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}function Qm(r,e){return r.filters.filter((t=>t instanceof kt&&t.field.isEqual(e)))}function oS(r,e,t){let n=bm,a=!0;for(const s of Qm(r,e)){let l=bm,u=!0;switch(s.op){case"<":case"<=":l=JF(s.value);break;case"==":case"in":case">=":l=s.value;break;case">":l=s.value,u=!1;break;case"!=":case"not-in":l=bm}nS({value:n,inclusive:a},{value:l,inclusive:u})<0&&(n=l,a=u)}if(t!==null){for(let s=0;s<r.orderBy.length;++s)if(r.orderBy[s].field.isEqual(e)){const l=t.position[s];nS({value:n,inclusive:a},{value:l,inclusive:t.inclusive})<0&&(n=l,a=t.inclusive);break}}return{value:n,inclusive:a}}function lS(r,e,t){let n=Ro,a=!0;for(const s of Qm(r,e)){let l=Ro,u=!0;switch(s.op){case">=":case">":l=ZF(s.value),u=!1;break;case"==":case"in":case"<=":l=s.value;break;case"<":l=s.value,u=!1;break;case"!=":case"not-in":l=Ro}aS({value:n,inclusive:a},{value:l,inclusive:u})>0&&(n=l,a=u)}if(t!==null){for(let s=0;s<r.orderBy.length;++s)if(r.orderBy[s].field.isEqual(e)){const l=t.position[s];aS({value:n,inclusive:a},{value:l,inclusive:t.inclusive})>0&&(n=l,a=t.inclusive);break}}return{value:n,inclusive:a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mp{constructor(e,t=null,n=[],a=[],s=null,l="F",u=null,f=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=a,this.limit=s,this.limitType=l,this.startAt=u,this.endAt=f,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function lM(r,e,t,n,a,s,l,u){return new Mp(r,e,t,n,a,s,l,u)}function _0(r){return new Mp(r)}function cS(r){return r.filters.length===0&&r.limit===null&&r.startAt==null&&r.endAt==null&&(r.explicitOrderBy.length===0||r.explicitOrderBy.length===1&&r.explicitOrderBy[0].field.isKeyField())}function cM(r){return r.collectionGroup!==null}function Ih(r){const e=ft(r);if(e.Ie===null){e.Ie=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(l){let u=new Jt(Er.comparator);return l.filters.forEach((f=>{f.getFlattenedFilters().forEach((d=>{d.isInequality()&&(u=u.add(d.field))}))})),u})(e).forEach((s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new Ym(s,n))})),t.has(Er.keyField().canonicalString())||e.Ie.push(new Ym(Er.keyField(),n))}return e.Ie}function Ja(r){const e=ft(r);return e.Ee||(e.Ee=uM(e,Ih(r))),e.Ee}function uM(r,e){if(r.limitType==="F")return Jx(r.path,r.collectionGroup,e,r.filters,r.limit,r.startAt,r.endAt);{e=e.map((a=>{const s=a.dir==="desc"?"asc":"desc";return new Ym(a.field,s)}));const t=r.endAt?new Uu(r.endAt.position,r.endAt.inclusive):null,n=r.startAt?new Uu(r.startAt.position,r.startAt.inclusive):null;return Jx(r.path,r.collectionGroup,e,r.filters,r.limit,t,n)}}function Zx(r,e,t){return new Mp(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function Pp(r,e){return v0(Ja(r),Ja(e))&&r.limitType===e.limitType}function EI(r){return`${Ql(Ja(r))}|lt:${r.limitType}`}function mu(r){return`Query(target=${(function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map((a=>_I(a))).join(", ")}]`),Cp(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map((a=>(function(l){return`${l.field.canonicalString()} (${l.dir})`})(a))).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map((a=>Bu(a))).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map((a=>Bu(a))).join(",")),`Target(${n})`})(Ja(r))}; limitType=${r.limitType})`}function y0(r,e){return e.isFoundDocument()&&(function(n,a){const s=a.key.path;return n.collectionGroup!==null?a.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):qe.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)})(r,e)&&(function(n,a){for(const s of Ih(n))if(!s.field.isKeyField()&&a.data.field(s.field)===null)return!1;return!0})(r,e)&&(function(n,a){for(const s of n.filters)if(!s.matches(a))return!1;return!0})(r,e)&&(function(n,a){return!(n.startAt&&!(function(l,u,f){const d=iS(l,u,f);return l.inclusive?d<=0:d<0})(n.startAt,Ih(n),a)||n.endAt&&!(function(l,u,f){const d=iS(l,u,f);return l.inclusive?d>=0:d>0})(n.endAt,Ih(n),a))})(r,e)}function fM(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}function wI(r){return(e,t)=>{let n=!1;for(const a of Ih(r)){const s=hM(a,e,t);if(s!==0)return s;n=n||a.field.isKeyField()}return 0}}function hM(r,e,t){const n=r.field.isKeyField()?qe.comparator(e.key,t.key):(function(s,l,u){const f=l.data.field(s),d=u.data.field(s);return f!==null&&d!==null?Bo(f,d):Ye(42886)})(r.field,e,t);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return Ye(19790,{direction:r.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ls{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[a,s]of n)if(this.equalsFn(a,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),a=this.inner[n];if(a===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let s=0;s<a.length;s++)if(this.equalsFn(a[s][0],e))return void(a[s]=[e,t]);a.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let a=0;a<n.length;a++)if(this.equalsFn(n[a][0],e))return n.length===1?delete this.inner[t]:n.splice(a,1),this.innerSize--,!0;return!1}forEach(e){fc(this.inner,((t,n)=>{for(const[a,s]of n)e(a,s)}))}isEmpty(){return iI(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dM=new yr(qe.comparator);function wa(){return dM}const SI=new yr(qe.comparator);function dh(...r){let e=SI;for(const t of r)e=e.insert(t.key,t);return e}function AI(r){let e=SI;return r.forEach(((t,n)=>e=e.insert(t,n.overlayedDocument))),e}function zi(){return kh()}function bI(){return kh()}function kh(){return new Ls((r=>r.toString()),((r,e)=>r.isEqual(e)))}const mM=new yr(qe.comparator),pM=new Jt(qe.comparator);function yt(...r){let e=pM;for(const t of r)e=e.add(t);return e}const gM=new Jt(ut);function xM(){return gM}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i_(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:jh(e)?"-0":e}}function II(r){return{integerValue:""+r}}function vM(r,e){return wF(e)?II(e):i_(r,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lp{constructor(){this._=void 0}}function _M(r,e,t){return r instanceof ju?(function(a,s){const l={fields:{[lI]:{stringValue:oI},[uI]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return s&&e_(s)&&(s=Op(s)),s&&(l.fields[cI]=s),{mapValue:l}})(t,e):r instanceof Hu?CI(r,e):r instanceof Gu?RI(r,e):(function(a,s){const l=kI(a,s),u=uS(l)+uS(a.Ae);return Yx(l)&&Yx(a.Ae)?II(u):i_(a.serializer,u)})(r,e)}function yM(r,e,t){return r instanceof Hu?CI(r,e):r instanceof Gu?RI(r,e):t}function kI(r,e){return r instanceof Yh?(function(n){return Yx(n)||(function(s){return!!s&&"doubleValue"in s})(n)})(e)?e:{integerValue:0}:null}class ju extends Lp{}class Hu extends Lp{constructor(e){super(),this.elements=e}}function CI(r,e){const t=DI(e);for(const n of r.elements)t.some((a=>Wi(a,n)))||t.push(n);return{arrayValue:{values:t}}}class Gu extends Lp{constructor(e){super(),this.elements=e}}function RI(r,e){let t=DI(e);for(const n of r.elements)t=t.filter((a=>!Wi(a,n)));return{arrayValue:{values:t}}}class Yh extends Lp{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function uS(r){return _r(r.integerValue||r.doubleValue)}function DI(r){return Wh(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NI{constructor(e,t){this.field=e,this.transform=t}}function TM(r,e){return r.field.isEqual(e.field)&&(function(n,a){return n instanceof Hu&&a instanceof Hu||n instanceof Gu&&a instanceof Gu?Ou(n.elements,a.elements,Wi):n instanceof Yh&&a instanceof Yh?Wi(n.Ae,a.Ae):n instanceof ju&&a instanceof ju})(r.transform,e.transform)}class EM{constructor(e,t){this.version=e,this.transformResults=t}}class Sa{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Sa}static exists(e){return new Sa(void 0,e)}static updateTime(e){return new Sa(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Cm(r,e){return r.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(r.updateTime):r.exists===void 0||r.exists===e.isFoundDocument()}class Vp{}function OI(r,e){if(!r.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return r.isNoDocument()?new s_(r.key,Sa.none()):new tf(r.key,r.data,Sa.none());{const t=r.data,n=na.empty();let a=new Jt(Er.comparator);for(let s of e.fields)if(!a.has(s)){let l=t.field(s);l===null&&s.length>1&&(s=s.popLast(),l=t.field(s)),l===null?n.delete(s):n.set(s,l),a=a.add(s)}return new Xo(r.key,n,new $a(a.toArray()),Sa.none())}}function wM(r,e,t){r instanceof tf?(function(a,s,l){const u=a.value.clone(),f=hS(a.fieldTransforms,s,l.transformResults);u.setAll(f),s.convertToFoundDocument(l.version,u).setHasCommittedMutations()})(r,e,t):r instanceof Xo?(function(a,s,l){if(!Cm(a.precondition,s))return void s.convertToUnknownDocument(l.version);const u=hS(a.fieldTransforms,s,l.transformResults),f=s.data;f.setAll(FI(a)),f.setAll(u),s.convertToFoundDocument(l.version,f).setHasCommittedMutations()})(r,e,t):(function(a,s,l){s.convertToNoDocument(l.version).setHasCommittedMutations()})(0,e,t)}function Ch(r,e,t,n){return r instanceof tf?(function(s,l,u,f){if(!Cm(s.precondition,l))return u;const d=s.value.clone(),m=dS(s.fieldTransforms,f,l);return d.setAll(m),l.convertToFoundDocument(l.version,d).setHasLocalMutations(),null})(r,e,t,n):r instanceof Xo?(function(s,l,u,f){if(!Cm(s.precondition,l))return u;const d=dS(s.fieldTransforms,f,l),m=l.data;return m.setAll(FI(s)),m.setAll(d),l.convertToFoundDocument(l.version,m).setHasLocalMutations(),u===null?null:u.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((x=>x.field)))})(r,e,t,n):(function(s,l,u){return Cm(s.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):u})(r,e,t)}function SM(r,e){let t=null;for(const n of r.fieldTransforms){const a=e.data.field(n.field),s=kI(n.transform,a||null);s!=null&&(t===null&&(t=na.empty()),t.set(n.field,s))}return t||null}function fS(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&!!(function(n,a){return n===void 0&&a===void 0||!(!n||!a)&&Ou(n,a,((s,l)=>TM(s,l)))})(r.fieldTransforms,e.fieldTransforms)&&(r.type===0?r.value.isEqual(e.value):r.type!==1||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask))}class tf extends Vp{constructor(e,t,n,a=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class Xo extends Vp{constructor(e,t,n,a,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=a,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function FI(r){const e=new Map;return r.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const n=r.data.field(t);e.set(t,n)}})),e}function hS(r,e,t){const n=new Map;Je(r.length===t.length,32656,{Re:t.length,Ve:r.length});for(let a=0;a<t.length;a++){const s=r[a],l=s.transform,u=e.data.field(s.field);n.set(s.field,yM(l,u,t[a]))}return n}function dS(r,e,t){const n=new Map;for(const a of r){const s=a.transform,l=t.data.field(a.field);n.set(a.field,_M(s,l,e))}return n}class s_ extends Vp{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class MI extends Vp{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o_{constructor(e,t,n,a){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=a}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let a=0;a<this.mutations.length;a++){const s=this.mutations[a];s.key.isEqual(e.key)&&wM(s,e,n[a])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Ch(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Ch(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=bI();return this.mutations.forEach((a=>{const s=e.get(a.key),l=s.overlayedDocument;let u=this.applyToLocalView(l,s.mutatedFields);u=t.has(a.key)?null:u;const f=OI(l,u);f!==null&&n.set(a.key,f),l.isValidDocument()||l.convertToNoDocument(tt.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),yt())}isEqual(e){return this.batchId===e.batchId&&Ou(this.mutations,e.mutations,((t,n)=>fS(t,n)))&&Ou(this.baseMutations,e.baseMutations,((t,n)=>fS(t,n)))}}class l_{constructor(e,t,n,a){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=a}static from(e,t,n){Je(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let a=(function(){return mM})();const s=e.mutations;for(let l=0;l<s.length;l++)a=a.insert(s[l].key,n[l].version);return new l_(e,t,n,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c_{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AM{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var qr,Ct;function bM(r){switch(r){case ke.OK:return Ye(64938);case ke.CANCELLED:case ke.UNKNOWN:case ke.DEADLINE_EXCEEDED:case ke.RESOURCE_EXHAUSTED:case ke.INTERNAL:case ke.UNAVAILABLE:case ke.UNAUTHENTICATED:return!1;case ke.INVALID_ARGUMENT:case ke.NOT_FOUND:case ke.ALREADY_EXISTS:case ke.PERMISSION_DENIED:case ke.FAILED_PRECONDITION:case ke.ABORTED:case ke.OUT_OF_RANGE:case ke.UNIMPLEMENTED:case ke.DATA_LOSS:return!0;default:return Ye(15467,{code:r})}}function PI(r){if(r===void 0)return Hn("GRPC error has no .code"),ke.UNKNOWN;switch(r){case qr.OK:return ke.OK;case qr.CANCELLED:return ke.CANCELLED;case qr.UNKNOWN:return ke.UNKNOWN;case qr.DEADLINE_EXCEEDED:return ke.DEADLINE_EXCEEDED;case qr.RESOURCE_EXHAUSTED:return ke.RESOURCE_EXHAUSTED;case qr.INTERNAL:return ke.INTERNAL;case qr.UNAVAILABLE:return ke.UNAVAILABLE;case qr.UNAUTHENTICATED:return ke.UNAUTHENTICATED;case qr.INVALID_ARGUMENT:return ke.INVALID_ARGUMENT;case qr.NOT_FOUND:return ke.NOT_FOUND;case qr.ALREADY_EXISTS:return ke.ALREADY_EXISTS;case qr.PERMISSION_DENIED:return ke.PERMISSION_DENIED;case qr.FAILED_PRECONDITION:return ke.FAILED_PRECONDITION;case qr.ABORTED:return ke.ABORTED;case qr.OUT_OF_RANGE:return ke.OUT_OF_RANGE;case qr.UNIMPLEMENTED:return ke.UNIMPLEMENTED;case qr.DATA_LOSS:return ke.DATA_LOSS;default:return Ye(39323,{code:r})}}(Ct=qr||(qr={}))[Ct.OK=0]="OK",Ct[Ct.CANCELLED=1]="CANCELLED",Ct[Ct.UNKNOWN=2]="UNKNOWN",Ct[Ct.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ct[Ct.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ct[Ct.NOT_FOUND=5]="NOT_FOUND",Ct[Ct.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ct[Ct.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ct[Ct.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ct[Ct.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ct[Ct.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ct[Ct.ABORTED=10]="ABORTED",Ct[Ct.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ct[Ct.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ct[Ct.INTERNAL=13]="INTERNAL",Ct[Ct.UNAVAILABLE=14]="UNAVAILABLE",Ct[Ct.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IM(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kM=new Mo([4294967295,4294967295],0);function mS(r){const e=IM().encode(r),t=new M4;return t.update(e),new Uint8Array(t.digest())}function pS(r){const e=new DataView(r.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),a=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Mo([t,n],0),new Mo([a,s],0)]}class u_{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new mh(`Invalid padding: ${t}`);if(n<0)throw new mh(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new mh(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new mh(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Mo.fromNumber(this.ge)}ye(e,t,n){let a=e.add(t.multiply(Mo.fromNumber(n)));return a.compare(kM)===1&&(a=new Mo([a.getBits(0),a.getBits(1)],0)),a.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=mS(e),[n,a]=pS(t);for(let s=0;s<this.hashCount;s++){const l=this.ye(n,a,s);if(!this.we(l))return!1}return!0}static create(e,t,n){const a=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),l=new u_(s,a,t);return n.forEach((u=>l.insert(u))),l}insert(e){if(this.ge===0)return;const t=mS(e),[n,a]=pS(t);for(let s=0;s<this.hashCount;s++){const l=this.ye(n,a,s);this.Se(l)}}Se(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class mh extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bp{constructor(e,t,n,a,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=a,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const a=new Map;return a.set(e,T0.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Bp(tt.min(),a,new yr(ut),wa(),yt())}}class T0{constructor(e,t,n,a,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=a,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new T0(n,t,yt(),yt(),yt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rm{constructor(e,t,n,a){this.be=e,this.removedTargetIds=t,this.key=n,this.De=a}}class LI{constructor(e,t){this.targetId=e,this.Ce=t}}class VI{constructor(e,t,n=Yr.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=a}}class gS{constructor(){this.ve=0,this.Fe=xS(),this.Me=Yr.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=yt(),t=yt(),n=yt();return this.Fe.forEach(((a,s)=>{switch(s){case 0:e=e.add(a);break;case 2:t=t.add(a);break;case 1:n=n.add(a);break;default:Ye(38017,{changeType:s})}})),new T0(this.Me,this.xe,e,t,n)}qe(){this.Oe=!1,this.Fe=xS()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Je(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class CM{constructor(e){this.Ge=e,this.ze=new Map,this.je=wa(),this.Je=em(),this.He=em(),this.Ye=new yr(ut)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:Ye(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((n,a)=>{this.rt(a)&&t(a)}))}st(e){const t=e.targetId,n=e.Ce.count,a=this.ot(t);if(a){const s=a.target;if($m(s))if(n===0){const l=new qe(s.path);this.et(t,l,Rr.newNoDocument(l,tt.min()))}else Je(n===1,20013,{expectedCount:n});else{const l=this._t(t);if(l!==n){const u=this.ut(e),f=u?this.ct(u,e,l):1;if(f!==0){this.it(t);const d=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,d)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:a=0},hashCount:s=0}=t;let l,u;try{l=Ms(n).toUint8Array()}catch(f){if(f instanceof sI)return Yl("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{u=new u_(l,a,s)}catch(f){return Yl(f instanceof mh?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return u.ge===0?null:u}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let a=0;return n.forEach((s=>{const l=this.Ge.ht(),u=`projects/${l.projectId}/databases/${l.database}/documents/${s.path.canonicalString()}`;e.mightContain(u)||(this.et(t,s,null),a++)})),a}Tt(e){const t=new Map;this.ze.forEach(((s,l)=>{const u=this.ot(l);if(u){if(s.current&&$m(u.target)){const f=new qe(u.target.path);this.It(f).has(l)||this.Et(l,f)||this.et(l,f,Rr.newNoDocument(f,e))}s.Be&&(t.set(l,s.ke()),s.qe())}}));let n=yt();this.He.forEach(((s,l)=>{let u=!0;l.forEachWhile((f=>{const d=this.ot(f);return!d||d.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)})),u&&(n=n.add(s))})),this.je.forEach(((s,l)=>l.setReadTime(e)));const a=new Bp(e,t,this.Ye,this.je,n);return this.je=wa(),this.Je=em(),this.He=em(),this.Ye=new yr(ut),a}Xe(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,n),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const a=this.nt(e);this.Et(e,t)?a.Qe(t,1):a.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new gS,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Jt(ut),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Jt(ut),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Le("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new gS),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function em(){return new yr(qe.comparator)}function xS(){return new yr(qe.comparator)}const RM={asc:"ASCENDING",desc:"DESCENDING"},DM={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},NM={and:"AND",or:"OR"};class OM{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function ev(r,e){return r.useProto3Json||Cp(e)?e:{value:e}}function qu(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function BI(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function FM(r,e){return qu(r,e.toTimestamp())}function qn(r){return Je(!!r,49232),tt.fromTimestamp((function(t){const n=Fs(t);return new $t(n.seconds,n.nanos)})(r))}function f_(r,e){return tv(r,e).canonicalString()}function tv(r,e){const t=(function(a){return new nr(["projects",a.projectId,"databases",a.database])})(r).child("documents");return e===void 0?t:t.child(e)}function UI(r){const e=nr.fromString(r);return Je(YI(e),10190,{key:e.toString()}),e}function Jm(r,e){return f_(r.databaseId,e.path)}function Bl(r,e){const t=UI(e);if(t.get(1)!==r.databaseId.projectId)throw new Ke(ke.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+r.databaseId.projectId);if(t.get(3)!==r.databaseId.database)throw new Ke(ke.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+r.databaseId.database);return new qe(HI(t))}function zI(r,e){return f_(r.databaseId,e)}function jI(r){const e=UI(r);return e.length===4?nr.emptyPath():HI(e)}function rv(r){return new nr(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function HI(r){return Je(r.length>4&&r.get(4)==="documents",29091,{key:r.toString()}),r.popFirst(5)}function vS(r,e,t){return{name:Jm(r,e),fields:t.value.mapValue.fields}}function MM(r,e,t){const n=Bl(r,e.name),a=qn(e.updateTime),s=e.createTime?qn(e.createTime):tt.min(),l=new na({mapValue:{fields:e.fields}}),u=Rr.newFoundDocument(n,a,s,l);return t&&u.setHasCommittedMutations(),t?u.setHasCommittedMutations():u}function PM(r,e){let t;if("targetChange"in e){e.targetChange;const n=(function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:Ye(39313,{state:d})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],s=(function(d,m){return d.useProto3Json?(Je(m===void 0||typeof m=="string",58123),Yr.fromBase64String(m||"")):(Je(m===void 0||m instanceof Buffer||m instanceof Uint8Array,16193),Yr.fromUint8Array(m||new Uint8Array))})(r,e.targetChange.resumeToken),l=e.targetChange.cause,u=l&&(function(d){const m=d.code===void 0?ke.UNKNOWN:PI(d.code);return new Ke(m,d.message||"")})(l);t=new VI(n,a,s,u||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const a=Bl(r,n.document.name),s=qn(n.document.updateTime),l=n.document.createTime?qn(n.document.createTime):tt.min(),u=new na({mapValue:{fields:n.document.fields}}),f=Rr.newFoundDocument(a,s,l,u),d=n.targetIds||[],m=n.removedTargetIds||[];t=new Rm(d,m,f.key,f)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const a=Bl(r,n.document),s=n.readTime?qn(n.readTime):tt.min(),l=Rr.newNoDocument(a,s),u=n.removedTargetIds||[];t=new Rm([],u,l.key,l)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const a=Bl(r,n.document),s=n.removedTargetIds||[];t=new Rm([],s,a,null)}else{if(!("filter"in e))return Ye(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:a=0,unchangedNames:s}=n,l=new AM(a,s),u=n.targetId;t=new LI(u,l)}}return t}function Zm(r,e){let t;if(e instanceof tf)t={update:vS(r,e.key,e.value)};else if(e instanceof s_)t={delete:Jm(r,e.key)};else if(e instanceof Xo)t={update:vS(r,e.key,e.data),updateMask:jM(e.fieldMask)};else{if(!(e instanceof MI))return Ye(16599,{Vt:e.type});t={verify:Jm(r,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((n=>(function(s,l){const u=l.transform;if(u instanceof ju)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof Hu)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof Gu)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof Yh)return{fieldPath:l.field.canonicalString(),increment:u.Ae};throw Ye(20930,{transform:l.transform})})(0,n)))),e.precondition.isNone||(t.currentDocument=(function(a,s){return s.updateTime!==void 0?{updateTime:FM(a,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Ye(27497)})(r,e.precondition)),t}function nv(r,e){const t=e.currentDocument?(function(s){return s.updateTime!==void 0?Sa.updateTime(qn(s.updateTime)):s.exists!==void 0?Sa.exists(s.exists):Sa.none()})(e.currentDocument):Sa.none(),n=e.updateTransforms?e.updateTransforms.map((a=>(function(l,u){let f=null;if("setToServerValue"in u)Je(u.setToServerValue==="REQUEST_TIME",16630,{proto:u}),f=new ju;else if("appendMissingElements"in u){const m=u.appendMissingElements.values||[];f=new Hu(m)}else if("removeAllFromArray"in u){const m=u.removeAllFromArray.values||[];f=new Gu(m)}else"increment"in u?f=new Yh(l,u.increment):Ye(16584,{proto:u});const d=Er.fromServerFormat(u.fieldPath);return new NI(d,f)})(r,a))):[];if(e.update){e.update.name;const a=Bl(r,e.update.name),s=new na({mapValue:{fields:e.update.fields}});if(e.updateMask){const l=(function(f){const d=f.fieldPaths||[];return new $a(d.map((m=>Er.fromServerFormat(m))))})(e.updateMask);return new Xo(a,s,l,t,n)}return new tf(a,s,t,n)}if(e.delete){const a=Bl(r,e.delete);return new s_(a,t)}if(e.verify){const a=Bl(r,e.verify);return new MI(a,t)}return Ye(1463,{proto:e})}function LM(r,e){return r&&r.length>0?(Je(e!==void 0,14353),r.map((t=>(function(a,s){let l=a.updateTime?qn(a.updateTime):qn(s);return l.isEqual(tt.min())&&(l=qn(s)),new EM(l,a.transformResults||[])})(t,e)))):[]}function GI(r,e){return{documents:[zI(r,e.path)]}}function qI(r,e){const t={structuredQuery:{}},n=e.path;let a;e.collectionGroup!==null?(a=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=zI(r,a);const s=(function(d){if(d.length!==0)return WI(ar.create(d,"and"))})(e.filters);s&&(t.structuredQuery.where=s);const l=(function(d){if(d.length!==0)return d.map((m=>(function(_){return{field:pu(_.field),direction:BM(_.dir)}})(m)))})(e.orderBy);l&&(t.structuredQuery.orderBy=l);const u=ev(r,e.limit);return u!==null&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt=(function(d){return{before:d.inclusive,values:d.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(d){return{before:!d.inclusive,values:d.position}})(e.endAt)),{ft:t,parent:a}}function KI(r){let e=jI(r.parent);const t=r.structuredQuery,n=t.from?t.from.length:0;let a=null;if(n>0){Je(n===1,65062);const m=t.from[0];m.allDescendants?a=m.collectionId:e=e.child(m.collectionId)}let s=[];t.where&&(s=(function(x){const _=XI(x);return _ instanceof ar&&a_(_)?_.getFilters():[_]})(t.where));let l=[];t.orderBy&&(l=(function(x){return x.map((_=>(function(w){return new Ym(gu(w.field),(function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(w.direction))})(_)))})(t.orderBy));let u=null;t.limit&&(u=(function(x){let _;return _=typeof x=="object"?x.value:x,Cp(_)?null:_})(t.limit));let f=null;t.startAt&&(f=(function(x){const _=!!x.before,y=x.values||[];return new Uu(y,_)})(t.startAt));let d=null;return t.endAt&&(d=(function(x){const _=!x.before,y=x.values||[];return new Uu(y,_)})(t.endAt)),lM(e,a,l,s,u,"F",f,d)}function VM(r,e){const t=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ye(28987,{purpose:a})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function XI(r){return r.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=gu(t.unaryFilter.field);return kt.create(n,"==",{doubleValue:NaN});case"IS_NULL":const a=gu(t.unaryFilter.field);return kt.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=gu(t.unaryFilter.field);return kt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=gu(t.unaryFilter.field);return kt.create(l,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ye(61313);default:return Ye(60726)}})(r):r.fieldFilter!==void 0?(function(t){return kt.create(gu(t.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ye(58110);default:return Ye(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(r):r.compositeFilter!==void 0?(function(t){return ar.create(t.compositeFilter.filters.map((n=>XI(n))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return Ye(1026)}})(t.compositeFilter.op))})(r):Ye(30097,{filter:r})}function BM(r){return RM[r]}function UM(r){return DM[r]}function zM(r){return NM[r]}function pu(r){return{fieldPath:r.canonicalString()}}function gu(r){return Er.fromServerFormat(r.fieldPath)}function WI(r){return r instanceof kt?(function(t){if(t.op==="=="){if(rS(t.value))return{unaryFilter:{field:pu(t.field),op:"IS_NAN"}};if(tS(t.value))return{unaryFilter:{field:pu(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(rS(t.value))return{unaryFilter:{field:pu(t.field),op:"IS_NOT_NAN"}};if(tS(t.value))return{unaryFilter:{field:pu(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:pu(t.field),op:UM(t.op),value:t.value}}})(r):r instanceof ar?(function(t){const n=t.getFilters().map((a=>WI(a)));return n.length===1?n[0]:{compositeFilter:{op:zM(t.op),filters:n}}})(r):Ye(54877,{filter:r})}function jM(r){const e=[];return r.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function YI(r){return r.length>=4&&r.get(0)==="projects"&&r.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As{constructor(e,t,n,a,s=tt.min(),l=tt.min(),u=Yr.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=a,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=u,this.expectedCount=f}withSequenceNumber(e){return new As(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new As(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new As(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new As(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $I{constructor(e){this.yt=e}}function HM(r,e){let t;if(e.document)t=MM(r.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const n=qe.fromSegments(e.noDocument.path),a=Zl(e.noDocument.readTime);t=Rr.newNoDocument(n,a),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Ye(56709);{const n=qe.fromSegments(e.unknownDocument.path),a=Zl(e.unknownDocument.version);t=Rr.newUnknownDocument(n,a)}}return e.readTime&&t.setReadTime((function(a){const s=new $t(a[0],a[1]);return tt.fromTimestamp(s)})(e.readTime)),t}function _S(r,e){const t=e.key,n={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:ep(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document=(function(s,l){return{name:Jm(s,l.key),fields:l.data.value.mapValue.fields,updateTime:qu(s,l.version.toTimestamp()),createTime:qu(s,l.createTime.toTimestamp())}})(r.yt,e);else if(e.isNoDocument())n.noDocument={path:t.path.toArray(),readTime:Jl(e.version)};else{if(!e.isUnknownDocument())return Ye(57904,{document:e});n.unknownDocument={path:t.path.toArray(),version:Jl(e.version)}}return n}function ep(r){const e=r.toTimestamp();return[e.seconds,e.nanoseconds]}function Jl(r){const e=r.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Zl(r){const e=new $t(r.seconds,r.nanoseconds);return tt.fromTimestamp(e)}function kl(r,e){const t=(e.baseMutations||[]).map((s=>nv(r.yt,s)));for(let s=0;s<e.mutations.length-1;++s){const l=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const u=e.mutations[s+1];l.updateTransforms=u.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const n=e.mutations.map((s=>nv(r.yt,s))),a=$t.fromMillis(e.localWriteTimeMs);return new o_(e.batchId,a,t,n)}function ph(r){const e=Zl(r.readTime),t=r.lastLimboFreeSnapshotVersion!==void 0?Zl(r.lastLimboFreeSnapshotVersion):tt.min();let n;return n=(function(s){return s.documents!==void 0})(r.query)?(function(s){const l=s.documents.length;return Je(l===1,1966,{count:l}),Ja(_0(jI(s.documents[0])))})(r.query):(function(s){return Ja(KI(s))})(r.query),new As(n,r.targetId,"TargetPurposeListen",r.lastListenSequenceNumber,e,t,Yr.fromBase64String(r.resumeToken))}function QI(r,e){const t=Jl(e.snapshotVersion),n=Jl(e.lastLimboFreeSnapshotVersion);let a;a=$m(e.target)?GI(r.yt,e.target):qI(r.yt,e.target).ft;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Ql(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:a}}function JI(r){const e=KI({parent:r.parent,structuredQuery:r.structuredQuery});return r.limitType==="LAST"?Zx(e,e.limit,"L"):e}function hx(r,e){return new c_(e.largestBatchId,nv(r.yt,e.overlayMutation))}function yS(r,e){const t=e.path.lastSegment();return[r,Nn(e.path.popLast()),t]}function TS(r,e,t,n){return{indexId:r,uid:e,sequenceNumber:t,readTime:Jl(n.readTime),documentKey:Nn(n.documentKey.path),largestBatchId:n.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GM{getBundleMetadata(e,t){return ES(e).get(t).next((n=>{if(n)return(function(s){return{id:s.bundleId,createTime:Zl(s.createTime),version:s.version}})(n)}))}saveBundleMetadata(e,t){return ES(e).put((function(a){return{bundleId:a.id,createTime:Jl(qn(a.createTime)),version:a.version}})(t))}getNamedQuery(e,t){return wS(e).get(t).next((n=>{if(n)return(function(s){return{name:s.name,query:JI(s.bundledQuery),readTime:Zl(s.readTime)}})(n)}))}saveNamedQuery(e,t){return wS(e).put((function(a){return{name:a.name,readTime:Jl(qn(a.readTime)),bundledQuery:a.bundledQuery}})(t))}}function ES(r){return tn(r,Rp)}function wS(r){return tn(r,Dp)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Up{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const n=t.uid||"";return new Up(e,n)}getOverlay(e,t){return ih(e).get(yS(this.userId,t)).next((n=>n?hx(this.serializer,n):null))}getOverlays(e,t){const n=zi();return oe.forEach(t,(a=>this.getOverlay(e,a).next((s=>{s!==null&&n.set(a,s)})))).next((()=>n))}saveOverlays(e,t,n){const a=[];return n.forEach(((s,l)=>{const u=new c_(t,l);a.push(this.St(e,u))})),oe.waitFor(a)}removeOverlaysForBatchId(e,t,n){const a=new Set;t.forEach((l=>a.add(Nn(l.getCollectionPath()))));const s=[];return a.forEach((l=>{const u=IDBKeyRange.bound([this.userId,l,n],[this.userId,l,n+1],!1,!0);s.push(ih(e).Z(Kx,u))})),oe.waitFor(s)}getOverlaysForCollection(e,t,n){const a=zi(),s=Nn(t),l=IDBKeyRange.bound([this.userId,s,n],[this.userId,s,Number.POSITIVE_INFINITY],!0);return ih(e).J(Kx,l).next((u=>{for(const f of u){const d=hx(this.serializer,f);a.set(d.getKey(),d)}return a}))}getOverlaysForCollectionGroup(e,t,n,a){const s=zi();let l;const u=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return ih(e).ee({index:eI,range:u},((f,d,m)=>{const x=hx(this.serializer,d);s.size()<a||x.largestBatchId===l?(s.set(x.getKey(),x),l=x.largestBatchId):m.done()})).next((()=>s))}St(e,t){return ih(e).put((function(a,s,l){const[u,f,d]=yS(s,l.mutation.key);return{userId:s,collectionPath:f,documentId:d,collectionGroup:l.mutation.key.getCollectionGroup(),largestBatchId:l.largestBatchId,overlayMutation:Zm(a.yt,l.mutation)}})(this.serializer,this.userId,t))}}function ih(r){return tn(r,Np)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qM{bt(e){return tn(e,Jv)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const n=t==null?void 0:t.value;return n?Yr.fromUint8Array(n):Yr.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cl{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(_r(e.integerValue));else if("doubleValue"in e){const n=_r(e.doubleValue);isNaN(n)?this.Ft(t,13):(this.Ft(t,15),jh(n)?t.Mt(0):t.Mt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Ft(t,20),typeof n=="string"&&(n=Fs(n)),t.xt(`${n.seconds||""}`),t.Mt(n.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Ms(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Ft(t,45),t.Mt(n.latitude||0),t.Mt(n.longitude||0)}else"mapValue"in e?hI(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):Fp(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Ye(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const n=e.fields||{};this.Ft(t,55);for(const a of Object.keys(n))this.Ot(a,t),this.Ct(n[a],t)}kt(e,t){var l,u;const n=e.fields||{};this.Ft(t,53);const a=Vu,s=((u=(l=n[a].arrayValue)==null?void 0:l.values)==null?void 0:u.length)||0;this.Ft(t,15),t.Mt(_r(s)),this.Ot(a,t),this.Ct(n[a],t)}Qt(e,t){const n=e.values||[];this.Ft(t,50);for(const a of n)this.Ct(a,t)}Lt(e,t){this.Ft(t,37),qe.fromName(e).path.forEach((n=>{this.Ft(t,60),this.Ut(n,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}Cl.Kt=new Cl;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const su=255;function KM(r){if(r===0)return 8;let e=0;return r>>4||(e+=4,r<<=4),r>>6||(e+=2,r<<=2),r>>7||(e+=1),e}function SS(r){const e=64-(function(n){let a=0;for(let s=0;s<8;++s){const l=KM(255&n[s]);if(a+=l,l!==8)break}return a})(r);return Math.ceil(e/8)}class XM{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Gt(n.value),n=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Jt(n.value),n=t.next();this.Ht()}Yt(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.Gt(n);else if(n<2048)this.Gt(960|n>>>6),this.Gt(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|n>>>12),this.Gt(128|63&n>>>6),this.Gt(128|63&n);else{const a=t.codePointAt(0);this.Gt(240|a>>>18),this.Gt(128|63&a>>>12),this.Gt(128|63&a>>>6),this.Gt(128|63&a)}}this.zt()}Zt(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.Jt(n);else if(n<2048)this.Jt(960|n>>>6),this.Jt(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|n>>>12),this.Jt(128|63&n>>>6),this.Jt(128|63&n);else{const a=t.codePointAt(0);this.Jt(240|a>>>18),this.Jt(128|63&a>>>12),this.Jt(128|63&a>>>6),this.Jt(128|63&a)}}this.Ht()}Xt(e){const t=this.en(e),n=SS(t);this.tn(1+n),this.buffer[this.position++]=255&n;for(let a=t.length-n;a<t.length;++a)this.buffer[this.position++]=255&t[a]}nn(e){const t=this.en(e),n=SS(t);this.tn(1+n),this.buffer[this.position++]=~(255&n);for(let a=t.length-n;a<t.length;++a)this.buffer[this.position++]=~(255&t[a])}rn(){this.sn(su),this.sn(255)}_n(){this.an(su),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(s){const l=new DataView(new ArrayBuffer(8));return l.setFloat64(0,s,!1),new Uint8Array(l.buffer)})(e),n=!!(128&t[0]);t[0]^=n?255:128;for(let a=1;a<t.length;++a)t[a]^=n?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===su?(this.sn(su),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===su?(this.an(su),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const a=new Uint8Array(n);a.set(this.buffer),this.buffer=a}}class WM{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class YM{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class sh{constructor(){this.cn=new XM,this.ln=new WM(this.cn),this.hn=new YM(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rl{constructor(e,t,n,a){this.Tn=e,this.In=t,this.En=n,this.dn=a}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,n=new Uint8Array(t);return n.set(this.dn,0),t!==e?n.set([0],this.dn.length):++n[n.length-1],new Rl(this.Tn,this.In,this.En,n)}Rn(e,t,n){return{indexId:this.Tn,uid:e,arrayValue:Dm(this.En),directionalValue:Dm(this.dn),orderedDocumentKey:Dm(t),documentKey:n.path.toArray()}}Vn(e,t,n){const a=this.Rn(e,t,n);return[a.indexId,a.uid,a.arrayValue,a.directionalValue,a.orderedDocumentKey,a.documentKey]}}function To(r,e){let t=r.Tn-e.Tn;return t!==0?t:(t=AS(r.En,e.En),t!==0?t:(t=AS(r.dn,e.dn),t!==0?t:qe.comparator(r.In,e.In)))}function AS(r,e){for(let t=0;t<r.length&&t<e.length;++t){const n=r[t]-e[t];if(n!==0)return n}return r.length-e.length}function Dm(r){return Rb()?(function(t){let n="";for(let a=0;a<t.length;a++)n+=String.fromCharCode(t[a]);return n})(r):r}function bS(r){return typeof r!="string"?r:(function(t){const n=new Uint8Array(t.length);for(let a=0;a<t.length;a++)n[a]=t.charCodeAt(a);return n})(r)}class IS{constructor(e){this.mn=new Jt(((t,n)=>Er.comparator(t.field,n.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const n=t;n.isInequality()?this.mn=this.mn.add(n):this.gn.push(n)}}get pn(){return this.mn.size>1}yn(e){if(Je(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=Hx(e);if(t!==void 0&&!this.wn(t))return!1;const n=Al(e);let a=new Set,s=0,l=0;for(;s<n.length&&this.wn(n[s]);++s)a=a.add(n[s].fieldPath.canonicalString());if(s===n.length)return!0;if(this.mn.size>0){const u=this.mn.getIterator().getNext();if(!a.has(u.field.canonicalString())){const f=n[s];if(!this.Sn(u,f)||!this.bn(this.fn[l++],f))return!1}++s}for(;s<n.length;++s){const u=n[s];if(l>=this.fn.length||!this.bn(this.fn[l++],u))return!1}return!0}Dn(){if(this.pn)return null;let e=new Jt(Er.comparator);const t=[];for(const n of this.gn)if(!n.field.isKeyField())if(n.op==="array-contains"||n.op==="array-contains-any")t.push(new wm(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new wm(n.field,0))}for(const n of this.fn)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new wm(n.field,n.dir==="asc"?0:1)));return new Gm(Gm.UNKNOWN_ID,this.collectionId,t,zh.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const n=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===n}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZI(r){var t,n;if(Je(r instanceof kt||r instanceof ar,20012),r instanceof kt){if(r instanceof TI){const a=((n=(t=r.value.arrayValue)==null?void 0:t.values)==null?void 0:n.map((s=>kt.create(r.field,"==",s))))||[];return ar.create(a,"or")}return r}const e=r.filters.map((a=>ZI(a)));return ar.create(e,r.op)}function $M(r){if(r.getFilters().length===0)return[];const e=sv(ZI(r));return Je(ek(e),7391),av(e)||iv(e)?[e]:e.getFilters()}function av(r){return r instanceof kt}function iv(r){return r instanceof ar&&a_(r)}function ek(r){return av(r)||iv(r)||(function(t){if(t instanceof ar&&$x(t)){for(const n of t.getFilters())if(!av(n)&&!iv(n))return!1;return!0}return!1})(r)}function sv(r){if(Je(r instanceof kt||r instanceof ar,34018),r instanceof kt)return r;if(r.filters.length===1)return sv(r.filters[0]);const e=r.filters.map((n=>sv(n)));let t=ar.create(e,r.op);return t=tp(t),ek(t)?t:(Je(t instanceof ar,64498),Je(zu(t),40251),Je(t.filters.length>1,57927),t.filters.reduce(((n,a)=>h_(n,a))))}function h_(r,e){let t;return Je(r instanceof kt||r instanceof ar,38388),Je(e instanceof kt||e instanceof ar,25473),t=r instanceof kt?e instanceof kt?(function(a,s){return ar.create([a,s],"and")})(r,e):kS(r,e):e instanceof kt?kS(e,r):(function(a,s){if(Je(a.filters.length>0&&s.filters.length>0,48005),zu(a)&&zu(s))return vI(a,s.getFilters());const l=$x(a)?a:s,u=$x(a)?s:a,f=l.filters.map((d=>h_(d,u)));return ar.create(f,"or")})(r,e),tp(t)}function kS(r,e){if(zu(e))return vI(e,r.getFilters());{const t=e.filters.map((n=>h_(r,n)));return ar.create(t,"or")}}function tp(r){if(Je(r instanceof kt||r instanceof ar,11850),r instanceof kt)return r;const e=r.getFilters();if(e.length===1)return tp(e[0]);if(gI(r))return r;const t=e.map((a=>tp(a))),n=[];return t.forEach((a=>{a instanceof kt?n.push(a):a instanceof ar&&(a.op===r.op?n.push(...a.filters):n.push(a))})),n.length===1?n[0]:ar.create(n,r.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QM{constructor(){this.Cn=new d_}addToCollectionParentIndex(e,t){return this.Cn.add(t),oe.resolve()}getCollectionParents(e,t){return oe.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return oe.resolve()}deleteFieldIndex(e,t){return oe.resolve()}deleteAllFieldIndexes(e){return oe.resolve()}createTargetIndexes(e,t){return oe.resolve()}getDocumentsMatchingTarget(e,t){return oe.resolve(null)}getIndexType(e,t){return oe.resolve(0)}getFieldIndexes(e,t){return oe.resolve([])}getNextCollectionGroupToUpdate(e){return oe.resolve(null)}getMinOffset(e,t){return oe.resolve(ba.min())}getMinOffsetFromCollectionGroup(e,t){return oe.resolve(ba.min())}updateCollectionGroup(e,t,n){return oe.resolve()}updateIndexEntries(e,t){return oe.resolve()}}class d_{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),a=this.index[t]||new Jt(nr.comparator),s=!a.has(n);return this.index[t]=a.add(n),s}has(e){const t=e.lastSegment(),n=e.popLast(),a=this.index[t];return a&&a.has(n)}getEntries(e){return(this.index[e]||new Jt(nr.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CS="IndexedDbIndexManager",tm=new Uint8Array(0);class JM{constructor(e,t){this.databaseId=t,this.vn=new d_,this.Fn=new Ls((n=>Ql(n)),((n,a)=>v0(n,a))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const n=t.lastSegment(),a=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const s={collectionId:n,parent:Nn(a)};return RS(e).put(s)}return oe.resolve()}getCollectionParents(e,t){const n=[],a=IDBKeyRange.bound([t,""],[H4(t),""],!1,!0);return RS(e).J(a).next((s=>{for(const l of s){if(l.collectionId!==t)break;n.push(Ui(l.parent))}return n}))}addFieldIndex(e,t){const n=oh(e),a=(function(u){return{indexId:u.indexId,collectionGroup:u.collectionGroup,fields:u.fields.map((f=>[f.fieldPath.canonicalString(),f.kind]))}})(t);delete a.indexId;const s=n.add(a);if(t.indexState){const l=lu(e);return s.next((u=>{l.put(TS(u,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return s.next()}deleteFieldIndex(e,t){const n=oh(e),a=lu(e),s=ou(e);return n.delete(t.indexId).next((()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=oh(e),n=ou(e),a=lu(e);return t.Z().next((()=>n.Z())).next((()=>a.Z()))}createTargetIndexes(e,t){return oe.forEach(this.Mn(t),(n=>this.getIndexType(e,n).next((a=>{if(a===0||a===1){const s=new IS(n).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))))}getDocumentsMatchingTarget(e,t){const n=ou(e);let a=!0;const s=new Map;return oe.forEach(this.Mn(t),(l=>this.xn(e,l).next((u=>{a&&(a=!!u),s.set(l,u)})))).next((()=>{if(a){let l=yt();const u=[];return oe.forEach(s,((f,d)=>{Le(CS,`Using index ${(function(R){return`id=${R.indexId}|cg=${R.collectionGroup}|f=${R.fields.map((Y=>`${Y.fieldPath}:${Y.kind}`)).join(",")}`})(f)} to execute ${Ql(t)}`);const m=(function(R,Y){const te=Hx(Y);if(te===void 0)return null;for(const G of Qm(R,te.fieldPath))switch(G.op){case"array-contains-any":return G.value.arrayValue.values||[];case"array-contains":return[G.value]}return null})(d,f),x=(function(R,Y){const te=new Map;for(const G of Al(Y))for(const A of Qm(R,G.fieldPath))switch(A.op){case"==":case"in":te.set(G.fieldPath.canonicalString(),A.value);break;case"not-in":case"!=":return te.set(G.fieldPath.canonicalString(),A.value),Array.from(te.values())}return null})(d,f),_=(function(R,Y){const te=[];let G=!0;for(const A of Al(Y)){const C=A.kind===0?oS(R,A.fieldPath,R.startAt):lS(R,A.fieldPath,R.startAt);te.push(C.value),G&&(G=C.inclusive)}return new Uu(te,G)})(d,f),y=(function(R,Y){const te=[];let G=!0;for(const A of Al(Y)){const C=A.kind===0?lS(R,A.fieldPath,R.endAt):oS(R,A.fieldPath,R.endAt);te.push(C.value),G&&(G=C.inclusive)}return new Uu(te,G)})(d,f),w=this.On(f,d,_),T=this.On(f,d,y),S=this.Nn(f,d,x),O=this.Bn(f.indexId,m,w,_.inclusive,T,y.inclusive,S);return oe.forEach(O,(U=>n.Y(U,t.limit).next((R=>{R.forEach((Y=>{const te=qe.fromSegments(Y.documentKey);l.has(te)||(l=l.add(te),u.push(te))}))}))))})).next((()=>u))}return oe.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=$M(ar.create(e.filters,"and")).map((n=>Jx(e.path,e.collectionGroup,e.orderBy,n.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,n,a,s,l,u){const f=(t!=null?t.length:1)*Math.max(n.length,s.length),d=f/(t!=null?t.length:1),m=[];for(let x=0;x<f;++x){const _=t?this.Ln(t[x/d]):tm,y=this.kn(e,_,n[x%d],a),w=this.qn(e,_,s[x%d],l),T=u.map((S=>this.kn(e,_,S,!0)));m.push(...this.createRange(y,w,T))}return m}kn(e,t,n,a){const s=new Rl(e,qe.empty(),t,n);return a?s:s.An()}qn(e,t,n,a){const s=new Rl(e,qe.empty(),t,n);return a?s.An():s}xn(e,t){const n=new IS(t),a=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,a).next((s=>{let l=null;for(const u of s)n.yn(u)&&(!l||u.fields.length>l.fields.length)&&(l=u);return l}))}getIndexType(e,t){let n=2;const a=this.Mn(t);return oe.forEach(a,(s=>this.xn(e,s).next((l=>{l?n!==0&&l.fields.length<(function(f){let d=new Jt(Er.comparator),m=!1;for(const x of f.filters)for(const _ of x.getFlattenedFilters())_.field.isKeyField()||(_.op==="array-contains"||_.op==="array-contains-any"?m=!0:d=d.add(_.field));for(const x of f.orderBy)x.field.isKeyField()||(d=d.add(x.field));return d.size+(m?1:0)})(s)&&(n=1):n=0})))).next((()=>(function(l){return l.limit!==null})(t)&&a.length>1&&n===2?1:n))}Qn(e,t){const n=new sh;for(const a of Al(e)){const s=t.data.field(a.fieldPath);if(s==null)return null;const l=n.Pn(a.kind);Cl.Kt.Dt(s,l)}return n.un()}Ln(e){const t=new sh;return Cl.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const n=new sh;return Cl.Kt.Dt(n_(this.databaseId,t),n.Pn((function(s){const l=Al(s);return l.length===0?0:l[l.length-1].kind})(e))),n.un()}Nn(e,t,n){if(n===null)return[];let a=[];a.push(new sh);let s=0;for(const l of Al(e)){const u=n[s++];for(const f of a)if(this.Un(t,l.fieldPath)&&Wh(u))a=this.Kn(a,l,u);else{const d=f.Pn(l.kind);Cl.Kt.Dt(u,d)}}return this.Wn(a)}On(e,t,n){return this.Nn(e,t,n.position)}Wn(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].un();return t}Kn(e,t,n){const a=[...e],s=[];for(const l of n.arrayValue.values||[])for(const u of a){const f=new sh;f.seed(u.un()),Cl.Kt.Dt(l,f.Pn(t.kind)),s.push(f)}return s}Un(e,t){return!!e.filters.find((n=>n instanceof kt&&n.field.isEqual(t)&&(n.op==="in"||n.op==="not-in")))}getFieldIndexes(e,t){const n=oh(e),a=lu(e);return(t?n.J(qx,IDBKeyRange.bound(t,t)):n.J()).next((s=>{const l=[];return oe.forEach(s,(u=>a.get([u.indexId,this.uid]).next((f=>{l.push((function(m,x){const _=x?new zh(x.sequenceNumber,new ba(Zl(x.readTime),new qe(Ui(x.documentKey)),x.largestBatchId)):zh.empty(),y=m.fields.map((([w,T])=>new wm(Er.fromServerFormat(w),T)));return new Gm(m.indexId,m.collectionGroup,y,_)})(u,f))})))).next((()=>l))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((n,a)=>{const s=n.indexState.sequenceNumber-a.indexState.sequenceNumber;return s!==0?s:ut(n.collectionGroup,a.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,n){const a=oh(e),s=lu(e);return this.Gn(e).next((l=>a.J(qx,IDBKeyRange.bound(t,t)).next((u=>oe.forEach(u,(f=>s.put(TS(f.indexId,this.uid,l,n))))))))}updateIndexEntries(e,t){const n=new Map;return oe.forEach(t,((a,s)=>{const l=n.get(a.collectionGroup);return(l?oe.resolve(l):this.getFieldIndexes(e,a.collectionGroup)).next((u=>(n.set(a.collectionGroup,u),oe.forEach(u,(f=>this.zn(e,a,f).next((d=>{const m=this.jn(s,f);return d.isEqual(m)?oe.resolve():this.Jn(e,s,f,d,m)})))))))}))}Hn(e,t,n,a){return ou(e).put(a.Rn(this.uid,this.$n(n,t.key),t.key))}Yn(e,t,n,a){return ou(e).delete(a.Vn(this.uid,this.$n(n,t.key),t.key))}zn(e,t,n){const a=ou(e);let s=new Jt(To);return a.ee({index:Z4,range:IDBKeyRange.only([n.indexId,this.uid,Dm(this.$n(n,t))])},((l,u)=>{s=s.add(new Rl(n.indexId,t,bS(u.arrayValue),bS(u.directionalValue)))})).next((()=>s))}jn(e,t){let n=new Jt(To);const a=this.Qn(t,e);if(a==null)return n;const s=Hx(t);if(s!=null){const l=e.data.field(s.fieldPath);if(Wh(l))for(const u of l.arrayValue.values||[])n=n.add(new Rl(t.indexId,e.key,this.Ln(u),a))}else n=n.add(new Rl(t.indexId,e.key,tm,a));return n}Jn(e,t,n,a,s){Le(CS,"Updating index entries for document '%s'",t.key);const l=[];return(function(f,d,m,x,_){const y=f.getIterator(),w=d.getIterator();let T=iu(y),S=iu(w);for(;T||S;){let O=!1,U=!1;if(T&&S){const R=m(T,S);R<0?U=!0:R>0&&(O=!0)}else T!=null?U=!0:O=!0;O?(x(S),S=iu(w)):U?(_(T),T=iu(y)):(T=iu(y),S=iu(w))}})(a,s,To,(u=>{l.push(this.Hn(e,t,n,u))}),(u=>{l.push(this.Yn(e,t,n,u))})),oe.waitFor(l)}Gn(e){let t=1;return lu(e).ee({index:J4,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((n,a,s)=>{s.done(),t=a.sequenceNumber+1})).next((()=>t))}createRange(e,t,n){n=n.sort(((l,u)=>To(l,u))).filter(((l,u,f)=>!u||To(l,f[u-1])!==0));const a=[];a.push(e);for(const l of n){const u=To(l,e),f=To(l,t);if(u===0)a[0]=e.An();else if(u>0&&f<0)a.push(l),a.push(l.An());else if(f>0)break}a.push(t);const s=[];for(let l=0;l<a.length;l+=2){if(this.Zn(a[l],a[l+1]))return[];const u=a[l].Vn(this.uid,tm,qe.empty()),f=a[l+1].Vn(this.uid,tm,qe.empty());s.push(IDBKeyRange.bound(u,f))}return s}Zn(e,t){return To(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(DS)}getMinOffset(e,t){return oe.mapArray(this.Mn(t),(n=>this.xn(e,n).next((a=>a||Ye(44426))))).next(DS)}}function RS(r){return tn(r,qh)}function ou(r){return tn(r,Ah)}function oh(r){return tn(r,Qv)}function lu(r){return tn(r,Sh)}function DS(r){Je(r.length!==0,28825);let e=r[0].indexState.offset,t=e.largestBatchId;for(let n=1;n<r.length;n++){const a=r[n].indexState.offset;Wv(a,e)<0&&(e=a),t<a.largestBatchId&&(t=a.largestBatchId)}return new ba(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NS={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},tk=41943040;class In{static withCacheSize(e){return new In(e,In.DEFAULT_COLLECTION_PERCENTILE,In.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rk(r,e,t){const n=r.store(pi),a=r.store(Fu),s=[],l=IDBKeyRange.only(t.batchId);let u=0;const f=n.ee({range:l},((m,x,_)=>(u++,_.delete())));s.push(f.next((()=>{Je(u===1,47070,{batchId:t.batchId})})));const d=[];for(const m of t.mutations){const x=Y4(e,m.key.path,t.batchId);s.push(a.delete(x)),d.push(m.key)}return oe.waitFor(s).next((()=>d))}function rp(r){if(!r)return 0;let e;if(r.document)e=r.document;else if(r.unknownDocument)e=r.unknownDocument;else{if(!r.noDocument)throw Ye(14731);e=r.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */In.DEFAULT_COLLECTION_PERCENTILE=10,In.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,In.DEFAULT=new In(tk,In.DEFAULT_COLLECTION_PERCENTILE,In.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),In.DISABLED=new In(-1,0,0);class zp{constructor(e,t,n,a){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=a,this.Xn={}}static wt(e,t,n,a){Je(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new zp(s,t,n,a)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Eo(e).ee({index:Fl,range:n},((a,s,l)=>{t=!1,l.done()})).next((()=>t))}addMutationBatch(e,t,n,a){const s=xu(e),l=Eo(e);return l.add({}).next((u=>{Je(typeof u=="number",49019);const f=new o_(u,t,n,a),d=(function(y,w,T){const S=T.baseMutations.map((U=>Zm(y.yt,U))),O=T.mutations.map((U=>Zm(y.yt,U)));return{userId:w,batchId:T.batchId,localWriteTimeMs:T.localWriteTime.toMillis(),baseMutations:S,mutations:O}})(this.serializer,this.userId,f),m=[];let x=new Jt(((_,y)=>ut(_.canonicalString(),y.canonicalString())));for(const _ of a){const y=Y4(this.userId,_.key.path,u);x=x.add(_.key.path.popLast()),m.push(l.put(d)),m.push(s.put(y,bF))}return x.forEach((_=>{m.push(this.indexManager.addToCollectionParentIndex(e,_))})),e.addOnCommittedListener((()=>{this.Xn[u]=f.keys()})),oe.waitFor(m).next((()=>f))}))}lookupMutationBatch(e,t){return Eo(e).get(t).next((n=>n?(Je(n.userId===this.userId,48,"Unexpected user for mutation batch",{userId:n.userId,batchId:t}),kl(this.serializer,n)):null))}er(e,t){return this.Xn[t]?oe.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((n=>{if(n){const a=n.keys();return this.Xn[t]=a,a}return null}))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,a=IDBKeyRange.lowerBound([this.userId,n]);let s=null;return Eo(e).ee({index:Fl,range:a},((l,u,f)=>{u.userId===this.userId&&(Je(u.batchId>=n,47524,{tr:n}),s=kl(this.serializer,u)),f.done()})).next((()=>s))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=Ll;return Eo(e).ee({index:Fl,range:t,reverse:!0},((a,s,l)=>{n=s.batchId,l.done()})).next((()=>n))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Ll],[this.userId,Number.POSITIVE_INFINITY]);return Eo(e).J(Fl,t).next((n=>n.map((a=>kl(this.serializer,a)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=Sm(this.userId,t.path),a=IDBKeyRange.lowerBound(n),s=[];return xu(e).ee({range:a},((l,u,f)=>{const[d,m,x]=l,_=Ui(m);if(d===this.userId&&t.path.isEqual(_))return Eo(e).get(x).next((y=>{if(!y)throw Ye(61480,{nr:l,batchId:x});Je(y.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:y.userId,batchId:x}),s.push(kl(this.serializer,y))}));f.done()})).next((()=>s))}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Jt(ut);const a=[];return t.forEach((s=>{const l=Sm(this.userId,s.path),u=IDBKeyRange.lowerBound(l),f=xu(e).ee({range:u},((d,m,x)=>{const[_,y,w]=d,T=Ui(y);_===this.userId&&s.path.isEqual(T)?n=n.add(w):x.done()}));a.push(f)})),oe.waitFor(a).next((()=>this.rr(e,n)))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,a=n.length+1,s=Sm(this.userId,n),l=IDBKeyRange.lowerBound(s);let u=new Jt(ut);return xu(e).ee({range:l},((f,d,m)=>{const[x,_,y]=f,w=Ui(_);x===this.userId&&n.isPrefixOf(w)?w.length===a&&(u=u.add(y)):m.done()})).next((()=>this.rr(e,u)))}rr(e,t){const n=[],a=[];return t.forEach((s=>{a.push(Eo(e).get(s).next((l=>{if(l===null)throw Ye(35274,{batchId:s});Je(l.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:l.userId,batchId:s}),n.push(kl(this.serializer,l))})))})),oe.waitFor(a).next((()=>n))}removeMutationBatch(e,t){return rk(e.le,this.userId,t).next((n=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),oe.forEach(n,(a=>this.referenceDelegate.markPotentiallyOrphaned(e,a))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return oe.resolve();const n=IDBKeyRange.lowerBound((function(l){return[l]})(this.userId)),a=[];return xu(e).ee({range:n},((s,l,u)=>{if(s[0]===this.userId){const f=Ui(s[1]);a.push(f)}else u.done()})).next((()=>{Je(a.length===0,56720,{sr:a.map((s=>s.canonicalString()))})}))}))}containsKey(e,t){return nk(e,this.userId,t)}_r(e){return ak(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:Ll,lastStreamToken:""}))}}function nk(r,e,t){const n=Sm(e,t.path),a=n[1],s=IDBKeyRange.lowerBound(n);let l=!1;return xu(r).ee({range:s,X:!0},((u,f,d)=>{const[m,x,_]=u;m===e&&x===a&&(l=!0),d.done()})).next((()=>l))}function Eo(r){return tn(r,pi)}function xu(r){return tn(r,Fu)}function ak(r){return tn(r,Hh)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ec{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new ec(0)}static cr(){return new ec(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZM{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const n=new ec(t.highestTargetId);return t.highestTargetId=n.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>tt.fromTimestamp(new $t(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,n){return this.lr(e).next((a=>(a.highestListenSequenceNumber=t,n&&(a.lastRemoteSnapshotVersion=n.toTimestamp()),t>a.highestListenSequenceNumber&&(a.highestListenSequenceNumber=t),this.hr(e,a))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((n=>(n.targetCount+=1,this.Tr(t,n),this.hr(e,n))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>cu(e).delete(t.targetId))).next((()=>this.lr(e))).next((n=>(Je(n.targetCount>0,8065),n.targetCount-=1,this.hr(e,n))))}removeTargets(e,t,n){let a=0;const s=[];return cu(e).ee(((l,u)=>{const f=ph(u);f.sequenceNumber<=t&&n.get(f.targetId)===null&&(a++,s.push(this.removeTargetData(e,f)))})).next((()=>oe.waitFor(s))).next((()=>a))}forEachTarget(e,t){return cu(e).ee(((n,a)=>{const s=ph(a);t(s)}))}lr(e){return OS(e).get(Xm).next((t=>(Je(t!==null,2888),t)))}hr(e,t){return OS(e).put(Xm,t)}Pr(e,t){return cu(e).put(QI(this.serializer,t))}Tr(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const n=Ql(t),a=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let s=null;return cu(e).ee({range:a,index:Q4},((l,u,f)=>{const d=ph(u);v0(t,d.target)&&(s=d,f.done())})).next((()=>s))}addMatchingKeys(e,t,n){const a=[],s=Co(e);return t.forEach((l=>{const u=Nn(l.path);a.push(s.put({targetId:n,path:u})),a.push(this.referenceDelegate.addReference(e,n,l))})),oe.waitFor(a)}removeMatchingKeys(e,t,n){const a=Co(e);return oe.forEach(t,(s=>{const l=Nn(s.path);return oe.waitFor([a.delete([n,l]),this.referenceDelegate.removeReference(e,n,s)])}))}removeMatchingKeysForTargetId(e,t){const n=Co(e),a=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(a)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),a=Co(e);let s=yt();return a.ee({range:n,X:!0},((l,u,f)=>{const d=Ui(l[1]),m=new qe(d);s=s.add(m)})).next((()=>s))}containsKey(e,t){const n=Nn(t.path),a=IDBKeyRange.bound([n],[H4(n)],!1,!0);let s=0;return Co(e).ee({index:$v,X:!0,range:a},(([l,u],f,d)=>{l!==0&&(s++,d.done())})).next((()=>s>0))}At(e,t){return cu(e).get(t).next((n=>n?ph(n):null))}}function cu(r){return tn(r,Mu)}function OS(r){return tn(r,Vl)}function Co(r){return tn(r,Pu)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FS="LruGarbageCollector",eP=1048576;function MS([r,e],[t,n]){const a=ut(r,t);return a===0?ut(e,n):a}class tP{constructor(e){this.Ir=e,this.buffer=new Jt(MS),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();MS(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class ik{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Le(FS,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Ko(t)?Le(FS,"Ignoring IndexedDB error during garbage collection: ",t):await uc(t)}await this.Vr(3e5)}))}}class rP{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((n=>Math.floor(t/100*n)))}nthSequenceNumber(e,t){if(t===0)return oe.resolve(Ya.ce);const n=new tP(t);return this.mr.forEachTarget(e,(a=>n.Ar(a.sequenceNumber))).next((()=>this.mr.pr(e,(a=>n.Ar(a))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.mr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Le("LruGarbageCollector","Garbage collection skipped; disabled"),oe.resolve(NS)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(Le("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),NS):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let n,a,s,l,u,f,d;const m=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((x=>(x>this.params.maximumSequenceNumbersToCollect?(Le("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${x}`),a=this.params.maximumSequenceNumbersToCollect):a=x,l=Date.now(),this.nthSequenceNumber(e,a)))).next((x=>(n=x,u=Date.now(),this.removeTargets(e,n,t)))).next((x=>(s=x,f=Date.now(),this.removeOrphanedDocuments(e,n)))).next((x=>(d=Date.now(),du()<=bt.DEBUG&&Le("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-m}ms
	Determined least recently used ${a} in `+(u-l)+`ms
	Removed ${s} targets in `+(f-u)+`ms
	Removed ${x} documents in `+(d-f)+`ms
Total Duration: ${d-m}ms`),oe.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:s,documentsRemoved:x}))))}}function sk(r,e){return new rP(r,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nP{constructor(e,t){this.db=e,this.garbageCollector=sk(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((n=>t.next((a=>n+a))))}wr(e){let t=0;return this.pr(e,(n=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((n,a)=>t(a)))}addReference(e,t,n){return rm(e,n)}removeReference(e,t,n){return rm(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return rm(e,t)}br(e,t){return(function(a,s){let l=!1;return ak(a).te((u=>nk(a,u,s).next((f=>(f&&(l=!0),oe.resolve(!f)))))).next((()=>l))})(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),a=[];let s=0;return this.Sr(e,((l,u)=>{if(u<=t){const f=this.br(e,l).next((d=>{if(!d)return s++,n.getEntry(e,l).next((()=>(n.removeEntry(l,tt.min()),Co(e).delete((function(x){return[0,Nn(x.path)]})(l)))))}));a.push(f)}})).next((()=>oe.waitFor(a))).next((()=>n.apply(e))).next((()=>s))}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return rm(e,t)}Sr(e,t){const n=Co(e);let a,s=Ya.ce;return n.ee({index:$v},(([l,u],{path:f,sequenceNumber:d})=>{l===0?(s!==Ya.ce&&t(new qe(Ui(a)),s),s=d,a=f):s=Ya.ce})).next((()=>{s!==Ya.ce&&t(new qe(Ui(a)),s)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function rm(r,e){return Co(r).put((function(n,a){return{targetId:0,path:Nn(n.path),sequenceNumber:a}})(e,r.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ok{constructor(){this.changes=new Ls((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Rr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?oe.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aP{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return wl(e).put(n)}removeEntry(e,t,n){return wl(e).delete((function(s,l){const u=s.path.toArray();return[u.slice(0,u.length-2),u[u.length-2],ep(l),u[u.length-1]]})(t,n))}updateMetadata(e,t){return this.getMetadata(e).next((n=>(n.byteSize+=t,this.Dr(e,n))))}getEntry(e,t){let n=Rr.newInvalidDocument(t);return wl(e).ee({index:Am,range:IDBKeyRange.only(lh(t))},((a,s)=>{n=this.Cr(t,s)})).next((()=>n))}vr(e,t){let n={size:0,document:Rr.newInvalidDocument(t)};return wl(e).ee({index:Am,range:IDBKeyRange.only(lh(t))},((a,s)=>{n={document:this.Cr(t,s),size:rp(s)}})).next((()=>n))}getEntries(e,t){let n=wa();return this.Fr(e,t,((a,s)=>{const l=this.Cr(a,s);n=n.insert(a,l)})).next((()=>n))}Mr(e,t){let n=wa(),a=new yr(qe.comparator);return this.Fr(e,t,((s,l)=>{const u=this.Cr(s,l);n=n.insert(s,u),a=a.insert(s,rp(l))})).next((()=>({documents:n,Or:a})))}Fr(e,t,n){if(t.isEmpty())return oe.resolve();let a=new Jt(VS);t.forEach((f=>a=a.add(f)));const s=IDBKeyRange.bound(lh(a.first()),lh(a.last())),l=a.getIterator();let u=l.getNext();return wl(e).ee({index:Am,range:s},((f,d,m)=>{const x=qe.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;u&&VS(u,x)<0;)n(u,null),u=l.getNext();u&&u.isEqual(x)&&(n(u,d),u=l.hasNext()?l.getNext():null),u?m.j(lh(u)):m.done()})).next((()=>{for(;u;)n(u,null),u=l.hasNext()?l.getNext():null}))}getDocumentsMatchingQuery(e,t,n,a,s){const l=t.path,u=[l.popLast().toArray(),l.lastSegment(),ep(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],f=[l.popLast().toArray(),l.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return wl(e).J(IDBKeyRange.bound(u,f,!0)).next((d=>{s==null||s.incrementDocumentReadCount(d.length);let m=wa();for(const x of d){const _=this.Cr(qe.fromSegments(x.prefixPath.concat(x.collectionGroup,x.documentId)),x);_.isFoundDocument()&&(y0(t,_)||a.has(_.key))&&(m=m.insert(_.key,_))}return m}))}getAllFromCollectionGroup(e,t,n,a){let s=wa();const l=LS(t,n),u=LS(t,ba.max());return wl(e).ee({index:$4,range:IDBKeyRange.bound(l,u,!0)},((f,d,m)=>{const x=this.Cr(qe.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);s=s.insert(x.key,x),s.size===a&&m.done()})).next((()=>s))}newChangeBuffer(e){return new iP(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return PS(e).get(Gx).next((t=>(Je(!!t,20021),t)))}Dr(e,t){return PS(e).put(Gx,t)}Cr(e,t){if(t){const n=HM(this.serializer,t);if(!(n.isNoDocument()&&n.version.isEqual(tt.min())))return n}return Rr.newInvalidDocument(e)}}function lk(r){return new aP(r)}class iP extends ok{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new Ls((n=>n.toString()),((n,a)=>n.isEqual(a)))}applyChanges(e){const t=[];let n=0,a=new Jt(((s,l)=>ut(s.canonicalString(),l.canonicalString())));return this.changes.forEach(((s,l)=>{const u=this.Br.get(s);if(t.push(this.Nr.removeEntry(e,s,u.readTime)),l.isValidDocument()){const f=_S(this.Nr.serializer,l);a=a.add(s.path.popLast());const d=rp(f);n+=d-u.size,t.push(this.Nr.addEntry(e,s,f))}else if(n-=u.size,this.trackRemovals){const f=_S(this.Nr.serializer,l.convertToNoDocument(tt.min()));t.push(this.Nr.addEntry(e,s,f))}})),a.forEach((s=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))})),t.push(this.Nr.updateMetadata(e,n)),oe.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((n=>(this.Br.set(t,{size:n.size,readTime:n.document.readTime}),n.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:n,Or:a})=>(a.forEach(((s,l)=>{this.Br.set(s,{size:l,readTime:n.get(s).readTime})})),n)))}}function PS(r){return tn(r,Gh)}function wl(r){return tn(r,Km)}function lh(r){const e=r.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function LS(r,e){const t=e.documentKey.path.toArray();return[r,ep(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function VS(r,e){const t=r.path.toArray(),n=e.path.toArray();let a=0;for(let s=0;s<t.length-2&&s<n.length-2;++s)if(a=ut(t[s],n[s]),a)return a;return a=ut(t.length,n.length),a||(a=ut(t[t.length-2],n[n.length-2]),a||ut(t[t.length-1],n[n.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sP{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ck{constructor(e,t,n,a){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=a}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((a=>(n=a,this.remoteDocumentCache.getEntry(e,t)))).next((a=>(n!==null&&Ch(n.mutation,a,$a.empty(),$t.now()),a)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((n=>this.getLocalViewOfDocuments(e,n,yt()).next((()=>n))))}getLocalViewOfDocuments(e,t,n=yt()){const a=zi();return this.populateOverlays(e,a,t).next((()=>this.computeViews(e,t,a,n).next((s=>{let l=dh();return s.forEach(((u,f)=>{l=l.insert(u,f.overlayedDocument)})),l}))))}getOverlayedDocuments(e,t){const n=zi();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,yt())))}populateOverlays(e,t,n){const a=[];return n.forEach((s=>{t.has(s)||a.push(s)})),this.documentOverlayCache.getOverlays(e,a).next((s=>{s.forEach(((l,u)=>{t.set(l,u)}))}))}computeViews(e,t,n,a){let s=wa();const l=kh(),u=(function(){return kh()})();return t.forEach(((f,d)=>{const m=n.get(d.key);a.has(d.key)&&(m===void 0||m.mutation instanceof Xo)?s=s.insert(d.key,d):m!==void 0?(l.set(d.key,m.mutation.getFieldMask()),Ch(m.mutation,d,m.mutation.getFieldMask(),$t.now())):l.set(d.key,$a.empty())})),this.recalculateAndSaveOverlays(e,s).next((f=>(f.forEach(((d,m)=>l.set(d,m))),t.forEach(((d,m)=>u.set(d,new sP(m,l.get(d)??null)))),u)))}recalculateAndSaveOverlays(e,t){const n=kh();let a=new yr(((l,u)=>l-u)),s=yt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((l=>{for(const u of l)u.keys().forEach((f=>{const d=t.get(f);if(d===null)return;let m=n.get(f)||$a.empty();m=u.applyToLocalView(d,m),n.set(f,m);const x=(a.get(u.batchId)||yt()).add(f);a=a.insert(u.batchId,x)}))})).next((()=>{const l=[],u=a.getReverseIterator();for(;u.hasNext();){const f=u.getNext(),d=f.key,m=f.value,x=bI();m.forEach((_=>{if(!s.has(_)){const y=OI(t.get(_),n.get(_));y!==null&&x.set(_,y),s=s.add(_)}})),l.push(this.documentOverlayCache.saveOverlays(e,d,x))}return oe.waitFor(l)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((n=>this.recalculateAndSaveOverlays(e,n)))}getDocumentsMatchingQuery(e,t,n,a){return(function(l){return qe.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):cM(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,a):this.getDocumentsMatchingCollectionQuery(e,t,n,a)}getNextDocuments(e,t,n,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,a).next((s=>{const l=a-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,a-s.size):oe.resolve(zi());let u=Uh,f=s;return l.next((d=>oe.forEach(d,((m,x)=>(u<x.largestBatchId&&(u=x.largestBatchId),s.get(m)?oe.resolve():this.remoteDocumentCache.getEntry(e,m).next((_=>{f=f.insert(m,_)}))))).next((()=>this.populateOverlays(e,d,s))).next((()=>this.computeViews(e,f,d,yt()))).next((m=>({batchId:u,changes:AI(m)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new qe(t)).next((n=>{let a=dh();return n.isFoundDocument()&&(a=a.insert(n.key,n)),a}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,a){const s=t.collectionGroup;let l=dh();return this.indexManager.getCollectionParents(e,s).next((u=>oe.forEach(u,(f=>{const d=(function(x,_){return new Mp(_,null,x.explicitOrderBy.slice(),x.filters.slice(),x.limit,x.limitType,x.startAt,x.endAt)})(t,f.child(s));return this.getDocumentsMatchingCollectionQuery(e,d,n,a).next((m=>{m.forEach(((x,_)=>{l=l.insert(x,_)}))}))})).next((()=>l))))}getDocumentsMatchingCollectionQuery(e,t,n,a){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((l=>(s=l,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,s,a)))).next((l=>{s.forEach(((f,d)=>{const m=d.getKey();l.get(m)===null&&(l=l.insert(m,Rr.newInvalidDocument(m)))}));let u=dh();return l.forEach(((f,d)=>{const m=s.get(f);m!==void 0&&Ch(m.mutation,d,$a.empty(),$t.now()),y0(t,d)&&(u=u.insert(f,d))})),u}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oP{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return oe.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(a){return{id:a.id,version:a.version,createTime:qn(a.createTime)}})(t)),oe.resolve()}getNamedQuery(e,t){return oe.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(a){return{name:a.name,query:JI(a.bundledQuery),readTime:qn(a.readTime)}})(t)),oe.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lP{constructor(){this.overlays=new yr(qe.comparator),this.qr=new Map}getOverlay(e,t){return oe.resolve(this.overlays.get(t))}getOverlays(e,t){const n=zi();return oe.forEach(t,(a=>this.getOverlay(e,a).next((s=>{s!==null&&n.set(a,s)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((a,s)=>{this.St(e,t,s)})),oe.resolve()}removeOverlaysForBatchId(e,t,n){const a=this.qr.get(n);return a!==void 0&&(a.forEach((s=>this.overlays=this.overlays.remove(s))),this.qr.delete(n)),oe.resolve()}getOverlaysForCollection(e,t,n){const a=zi(),s=t.length+1,l=new qe(t.child("")),u=this.overlays.getIteratorFrom(l);for(;u.hasNext();){const f=u.getNext().value,d=f.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===s&&f.largestBatchId>n&&a.set(f.getKey(),f)}return oe.resolve(a)}getOverlaysForCollectionGroup(e,t,n,a){let s=new yr(((d,m)=>d-m));const l=this.overlays.getIterator();for(;l.hasNext();){const d=l.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>n){let m=s.get(d.largestBatchId);m===null&&(m=zi(),s=s.insert(d.largestBatchId,m)),m.set(d.getKey(),d)}}const u=zi(),f=s.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach(((d,m)=>u.set(d,m))),!(u.size()>=a)););return oe.resolve(u)}St(e,t,n){const a=this.overlays.get(n.key);if(a!==null){const l=this.qr.get(a.largestBatchId).delete(n.key);this.qr.set(a.largestBatchId,l)}this.overlays=this.overlays.insert(n.key,new c_(t,n));let s=this.qr.get(t);s===void 0&&(s=yt(),this.qr.set(t,s)),this.qr.set(t,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cP{constructor(){this.sessionToken=Yr.EMPTY_BYTE_STRING}getSessionToken(e){return oe.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,oe.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m_{constructor(){this.Qr=new Jt(sn.$r),this.Ur=new Jt(sn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const n=new sn(e,t);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,t){e.forEach((n=>this.addReference(n,t)))}removeReference(e,t){this.Gr(new sn(e,t))}zr(e,t){e.forEach((n=>this.removeReference(n,t)))}jr(e){const t=new qe(new nr([])),n=new sn(t,e),a=new sn(t,e+1),s=[];return this.Ur.forEachInRange([n,a],(l=>{this.Gr(l),s.push(l.key)})),s}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new qe(new nr([])),n=new sn(t,e),a=new sn(t,e+1);let s=yt();return this.Ur.forEachInRange([n,a],(l=>{s=s.add(l.key)})),s}containsKey(e){const t=new sn(e,0),n=this.Qr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class sn{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return qe.comparator(e.key,t.key)||ut(e.Yr,t.Yr)}static Kr(e,t){return ut(e.Yr,t.Yr)||qe.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uP{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Jt(sn.$r)}checkEmpty(e){return oe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,a){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new o_(s,t,n,a);this.mutationQueue.push(l);for(const u of a)this.Zr=this.Zr.add(new sn(u.key,s)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return oe.resolve(l)}lookupMutationBatch(e,t){return oe.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,a=this.ei(n),s=a<0?0:a;return oe.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return oe.resolve(this.mutationQueue.length===0?Ll:this.tr-1)}getAllMutationBatches(e){return oe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new sn(t,0),a=new sn(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([n,a],(l=>{const u=this.Xr(l.Yr);s.push(u)})),oe.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Jt(ut);return t.forEach((a=>{const s=new sn(a,0),l=new sn(a,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,l],(u=>{n=n.add(u.Yr)}))})),oe.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,a=n.length+1;let s=n;qe.isDocumentKey(s)||(s=s.child(""));const l=new sn(new qe(s),0);let u=new Jt(ut);return this.Zr.forEachWhile((f=>{const d=f.key.path;return!!n.isPrefixOf(d)&&(d.length===a&&(u=u.add(f.Yr)),!0)}),l),oe.resolve(this.ti(u))}ti(e){const t=[];return e.forEach((n=>{const a=this.Xr(n);a!==null&&t.push(a)})),t}removeMutationBatch(e,t){Je(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return oe.forEach(t.mutations,(a=>{const s=new sn(a.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Zr=n}))}ir(e){}containsKey(e,t){const n=new sn(t,0),a=this.Zr.firstAfterOrEqual(n);return oe.resolve(t.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,oe.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fP{constructor(e){this.ri=e,this.docs=(function(){return new yr(qe.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,a=this.docs.get(n),s=a?a.size:0,l=this.ri(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:l}),this.size+=l-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return oe.resolve(n?n.document.mutableCopy():Rr.newInvalidDocument(t))}getEntries(e,t){let n=wa();return t.forEach((a=>{const s=this.docs.get(a);n=n.insert(a,s?s.document.mutableCopy():Rr.newInvalidDocument(a))})),oe.resolve(n)}getDocumentsMatchingQuery(e,t,n,a){let s=wa();const l=t.path,u=new qe(l.child("__id-9223372036854775808__")),f=this.docs.getIteratorFrom(u);for(;f.hasNext();){const{key:d,value:{document:m}}=f.getNext();if(!l.isPrefixOf(d.path))break;d.path.length>l.length+1||Wv(q4(m),n)<=0||(a.has(m.key)||y0(t,m))&&(s=s.insert(m.key,m.mutableCopy()))}return oe.resolve(s)}getAllFromCollectionGroup(e,t,n,a){Ye(9500)}ii(e,t){return oe.forEach(this.docs,(n=>t(n)))}newChangeBuffer(e){return new hP(this)}getSize(e){return oe.resolve(this.size)}}class hP extends ok{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((n,a)=>{a.isValidDocument()?t.push(this.Nr.addEntry(e,a)):this.Nr.removeEntry(n)})),oe.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dP{constructor(e){this.persistence=e,this.si=new Ls((t=>Ql(t)),v0),this.lastRemoteSnapshotVersion=tt.min(),this.highestTargetId=0,this.oi=0,this._i=new m_,this.targetCount=0,this.ai=ec.ur()}forEachTarget(e,t){return this.si.forEach(((n,a)=>t(a))),oe.resolve()}getLastRemoteSnapshotVersion(e){return oe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return oe.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),oe.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.oi&&(this.oi=t),oe.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new ec(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,oe.resolve()}updateTargetData(e,t){return this.Pr(t),oe.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,oe.resolve()}removeTargets(e,t,n){let a=0;const s=[];return this.si.forEach(((l,u)=>{u.sequenceNumber<=t&&n.get(u.targetId)===null&&(this.si.delete(l),s.push(this.removeMatchingKeysForTargetId(e,u.targetId)),a++)})),oe.waitFor(s).next((()=>a))}getTargetCount(e){return oe.resolve(this.targetCount)}getTargetData(e,t){const n=this.si.get(t)||null;return oe.resolve(n)}addMatchingKeys(e,t,n){return this._i.Wr(t,n),oe.resolve()}removeMatchingKeys(e,t,n){this._i.zr(t,n);const a=this.persistence.referenceDelegate,s=[];return a&&t.forEach((l=>{s.push(a.markPotentiallyOrphaned(e,l))})),oe.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),oe.resolve()}getMatchingKeysForTargetId(e,t){const n=this._i.Hr(t);return oe.resolve(n)}containsKey(e,t){return oe.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p_{constructor(e,t){this.ui={},this.overlays={},this.ci=new Ya(0),this.li=!1,this.li=!0,this.hi=new cP,this.referenceDelegate=e(this),this.Pi=new dP(this),this.indexManager=new QM,this.remoteDocumentCache=(function(a){return new fP(a)})((n=>this.referenceDelegate.Ti(n))),this.serializer=new $I(t),this.Ii=new oP(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new lP,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ui[e.toKey()];return n||(n=new uP(t,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,n){Le("MemoryPersistence","Starting transaction:",e);const a=new mP(this.ci.next());return this.referenceDelegate.Ei(),n(a).next((s=>this.referenceDelegate.di(a).next((()=>s)))).toPromise().then((s=>(a.raiseOnCommittedEvent(),s)))}Ai(e,t){return oe.or(Object.values(this.ui).map((n=>()=>n.containsKey(e,t))))}}class mP extends X4{constructor(e){super(),this.currentSequenceNumber=e}}class jp{constructor(e){this.persistence=e,this.Ri=new m_,this.Vi=null}static mi(e){return new jp(e)}get fi(){if(this.Vi)return this.Vi;throw Ye(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.fi.delete(n.toString()),oe.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.fi.add(n.toString()),oe.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),oe.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((a=>this.fi.add(a.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((a=>{a.forEach((s=>this.fi.add(s.toString())))})).next((()=>n.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return oe.forEach(this.fi,(n=>{const a=qe.fromPath(n);return this.gi(e,a).next((s=>{s||t.removeEntry(a,tt.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((n=>{n?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return oe.or([()=>oe.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class np{constructor(e,t){this.persistence=e,this.pi=new Ls((n=>Nn(n.path)),((n,a)=>n.isEqual(a))),this.garbageCollector=sk(this,t)}static mi(e,t){return new np(e,t)}Ei(){}di(e){return oe.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((n=>t.next((a=>n+a))))}wr(e){let t=0;return this.pr(e,(n=>{t++})).next((()=>t))}pr(e,t){return oe.forEach(this.pi,((n,a)=>this.br(e,n,a).next((s=>s?oe.resolve():t(a)))))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const a=this.persistence.getRemoteDocumentCache(),s=a.newChangeBuffer();return a.ii(e,(l=>this.br(e,l,t).next((u=>{u||(n++,s.removeEntry(l,tt.min()))})))).next((()=>s.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),oe.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),oe.resolve()}removeReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),oe.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),oe.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Im(e.data.value)),t}br(e,t,n){return oe.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const a=this.pi.get(t);return oe.resolve(a!==void 0&&a>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pP{constructor(e){this.serializer=e}k(e,t,n,a){const s=new kp("createOrUpgrade",t);n<1&&a>=1&&((function(f){f.createObjectStore(x0)})(e),(function(f){f.createObjectStore(Hh,{keyPath:AF}),f.createObjectStore(pi,{keyPath:Yw,autoIncrement:!0}).createIndex(Fl,$w,{unique:!0}),f.createObjectStore(Fu)})(e),BS(e),(function(f){f.createObjectStore(bl)})(e));let l=oe.resolve();return n<3&&a>=3&&(n!==0&&((function(f){f.deleteObjectStore(Pu),f.deleteObjectStore(Mu),f.deleteObjectStore(Vl)})(e),BS(e)),l=l.next((()=>(function(f){const d=f.store(Vl),m={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:tt.min().toTimestamp(),targetCount:0};return d.put(Xm,m)})(s)))),n<4&&a>=4&&(n!==0&&(l=l.next((()=>(function(f,d){return d.store(pi).J().next((x=>{f.deleteObjectStore(pi),f.createObjectStore(pi,{keyPath:Yw,autoIncrement:!0}).createIndex(Fl,$w,{unique:!0});const _=d.store(pi),y=x.map((w=>_.put(w)));return oe.waitFor(y)}))})(e,s)))),l=l.next((()=>{(function(f){f.createObjectStore(Lu,{keyPath:FF})})(e)}))),n<5&&a>=5&&(l=l.next((()=>this.yi(s)))),n<6&&a>=6&&(l=l.next((()=>((function(f){f.createObjectStore(Gh)})(e),this.wi(s))))),n<7&&a>=7&&(l=l.next((()=>this.Si(s)))),n<8&&a>=8&&(l=l.next((()=>this.bi(e,s)))),n<9&&a>=9&&(l=l.next((()=>{(function(f){f.objectStoreNames.contains("remoteDocumentChanges")&&f.deleteObjectStore("remoteDocumentChanges")})(e)}))),n<10&&a>=10&&(l=l.next((()=>this.Di(s)))),n<11&&a>=11&&(l=l.next((()=>{(function(f){f.createObjectStore(Rp,{keyPath:MF})})(e),(function(f){f.createObjectStore(Dp,{keyPath:PF})})(e)}))),n<12&&a>=12&&(l=l.next((()=>{(function(f){const d=f.createObjectStore(Np,{keyPath:HF});d.createIndex(Kx,GF,{unique:!1}),d.createIndex(eI,qF,{unique:!1})})(e)}))),n<13&&a>=13&&(l=l.next((()=>(function(f){const d=f.createObjectStore(Km,{keyPath:IF});d.createIndex(Am,kF),d.createIndex($4,CF)})(e))).next((()=>this.Ci(e,s))).next((()=>e.deleteObjectStore(bl)))),n<14&&a>=14&&(l=l.next((()=>this.Fi(e,s)))),n<15&&a>=15&&(l=l.next((()=>(function(f){f.createObjectStore(Qv,{keyPath:LF,autoIncrement:!0}).createIndex(qx,VF,{unique:!1}),f.createObjectStore(Sh,{keyPath:BF}).createIndex(J4,UF,{unique:!1}),f.createObjectStore(Ah,{keyPath:zF}).createIndex(Z4,jF,{unique:!1})})(e)))),n<16&&a>=16&&(l=l.next((()=>{t.objectStore(Sh).clear()})).next((()=>{t.objectStore(Ah).clear()}))),n<17&&a>=17&&(l=l.next((()=>{(function(f){f.createObjectStore(Jv,{keyPath:KF})})(e)}))),n<18&&a>=18&&Rb()&&(l=l.next((()=>{t.objectStore(Sh).clear()})).next((()=>{t.objectStore(Ah).clear()}))),l}wi(e){let t=0;return e.store(bl).ee(((n,a)=>{t+=rp(a)})).next((()=>{const n={byteSize:t};return e.store(Gh).put(Gx,n)}))}yi(e){const t=e.store(Hh),n=e.store(pi);return t.J().next((a=>oe.forEach(a,(s=>{const l=IDBKeyRange.bound([s.userId,Ll],[s.userId,s.lastAcknowledgedBatchId]);return n.J(Fl,l).next((u=>oe.forEach(u,(f=>{Je(f.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:f.batchId});const d=kl(this.serializer,f);return rk(e,s.userId,d).next((()=>{}))}))))}))))}Si(e){const t=e.store(Pu),n=e.store(bl);return e.store(Vl).get(Xm).next((a=>{const s=[];return n.ee(((l,u)=>{const f=new nr(l),d=(function(x){return[0,Nn(x)]})(f);s.push(t.get(d).next((m=>m?oe.resolve():(x=>t.put({targetId:0,path:Nn(x),sequenceNumber:a.highestListenSequenceNumber}))(f))))})).next((()=>oe.waitFor(s)))}))}bi(e,t){e.createObjectStore(qh,{keyPath:OF});const n=t.store(qh),a=new d_,s=l=>{if(a.add(l)){const u=l.lastSegment(),f=l.popLast();return n.put({collectionId:u,parent:Nn(f)})}};return t.store(bl).ee({X:!0},((l,u)=>{const f=new nr(l);return s(f.popLast())})).next((()=>t.store(Fu).ee({X:!0},(([l,u,f],d)=>{const m=Ui(u);return s(m.popLast())}))))}Di(e){const t=e.store(Mu);return t.ee(((n,a)=>{const s=ph(a),l=QI(this.serializer,s);return t.put(l)}))}Ci(e,t){const n=t.store(bl),a=[];return n.ee(((s,l)=>{const u=t.store(Km),f=(function(x){return x.document?new qe(nr.fromString(x.document.name).popFirst(5)):x.noDocument?qe.fromSegments(x.noDocument.path):x.unknownDocument?qe.fromSegments(x.unknownDocument.path):Ye(36783)})(l).path.toArray(),d={prefixPath:f.slice(0,f.length-2),collectionGroup:f[f.length-2],documentId:f[f.length-1],readTime:l.readTime||[0,0],unknownDocument:l.unknownDocument,noDocument:l.noDocument,document:l.document,hasCommittedMutations:!!l.hasCommittedMutations};a.push(u.put(d))})).next((()=>oe.waitFor(a)))}Fi(e,t){const n=t.store(pi),a=lk(this.serializer),s=new p_(jp.mi,this.serializer.yt);return n.J().next((l=>{const u=new Map;return l.forEach((f=>{let d=u.get(f.userId)??yt();kl(this.serializer,f).keys().forEach((m=>d=d.add(m))),u.set(f.userId,d)})),oe.forEach(u,((f,d)=>{const m=new vn(d),x=Up.wt(this.serializer,m),_=s.getIndexManager(m),y=zp.wt(m,this.serializer,_,s.referenceDelegate);return new ck(a,y,x,_).recalculateAndSaveOverlaysForDocumentKeys(new Xx(t,Ya.ce),f).next()}))}))}}function BS(r){r.createObjectStore(Pu,{keyPath:DF}).createIndex($v,NF,{unique:!0}),r.createObjectStore(Mu,{keyPath:"targetId"}).createIndex(Q4,RF,{unique:!0}),r.createObjectStore(Vl)}const wo="IndexedDbPersistence",dx=18e5,mx=5e3,px="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",gP="main";class g_{constructor(e,t,n,a,s,l,u,f,d,m,x=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.Mi=s,this.window=l,this.document=u,this.xi=d,this.Oi=m,this.Ni=x,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=_=>Promise.resolve(),!g_.v())throw new Ke(ke.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new nP(this,a),this.$i=t+gP,this.serializer=new $I(f),this.Ui=new Po(this.$i,this.Ni,new pP(this.serializer)),this.hi=new qM,this.Pi=new ZM(this.referenceDelegate,this.serializer),this.remoteDocumentCache=lk(this.serializer),this.Ii=new GM,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,m===!1&&Hn(wo,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Ke(ke.FAILED_PRECONDITION,px);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new Ya(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>nm(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(Ko(e))return Le(wo,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Le(wo,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return ch(e).get(au).next((t=>oe.resolve(this.es(t))))}ts(e){return nm(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,dx)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const n=tn(t,Lu);return n.J().next((a=>{const s=this.ss(a,dx),l=a.filter((u=>s.indexOf(u)===-1));return oe.forEach(l,(u=>n.delete(u.clientId))).next((()=>l))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?oe.resolve(!0):ch(e).get(au).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,mx)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new Ke(ke.FAILED_PRECONDITION,px);return!1}}return!(!this.networkEnabled||!this.inForeground)||nm(e).J().next((n=>this.ss(n,mx).find((a=>{if(this.clientId!==a.clientId){const s=!this.networkEnabled&&a.networkEnabled,l=!this.inForeground&&a.inForeground,u=this.networkEnabled===a.networkEnabled;if(s||l&&u)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&Le(wo,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[x0,Lu],(e=>{const t=new Xx(e,Ya.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((n=>this.rs(n.updateTimeMs,t)&&!this.us(n.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>nm(e).J().next((t=>this.ss(t,dx).map((n=>n.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return zp.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new JM(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return Up.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,n){Le(wo,"Starting transaction:",e);const a=t==="readonly"?"readonly":"readwrite",s=(function(f){return f===18?YF:f===17?aI:f===16?WF:f===15?Zv:f===14?nI:f===13?rI:f===12?XF:f===11?tI:void Ye(60245)})(this.Ni);let l;return this.Ui.runTransaction(e,a,s,(u=>(l=new Xx(u,this.ci?this.ci.next():Ya.ce),t==="readwrite-primary"?this.Hi(l).next((f=>!!f||this.Yi(l))).next((f=>{if(!f)throw Hn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new Ke(ke.FAILED_PRECONDITION,K4);return n(l)})).next((f=>this.Xi(l).next((()=>f)))):this.Is(l).next((()=>n(l)))))).then((u=>(l.raiseOnCommittedEvent(),u)))}Is(e){return ch(e).get(au).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,mx)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Ke(ke.FAILED_PRECONDITION,px)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ch(e).put(au,t)}static v(){return Po.v()}Zi(e){const t=ch(e);return t.get(au).next((n=>this.es(n)?(Le(wo,"Releasing primary lease."),t.delete(au)):oe.resolve()))}rs(e,t){const n=Date.now();return!(e<n-t)&&(!(e>n)||(Hn(`Detected an update time that is in the future: ${e} > ${n}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const t=/(?:Version|Mobile)\/1[456]/;Cb()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var t;try{const n=((t=this.Ki)==null?void 0:t.getItem(this._s(e)))!==null;return Le(wo,`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return Hn(wo,"Failed to get zombied client id.",n),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){Hn("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function ch(r){return tn(r,x0)}function nm(r){return tn(r,Lu)}function xP(r,e){let t=r.projectId;return r.isDefaultDatabase||(t+="."+r.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x_{constructor(e,t,n,a){this.targetId=e,this.fromCache=t,this.Es=n,this.ds=a}static As(e,t){let n=yt(),a=yt();for(const s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:a=a.add(s.doc.key)}return new x_(e,t.fromCache,n,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vP{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uk{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return Cb()?8:W4(Zr())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,a){const s={result:null};return this.ys(e,t).next((l=>{s.result=l})).next((()=>{if(!s.result)return this.ws(e,t,a,n).next((l=>{s.result=l}))})).next((()=>{if(s.result)return;const l=new vP;return this.Ss(e,t,l).next((u=>{if(s.result=u,this.Vs)return this.bs(e,t,l,u.size)}))})).next((()=>s.result))}bs(e,t,n,a){return n.documentReadCount<this.fs?(du()<=bt.DEBUG&&Le("QueryEngine","SDK will not create cache indexes for query:",mu(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),oe.resolve()):(du()<=bt.DEBUG&&Le("QueryEngine","Query:",mu(t),"scans",n.documentReadCount,"local documents and returns",a,"documents as results."),n.documentReadCount>this.gs*a?(du()<=bt.DEBUG&&Le("QueryEngine","The SDK decides to create cache indexes for query:",mu(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ja(t))):oe.resolve())}ys(e,t){if(cS(t))return oe.resolve(null);let n=Ja(t);return this.indexManager.getIndexType(e,n).next((a=>a===0?null:(t.limit!==null&&a===1&&(t=Zx(t,null,"F"),n=Ja(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((s=>{const l=yt(...s);return this.ps.getDocuments(e,l).next((u=>this.indexManager.getMinOffset(e,n).next((f=>{const d=this.Ds(t,u);return this.Cs(t,d,l,f.readTime)?this.ys(e,Zx(t,null,"F")):this.vs(e,d,t,f)}))))})))))}ws(e,t,n,a){return cS(t)||a.isEqual(tt.min())?oe.resolve(null):this.ps.getDocuments(e,n).next((s=>{const l=this.Ds(t,s);return this.Cs(t,l,n,a)?oe.resolve(null):(du()<=bt.DEBUG&&Le("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),mu(t)),this.vs(e,l,t,vF(a,Uh)).next((u=>u)))}))}Ds(e,t){let n=new Jt(wI(e));return t.forEach(((a,s)=>{y0(e,s)&&(n=n.add(s))})),n}Cs(e,t,n,a){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(a)>0)}Ss(e,t,n){return du()<=bt.DEBUG&&Le("QueryEngine","Using full collection scan to execute query:",mu(t)),this.ps.getDocumentsMatchingQuery(e,t,ba.min(),n)}vs(e,t,n,a){return this.ps.getDocumentsMatchingQuery(e,n,a).next((s=>(t.forEach((l=>{s=s.insert(l.key,l)})),s)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v_="LocalStore",_P=3e8;class yP{constructor(e,t,n,a){this.persistence=e,this.Fs=t,this.serializer=a,this.Ms=new yr(ut),this.xs=new Ls((s=>Ql(s)),v0),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ck(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function fk(r,e,t,n){return new yP(r,e,t,n)}async function hk(r,e){const t=ft(r);return await t.persistence.runTransaction("Handle user change","readonly",(n=>{let a;return t.mutationQueue.getAllMutationBatches(n).next((s=>(a=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(n)))).next((s=>{const l=[],u=[];let f=yt();for(const d of a){l.push(d.batchId);for(const m of d.mutations)f=f.add(m.key)}for(const d of s){u.push(d.batchId);for(const m of d.mutations)f=f.add(m.key)}return t.localDocuments.getDocuments(n,f).next((d=>({Ls:d,removedBatchIds:l,addedBatchIds:u})))}))}))}function TP(r,e){const t=ft(r);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(n=>{const a=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(u,f,d,m){const x=d.batch,_=x.keys();let y=oe.resolve();return _.forEach((w=>{y=y.next((()=>m.getEntry(f,w))).next((T=>{const S=d.docVersions.get(w);Je(S!==null,48541),T.version.compareTo(S)<0&&(x.applyToRemoteDocument(T,d),T.isValidDocument()&&(T.setReadTime(d.commitVersion),m.addEntry(T)))}))})),y.next((()=>u.mutationQueue.removeMutationBatch(f,x)))})(t,n,e,s).next((()=>s.apply(n))).next((()=>t.mutationQueue.performConsistencyCheck(n))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(n,a,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,(function(u){let f=yt();for(let d=0;d<u.mutationResults.length;++d)u.mutationResults[d].transformResults.length>0&&(f=f.add(u.batch.mutations[d].key));return f})(e)))).next((()=>t.localDocuments.getDocuments(n,a)))}))}function dk(r){const e=ft(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function EP(r,e){const t=ft(r),n=e.snapshotVersion;let a=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(s=>{const l=t.Ns.newChangeBuffer({trackRemovals:!0});a=t.Ms;const u=[];e.targetChanges.forEach(((m,x)=>{const _=a.get(x);if(!_)return;u.push(t.Pi.removeMatchingKeys(s,m.removedDocuments,x).next((()=>t.Pi.addMatchingKeys(s,m.addedDocuments,x))));let y=_.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(x)!==null?y=y.withResumeToken(Yr.EMPTY_BYTE_STRING,tt.min()).withLastLimboFreeSnapshotVersion(tt.min()):m.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(m.resumeToken,n)),a=a.insert(x,y),(function(T,S,O){return T.resumeToken.approximateByteSize()===0||S.snapshotVersion.toMicroseconds()-T.snapshotVersion.toMicroseconds()>=_P?!0:O.addedDocuments.size+O.modifiedDocuments.size+O.removedDocuments.size>0})(_,y,m)&&u.push(t.Pi.updateTargetData(s,y))}));let f=wa(),d=yt();if(e.documentUpdates.forEach((m=>{e.resolvedLimboDocuments.has(m)&&u.push(t.persistence.referenceDelegate.updateLimboDocument(s,m))})),u.push(wP(s,l,e.documentUpdates).next((m=>{f=m.ks,d=m.qs}))),!n.isEqual(tt.min())){const m=t.Pi.getLastRemoteSnapshotVersion(s).next((x=>t.Pi.setTargetsMetadata(s,s.currentSequenceNumber,n)));u.push(m)}return oe.waitFor(u).next((()=>l.apply(s))).next((()=>t.localDocuments.getLocalViewOfDocuments(s,f,d))).next((()=>f))})).then((s=>(t.Ms=a,s)))}function wP(r,e,t){let n=yt(),a=yt();return t.forEach((s=>n=n.add(s))),e.getEntries(r,n).next((s=>{let l=wa();return t.forEach(((u,f)=>{const d=s.get(u);f.isFoundDocument()!==d.isFoundDocument()&&(a=a.add(u)),f.isNoDocument()&&f.version.isEqual(tt.min())?(e.removeEntry(u,f.readTime),l=l.insert(u,f)):!d.isValidDocument()||f.version.compareTo(d.version)>0||f.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(f),l=l.insert(u,f)):Le(v_,"Ignoring outdated watch update for ",u,". Current version:",d.version," Watch version:",f.version)})),{ks:l,qs:a}}))}function SP(r,e){const t=ft(r);return t.persistence.runTransaction("Get next mutation batch","readonly",(n=>(e===void 0&&(e=Ll),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e))))}function AP(r,e){const t=ft(r);return t.persistence.runTransaction("Allocate target","readwrite",(n=>{let a;return t.Pi.getTargetData(n,e).next((s=>s?(a=s,oe.resolve(a)):t.Pi.allocateTargetId(n).next((l=>(a=new As(e,l,"TargetPurposeListen",n.currentSequenceNumber),t.Pi.addTargetData(n,a).next((()=>a)))))))})).then((n=>{const a=t.Ms.get(n.targetId);return(a===null||n.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(n.targetId,n),t.xs.set(e,n.targetId)),n}))}async function ov(r,e,t){const n=ft(r),a=n.Ms.get(e),s=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",s,(l=>n.persistence.referenceDelegate.removeTarget(l,a)))}catch(l){if(!Ko(l))throw l;Le(v_,`Failed to update sequence numbers for target ${e}: ${l}`)}n.Ms=n.Ms.remove(e),n.xs.delete(a.target)}function US(r,e,t){const n=ft(r);let a=tt.min(),s=yt();return n.persistence.runTransaction("Execute query","readwrite",(l=>(function(f,d,m){const x=ft(f),_=x.xs.get(m);return _!==void 0?oe.resolve(x.Ms.get(_)):x.Pi.getTargetData(d,m)})(n,l,Ja(e)).next((u=>{if(u)return a=u.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(l,u.targetId).next((f=>{s=f}))})).next((()=>n.Fs.getDocumentsMatchingQuery(l,e,t?a:tt.min(),t?s:yt()))).next((u=>(bP(n,fM(e),u),{documents:u,Qs:s})))))}function bP(r,e,t){let n=r.Os.get(e)||tt.min();t.forEach(((a,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)})),r.Os.set(e,n)}class zS{constructor(){this.activeTargetIds=xM()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class mk{constructor(){this.Mo=new zS,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,n){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new zS,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IP{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jS="ConnectivityMonitor";class HS{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Le(jS,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Le(jS,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let am=null;function lv(){return am===null?am=(function(){return 268435456+Math.round(2147483648*Math.random())})():am++,"0x"+am.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gx="RestConnection",kP={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class CP{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${n}/databases/${a}`,this.Wo=this.databaseId.database===Wm?`project_id=${n}`:`project_id=${n}&database_id=${a}`}Go(e,t,n,a,s){const l=lv(),u=this.zo(e,t.toUriEncodedString());Le(gx,`Sending RPC '${e}' ${l}:`,u,n);const f={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(f,a,s);const{host:d}=new URL(u),m=Qu(d);return this.Jo(e,u,f,n,m).then((x=>(Le(gx,`Received RPC '${e}' ${l}: `,x),x)),(x=>{throw Yl(gx,`RPC '${e}' ${l} failed with error: `,x,"url: ",u,"request:",n),x}))}Ho(e,t,n,a,s,l){return this.Go(e,t,n,a,s)}jo(e,t,n){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+ef})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((a,s)=>e[s]=a)),n&&n.headers.forEach(((a,s)=>e[s]=a))}zo(e,t){const n=kP[e];return`${this.Uo}/v1/${t}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RP{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const An="WebChannelConnection";class DP extends CP{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,a,s){const l=lv();return new Promise(((u,f)=>{const d=new P4;d.setWithCredentials(!0),d.listenOnce(L4.COMPLETE,(()=>{try{switch(d.getLastErrorCode()){case Em.NO_ERROR:const x=d.getResponseJson();Le(An,`XHR for RPC '${e}' ${l} received:`,JSON.stringify(x)),u(x);break;case Em.TIMEOUT:Le(An,`RPC '${e}' ${l} timed out`),f(new Ke(ke.DEADLINE_EXCEEDED,"Request time out"));break;case Em.HTTP_ERROR:const _=d.getStatus();if(Le(An,`RPC '${e}' ${l} failed with status:`,_,"response text:",d.getResponseText()),_>0){let y=d.getResponseJson();Array.isArray(y)&&(y=y[0]);const w=y==null?void 0:y.error;if(w&&w.status&&w.message){const T=(function(O){const U=O.toLowerCase().replace(/_/g,"-");return Object.values(ke).indexOf(U)>=0?U:ke.UNKNOWN})(w.status);f(new Ke(T,w.message))}else f(new Ke(ke.UNKNOWN,"Server responded with status "+d.getStatus()))}else f(new Ke(ke.UNAVAILABLE,"Connection failed."));break;default:Ye(9055,{l_:e,streamId:l,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{Le(An,`RPC '${e}' ${l} completed.`)}}));const m=JSON.stringify(a);Le(An,`RPC '${e}' ${l} sending request:`,a),d.send(t,"POST",m,n,15)}))}T_(e,t,n){const a=lv(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],l=U4(),u=B4(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(f.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(f.useFetchStreams=!0),this.jo(f.initMessageHeaders,t,n),f.encodeInitMessageHeaders=!0;const m=s.join("");Le(An,`Creating RPC '${e}' stream ${a}: ${m}`,f);const x=l.createWebChannel(m,f);this.I_(x);let _=!1,y=!1;const w=new RP({Yo:S=>{y?Le(An,`Not sending because RPC '${e}' stream ${a} is closed:`,S):(_||(Le(An,`Opening RPC '${e}' stream ${a} transport.`),x.open(),_=!0),Le(An,`RPC '${e}' stream ${a} sending:`,S),x.send(S))},Zo:()=>x.close()}),T=(S,O,U)=>{S.listen(O,(R=>{try{U(R)}catch(Y){setTimeout((()=>{throw Y}),0)}}))};return T(x,hh.EventType.OPEN,(()=>{y||(Le(An,`RPC '${e}' stream ${a} transport opened.`),w.o_())})),T(x,hh.EventType.CLOSE,(()=>{y||(y=!0,Le(An,`RPC '${e}' stream ${a} transport closed`),w.a_(),this.E_(x))})),T(x,hh.EventType.ERROR,(S=>{y||(y=!0,Yl(An,`RPC '${e}' stream ${a} transport errored. Name:`,S.name,"Message:",S.message),w.a_(new Ke(ke.UNAVAILABLE,"The operation could not be completed")))})),T(x,hh.EventType.MESSAGE,(S=>{var O;if(!y){const U=S.data[0];Je(!!U,16349);const R=U,Y=(R==null?void 0:R.error)||((O=R[0])==null?void 0:O.error);if(Y){Le(An,`RPC '${e}' stream ${a} received error:`,Y);const te=Y.status;let G=(function(k){const V=qr[k];if(V!==void 0)return PI(V)})(te),A=Y.message;G===void 0&&(G=ke.INTERNAL,A="Unknown error status: "+te+" with message "+Y.message),y=!0,w.a_(new Ke(G,A)),x.close()}else Le(An,`RPC '${e}' stream ${a} received:`,U),w.u_(U)}})),T(u,V4.STAT_EVENT,(S=>{S.stat===zx.PROXY?Le(An,`RPC '${e}' stream ${a} detected buffering proxy`):S.stat===zx.NOPROXY&&Le(An,`RPC '${e}' stream ${a} detected no buffering proxy`)})),setTimeout((()=>{w.__()}),0),w}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NP(){return typeof window<"u"?window:null}function Nm(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hp(r){return new OM(r,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pk{constructor(e,t,n=1e3,a=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=n,this.A_=a,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),a=Math.max(0,t-n);a>0&&Le("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,a,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GS="PersistentStream";class gk{constructor(e,t,n,a,s,l,u,f){this.Mi=e,this.S_=n,this.b_=a,this.connection=s,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=u,this.listener=f,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new pk(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ke.RESOURCE_EXHAUSTED?(Hn(t.toString()),Hn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ke.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([n,a])=>{this.D_===t&&this.G_(n,a)}),(n=>{e((()=>{const a=new Ke(ke.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(a)}))}))}G_(e,t){const n=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{n((()=>this.listener.Xo()))})),this.stream.t_((()=>{n((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((a=>{n((()=>this.z_(a)))})),this.stream.onMessage((a=>{n((()=>++this.F_==1?this.J_(a):this.onNext(a)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Le(GS,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(Le(GS,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class OP extends gk{constructor(e,t,n,a,s,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,a,l),this.serializer=s}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=PM(this.serializer,e),n=(function(s){if(!("targetChange"in s))return tt.min();const l=s.targetChange;return l.targetIds&&l.targetIds.length?tt.min():l.readTime?qn(l.readTime):tt.min()})(e);return this.listener.H_(t,n)}Y_(e){const t={};t.database=rv(this.serializer),t.addTarget=(function(s,l){let u;const f=l.target;if(u=$m(f)?{documents:GI(s,f)}:{query:qI(s,f).ft},u.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){u.resumeToken=BI(s,l.resumeToken);const d=ev(s,l.expectedCount);d!==null&&(u.expectedCount=d)}else if(l.snapshotVersion.compareTo(tt.min())>0){u.readTime=qu(s,l.snapshotVersion.toTimestamp());const d=ev(s,l.expectedCount);d!==null&&(u.expectedCount=d)}return u})(this.serializer,e);const n=VM(this.serializer,e);n&&(t.labels=n),this.q_(t)}Z_(e){const t={};t.database=rv(this.serializer),t.removeTarget=e,this.q_(t)}}class FP extends gk{constructor(e,t,n,a,s,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,a,l),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Je(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Je(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Je(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=LM(e.writeResults,e.commitTime),n=qn(e.commitTime);return this.listener.na(n,t)}ra(){const e={};e.database=rv(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((n=>Zm(this.serializer,n)))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MP{}class PP extends MP{constructor(e,t,n,a){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=a,this.ia=!1}sa(){if(this.ia)throw new Ke(ke.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,n,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,l])=>this.connection.Go(e,tv(t,n),a,s,l))).catch((s=>{throw s.name==="FirebaseError"?(s.code===ke.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Ke(ke.UNKNOWN,s.toString())}))}Ho(e,t,n,a,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,u])=>this.connection.Ho(e,tv(t,n),a,l,u,s))).catch((l=>{throw l.name==="FirebaseError"?(l.code===ke.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Ke(ke.UNKNOWN,l.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class LP{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Hn(t),this.aa=!1):Le("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tc="RemoteStore";class VP{constructor(e,t,n,a,s){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo((l=>{n.enqueueAndForget((async()=>{hc(this)&&(Le(tc,"Restarting streams for network reachability change."),await(async function(f){const d=ft(f);d.Ea.add(4),await E0(d),d.Ra.set("Unknown"),d.Ea.delete(4),await Gp(d)})(this))}))})),this.Ra=new LP(n,a)}}async function Gp(r){if(hc(r))for(const e of r.da)await e(!0)}async function E0(r){for(const e of r.da)await e(!1)}function xk(r,e){const t=ft(r);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),E_(t)?T_(t):rf(t).O_()&&y_(t,e))}function __(r,e){const t=ft(r),n=rf(t);t.Ia.delete(e),n.O_()&&vk(t,e),t.Ia.size===0&&(n.O_()?n.L_():hc(t)&&t.Ra.set("Unknown"))}function y_(r,e){if(r.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(tt.min())>0){const t=r.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}rf(r).Y_(e)}function vk(r,e){r.Va.Ue(e),rf(r).Z_(e)}function T_(r){r.Va=new CM({getRemoteKeysForTarget:e=>r.remoteSyncer.getRemoteKeysForTarget(e),At:e=>r.Ia.get(e)||null,ht:()=>r.datastore.serializer.databaseId}),rf(r).start(),r.Ra.ua()}function E_(r){return hc(r)&&!rf(r).x_()&&r.Ia.size>0}function hc(r){return ft(r).Ea.size===0}function _k(r){r.Va=void 0}async function BP(r){r.Ra.set("Online")}async function UP(r){r.Ia.forEach(((e,t)=>{y_(r,e)}))}async function zP(r,e){_k(r),E_(r)?(r.Ra.ha(e),T_(r)):r.Ra.set("Unknown")}async function jP(r,e,t){if(r.Ra.set("Online"),e instanceof VI&&e.state===2&&e.cause)try{await(async function(a,s){const l=s.cause;for(const u of s.targetIds)a.Ia.has(u)&&(await a.remoteSyncer.rejectListen(u,l),a.Ia.delete(u),a.Va.removeTarget(u))})(r,e)}catch(n){Le(tc,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await ap(r,n)}else if(e instanceof Rm?r.Va.Ze(e):e instanceof LI?r.Va.st(e):r.Va.tt(e),!t.isEqual(tt.min()))try{const n=await dk(r.localStore);t.compareTo(n)>=0&&await(function(s,l){const u=s.Va.Tt(l);return u.targetChanges.forEach(((f,d)=>{if(f.resumeToken.approximateByteSize()>0){const m=s.Ia.get(d);m&&s.Ia.set(d,m.withResumeToken(f.resumeToken,l))}})),u.targetMismatches.forEach(((f,d)=>{const m=s.Ia.get(f);if(!m)return;s.Ia.set(f,m.withResumeToken(Yr.EMPTY_BYTE_STRING,m.snapshotVersion)),vk(s,f);const x=new As(m.target,f,d,m.sequenceNumber);y_(s,x)})),s.remoteSyncer.applyRemoteEvent(u)})(r,t)}catch(n){Le(tc,"Failed to raise snapshot:",n),await ap(r,n)}}async function ap(r,e,t){if(!Ko(e))throw e;r.Ea.add(1),await E0(r),r.Ra.set("Offline"),t||(t=()=>dk(r.localStore)),r.asyncQueue.enqueueRetryable((async()=>{Le(tc,"Retrying IndexedDB access"),await t(),r.Ea.delete(1),await Gp(r)}))}function yk(r,e){return e().catch((t=>ap(r,t,e)))}async function w0(r){const e=ft(r),t=Uo(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Ll;for(;HP(e);)try{const a=await SP(e.localStore,n);if(a===null){e.Ta.length===0&&t.L_();break}n=a.batchId,GP(e,a)}catch(a){await ap(e,a)}Tk(e)&&Ek(e)}function HP(r){return hc(r)&&r.Ta.length<10}function GP(r,e){r.Ta.push(e);const t=Uo(r);t.O_()&&t.X_&&t.ea(e.mutations)}function Tk(r){return hc(r)&&!Uo(r).x_()&&r.Ta.length>0}function Ek(r){Uo(r).start()}async function qP(r){Uo(r).ra()}async function KP(r){const e=Uo(r);for(const t of r.Ta)e.ea(t.mutations)}async function XP(r,e,t){const n=r.Ta.shift(),a=l_.from(n,e,t);await yk(r,(()=>r.remoteSyncer.applySuccessfulWrite(a))),await w0(r)}async function WP(r,e){e&&Uo(r).X_&&await(async function(n,a){if((function(l){return bM(l)&&l!==ke.ABORTED})(a.code)){const s=n.Ta.shift();Uo(n).B_(),await yk(n,(()=>n.remoteSyncer.rejectFailedWrite(s.batchId,a))),await w0(n)}})(r,e),Tk(r)&&Ek(r)}async function qS(r,e){const t=ft(r);t.asyncQueue.verifyOperationInProgress(),Le(tc,"RemoteStore received new credentials");const n=hc(t);t.Ea.add(3),await E0(t),n&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Gp(t)}async function YP(r,e){const t=ft(r);e?(t.Ea.delete(2),await Gp(t)):e||(t.Ea.add(2),await E0(t),t.Ra.set("Unknown"))}function rf(r){return r.ma||(r.ma=(function(t,n,a){const s=ft(t);return s.sa(),new OP(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,a)})(r.datastore,r.asyncQueue,{Xo:BP.bind(null,r),t_:UP.bind(null,r),r_:zP.bind(null,r),H_:jP.bind(null,r)}),r.da.push((async e=>{e?(r.ma.B_(),E_(r)?T_(r):r.Ra.set("Unknown")):(await r.ma.stop(),_k(r))}))),r.ma}function Uo(r){return r.fa||(r.fa=(function(t,n,a){const s=ft(t);return s.sa(),new FP(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,a)})(r.datastore,r.asyncQueue,{Xo:()=>Promise.resolve(),t_:qP.bind(null,r),r_:WP.bind(null,r),ta:KP.bind(null,r),na:XP.bind(null,r)}),r.da.push((async e=>{e?(r.fa.B_(),await w0(r)):(await r.fa.stop(),r.Ta.length>0&&(Le(tc,`Stopping write stream with ${r.Ta.length} pending writes`),r.Ta=[]))}))),r.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w_{constructor(e,t,n,a,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=a,this.removalCallback=s,this.deferred=new Is,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((l=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,a,s){const l=Date.now()+n,u=new w_(e,t,l,a,s);return u.start(n),u}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ke(ke.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function S_(r,e){if(Hn("AsyncQueue",`${e}: ${r}`),Ko(r))return new Ke(ke.UNAVAILABLE,`${e}: ${r}`);throw r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu{static emptySet(e){return new bu(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||qe.comparator(t.key,n.key):(t,n)=>qe.comparator(t.key,n.key),this.keyedMap=dh(),this.sortedSet=new yr(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof bu)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const a=t.getNext().key,s=n.getNext().key;if(!a.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new bu;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KS{constructor(){this.ga=new yr(qe.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(t,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(t):e.type===1&&n.type===2?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Ye(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,n)=>{e.push(n)})),e}}class Ku{constructor(e,t,n,a,s,l,u,f,d){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=a,this.mutatedKeys=s,this.fromCache=l,this.syncStateChanged=u,this.excludesMetadataChanges=f,this.hasCachedResults=d}static fromInitialDocuments(e,t,n,a,s){const l=[];return t.forEach((u=>{l.push({type:0,doc:u})})),new Ku(e,t,bu.emptySet(t),l,n,a,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Pp(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let a=0;a<t.length;a++)if(t[a].type!==n[a].type||!t[a].doc.isEqual(n[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $P{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class QP{constructor(){this.queries=XS(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,n){const a=ft(t),s=a.queries;a.queries=XS(),s.forEach(((l,u)=>{for(const f of u.Sa)f.onError(n)}))})(this,new Ke(ke.ABORTED,"Firestore shutting down"))}}function XS(){return new Ls((r=>EI(r)),Pp)}async function wk(r,e){const t=ft(r);let n=3;const a=e.query;let s=t.queries.get(a);s?!s.ba()&&e.Da()&&(n=2):(s=new $P,n=e.Da()?0:1);try{switch(n){case 0:s.wa=await t.onListen(a,!0);break;case 1:s.wa=await t.onListen(a,!1);break;case 2:await t.onFirstRemoteStoreListen(a)}}catch(l){const u=S_(l,`Initialization of query '${mu(e.query)}' failed`);return void e.onError(u)}t.queries.set(a,s),s.Sa.push(e),e.va(t.onlineState),s.wa&&e.Fa(s.wa)&&A_(t)}async function Sk(r,e){const t=ft(r),n=e.query;let a=3;const s=t.queries.get(n);if(s){const l=s.Sa.indexOf(e);l>=0&&(s.Sa.splice(l,1),s.Sa.length===0?a=e.Da()?0:1:!s.ba()&&e.Da()&&(a=2))}switch(a){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function JP(r,e){const t=ft(r);let n=!1;for(const a of e){const s=a.query,l=t.queries.get(s);if(l){for(const u of l.Sa)u.Fa(a)&&(n=!0);l.wa=a}}n&&A_(t)}function ZP(r,e,t){const n=ft(r),a=n.queries.get(e);if(a)for(const s of a.Sa)s.onError(t);n.queries.delete(e)}function A_(r){r.Ca.forEach((e=>{e.next()}))}var cv,WS;(WS=cv||(cv={})).Ma="default",WS.Cache="cache";class Ak{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const a of e.docChanges)a.type!==3&&n.push(a);e=new Ku(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const n=t!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Ku.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==cv.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bk{constructor(e){this.key=e}}class Ik{constructor(e){this.key=e}}class e9{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=yt(),this.mutatedKeys=yt(),this.eu=wI(e),this.tu=new bu(this.eu)}get nu(){return this.Ya}ru(e,t){const n=t?t.iu:new KS,a=t?t.tu:this.tu;let s=t?t.mutatedKeys:this.mutatedKeys,l=a,u=!1;const f=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,d=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((m,x)=>{const _=a.get(m),y=y0(this.query,x)?x:null,w=!!_&&this.mutatedKeys.has(_.key),T=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let S=!1;_&&y?_.data.isEqual(y.data)?w!==T&&(n.track({type:3,doc:y}),S=!0):this.su(_,y)||(n.track({type:2,doc:y}),S=!0,(f&&this.eu(y,f)>0||d&&this.eu(y,d)<0)&&(u=!0)):!_&&y?(n.track({type:0,doc:y}),S=!0):_&&!y&&(n.track({type:1,doc:_}),S=!0,(f||d)&&(u=!0)),S&&(y?(l=l.add(y),s=T?s.add(m):s.delete(m)):(l=l.delete(m),s=s.delete(m)))})),this.query.limit!==null)for(;l.size>this.query.limit;){const m=this.query.limitType==="F"?l.last():l.first();l=l.delete(m.key),s=s.delete(m.key),n.track({type:1,doc:m})}return{tu:l,iu:n,Cs:u,mutatedKeys:s}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,a){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const l=e.iu.ya();l.sort(((m,x)=>(function(y,w){const T=S=>{switch(S){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ye(20277,{Rt:S})}};return T(y)-T(w)})(m.type,x.type)||this.eu(m.doc,x.doc))),this.ou(n),a=a??!1;const u=t&&!a?this._u():[],f=this.Xa.size===0&&this.current&&!a?1:0,d=f!==this.Za;return this.Za=f,l.length!==0||d?{snapshot:new Ku(this.query,e.tu,s,l,e.mutatedKeys,f===0,d,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:u}:{au:u}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new KS,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=yt(),this.tu.forEach((n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))}));const t=[];return e.forEach((n=>{this.Xa.has(n)||t.push(new Ik(n))})),this.Xa.forEach((n=>{e.has(n)||t.push(new bk(n))})),t}cu(e){this.Ya=e.Qs,this.Xa=yt();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Ku.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const b_="SyncEngine";class t9{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class r9{constructor(e){this.key=e,this.hu=!1}}class n9{constructor(e,t,n,a,s,l){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=a,this.currentUser=s,this.maxConcurrentLimboResolutions=l,this.Pu={},this.Tu=new Ls((u=>EI(u)),Pp),this.Iu=new Map,this.Eu=new Set,this.du=new yr(qe.comparator),this.Au=new Map,this.Ru=new m_,this.Vu={},this.mu=new Map,this.fu=ec.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function a9(r,e,t=!0){const n=Ok(r);let a;const s=n.Tu.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),a=s.view.lu()):a=await kk(n,e,t,!0),a}async function i9(r,e){const t=Ok(r);await kk(t,e,!0,!1)}async function kk(r,e,t,n){const a=await AP(r.localStore,Ja(e)),s=a.targetId,l=r.sharedClientState.addLocalQueryTarget(s,t);let u;return n&&(u=await s9(r,e,s,l==="current",a.resumeToken)),r.isPrimaryClient&&t&&xk(r.remoteStore,a),u}async function s9(r,e,t,n,a){r.pu=(x,_,y)=>(async function(T,S,O,U){let R=S.view.ru(O);R.Cs&&(R=await US(T.localStore,S.query,!1).then((({documents:A})=>S.view.ru(A,R))));const Y=U&&U.targetChanges.get(S.targetId),te=U&&U.targetMismatches.get(S.targetId)!=null,G=S.view.applyChanges(R,T.isPrimaryClient,Y,te);return $S(T,S.targetId,G.au),G.snapshot})(r,x,_,y);const s=await US(r.localStore,e,!0),l=new e9(e,s.Qs),u=l.ru(s.documents),f=T0.createSynthesizedTargetChangeForCurrentChange(t,n&&r.onlineState!=="Offline",a),d=l.applyChanges(u,r.isPrimaryClient,f);$S(r,t,d.au);const m=new t9(e,t,l);return r.Tu.set(e,m),r.Iu.has(t)?r.Iu.get(t).push(e):r.Iu.set(t,[e]),d.snapshot}async function o9(r,e,t){const n=ft(r),a=n.Tu.get(e),s=n.Iu.get(a.targetId);if(s.length>1)return n.Iu.set(a.targetId,s.filter((l=>!Pp(l,e)))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(a.targetId),n.sharedClientState.isActiveQueryTarget(a.targetId)||await ov(n.localStore,a.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(a.targetId),t&&__(n.remoteStore,a.targetId),uv(n,a.targetId)})).catch(uc)):(uv(n,a.targetId),await ov(n.localStore,a.targetId,!0))}async function l9(r,e){const t=ft(r),n=t.Tu.get(e),a=t.Iu.get(n.targetId);t.isPrimaryClient&&a.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),__(t.remoteStore,n.targetId))}async function c9(r,e,t){const n=Fk(r);try{const a=await(function(l,u){const f=ft(l),d=$t.now(),m=u.reduce(((y,w)=>y.add(w.key)),yt());let x,_;return f.persistence.runTransaction("Locally write mutations","readwrite",(y=>{let w=wa(),T=yt();return f.Ns.getEntries(y,m).next((S=>{w=S,w.forEach(((O,U)=>{U.isValidDocument()||(T=T.add(O))}))})).next((()=>f.localDocuments.getOverlayedDocuments(y,w))).next((S=>{x=S;const O=[];for(const U of u){const R=SM(U,x.get(U.key).overlayedDocument);R!=null&&O.push(new Xo(U.key,R,mI(R.value.mapValue),Sa.exists(!0)))}return f.mutationQueue.addMutationBatch(y,d,O,u)})).next((S=>{_=S;const O=S.applyToLocalDocumentSet(x,T);return f.documentOverlayCache.saveOverlays(y,S.batchId,O)}))})).then((()=>({batchId:_.batchId,changes:AI(x)})))})(n.localStore,e);n.sharedClientState.addPendingMutation(a.batchId),(function(l,u,f){let d=l.Vu[l.currentUser.toKey()];d||(d=new yr(ut)),d=d.insert(u,f),l.Vu[l.currentUser.toKey()]=d})(n,a.batchId,t),await S0(n,a.changes),await w0(n.remoteStore)}catch(a){const s=S_(a,"Failed to persist write");t.reject(s)}}async function Ck(r,e){const t=ft(r);try{const n=await EP(t.localStore,e);e.targetChanges.forEach(((a,s)=>{const l=t.Au.get(s);l&&(Je(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?l.hu=!0:a.modifiedDocuments.size>0?Je(l.hu,14607):a.removedDocuments.size>0&&(Je(l.hu,42227),l.hu=!1))})),await S0(t,n,e)}catch(n){await uc(n)}}function YS(r,e,t){const n=ft(r);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const a=[];n.Tu.forEach(((s,l)=>{const u=l.view.va(e);u.snapshot&&a.push(u.snapshot)})),(function(l,u){const f=ft(l);f.onlineState=u;let d=!1;f.queries.forEach(((m,x)=>{for(const _ of x.Sa)_.va(u)&&(d=!0)})),d&&A_(f)})(n.eventManager,e),a.length&&n.Pu.H_(a),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function u9(r,e,t){const n=ft(r);n.sharedClientState.updateQueryState(e,"rejected",t);const a=n.Au.get(e),s=a&&a.key;if(s){let l=new yr(qe.comparator);l=l.insert(s,Rr.newNoDocument(s,tt.min()));const u=yt().add(s),f=new Bp(tt.min(),new Map,new yr(ut),l,u);await Ck(n,f),n.du=n.du.remove(s),n.Au.delete(e),I_(n)}else await ov(n.localStore,e,!1).then((()=>uv(n,e,t))).catch(uc)}async function f9(r,e){const t=ft(r),n=e.batch.batchId;try{const a=await TP(t.localStore,e);Dk(t,n,null),Rk(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await S0(t,a)}catch(a){await uc(a)}}async function h9(r,e,t){const n=ft(r);try{const a=await(function(l,u){const f=ft(l);return f.persistence.runTransaction("Reject batch","readwrite-primary",(d=>{let m;return f.mutationQueue.lookupMutationBatch(d,u).next((x=>(Je(x!==null,37113),m=x.keys(),f.mutationQueue.removeMutationBatch(d,x)))).next((()=>f.mutationQueue.performConsistencyCheck(d))).next((()=>f.documentOverlayCache.removeOverlaysForBatchId(d,m,u))).next((()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,m))).next((()=>f.localDocuments.getDocuments(d,m)))}))})(n.localStore,e);Dk(n,e,t),Rk(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await S0(n,a)}catch(a){await uc(a)}}function Rk(r,e){(r.mu.get(e)||[]).forEach((t=>{t.resolve()})),r.mu.delete(e)}function Dk(r,e,t){const n=ft(r);let a=n.Vu[n.currentUser.toKey()];if(a){const s=a.get(e);s&&(t?s.reject(t):s.resolve(),a=a.remove(e)),n.Vu[n.currentUser.toKey()]=a}}function uv(r,e,t=null){r.sharedClientState.removeLocalQueryTarget(e);for(const n of r.Iu.get(e))r.Tu.delete(n),t&&r.Pu.yu(n,t);r.Iu.delete(e),r.isPrimaryClient&&r.Ru.jr(e).forEach((n=>{r.Ru.containsKey(n)||Nk(r,n)}))}function Nk(r,e){r.Eu.delete(e.path.canonicalString());const t=r.du.get(e);t!==null&&(__(r.remoteStore,t),r.du=r.du.remove(e),r.Au.delete(t),I_(r))}function $S(r,e,t){for(const n of t)n instanceof bk?(r.Ru.addReference(n.key,e),d9(r,n)):n instanceof Ik?(Le(b_,"Document no longer in limbo: "+n.key),r.Ru.removeReference(n.key,e),r.Ru.containsKey(n.key)||Nk(r,n.key)):Ye(19791,{wu:n})}function d9(r,e){const t=e.key,n=t.path.canonicalString();r.du.get(t)||r.Eu.has(n)||(Le(b_,"New document in limbo: "+t),r.Eu.add(n),I_(r))}function I_(r){for(;r.Eu.size>0&&r.du.size<r.maxConcurrentLimboResolutions;){const e=r.Eu.values().next().value;r.Eu.delete(e);const t=new qe(nr.fromString(e)),n=r.fu.next();r.Au.set(n,new r9(t)),r.du=r.du.insert(t,n),xk(r.remoteStore,new As(Ja(_0(t.path)),n,"TargetPurposeLimboResolution",Ya.ce))}}async function S0(r,e,t){const n=ft(r),a=[],s=[],l=[];n.Tu.isEmpty()||(n.Tu.forEach(((u,f)=>{l.push(n.pu(f,e,t).then((d=>{var m;if((d||t)&&n.isPrimaryClient){const x=d?!d.fromCache:(m=t==null?void 0:t.targetChanges.get(f.targetId))==null?void 0:m.current;n.sharedClientState.updateQueryState(f.targetId,x?"current":"not-current")}if(d){a.push(d);const x=x_.As(f.targetId,d);s.push(x)}})))})),await Promise.all(l),n.Pu.H_(a),await(async function(f,d){const m=ft(f);try{await m.persistence.runTransaction("notifyLocalViewChanges","readwrite",(x=>oe.forEach(d,(_=>oe.forEach(_.Es,(y=>m.persistence.referenceDelegate.addReference(x,_.targetId,y))).next((()=>oe.forEach(_.ds,(y=>m.persistence.referenceDelegate.removeReference(x,_.targetId,y)))))))))}catch(x){if(!Ko(x))throw x;Le(v_,"Failed to update sequence numbers: "+x)}for(const x of d){const _=x.targetId;if(!x.fromCache){const y=m.Ms.get(_),w=y.snapshotVersion,T=y.withLastLimboFreeSnapshotVersion(w);m.Ms=m.Ms.insert(_,T)}}})(n.localStore,s))}async function m9(r,e){const t=ft(r);if(!t.currentUser.isEqual(e)){Le(b_,"User change. New user:",e.toKey());const n=await hk(t.localStore,e);t.currentUser=e,(function(s,l){s.mu.forEach((u=>{u.forEach((f=>{f.reject(new Ke(ke.CANCELLED,l))}))})),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await S0(t,n.Ls)}}function p9(r,e){const t=ft(r),n=t.Au.get(e);if(n&&n.hu)return yt().add(n.key);{let a=yt();const s=t.Iu.get(e);if(!s)return a;for(const l of s){const u=t.Tu.get(l);a=a.unionWith(u.view.nu)}return a}}function Ok(r){const e=ft(r);return e.remoteStore.remoteSyncer.applyRemoteEvent=Ck.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=p9.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=u9.bind(null,e),e.Pu.H_=JP.bind(null,e.eventManager),e.Pu.yu=ZP.bind(null,e.eventManager),e}function Fk(r){const e=ft(r);return e.remoteStore.remoteSyncer.applySuccessfulWrite=f9.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=h9.bind(null,e),e}class $h{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Hp(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return fk(this.persistence,new uk,e.initialUser,this.serializer)}Cu(e){return new p_(jp.mi,this.serializer)}Du(e){return new mk}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}$h.provider={build:()=>new $h};class g9 extends $h{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Je(this.persistence.referenceDelegate instanceof np,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new ik(n,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?In.withCacheSize(this.cacheSizeBytes):In.DEFAULT;return new p_((n=>np.mi(n,t)),this.serializer)}}class x9 extends $h{constructor(e,t,n){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await Fk(this.xu.syncEngine),await w0(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return fk(this.persistence,new uk,e.initialUser,this.serializer)}Fu(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new ik(n,e.asyncQueue,t)}Mu(e,t){const n=new EF(t,this.persistence);return new TF(e.asyncQueue,n)}Cu(e){const t=xP(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=this.cacheSizeBytes!==void 0?In.withCacheSize(this.cacheSizeBytes):In.DEFAULT;return new g_(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,NP(),Nm(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new mk}}class ip{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>YS(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=m9.bind(null,this.syncEngine),await YP(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new QP})()}createDatastore(e){const t=Hp(e.databaseInfo.databaseId),n=(function(s){return new DP(s)})(e.databaseInfo);return(function(s,l,u,f){return new PP(s,l,u,f)})(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return(function(n,a,s,l,u){return new VP(n,a,s,l,u)})(this.localStore,this.datastore,e.asyncQueue,(t=>YS(this.syncEngine,t,0)),(function(){return HS.v()?new HS:new IP})())}createSyncEngine(e,t){return(function(a,s,l,u,f,d,m){const x=new n9(a,s,l,u,f,d);return m&&(x.gu=!0),x})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(a){const s=ft(a);Le(tc,"RemoteStore shutting down."),s.Ea.add(5),await E0(s),s.Aa.shutdown(),s.Ra.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}ip.provider={build:()=>new ip};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mk{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Hn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zo="FirestoreClient";class v9{constructor(e,t,n,a,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=a,this.user=vn.UNAUTHENTICATED,this.clientId=Kv.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,(async l=>{Le(zo,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l})),this.appCheckCredentials.start(n,(l=>(Le(zo,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Is;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=S_(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function xx(r,e){r.asyncQueue.verifyOperationInProgress(),Le(zo,"Initializing OfflineComponentProvider");const t=r.configuration;await e.initialize(t);let n=t.initialUser;r.setCredentialChangeListener((async a=>{n.isEqual(a)||(await hk(e.localStore,a),n=a)})),e.persistence.setDatabaseDeletedListener((()=>r.terminate())),r._offlineComponents=e}async function QS(r,e){r.asyncQueue.verifyOperationInProgress();const t=await _9(r);Le(zo,"Initializing OnlineComponentProvider"),await e.initialize(t,r.configuration),r.setCredentialChangeListener((n=>qS(e.remoteStore,n))),r.setAppCheckTokenChangeListener(((n,a)=>qS(e.remoteStore,a))),r._onlineComponents=e}async function _9(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){Le(zo,"Using user provided OfflineComponentProvider");try{await xx(r,r._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(a){return a.name==="FirebaseError"?a.code===ke.FAILED_PRECONDITION||a.code===ke.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(t))throw t;Yl("Error using user provided cache. Falling back to memory cache: "+t),await xx(r,new $h)}}else Le(zo,"Using default OfflineComponentProvider"),await xx(r,new g9(void 0));return r._offlineComponents}async function Pk(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(Le(zo,"Using user provided OnlineComponentProvider"),await QS(r,r._uninitializedComponentsProvider._online)):(Le(zo,"Using default OnlineComponentProvider"),await QS(r,new ip))),r._onlineComponents}function y9(r){return Pk(r).then((e=>e.syncEngine))}async function fv(r){const e=await Pk(r),t=e.eventManager;return t.onListen=a9.bind(null,e.syncEngine),t.onUnlisten=o9.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=i9.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=l9.bind(null,e.syncEngine),t}function T9(r,e,t={}){const n=new Is;return r.asyncQueue.enqueueAndForget((async()=>(function(s,l,u,f,d){const m=new Mk({next:_=>{m.Nu(),l.enqueueAndForget((()=>Sk(s,x)));const y=_.docs.has(u);!y&&_.fromCache?d.reject(new Ke(ke.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&_.fromCache&&f&&f.source==="server"?d.reject(new Ke(ke.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(_)},error:_=>d.reject(_)}),x=new Ak(_0(u.path),m,{includeMetadataChanges:!0,qa:!0});return wk(s,x)})(await fv(r),r.asyncQueue,e,t,n))),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lk(r){const e={};return r.timeoutSeconds!==void 0&&(e.timeoutSeconds=r.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JS=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vk="firestore.googleapis.com",ZS=!0;class eA{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ke(ke.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Vk,this.ssl=ZS}else this.host=e.host,this.ssl=e.ssl??ZS;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=tk;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<eP)throw new Ke(ke.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}xF("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Lk(e.experimentalLongPollingOptions??{}),(function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new Ke(ke.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new Ke(ke.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new Ke(ke.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(n,a){return n.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class k_{constructor(e,t,n,a){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new eA({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ke(ke.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ke(ke.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new eA(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(n){if(!n)return new sF;switch(n.type){case"firstParty":return new uF(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Ke(ke.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const n=JS.get(t);n&&(Le("ComponentProvider","Removing Datastore"),JS.delete(t),n.terminate())})(this),Promise.resolve()}}function E9(r,e,t,n={}){var d;r=ks(r,k_);const a=Qu(e),s=r._getSettings(),l={...s,emulatorOptions:r._getEmulatorOptions()},u=`${e}:${t}`;a&&(Ab(`https://${u}`),bb("Firestore",!0)),s.host!==Vk&&s.host!==u&&Yl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const f={...s,host:u,ssl:a,emulatorOptions:n};if(!Lo(f,l)&&(r._setSettings(f),n.mockUserToken)){let m,x;if(typeof n.mockUserToken=="string")m=n.mockUserToken,x=vn.MOCK_USER;else{m=uN(n.mockUserToken,(d=r._app)==null?void 0:d.options.projectId);const _=n.mockUserToken.sub||n.mockUserToken.user_id;if(!_)throw new Ke(ke.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");x=new vn(_)}r._authCredentials=new oF(new j4(m,x))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qp{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new qp(this.firestore,e,this._query)}}class Jr{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Qh(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Jr(this.firestore,e,this._key)}toJSON(){return{type:Jr._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(g0(t,Jr._jsonSchema))return new Jr(e,n||null,new qe(nr.fromString(t.referencePath)))}}Jr._jsonSchemaVersion="firestore/documentReference/1.0",Jr._jsonSchema={type:Wr("string",Jr._jsonSchemaVersion),referencePath:Wr("string")};class Qh extends qp{constructor(e,t,n){super(e,t,_0(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Jr(this.firestore,null,new qe(e))}withConverter(e){return new Qh(this.firestore,e,this._path)}}function w9(r,e,...t){if(r=Fn(r),arguments.length===1&&(e=Kv.newId()),gF("doc","path",e),r instanceof k_){const n=nr.fromString(e,...t);return Gw(n),new Jr(r,null,new qe(n))}{if(!(r instanceof Jr||r instanceof Qh))throw new Ke(ke.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(nr.fromString(e,...t));return Gw(n),new Jr(r.firestore,r instanceof Qh?r.converter:null,new qe(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tA="AsyncQueue";class rA{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new pk(this,"async_queue_retry"),this._c=()=>{const n=Nm();n&&Le(tA,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const t=Nm();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Nm();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Is;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Ko(e))throw e;Le(tA,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((n=>{throw this.nc=n,this.rc=!1,Hn("INTERNAL UNHANDLED ERROR: ",nA(n)),n})).then((n=>(this.rc=!1,n))))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const a=w_.createAndSchedule(this,e,t,n,(s=>this.hc(s)));return this.tc.push(a),a}uc(){this.nc&&Ye(47125,{Pc:nA(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,n)=>t.targetTimeMs-n.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function nA(r){let e=r.message||"";return r.stack&&(e=r.stack.includes(r.message)?r.stack:r.message+`
`+r.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aA(r){return(function(t,n){if(typeof t!="object"||t===null)return!1;const a=t;for(const s of n)if(s in a&&typeof a[s]=="function")return!0;return!1})(r,["next","error","complete"])}class Xu extends k_{constructor(e,t,n,a){super(e,t,n,a),this.type="firestore",this._queue=new rA,this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new rA(e),this._firestoreClient=void 0,await e}}}function S9(r,e){const t=typeof r=="object"?r:kv(),n=typeof r=="string"?r:Wm,a=cc(t,"firestore").getImmediate({identifier:n});if(!a._initialized){const s=lN("firestore");s&&E9(a,...s)}return a}function C_(r){if(r._terminated)throw new Ke(ke.FAILED_PRECONDITION,"The client has already been terminated.");return r._firestoreClient||Bk(r),r._firestoreClient}function Bk(r){var n,a,s;const e=r._freezeSettings(),t=(function(u,f,d,m){return new QF(u,f,d,m.host,m.ssl,m.experimentalForceLongPolling,m.experimentalAutoDetectLongPolling,Lk(m.experimentalLongPollingOptions),m.useFetchStreams,m.isUsingEmulator)})(r._databaseId,((n=r._app)==null?void 0:n.options.appId)||"",r._persistenceKey,e);r._componentsProvider||(a=e.localCache)!=null&&a._offlineComponentProvider&&((s=e.localCache)!=null&&s._onlineComponentProvider)&&(r._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),r._firestoreClient=new v9(r._authCredentials,r._appCheckCredentials,r._queue,t,r._componentsProvider&&(function(u){const f=u==null?void 0:u._online.build();return{_offline:u==null?void 0:u._offline.build(f),_online:f}})(r._componentsProvider))}function A9(r,e){Yl("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=r._freezeSettings();return b9(r,ip.provider,{build:n=>new x9(n,t.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}function b9(r,e,t){if((r=ks(r,Xu))._firestoreClient||r._terminated)throw new Ke(ke.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(r._componentsProvider||r._getSettings().localCache)throw new Ke(ke.FAILED_PRECONDITION,"SDK cache is already specified.");r._componentsProvider={_online:e,_offline:t},Bk(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wa{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Wa(Yr.fromBase64String(e))}catch(t){throw new Ke(ke.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Wa(Yr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Wa._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(g0(e,Wa._jsonSchema))return Wa.fromBase64String(e.bytes)}}Wa._jsonSchemaVersion="firestore/bytes/1.0",Wa._jsonSchema={type:Wr("string",Wa._jsonSchemaVersion),bytes:Wr("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R_{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ke(ke.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Er(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D_{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gi{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ke(ke.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ke(ke.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ut(this._lat,e._lat)||ut(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Gi._jsonSchemaVersion}}static fromJSON(e){if(g0(e,Gi._jsonSchema))return new Gi(e.latitude,e.longitude)}}Gi._jsonSchemaVersion="firestore/geoPoint/1.0",Gi._jsonSchema={type:Wr("string",Gi._jsonSchemaVersion),latitude:Wr("number"),longitude:Wr("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qi{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(n,a){if(n.length!==a.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==a[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:qi._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(g0(e,qi._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new qi(e.vectorValues);throw new Ke(ke.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}qi._jsonSchemaVersion="firestore/vectorValue/1.0",qi._jsonSchema={type:Wr("string",qi._jsonSchemaVersion),vectorValues:Wr("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I9=/^__.*__$/;class k9{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new Xo(e,this.data,this.fieldMask,t,this.fieldTransforms):new tf(e,this.data,t,this.fieldTransforms)}}function Uk(r){switch(r){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ye(40011,{Ac:r})}}class N_{constructor(e,t,n,a,s,l){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=a,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new N_({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var a;const t=(a=this.path)==null?void 0:a.child(e),n=this.Vc({path:t,fc:!1});return n.gc(e),n}yc(e){var a;const t=(a=this.path)==null?void 0:a.child(e),n=this.Vc({path:t,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return sp(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Uk(this.Ac)&&I9.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class C9{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Hp(e)}Cc(e,t,n,a=!1){return new N_({Ac:e,methodName:t,Dc:n,path:Er.emptyPath(),fc:!1,bc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function R9(r){const e=r._freezeSettings(),t=Hp(r._databaseId);return new C9(r._databaseId,!!e.ignoreUndefinedProperties,t)}function D9(r,e,t,n,a,s={}){const l=r.Cc(s.merge||s.mergeFields?2:0,e,t,a);Gk("Data must be an object, but it was:",l,n);const u=jk(n,l);let f,d;if(s.merge)f=new $a(l.fieldMask),d=l.fieldTransforms;else if(s.mergeFields){const m=[];for(const x of s.mergeFields){const _=N9(e,x,t);if(!l.contains(_))throw new Ke(ke.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);F9(m,_)||m.push(_)}f=new $a(m),d=l.fieldTransforms.filter((x=>f.covers(x.field)))}else f=null,d=l.fieldTransforms;return new k9(new na(u),f,d)}class O_ extends D_{_toFieldTransform(e){return new NI(e.path,new ju)}isEqual(e){return e instanceof O_}}function zk(r,e){if(Hk(r=Fn(r)))return Gk("Unsupported field value:",e,r),jk(r,e);if(r instanceof D_)return(function(n,a){if(!Uk(a.Ac))throw a.Sc(`${n._methodName}() can only be used with update() and set()`);if(!a.path)throw a.Sc(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(a);s&&a.fieldTransforms.push(s)})(r,e),null;if(r===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),r instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(n,a){const s=[];let l=0;for(const u of n){let f=zk(u,a.wc(l));f==null&&(f={nullValue:"NULL_VALUE"}),s.push(f),l++}return{arrayValue:{values:s}}})(r,e)}return(function(n,a){if((n=Fn(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return vM(a.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=$t.fromDate(n);return{timestampValue:qu(a.serializer,s)}}if(n instanceof $t){const s=new $t(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:qu(a.serializer,s)}}if(n instanceof Gi)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Wa)return{bytesValue:BI(a.serializer,n._byteString)};if(n instanceof Jr){const s=a.databaseId,l=n.firestore._databaseId;if(!l.isEqual(s))throw a.Sc(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:f_(n.firestore._databaseId||a.databaseId,n._key.path)}}if(n instanceof qi)return(function(l,u){return{mapValue:{fields:{[t_]:{stringValue:r_},[Vu]:{arrayValue:{values:l.toArray().map((d=>{if(typeof d!="number")throw u.Sc("VectorValues must only contain numeric values.");return i_(u.serializer,d)}))}}}}}})(n,a);throw a.Sc(`Unsupported field value: ${Xv(n)}`)})(r,e)}function jk(r,e){const t={};return iI(r)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):fc(r,((n,a)=>{const s=zk(a,e.mc(n));s!=null&&(t[n]=s)})),{mapValue:{fields:t}}}function Hk(r){return!(typeof r!="object"||r===null||r instanceof Array||r instanceof Date||r instanceof $t||r instanceof Gi||r instanceof Wa||r instanceof Jr||r instanceof D_||r instanceof qi)}function Gk(r,e,t){if(!Hk(t)||!G4(t)){const n=Xv(t);throw n==="an object"?e.Sc(r+" a custom object"):e.Sc(r+" "+n)}}function N9(r,e,t){if((e=Fn(e))instanceof R_)return e._internalPath;if(typeof e=="string")return qk(r,e);throw sp("Field path arguments must be of type string or ",r,!1,void 0,t)}const O9=new RegExp("[~\\*/\\[\\]]");function qk(r,e,t){if(e.search(O9)>=0)throw sp(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,t);try{return new R_(...e.split("."))._internalPath}catch{throw sp(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,t)}}function sp(r,e,t,n,a){const s=n&&!n.isEmpty(),l=a!==void 0;let u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let f="";return(s||l)&&(f+=" (found",s&&(f+=` in field ${n}`),l&&(f+=` in document ${a}`),f+=")"),new Ke(ke.INVALID_ARGUMENT,u+r+f)}function F9(r,e){return r.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kk{constructor(e,t,n,a,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=a,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Jr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new M9(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Xk("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class M9 extends Kk{data(){return super.data()}}function Xk(r,e){return typeof e=="string"?qk(r,e):e instanceof R_?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P9(r){if(r.limitType==="L"&&r.explicitOrderBy.length===0)throw new Ke(ke.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class L9{convertValue(e,t="none"){switch(Vo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return _r(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ms(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ye(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return fc(e,((a,s)=>{n[a]=this.convertValue(s,t)})),n}convertVectorValue(e){var n,a,s;const t=(s=(a=(n=e.fields)==null?void 0:n[Vu].arrayValue)==null?void 0:a.values)==null?void 0:s.map((l=>_r(l.doubleValue)));return new qi(t)}convertGeoPoint(e){return new Gi(_r(e.latitude),_r(e.longitude))}convertArray(e,t){return(e.values||[]).map((n=>this.convertValue(n,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Op(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Kh(e));default:return null}}convertTimestamp(e){const t=Fs(e);return new $t(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=nr.fromString(e);Je(YI(n),9688,{name:e});const a=new $l(n.get(1),n.get(3)),s=new qe(n.popFirst(5));return a.isEqual(t)||Hn(`Document ${s} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V9(r,e,t){let n;return n=r?t&&(t.merge||t.mergeFields)?r.toFirestore(e,t):r.toFirestore(e):e,n}class gh{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ul extends Kk{constructor(e,t,n,a,s,l){super(e,t,n,a,l),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Om(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(Xk("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ke(ke.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Ul._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Ul._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ul._jsonSchema={type:Wr("string",Ul._jsonSchemaVersion),bundleSource:Wr("string","DocumentSnapshot"),bundleName:Wr("string"),bundle:Wr("string")};class Om extends Ul{data(e={}){return super.data(e)}}class Iu{constructor(e,t,n,a){this._firestore=e,this._userDataWriter=t,this._snapshot=a,this.metadata=new gh(a.hasPendingWrites,a.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new Om(this._firestore,this._userDataWriter,n.key,n,new gh(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ke(ke.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(a,s){if(a._snapshot.oldDocs.isEmpty()){let l=0;return a._snapshot.docChanges.map((u=>{const f=new Om(a._firestore,a._userDataWriter,u.doc.key,u.doc,new gh(a._snapshot.mutatedKeys.has(u.doc.key),a._snapshot.fromCache),a.query.converter);return u.doc,{type:"added",doc:f,oldIndex:-1,newIndex:l++}}))}{let l=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((u=>s||u.type!==3)).map((u=>{const f=new Om(a._firestore,a._userDataWriter,u.doc.key,u.doc,new gh(a._snapshot.mutatedKeys.has(u.doc.key),a._snapshot.fromCache),a.query.converter);let d=-1,m=-1;return u.type!==0&&(d=l.indexOf(u.doc.key),l=l.delete(u.doc.key)),u.type!==1&&(l=l.add(u.doc),m=l.indexOf(u.doc.key)),{type:B9(u.type),doc:f,oldIndex:d,newIndex:m}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ke(ke.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Iu._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Kv.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],a=[];return this.docs.forEach((s=>{s._document!==null&&(t.push(s._document),n.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),a.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function B9(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ye(61501,{type:r})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U9(r){r=ks(r,Jr);const e=ks(r.firestore,Xu);return T9(C_(e),r._key).then((t=>Yk(e,r,t)))}Iu._jsonSchemaVersion="firestore/querySnapshot/1.0",Iu._jsonSchema={type:Wr("string",Iu._jsonSchemaVersion),bundleSource:Wr("string","QuerySnapshot"),bundleName:Wr("string"),bundle:Wr("string")};class Wk extends L9{constructor(e){super(),this.firestore=e}convertBytes(e){return new Wa(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Jr(this.firestore,null,t)}}function z9(r,e,t){r=ks(r,Jr);const n=ks(r.firestore,Xu),a=V9(r.converter,e,t);return H9(n,[D9(R9(n),"setDoc",r._key,a,r.converter!==null,t).toMutation(r._key,Sa.none())])}function j9(r,...e){var f,d,m;r=Fn(r);let t={includeMetadataChanges:!1,source:"default"},n=0;typeof e[n]!="object"||aA(e[n])||(t=e[n++]);const a={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(aA(e[n])){const x=e[n];e[n]=(f=x.next)==null?void 0:f.bind(x),e[n+1]=(d=x.error)==null?void 0:d.bind(x),e[n+2]=(m=x.complete)==null?void 0:m.bind(x)}let s,l,u;if(r instanceof Jr)l=ks(r.firestore,Xu),u=_0(r._key.path),s={next:x=>{e[n]&&e[n](Yk(l,r,x))},error:e[n+1],complete:e[n+2]};else{const x=ks(r,qp);l=ks(x.firestore,Xu),u=x._query;const _=new Wk(l);s={next:y=>{e[n]&&e[n](new Iu(l,_,x,y))},error:e[n+1],complete:e[n+2]},P9(r._query)}return(function(_,y,w,T){const S=new Mk(T),O=new Ak(y,S,w);return _.asyncQueue.enqueueAndForget((async()=>wk(await fv(_),O))),()=>{S.Nu(),_.asyncQueue.enqueueAndForget((async()=>Sk(await fv(_),O)))}})(C_(l),u,a,s)}function H9(r,e){return(function(n,a){const s=new Is;return n.asyncQueue.enqueueAndForget((async()=>c9(await y9(n),a,s))),s.promise})(C_(r),e)}function Yk(r,e,t){const n=t.docs.get(e._key),a=new Wk(r);return new Ul(r,a,e._key,n,new gh(t.hasPendingWrites,t.fromCache),e.converter)}function G9(){return new O_("serverTimestamp")}(function(e,t=!0){(function(a){ef=a})(Ju),Ki(new wi("firestore",((n,{instanceIdentifier:a,options:s})=>{const l=n.getProvider("app").getImmediate(),u=new Xu(new lF(n.getProvider("auth-internal")),new fF(l,n.getProvider("app-check-internal")),(function(d,m){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new Ke(ke.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new $l(d.options.projectId,m)})(l,a),l);return s={useFetchStreams:t,...s},u._setSettings(s),u}),"PUBLIC").setMultipleInstances(!0)),Qa(Uw,zw,e),Qa(Uw,zw,"esm2020")})();const q9={apiKey:"AIzaSyCNakdhJevTPVbynomVQuv5nSsXmPewUAs",authDomain:"smartspend-june0311.firebaseapp.com",projectId:"smartspend-june0311",storageBucket:"smartspend-june0311.firebasestorage.app",messagingSenderId:"173532794836",appId:"1:173532794836:web:9a4a9dcedb22b5ada31041",measurementId:"G-MK724M9C36"},F_=Mb(q9);tF(F_);const M_=M5(F_),K9=new Es,$k=S9(F_);A9($k).catch(r=>{r.code==="failed-precondition"?console.warn("Firestore  :    "):r.code==="unimplemented"&&console.warn("Firestore  :   ")});const X9=async()=>{try{return(await GO(M_,K9)).user}catch(r){throw console.error("Google  :",r),r}},W9=async()=>{try{await SO(M_)}catch(r){throw console.error(" :",r),r}},Y9=r=>wO(M_,r),Qk=()=>{const[r,e]=Qe.useState(null),[t,n]=Qe.useState(!0),[a,s]=Qe.useState(null);Qe.useEffect(()=>{const f=Y9(d=>{e(d),n(!1)});return()=>f()},[]);const l=Qe.useCallback(async()=>{try{s(null),await X9()}catch(f){s(f.message),console.error(" :",f)}},[]),u=Qe.useCallback(async()=>{try{s(null),await W9()}catch(f){s(f.message),console.error(" :",f)}},[]);return{user:r,loading:t,error:a,signIn:l,signOut:u,isAuthenticated:!!r}},op=[{color:"bg-amber-100 text-amber-700",chartColor:"text-amber-400",fillColor:"#fbbf24",icon:""},{color:"bg-green-100 text-green-700",chartColor:"text-green-400",fillColor:"#4ade80",icon:""},{color:"bg-blue-100 text-blue-700",chartColor:"text-blue-400",fillColor:"#60a5fa",icon:""},{color:"bg-pink-100 text-pink-700",chartColor:"text-pink-400",fillColor:"#f472b6",icon:""},{color:"bg-cyan-100 text-cyan-700",chartColor:"text-cyan-500",fillColor:"#06b6d4",icon:""},{color:"bg-orange-100 text-orange-700",chartColor:"text-orange-400",fillColor:"#fb923c",icon:""},{color:"bg-violet-100 text-violet-700",chartColor:"text-violet-400",fillColor:"#a78bfa",icon:""},{color:"bg-gray-100 text-gray-700",chartColor:"text-gray-400",fillColor:"#9ca3af",icon:""}],Kp=Array.from({length:12},(r,e)=>`${e+1}`),P_=r=>w9($k,"budgets",r),Jk=async(r,e)=>{if(!r){console.error("saveBudgetData: userId ");return}try{await z9(P_(r),{...e,updatedAt:G9()},{merge:!0}),console.log("Firestore   ")}catch(t){throw console.error("Firestore  :",t),t}},Zk=async r=>{if(!r)return console.error("loadBudgetData: userId "),null;try{const e=await U9(P_(r));if(e.exists()){const t=e.data();return console.log("Firestore   "),t}return console.log("Firestore   "),null}catch(e){throw console.error("Firestore  :",e),e}},$9=(r,e)=>r?j9(P_(r),t=>{t.exists()?e(t.data()):e(null)},t=>{console.error("Firestore  :",t)}):(console.error("subscribeToBudgetData: userId "),()=>{}),Q9=async r=>{try{const e=localStorage.getItem("budgetData");if(!e)return!1;const t=await Zk(r);if(t&&t.dbData&&Object.keys(t.dbData).length>0)return console.log("Firestore     "),!1;const n=JSON.parse(e);return await Jk(r,n),console.log("LocalStorage  Firestore  "),!0}catch(e){return console.error(" :",e),!1}},eC=Qe.createContext(),ka=()=>{const r=Qe.useContext(eC);if(!r)throw new Error("useBudgetContext must be used within a BudgetProvider");return r},J9=({children:r,userId:e})=>{const[t,n]=Qe.useState({}),[a,s]=Qe.useState([]),[l,u]=Qe.useState(new Date().getFullYear()),[f,d]=Qe.useState(Kp[0]),[m,x]=Qe.useState("home"),[_,y]=Qe.useState(!0),[w,T]=Qe.useState("idle"),S=Qe.useRef(!1),O=Qe.useRef(!0),U=Qe.useRef(null);Qe.useEffect(()=>{if(!e){y(!1);return}let le=()=>{};return(async()=>{try{y(!0),T("syncing"),await Q9(e);const ie=await Zk(e);ie&&(n(ie.dbData||{}),s(ie.categories||[])),le=$9(e,Ne=>{var Q,N;if(Ne&&!O.current){const J=((N=(Q=Ne.updatedAt)==null?void 0:Q.toMillis)==null?void 0:N.call(Q))||0;console.log("  :",J),n(Ne.dbData||{}),s(Ne.categories||[]),T("synced"),S.current||(Ie({show:!0,message:"  ",type:"success"}),setTimeout(()=>Ie({show:!1,message:"",type:"info"}),3e3))}}),T("synced"),O.current=!1,S.current||(Ie({show:!0,message:"  ",type:"success"}),setTimeout(()=>Ie({show:!1,message:"",type:"info"}),3e3),S.current=!0)}catch(ie){console.error("  :",ie),T("error");try{const Ne=localStorage.getItem("budgetData");if(Ne){const{dbData:Q,categories:N}=JSON.parse(Ne);n(Q||{}),s(N||[]),Ie({show:!0,message:" :    ",type:"info"}),setTimeout(()=>Ie({show:!1,message:"",type:"info"}),3e3)}}catch(Ne){console.error("LocalStorage  :",Ne)}}finally{y(!1)}})(),()=>{le()}},[e]),Qe.useEffect(()=>{if(Object.keys(t).length===0)return;let le=!1;const Fe=JSON.parse(JSON.stringify(t)),ie=new Date().getFullYear();Object.keys(Fe).forEach(Ne=>{if(/^\d+$/.test(Ne)){le=!0;const Q=`${ie}-${Ne}`;Fe[Q]?Fe[Q].items=[...Fe[Q].items,...Fe[Ne].items]:Fe[Q]=Fe[Ne],delete Fe[Ne]}}),le&&n(Fe)},[t]);const R=Qe.useCallback(async le=>{if(e)try{T("syncing"),await Jk(e,le),T("synced")}catch(Fe){console.error("Firestore  :",Fe),T("error"),localStorage.setItem("budgetData",JSON.stringify(le))}},[e]);Qe.useEffect(()=>{if(!(O.current||!e)&&!(Object.keys(t).length===0&&a.length===0)){U.current&&clearTimeout(U.current),U.current=setTimeout(()=>{R({dbData:t,categories:a})},500);try{localStorage.setItem("budgetData",JSON.stringify({dbData:t,categories:a}))}catch(le){console.error("LocalStorage  :",le)}return()=>{U.current&&clearTimeout(U.current)}}},[t,a,e,R]);const Y=Qe.useCallback(async()=>{if(e)try{T("syncing"),await R({dbData:t,categories:a}),Ie({show:!0,message:"  ",type:"success"}),setTimeout(()=>Ie({show:!1,message:"",type:"info"}),3e3)}catch{Ie({show:!0,message:" ",type:"error"}),setTimeout(()=>Ie({show:!1,message:"",type:"info"}),3e3)}},[e,t,a,R]),[te,G]=Qe.useState(!1),[A,C]=Qe.useState(!1),[k,V]=Qe.useState(null),[F,M]=Qe.useState({date:new Date().toISOString().slice(0,10),category:"",amount:"",details:"",memo:"",type:"variable"}),[L,Ie]=Qe.useState({show:!1,message:"",type:"info"}),Re=(le,Fe="info")=>{Ie({show:!0,message:le,type:Fe}),setTimeout(()=>{Ie({show:!1,message:"",type:"info"})},3e3)},ae=Qe.useMemo(()=>({dbData:t,setDbData:n,categories:a,setCategories:s,currentYear:l,setCurrentYear:u,currentMonth:f,setCurrentMonth:d,activeTab:m,setActiveTab:x,isCategoryModalOpen:te,setIsCategoryModalOpen:G,isInputModalOpen:A,setIsInputModalOpen:C,editingId:k,setEditingId:V,inputForm:F,setInputForm:M,toast:L,showToast:Re,isLoading:_,syncStatus:w,manualSync:Y,userId:e}),[t,a,l,f,m,te,A,k,F,L,_,w,Y,e]);return B.jsx(eC.Provider,{value:ae,children:r})};/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z9=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),eL=r=>r.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()),iA=r=>{const e=eL(r);return e.charAt(0).toUpperCase()+e.slice(1)},tC=(...r)=>r.filter((e,t,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===t).join(" ").trim(),tL=r=>{for(const e in r)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var rL={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nL=Qe.forwardRef(({color:r="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:a="",children:s,iconNode:l,...u},f)=>Qe.createElement("svg",{ref:f,...rL,width:e,height:e,stroke:r,strokeWidth:n?Number(t)*24/Number(e):t,className:tC("lucide",a),...!s&&!tL(u)&&{"aria-hidden":"true"},...u},[...l.map(([d,m])=>Qe.createElement(d,m)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ar=(r,e)=>{const t=Qe.forwardRef(({className:n,...a},s)=>Qe.createElement(nL,{ref:s,iconNode:e,className:tC(`lucide-${Z9(iA(r))}`,`lucide-${r}`,n),...a}));return t.displayName=iA(r),t};/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aL=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],iL=Ar("calendar",aL);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sL=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],oL=Ar("chart-pie",sL);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lL=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],cL=Ar("chevron-down",lL);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uL=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],So=Ar("chevron-right",uL);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fL=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],hL=Ar("circle-alert",fL);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dL=[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5.782 5.782A7 7 0 0 0 9 19h8.5a4.5 4.5 0 0 0 1.307-.193",key:"yfwify"}],["path",{d:"M21.532 16.5A4.5 4.5 0 0 0 17.5 10h-1.79A7.008 7.008 0 0 0 10 5.07",key:"jlfiyv"}]],mL=Ar("cloud-off",dL);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pL=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],sA=Ar("cloud",pL);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gL=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],xL=Ar("download",gL);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vL=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],_L=Ar("house",vL);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yL=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],rC=Ar("list",yL);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TL=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],EL=Ar("log-out",TL);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wL=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],L_=Ar("pen-line",wL);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SL=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],AL=Ar("plus",SL);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bL=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],oA=Ar("refresh-cw",bL);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IL=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],kL=Ar("rotate-ccw",IL);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CL=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],nC=Ar("save",CL);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RL=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],aC=Ar("settings",RL);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DL=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],V_=Ar("trash-2",DL);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NL=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],OL=Ar("trending-down",NL);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FL=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],ML=Ar("trending-up",FL);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PL=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],LL=Ar("user",PL);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VL=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],BL=Ar("wallet",VL);/**
 * @license lucide-react v0.556.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UL=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],hv=Ar("x",UL),nf=()=>{const{dbData:r,setDbData:e,categories:t,setCategories:n,currentYear:a,currentMonth:s,setCurrentMonth:l,setEditingId:u,setInputForm:f,setIsInputModalOpen:d}=ka(),m=`${a}-${s}`,x=Qe.useMemo(()=>Kp.map(G=>{const A=`${a}-${G}`,C=r[A]||{items:[]},k=C.items.reduce((V,F)=>V+F.amount,0);return{...C,total:k}}),[r,a]),_=Qe.useMemo(()=>{const G=parseInt(s)-1;return x[G]},[x,s]),y=Qe.useMemo(()=>{const G=parseInt(s);let A=a,C=G-1;C===0&&(C=12,A-=1);const k=`${A}-${C}`;return(r[k]||{items:[]}).items.reduce((F,M)=>F+M.amount,0)},[r,a,s]),w=_.total-y,T=Qe.useMemo(()=>{const G=new Date,A=G.getFullYear(),C=G.getMonth()+1,k=G.getDate(),V=parseInt(s);return a>A||a===A&&V>C?_.items.filter(F=>F.type==="fixed").sort((F,M)=>F.day-M.day):a<A||a===A&&V<C?[]:_.items.filter(F=>F.type==="fixed"&&F.day>=k).sort((F,M)=>F.day-M.day)},[_,a,s]),S=Qe.useCallback((G,A)=>{e(C=>{const k={...C};k[m]||(k[m]={items:[]});const V=[...k[m].items];if(A){const F=V.findIndex(M=>M.id===A);F>-1&&(V[F]={...G,id:A})}else V.push({...G,id:Date.now()});return k[m]={...k[m],items:V},k})},[m,e]),O=Qe.useCallback(G=>{e(A=>{const C={...A};return C[m]&&(C[m].items=C[m].items.filter(k=>k.id!==G)),C})},[m,e]),U=Qe.useCallback(()=>{window.confirm(`   ?
    ,   .`)&&(e({}),n([]),localStorage.removeItem("budgetData"),alert("  ."))},[e,n]),R=Qe.useCallback(()=>{u(null);const G=new Date,A=G.getFullYear(),C=String(G.getMonth()+1).padStart(2,"0"),k=String(G.getDate()).padStart(2,"0");f({date:`${A}-${C}-${k}`,category:"",amount:"",details:"",memo:"",type:"variable"}),d(!0)},[u,f,d]),Y=Qe.useCallback(G=>{u(G.id);const A=parseInt(s.replace("","")),C=String(A).padStart(2,"0"),k=String(G.day).padStart(2,"0");f({date:`${a}-${C}-${k}`,category:G.category,amount:G.amount,details:G.name||G.details,memo:G.memo||"",type:G.type}),d(!0)},[a,s,u,f,d]),te=Qe.useCallback(()=>{const G={dbData:r,categories:t};localStorage.setItem("budgetData",JSON.stringify(G)),alert("  .")},[r,t]);return{currentData:_,monthlyData:x,prevMonthTotal:y,diffAmount:w,upcomingFixedExpenses:T,saveItem:S,deleteItem:O,resetData:U,openCreateModal:R,openEditModal:Y,handleSaveData:te,monthKey:m}},zL=()=>{const{currentYear:r,setCurrentYear:e,currentMonth:t,setCurrentMonth:n}=ka();return B.jsxs("header",{className:"bg-blue-600 pt-6 pb-4 px-4 shadow-lg rounded-b-xl z-20 shrink-0 flex flex-row items-center justify-between gap-4",children:[B.jsxs("div",{className:"flex-[3] flex flex-col items-center justify-center gap-2 shrink-0",children:[B.jsxs("h1",{className:"text-lg font-bold tracking-tight flex items-center justify-center gap-1 text-white whitespace-nowrap",children:[B.jsx(BL,{size:20,className:"text-blue-200"}),"SmartSpend"]}),B.jsxs("div",{className:"relative group w-full flex justify-center",children:[B.jsxs("button",{className:"flex items-center space-x-1 bg-blue-700/50 hover:bg-blue-700 px-3 py-1.5 rounded-full text-xs font-medium transition-colors border border-blue-500 text-white",children:[B.jsxs("span",{children:[r,""]}),B.jsx(cL,{size:14})]}),B.jsx("div",{className:"absolute top-full mt-1 w-24 bg-white rounded-xl shadow-xl overflow-hidden hidden group-hover:block z-50 animate-in fade-in slide-in-from-top-2 duration-200",children:[2024,2025,2026].map(a=>B.jsxs("div",{onClick:()=>e(a),className:"px-4 py-2 text-sm text-center hover:bg-blue-50 text-gray-700 cursor-pointer",children:[a,""]},a))})]})]}),B.jsx("div",{className:"flex-[7] grid grid-cols-6 gap-1",children:Kp.map(a=>B.jsx("button",{onClick:()=>n(a),className:`py-1.5 rounded text-xs font-bold transition-all duration-200 border flex items-center justify-center ${t===a?"bg-white text-blue-600 border-white shadow-md scale-105":"text-blue-100 border-blue-500 hover:bg-blue-500 hover:text-white"}`,children:a},a))})]})},im=({isActive:r,icon:e,label:t,onClick:n})=>B.jsxs("button",{onClick:n,className:`flex flex-col items-center justify-center w-full py-2 transition-all active:scale-95 ${r?"text-blue-600":"text-gray-400 hover:text-gray-600"}`,children:[B.jsx(e,{size:24,className:`mb-1 ${r?"fill-blue-100":""}`,strokeWidth:r?2.5:2}),B.jsx("span",{className:"text-[10px] font-medium",children:t})]}),jL=()=>{const{activeTab:r,setActiveTab:e}=ka();return B.jsxs("nav",{className:"bg-white border-t border-gray-200 h-20 flex justify-around items-center px-2 pb-safe w-full z-30 rounded-t-2xl shadow-[0_-5px_10px_rgba(0,0,0,0.02)] shrink-0 relative",children:[B.jsx(im,{isActive:r==="home",onClick:()=>e("home"),icon:_L,label:""}),B.jsx(im,{isActive:r==="ledger",onClick:()=>e("ledger"),icon:rC,label:""}),B.jsx(im,{isActive:r==="stats",onClick:()=>e("stats"),icon:oL,label:""}),B.jsx(im,{isActive:r==="settings",onClick:()=>e("settings"),icon:aC,label:""})]})},yu=r=>{if(r==null||r==="")return"";const e=typeof r=="string"?parseFloat(iC(r)):r;return isNaN(e)?"":e.toLocaleString("ko-KR")},vu=r=>{const e=yu(r);return e?`${e}`:""},iC=r=>typeof r!="string"?r:r.replace(/[^0-9.]/g,"");function HL({currentYear:r,currentMonth:e,monthlyData:t,categories:n,formatCurrency:a}){const[s,l]=Qe.useState(new Date().getDate()),u=parseInt(e.replace("","")),f=Qe.useMemo(()=>t[u-1]||{items:[]},[t,u]),d=Qe.useMemo(()=>{const x=new Date(r,u,0).getDate(),_=new Date(r,u-1,1).getDay(),y=[];for(let w=0;w<_;w++)y.push(null);for(let w=1;w<=x;w++){const T=f.items.filter(S=>S.day===w);y.push({day:w,items:T})}return y},[r,u,f]),m=Qe.useMemo(()=>s?f.items.filter(x=>x.day===s):[],[s,f]);return B.jsxs("div",{className:"bg-white rounded-2xl p-4 shadow-sm border border-gray-100",children:[B.jsxs("h3",{className:"font-bold text-gray-800 mb-2 text-sm flex items-center",children:[B.jsx(iL,{size:16,className:"text-blue-500 mr-2"}),r," ",e]}),B.jsx("div",{className:"grid grid-cols-7 gap-0.5 mb-1",children:["","","","","","",""].map((x,_)=>B.jsx("div",{className:`text-center text-[17px] font-bold py-1 ${_===0?"text-red-400":_===6?"text-blue-400":"text-gray-400"}`,children:x},_))}),B.jsx("div",{className:"grid grid-cols-7 gap-0.5",children:d.map((x,_)=>B.jsx("div",{className:"h-12",children:x?B.jsxs("button",{onClick:()=>l(x.day),className:`w-full h-full rounded-md flex flex-col items-center justify-start pt-1 transition-all relative border ${s===x.day?"bg-blue-600 text-white border-blue-600 shadow-md ring-1 ring-blue-200 z-10":x.items.length>0?"bg-indigo-50 text-indigo-900 border-indigo-100 font-semibold hover:bg-indigo-100 hover:border-indigo-200":"bg-white text-gray-400 border-transparent hover:bg-gray-50 hover:border-gray-200"}`,children:[B.jsx("span",{className:`text-[16px] ${s===x.day?"font-bold":""}`,children:x.day}),x.items.length>0&&B.jsxs("div",{className:"absolute bottom-1 flex gap-0.5 justify-center w-full px-0.5",children:[x.items.slice(0,3).map((y,w)=>{const T=n.find(O=>O.name===y.category)||{chartColor:"text-gray-400"},S=s===x.day?"text-white":T.chartColor;return B.jsx("span",{className:`text-[6px] leading-none ${S}`,children:""},w)}),x.items.length>3&&B.jsx("span",{className:`text-[6px] leading-none font-bold ${s===x.day?"text-white":"text-gray-400"}`,children:"+"})]})]}):B.jsx("div",{className:"w-full h-full"})},_))}),s&&B.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-100 animate-in fade-in slide-in-from-top-2 duration-300",children:[B.jsxs("h4",{className:"font-bold text-gray-800 mb-3 text-sm",children:[e.replace("",""),"/",s,"  "]}),m.length===0?B.jsx("p",{className:"text-xs text-gray-400 text-center py-4",children:"    ."}):B.jsxs("div",{className:"space-y-2",children:[m.map((x,_)=>{const y=n.find(w=>w.name===x.category)||{icon:"",chartColor:"text-gray-400"};return B.jsxs("div",{className:"flex justify-between items-center p-2 rounded-lg bg-gradient-to-r from-blue-50 to-purple-50",children:[B.jsxs("div",{className:"flex items-center gap-2",children:[B.jsx("span",{className:`text-lg ${y.chartColor}`,children:y.icon}),B.jsxs("div",{children:[B.jsx("p",{className:"text-sm font-bold text-gray-800",children:x.name}),B.jsx("p",{className:"text-xs text-gray-500",children:x.category})]})]}),B.jsxs("p",{className:"font-bold text-gray-900",children:["-",a(x.amount)]})]},_)}),B.jsx("div",{className:"mt-2 pt-2 border-t border-gray-200 text-right",children:B.jsxs("p",{className:"text-xs text-gray-600",children:[": ",B.jsx("span",{className:"font-bold text-blue-600",children:a(m.reduce((x,_)=>x+_.amount,0))})]})})]})]})]})}const lA=()=>{const{currentYear:r,currentMonth:e,categories:t}=ka(),{currentData:n,prevMonthTotal:a,diffAmount:s,upcomingFixedExpenses:l,monthlyData:u}=nf();return B.jsxs("div",{className:"flex-1 overflow-y-auto pb-24 p-5 flex flex-col space-y-5 animate-in fade-in duration-300",children:[B.jsxs("div",{className:"bg-white rounded-3xl p-6 shadow-sm border border-gray-100 text-center relative overflow-hidden flex flex-col justify-center min-h-[200px]",children:[B.jsx("div",{className:"absolute -top-6 -right-6 w-24 h-24 bg-blue-100 rounded-full opacity-50 blur-xl"}),B.jsxs("p",{className:"text-gray-500 text-sm mb-1 font-medium",children:[r," ",e," "]}),B.jsx("h2",{className:"text-4xl font-extrabold text-gray-800 tracking-tight",children:vu(n.total)}),B.jsx("div",{className:"mt-6 flex flex-col items-center justify-center space-y-2",children:a>0&&B.jsxs("div",{className:`flex items-center text-xs font-bold px-3 py-1 rounded-full border ${s>0?"bg-red-50 text-red-600 border-red-100":"bg-green-50 text-green-600 border-green-100"}`,children:[s>0?B.jsx(ML,{size:14,className:"mr-1"}):B.jsx(OL,{size:14,className:"mr-1"})," ",vu(Math.abs(s))," ",s>0?"  ":"  "]})})]}),B.jsxs("div",{className:"bg-white rounded-2xl p-5 shadow-sm border border-gray-100",children:[B.jsxs("h3",{className:"font-bold text-gray-800 mb-4 text-sm flex items-center",children:[B.jsx(hL,{size:16,className:"text-blue-500 mr-2"}),"   ()"]}),l.length>0?B.jsxs("div",{className:"space-y-3",children:[l.map((f,d)=>B.jsxs("div",{className:"flex justify-between items-center text-sm border-b border-gray-50 last:border-0 pb-2 last:pb-0",children:[B.jsxs("div",{className:"flex items-center gap-3",children:[B.jsxs("div",{className:"w-8 h-8 rounded-full bg-blue-50 text-blue-500 flex items-center justify-center font-bold text-xs",children:[f.day,""]}),B.jsxs("div",{children:[B.jsx("p",{className:"font-medium text-gray-700",children:f.name}),B.jsx("p",{className:"text-xs text-gray-400",children:f.category})]})]}),B.jsxs("div",{className:"text-right",children:[B.jsx("p",{className:"font-bold text-gray-800",children:vu(f.amount)}),B.jsxs("p",{className:"text-xs text-red-500",children:["D-",Math.max(0,f.day-new Date().getDate())]})]})]},d)),B.jsx("div",{className:"pt-2 text-center",children:B.jsxs("p",{className:"text-xs text-gray-500",children:[""," ",B.jsx("span",{className:"font-bold text-blue-600",children:vu(l.reduce((f,d)=>f+d.amount,0))}),"   ."]})})]}):B.jsx("div",{className:"text-center py-4 text-gray-400 text-xs",children:"   ."})]}),B.jsx("div",{className:"mt-5 pb-5",children:B.jsx(HL,{currentYear:r,currentMonth:e,monthlyData:u,categories:t,formatCurrency:vu})})]})},uh=({label:r,active:e,onClick:t})=>B.jsx("button",{onClick:t,className:`px-3 py-1.5 rounded-full text-xs font-medium whitespace-nowrap transition-colors border ${e?"bg-blue-600 text-white border-blue-600 shadow-md":"bg-white text-gray-500 border-gray-200 hover:bg-gray-50"}`,children:r}),GL=()=>{const{categories:r,currentMonth:e}=ka(),{currentData:t,openEditModal:n,deleteItem:a}=nf(),[s,l]=Qe.useState("all"),[u,f]=Qe.useState("all"),d=Qe.useMemo(()=>t.items.filter(m=>{const x=s==="all"||m.type===s,_=u==="all"||m.category===u;return x&&_}).sort((m,x)=>m.day-x.day),[t,s,u]);return B.jsxs("div",{className:"flex flex-col h-full animate-in fade-in duration-300",children:[B.jsxs("div",{className:"bg-white px-4 py-3 border-b border-gray-100 z-10 space-y-2 shadow-sm shrink-0",children:[B.jsxs("div",{className:"flex space-x-2",children:[B.jsx(uh,{label:" ",active:s==="all",onClick:()=>l("all")}),B.jsx(uh,{label:"",active:s==="fixed",onClick:()=>l("fixed")}),B.jsx(uh,{label:"",active:s==="variable",onClick:()=>l("variable")})]}),B.jsxs("div",{className:"flex flex-wrap gap-0.5 pb-1",children:[B.jsx(uh,{label:"",active:u==="all",onClick:()=>f("all")}),r.map(m=>B.jsx(uh,{label:m.name,active:u===m.name,onClick:()=>f(m.name)},m.id))]})]}),B.jsx("div",{className:"flex-1 overflow-y-auto pb-24",children:d.length===0?B.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-gray-400",children:[B.jsx(rC,{size:48,className:"mb-4 opacity-20"}),B.jsx("p",{children:"   ."})]}):B.jsxs("div",{className:"bg-white",children:[B.jsx("div",{className:"sticky top-0 bg-white border-b border-gray-200 z-10",children:B.jsxs("div",{className:"grid grid-cols-[2fr_1fr_0.8fr_1fr_0.7fr] gap-4 px-4 py-3 text-xs font-bold text-gray-700",children:[B.jsx("div",{children:""}),B.jsx("div",{className:"text-right",children:""}),B.jsx("div",{className:"text-center",children:""}),B.jsx("div",{children:""}),B.jsx("div",{className:"text-right",children:""})]})}),B.jsx("div",{className:"divide-y divide-gray-100",children:d.map((m,x)=>{const _=r.find(y=>y.name===m.category)||{icon:"",chartColor:"text-gray-400"};return B.jsxs("div",{className:"grid grid-cols-[2fr_1fr_0.8fr_1fr_0.7fr] gap-4 px-4 py-3 hover:bg-gray-50 transition-colors",children:[B.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[B.jsx("div",{className:`w-8 h-8 rounded flex items-center justify-center text-sm text-white shrink-0 ${_.chartColor.replace("text","bg")}`,children:_.icon}),B.jsxs("div",{className:"min-w-0 flex-1",children:[B.jsx("p",{className:"text-sm font-bold text-gray-800 truncate",children:m.name}),B.jsxs("div",{className:"flex items-center gap-1 mt-0.5",children:[B.jsx("span",{className:"text-xs text-gray-500",children:m.category}),B.jsx("span",{className:`text-[10px] px-1 py-0 rounded border font-medium ${m.type==="fixed"?"bg-blue-50 text-blue-600 border-blue-200":"bg-orange-50 text-orange-600 border-orange-200"}`,children:m.type==="fixed"?"":""})]})]})]}),B.jsx("div",{className:"text-right flex items-center justify-end",children:B.jsxs("span",{className:"text-sm font-bold text-gray-900",children:["- ",vu(m.amount)]})}),B.jsx("div",{className:"text-center flex items-center justify-center",children:B.jsx("span",{className:"text-sm text-gray-600",children:m.day?`${e.replace("","")}/${m.day}`:""})}),B.jsx("div",{className:"flex items-center min-w-0",children:m.memo?B.jsx("span",{className:"text-xs text-gray-500 truncate",children:m.memo}):B.jsx("span",{className:"text-xs text-gray-300",children:"-"})}),B.jsxs("div",{className:"flex items-center justify-end gap-1",children:[B.jsx("button",{onClick:()=>n(m),className:"p-1 text-gray-400 hover:text-blue-600 rounded-md hover:bg-blue-50 transition-colors",children:B.jsx(L_,{size:16})}),B.jsx("button",{onClick:()=>{confirm(" ?")&&a(m.id)},className:"p-1 text-gray-400 hover:text-red-600 rounded-md hover:bg-red-50 transition-colors",children:B.jsx(V_,{size:16})})]})]},m.id||x)})})]})})]})},qL=()=>{const{currentYear:r,currentMonth:e,setCurrentMonth:t,categories:n}=ka(),{monthlyData:a,currentData:s}=nf(),l=Qe.useMemo(()=>Math.max(...a.map(x=>x.total))||1,[a]),u=Math.max(l,16e6),f=x=>x/u*100,d=Qe.useMemo(()=>{const x=s.total;if(x===0)return[];let _=0;const y=n.map(T=>{const S=s.items.filter(Y=>Y.category===T.name).reduce((Y,te)=>Y+te.amount,0);if(S===0)return null;const O=S/x,U=_;return _+=O,{...T,amount:S,percent:O,startPercent:U,endPercent:_}}).filter(Boolean),w=y.reduce((T,S)=>T+S.amount,0);if(w<x){const T=x-w,S=T/x,O=_;_+=S;const U=_;y.push({id:"other",name:"",icon:"",chartColor:"text-gray-400",fillColor:"#9ca3af",amount:T,percent:S,startPercent:O,endPercent:U})}return y},[s,n]),m=(x,_)=>{const y=Math.cos(2*Math.PI*x),w=Math.sin(2*Math.PI*x),T=Math.cos(2*Math.PI*_),S=Math.sin(2*Math.PI*_);if(Math.abs(_-x)>=.9999)return"M 1 0 A 1 1 0 1 1 -1 0 A 1 1 0 1 1 1 0 Z";const O=_-x>.5?1:0;return`M 0 0 L ${y} ${w} A 1 1 0 ${O} 1 ${T} ${S} Z`};return B.jsxs("div",{className:"flex-1 overflow-y-auto pb-24 p-5 flex flex-col space-y-5 animate-in fade-in duration-300",children:[B.jsxs("div",{className:"bg-white p-5 rounded-2xl shadow-sm border border-gray-100 flex flex-col",children:[B.jsx("h2",{className:"text-lg font-bold text-gray-800 mb-4",children:"  "}),B.jsxs("div",{className:"relative h-64 w-full mt-4",children:[B.jsx("div",{className:"absolute inset-0 flex flex-col justify-end",children:[5e6,1e7,15e6].map(x=>B.jsx("div",{className:`absolute w-full border-b ${x===1e7?"border-red-300 border-solid":"border-dashed border-gray-200"}`,style:{bottom:`${f(x)}%`},children:B.jsxs("span",{className:`absolute -top-3 left-0 text-[10px] bg-white pr-1 ${x===1e7?"font-bold text-red-400":"text-gray-400"}`,children:[yu(x/1e4),""]})},x))}),B.jsx("div",{className:"absolute inset-0 flex items-end justify-between gap-1 pb-2 pl-8",children:Kp.map((x,_)=>{const w=a[_].total,T=x===e,S=f(w),O=w>1e7;return B.jsxs("div",{className:"flex flex-col items-center justify-end h-full flex-1 group cursor-pointer",onClick:()=>t(x),children:[B.jsx("div",{className:"w-full flex-1 flex items-end justify-center relative",children:B.jsx("div",{className:`w-full max-w-[32px] rounded-t-sm transition-all duration-500 relative ${T?O?"bg-pink-500 shadow-md":"bg-blue-600 shadow-md":O?"bg-pink-200 group-hover:bg-pink-300":"bg-blue-100 group-hover:bg-blue-200"}`,style:{height:`${Math.max(S,4)}%`},children:B.jsxs("div",{className:"absolute -top-5 left-1/2 transform -translate-x-1/2 text-[9px] font-bold text-gray-600 whitespace-nowrap",children:[yu(Math.floor(w/1e4)),""]})})}),B.jsxs("span",{className:`text-[10px] mt-2 whitespace-nowrap ${T?"font-bold text-gray-800":"text-gray-400"}`,children:[x.replace("",""),""]})]},x)})})]})]}),B.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100 flex flex-col",children:[B.jsx("h2",{className:"text-lg font-bold text-gray-800 mb-4 self-start",children:" "}),B.jsxs("div",{className:"flex flex-row items-center w-full justify-between gap-4",children:[B.jsx("div",{className:"w-5/12 flex justify-center items-center",children:B.jsxs("div",{className:"w-[85%] aspect-square relative flex items-center justify-center",children:[B.jsxs("svg",{viewBox:"-1.2 -1.2 2.4 2.4",className:"w-full h-full transform -rotate-90",children:[s.total===0?B.jsx("circle",{cx:"0",cy:"0",r:"1",fill:"#e5e7eb"}):d.map((x,_)=>B.jsx("path",{d:m(x.startPercent,x.endPercent),fill:x.fillColor||"#9ca3af"},_)),B.jsx("circle",{cx:"0",cy:"0",r:"0.6",fill:"white"})]}),B.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center pointer-events-none",children:[B.jsx("span",{className:"text-[10px] text-gray-400",children:" "}),B.jsx("span",{className:"text-sm md:text-lg font-bold text-gray-800",children:s.total>1e7?(s.total/1e7).toFixed(1)+"":yu(Math.floor(s.total/1e4))+""})]})]})}),B.jsx("div",{className:"w-7/12 flex flex-col justify-center space-y-3 pl-1",children:d.map(x=>B.jsxs("div",{className:"flex justify-between items-center text-sm w-full",children:[B.jsxs("div",{className:"flex items-center gap-2 min-w-0 overflow-hidden",children:[B.jsx("div",{className:`w-6 h-6 rounded flex items-center justify-center text-xs text-white shrink-0 ${x.chartColor.replace("text","bg")}`,children:x.icon}),B.jsx("span",{className:"font-bold text-gray-700 truncate text-[15px]",children:x.name})]}),B.jsxs("span",{className:"font-bold text-gray-600 whitespace-nowrap text-[13px]",children:[yu(Math.round(x.amount/1e4)),""]})]},x.id))})]})]})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var lp={};lp.version="0.18.5";var sC=1252,KL=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],B_={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},U_=function(r){KL.indexOf(r)!=-1&&(sC=B_[0]=r)};function XL(){U_(1252)}var vi=function(r){U_(r)};function z_(){vi(1200),XL()}function cA(r){for(var e=[],t=0,n=r.length;t<n;++t)e[t]=r.charCodeAt(t);return e}function WL(r){for(var e=[],t=0;t<r.length>>1;++t)e[t]=String.fromCharCode(r.charCodeAt(2*t)+(r.charCodeAt(2*t+1)<<8));return e.join("")}function oC(r){for(var e=[],t=0;t<r.length>>1;++t)e[t]=String.fromCharCode(r.charCodeAt(2*t+1)+(r.charCodeAt(2*t)<<8));return e.join("")}var xh=function(r){var e=r.charCodeAt(0),t=r.charCodeAt(1);return e==255&&t==254?WL(r.slice(2)):e==254&&t==255?oC(r.slice(2)):e==65279?r.slice(1):r},sm=function(e){return String.fromCharCode(e)},uA=function(e){return String.fromCharCode(e)},Jh,Do="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Zh(r){for(var e="",t=0,n=0,a=0,s=0,l=0,u=0,f=0,d=0;d<r.length;)t=r.charCodeAt(d++),s=t>>2,n=r.charCodeAt(d++),l=(t&3)<<4|n>>4,a=r.charCodeAt(d++),u=(n&15)<<2|a>>6,f=a&63,isNaN(n)?u=f=64:isNaN(a)&&(f=64),e+=Do.charAt(s)+Do.charAt(l)+Do.charAt(u)+Do.charAt(f);return e}function Ia(r){var e="",t=0,n=0,a=0,s=0,l=0,u=0,f=0;r=r.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<r.length;)s=Do.indexOf(r.charAt(d++)),l=Do.indexOf(r.charAt(d++)),t=s<<2|l>>4,e+=String.fromCharCode(t),u=Do.indexOf(r.charAt(d++)),n=(l&15)<<4|u>>2,u!==64&&(e+=String.fromCharCode(n)),f=Do.indexOf(r.charAt(d++)),a=(u&3)<<6|f,f!==64&&(e+=String.fromCharCode(a));return e}var _t=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Vs=(function(){if(typeof Buffer<"u"){var r=!Buffer.from;if(!r)try{Buffer.from("foo","utf8")}catch{r=!0}return r?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function jo(r){return _t?Buffer.alloc?Buffer.alloc(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}function fA(r){return _t?Buffer.allocUnsafe?Buffer.allocUnsafe(r):new Buffer(r):typeof Uint8Array<"u"?new Uint8Array(r):new Array(r)}var Ta=function(e){return _t?Vs(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function Xp(r){if(typeof ArrayBuffer>"u")return Ta(r);for(var e=new ArrayBuffer(r.length),t=new Uint8Array(e),n=0;n!=r.length;++n)t[n]=r.charCodeAt(n)&255;return e}function Wo(r){if(Array.isArray(r))return r.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],t=0;t<r.length;++t)e[t]=String.fromCharCode(r[t]);return e.join("")}function YL(r){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(r)}function j_(r){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(r instanceof ArrayBuffer)return j_(new Uint8Array(r));for(var e=new Array(r.length),t=0;t<r.length;++t)e[t]=r[t];return e}var ln=_t?function(r){return Buffer.concat(r.map(function(e){return Buffer.isBuffer(e)?e:Vs(e)}))}:function(r){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<r.length;++e)t+=r[e].length;var n=new Uint8Array(t),a=0;for(e=0,t=0;e<r.length;t+=a,++e)if(a=r[e].length,r[e]instanceof Uint8Array)n.set(r[e],t);else{if(typeof r[e]=="string")throw"wtf";n.set(new Uint8Array(r[e]),t)}return n}return[].concat.apply([],r.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function $L(r){for(var e=[],t=0,n=r.length+250,a=jo(r.length+255),s=0;s<r.length;++s){var l=r.charCodeAt(s);if(l<128)a[t++]=l;else if(l<2048)a[t++]=192|l>>6&31,a[t++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var u=r.charCodeAt(++s)&1023;a[t++]=240|l>>8&7,a[t++]=128|l>>2&63,a[t++]=128|u>>6&15|(l&3)<<4,a[t++]=128|u&63}else a[t++]=224|l>>12&15,a[t++]=128|l>>6&63,a[t++]=128|l&63;t>n&&(e.push(a.slice(0,t)),t=0,a=jo(65535),n=65530)}return e.push(a.slice(0,t)),ln(e)}var Kn=/\u0000/g,vh=/[\u0001-\u0006]/g;function ku(r){for(var e="",t=r.length-1;t>=0;)e+=r.charAt(t--);return e}function _i(r,e){var t=""+r;return t.length>=e?t:Cr("0",e-t.length)+t}function H_(r,e){var t=""+r;return t.length>=e?t:Cr(" ",e-t.length)+t}function cp(r,e){var t=""+r;return t.length>=e?t:t+Cr(" ",e-t.length)}function QL(r,e){var t=""+Math.round(r);return t.length>=e?t:Cr("0",e-t.length)+t}function JL(r,e){var t=""+r;return t.length>=e?t:Cr("0",e-t.length)+t}var hA=Math.pow(2,32);function uu(r,e){if(r>hA||r<-hA)return QL(r,e);var t=Math.round(r);return JL(t,e)}function up(r,e){return e=e||0,r.length>=7+e&&(r.charCodeAt(e)|32)===103&&(r.charCodeAt(e+1)|32)===101&&(r.charCodeAt(e+2)|32)===110&&(r.charCodeAt(e+3)|32)===101&&(r.charCodeAt(e+4)|32)===114&&(r.charCodeAt(e+5)|32)===97&&(r.charCodeAt(e+6)|32)===108}var dA=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],vx=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function ZL(r){return r||(r={}),r[0]="General",r[1]="0",r[2]="0.00",r[3]="#,##0",r[4]="#,##0.00",r[9]="0%",r[10]="0.00%",r[11]="0.00E+00",r[12]="# ?/?",r[13]="# ??/??",r[14]="m/d/yy",r[15]="d-mmm-yy",r[16]="d-mmm",r[17]="mmm-yy",r[18]="h:mm AM/PM",r[19]="h:mm:ss AM/PM",r[20]="h:mm",r[21]="h:mm:ss",r[22]="m/d/yy h:mm",r[37]="#,##0 ;(#,##0)",r[38]="#,##0 ;[Red](#,##0)",r[39]="#,##0.00;(#,##0.00)",r[40]="#,##0.00;[Red](#,##0.00)",r[45]="mm:ss",r[46]="[h]:mm:ss",r[47]="mmss.0",r[48]="##0.0E+0",r[49]="@",r[56]='"/ "hh""mm""ss" "',r}var nt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},mA={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},e7={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function fp(r,e,t){for(var n=r<0?-1:1,a=r*n,s=0,l=1,u=0,f=1,d=0,m=0,x=Math.floor(a);d<e&&(x=Math.floor(a),u=x*l+s,m=x*d+f,!(a-x<5e-8));)a=1/(a-x),s=l,l=u,f=d,d=m;if(m>e&&(d>e?(m=f,u=s):(m=d,u=l)),!t)return[0,n*u,m];var _=Math.floor(n*u/m);return[_,n*u-_*m,m]}function Ml(r,e,t){if(r>2958465||r<0)return null;var n=r|0,a=Math.floor(86400*(r-n)),s=0,l=[],u={D:n,T:a,u:86400*(r-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),e&&e.date1904&&(n+=1462),u.u>.9999&&(u.u=0,++a==86400&&(u.T=a=0,++n,++u.D)),n===60)l=t?[1317,10,29]:[1900,2,29],s=3;else if(n===0)l=t?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var f=new Date(1900,0,1);f.setDate(f.getDate()+n-1),l=[f.getFullYear(),f.getMonth()+1,f.getDate()],s=f.getDay(),n<60&&(s=(s+6)%7),t&&(s=s7(f,l))}return u.y=l[0],u.m=l[1],u.d=l[2],u.S=a%60,a=Math.floor(a/60),u.M=a%60,a=Math.floor(a/60),u.H=a,u.q=s,u}var lC=new Date(1899,11,31,0,0,0),t7=lC.getTime(),r7=new Date(1900,2,1,0,0,0);function cC(r,e){var t=r.getTime();return e?t-=1461*24*60*60*1e3:r>=r7&&(t+=1440*60*1e3),(t-(t7+(r.getTimezoneOffset()-lC.getTimezoneOffset())*6e4))/(1440*60*1e3)}function G_(r){return r.indexOf(".")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function n7(r){return r.indexOf("E")==-1?r:r.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function a7(r){var e=r<0?12:11,t=G_(r.toFixed(12));return t.length<=e||(t=r.toPrecision(10),t.length<=e)?t:r.toExponential(5)}function i7(r){var e=G_(r.toFixed(11));return e.length>(r<0?12:11)||e==="0"||e==="-0"?r.toPrecision(6):e}function e0(r){var e=Math.floor(Math.log(Math.abs(r))*Math.LOG10E),t;return e>=-4&&e<=-1?t=r.toPrecision(10+e):Math.abs(e)<=9?t=a7(r):e===10?t=r.toFixed(10).substr(0,12):t=i7(r),G_(n7(t.toUpperCase()))}function rc(r,e){switch(typeof r){case"string":return r;case"boolean":return r?"TRUE":"FALSE";case"number":return(r|0)===r?r.toString(10):e0(r);case"undefined":return"";case"object":if(r==null)return"";if(r instanceof Date)return ei(14,cC(r,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+r)}function s7(r,e){e[0]-=581;var t=r.getDay();return r<60&&(t=(t+6)%7),t}function o7(r,e,t,n){var a="",s=0,l=0,u=t.y,f,d=0;switch(r){case 98:u=t.y+543;case 121:switch(e.length){case 1:case 2:f=u%100,d=2;break;default:f=u%1e4,d=4;break}break;case 109:switch(e.length){case 1:case 2:f=t.m,d=e.length;break;case 3:return vx[t.m-1][1];case 5:return vx[t.m-1][0];default:return vx[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:f=t.d,d=e.length;break;case 3:return dA[t.q][0];default:return dA[t.q][1]}break;case 104:switch(e.length){case 1:case 2:f=1+(t.H+11)%12,d=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:f=t.H,d=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:f=t.M,d=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?_i(t.S,e.length):(n>=2?l=n===3?1e3:100:l=n===1?10:1,s=Math.round(l*(t.S+t.u)),s>=60*l&&(s=0),e==="s"?s===0?"0":""+s/l:(a=_i(s,2+n),e==="ss"?a.substr(0,2):"."+a.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":f=t.D*24+t.H;break;case"[m]":case"[mm]":f=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":f=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+e}d=e.length===3?1:2;break;case 101:f=u,d=1;break}var m=d>0?_i(f,d):"";return m}function No(r){var e=3;if(r.length<=e)return r;for(var t=r.length%e,n=r.substr(0,t);t!=r.length;t+=e)n+=(n.length>0?",":"")+r.substr(t,e);return n}var uC=/%/g;function l7(r,e,t){var n=e.replace(uC,""),a=e.length-n.length;return Cs(r,n,t*Math.pow(10,2*a))+Cr("%",a)}function c7(r,e,t){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Cs(r,e.substr(0,n),t/Math.pow(10,3*(e.length-n)))}function fC(r,e){var t,n=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+fC(r,-e);var a=r.indexOf(".");a===-1&&(a=r.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%a;if(s<0&&(s+=a),t=(e/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),t.indexOf("e")===-1){var l=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(l-t.length+s):t+="E+"+(l-s);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,a)+"."+t.substr(2+a),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,f,d,m){return f+d+m.substr(0,(a+s)%a)+"."+m.substr(s)+"E"})}else t=e.toExponential(n);return r.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),r.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var hC=/# (\?+)( ?)\/( ?)(\d+)/;function u7(r,e,t){var n=parseInt(r[4],10),a=Math.round(e*n),s=Math.floor(a/n),l=a-s*n,u=n;return t+(s===0?"":""+s)+" "+(l===0?Cr(" ",r[1].length+1+r[4].length):H_(l,r[1].length)+r[2]+"/"+r[3]+_i(u,r[4].length))}function f7(r,e,t){return t+(e===0?"":""+e)+Cr(" ",r[1].length+2+r[4].length)}var dC=/^#*0*\.([0#]+)/,mC=/\).*[0#]/,pC=/\(###\) ###\\?-####/;function zn(r){for(var e="",t,n=0;n!=r.length;++n)switch(t=r.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function pA(r,e){var t=Math.pow(10,e);return""+Math.round(r*t)/t}function gA(r,e){var t=r-Math.floor(r),n=Math.pow(10,e);return e<(""+Math.round(t*n)).length?0:Math.round(t*n)}function h7(r,e){return e<(""+Math.round((r-Math.floor(r))*Math.pow(10,e))).length?1:0}function d7(r){return r<2147483647&&r>-2147483648?""+(r>=0?r|0:r-1|0):""+Math.floor(r)}function Ha(r,e,t){if(r.charCodeAt(0)===40&&!e.match(mC)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Ha("n",n,t):"("+Ha("n",n,-t)+")"}if(e.charCodeAt(e.length-1)===44)return c7(r,e,t);if(e.indexOf("%")!==-1)return l7(r,e,t);if(e.indexOf("E")!==-1)return fC(e,t);if(e.charCodeAt(0)===36)return"$"+Ha(r,e.substr(e.charAt(1)==" "?2:1),t);var a,s,l,u,f=Math.abs(t),d=t<0?"-":"";if(e.match(/^00+$/))return d+uu(f,e.length);if(e.match(/^[#?]+$/))return a=uu(t,0),a==="0"&&(a=""),a.length>e.length?a:zn(e.substr(0,e.length-a.length))+a;if(s=e.match(hC))return u7(s,f,d);if(e.match(/^#+0+$/))return d+uu(f,e.length-e.indexOf("0"));if(s=e.match(dC))return a=pA(t,s[1].length).replace(/^([^\.]+)$/,"$1."+zn(s[1])).replace(/\.$/,"."+zn(s[1])).replace(/\.(\d*)$/,function(w,T){return"."+T+Cr("0",zn(s[1]).length-T.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return d+pA(f,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return d+No(uu(f,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Ha(r,e,-t):No(""+(Math.floor(t)+h7(t,s[1].length)))+"."+_i(gA(t,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return Ha(r,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=ku(Ha(r,e.replace(/[\\-]/g,""),t)),l=0,ku(ku(e.replace(/\\/g,"")).replace(/[0#]/g,function(w){return l<a.length?a.charAt(l++):w==="0"?"0":""}));if(e.match(pC))return a=Ha(r,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var m="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),u=fp(f,Math.pow(10,l)-1,!1),a=""+d,m=Cs("n",s[1],u[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),a+=m+s[2]+"/"+s[3],m=cp(u[2],l),m.length<s[4].length&&(m=zn(s[4].substr(s[4].length-m.length))+m),a+=m,a;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),u=fp(f,Math.pow(10,l)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?H_(u[1],l)+s[2]+"/"+s[3]+cp(u[2],l):Cr(" ",2*l+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return a=uu(t,0),e.length<=a.length?a:zn(e.substr(0,e.length-a.length))+a;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var x=e.indexOf(".")-l,_=e.length-a.length-x;return zn(e.substr(0,x)+a+e.substr(e.length-_))}if(s=e.match(/^00,000\.([#0]*0)$/))return l=gA(t,s[1].length),t<0?"-"+Ha(r,e,-t):No(d7(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?_i(0,3-w.length):"")+w})+"."+_i(l,s[1].length);switch(e){case"###,##0.00":return Ha(r,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var y=No(uu(f,0));return y!=="0"?d+y:"";case"###,###.00":return Ha(r,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return Ha(r,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function m7(r,e,t){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Cs(r,e.substr(0,n),t/Math.pow(10,3*(e.length-n)))}function p7(r,e,t){var n=e.replace(uC,""),a=e.length-n.length;return Cs(r,n,t*Math.pow(10,2*a))+Cr("%",a)}function gC(r,e){var t,n=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+gC(r,-e);var a=r.indexOf(".");a===-1&&(a=r.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%a;if(s<0&&(s+=a),t=(e/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!t.match(/[Ee]/)){var l=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(l-t.length+s):t+="E+"+(l-s),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,f,d,m){return f+d+m.substr(0,(a+s)%a)+"."+m.substr(s)+"E"})}else t=e.toExponential(n);return r.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),r.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Li(r,e,t){if(r.charCodeAt(0)===40&&!e.match(mC)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Li("n",n,t):"("+Li("n",n,-t)+")"}if(e.charCodeAt(e.length-1)===44)return m7(r,e,t);if(e.indexOf("%")!==-1)return p7(r,e,t);if(e.indexOf("E")!==-1)return gC(e,t);if(e.charCodeAt(0)===36)return"$"+Li(r,e.substr(e.charAt(1)==" "?2:1),t);var a,s,l,u,f=Math.abs(t),d=t<0?"-":"";if(e.match(/^00+$/))return d+_i(f,e.length);if(e.match(/^[#?]+$/))return a=""+t,t===0&&(a=""),a.length>e.length?a:zn(e.substr(0,e.length-a.length))+a;if(s=e.match(hC))return f7(s,f,d);if(e.match(/^#+0+$/))return d+_i(f,e.length-e.indexOf("0"));if(s=e.match(dC))return a=(""+t).replace(/^([^\.]+)$/,"$1."+zn(s[1])).replace(/\.$/,"."+zn(s[1])),a=a.replace(/\.(\d*)$/,function(w,T){return"."+T+Cr("0",zn(s[1]).length-T.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return d+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return d+No(""+f);if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Li(r,e,-t):No(""+t)+"."+Cr("0",s[1].length);if(s=e.match(/^#,#*,#0/))return Li(r,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=ku(Li(r,e.replace(/[\\-]/g,""),t)),l=0,ku(ku(e.replace(/\\/g,"")).replace(/[0#]/g,function(w){return l<a.length?a.charAt(l++):w==="0"?"0":""}));if(e.match(pC))return a=Li(r,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var m="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),u=fp(f,Math.pow(10,l)-1,!1),a=""+d,m=Cs("n",s[1],u[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),a+=m+s[2]+"/"+s[3],m=cp(u[2],l),m.length<s[4].length&&(m=zn(s[4].substr(s[4].length-m.length))+m),a+=m,a;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),u=fp(f,Math.pow(10,l)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?H_(u[1],l)+s[2]+"/"+s[3]+cp(u[2],l):Cr(" ",2*l+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return a=""+t,e.length<=a.length?a:zn(e.substr(0,e.length-a.length))+a;if(s=e.match(/^([#0]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var x=e.indexOf(".")-l,_=e.length-a.length-x;return zn(e.substr(0,x)+a+e.substr(e.length-_))}if(s=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Li(r,e,-t):No(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?_i(0,3-w.length):"")+w})+"."+_i(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var y=No(""+f);return y!=="0"?d+y:"";default:if(e.match(/\.[0#?]*$/))return Li(r,e.slice(0,e.lastIndexOf(".")),t)+zn(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Cs(r,e,t){return(t|0)===t?Li(r,e,t):Ha(r,e,t)}function g7(r){for(var e=[],t=!1,n=0,a=0;n<r.length;++n)switch(r.charCodeAt(n)){case 34:t=!t;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=r.substr(a,n-a),a=n+1}if(e[e.length]=r.substr(a),t===!0)throw new Error("Format |"+r+"| unterminated string ");return e}var xC=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function af(r){for(var e=0,t="",n="";e<r.length;)switch(t=r.charAt(e)){case"G":up(r,e)&&(e+=6),e++;break;case'"':for(;r.charCodeAt(++e)!==34&&e<r.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(r.charAt(e+1)==="1"||r.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(r.substr(e,3).toUpperCase()==="A/P"||r.substr(e,5).toUpperCase()==="AM/PM"||r.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=t;r.charAt(e++)!=="]"&&e<r.length;)n+=r.charAt(e);if(n.match(xC))return!0;break;case".":case"0":case"#":for(;e<r.length&&("0#?.,E+-%".indexOf(t=r.charAt(++e))>-1||t=="\\"&&r.charAt(e+1)=="-"&&"0#".indexOf(r.charAt(e+2))>-1););break;case"?":for(;r.charAt(++e)===t;);break;case"*":++e,(r.charAt(e)==" "||r.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<r.length&&"0123456789".indexOf(r.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function x7(r,e,t,n){for(var a=[],s="",l=0,u="",f="t",d,m,x,_="H";l<r.length;)switch(u=r.charAt(l)){case"G":if(!up(r,l))throw new Error("unrecognized character "+u+" in "+r);a[a.length]={t:"G",v:"General"},l+=7;break;case'"':for(s="";(x=r.charCodeAt(++l))!==34&&l<r.length;)s+=String.fromCharCode(x);a[a.length]={t:"t",v:s},++l;break;case"\\":var y=r.charAt(++l),w=y==="("||y===")"?y:"t";a[a.length]={t:w,v:y},++l;break;case"_":a[a.length]={t:"t",v:" "},l+=2;break;case"@":a[a.length]={t:"T",v:e},++l;break;case"B":case"b":if(r.charAt(l+1)==="1"||r.charAt(l+1)==="2"){if(d==null&&(d=Ml(e,t,r.charAt(l+1)==="2"),d==null))return"";a[a.length]={t:"X",v:r.substr(l,2)},f=u,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||d==null&&(d=Ml(e,t),d==null))return"";for(s=u;++l<r.length&&r.charAt(l).toLowerCase()===u;)s+=u;u==="m"&&f.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=_),a[a.length]={t:u,v:s},f=u;break;case"A":case"a":case"":var T={t:u,v:u};if(d==null&&(d=Ml(e,t)),r.substr(l,3).toUpperCase()==="A/P"?(d!=null&&(T.v=d.H>=12?"P":"A"),T.t="T",_="h",l+=3):r.substr(l,5).toUpperCase()==="AM/PM"?(d!=null&&(T.v=d.H>=12?"PM":"AM"),T.t="T",l+=5,_="h"):r.substr(l,5).toUpperCase()==="/"?(d!=null&&(T.v=d.H>=12?"":""),T.t="T",l+=5,_="h"):(T.t="t",++l),d==null&&T.t==="T")return"";a[a.length]=T,f=u;break;case"[":for(s=u;r.charAt(l++)!=="]"&&l<r.length;)s+=r.charAt(l);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(xC)){if(d==null&&(d=Ml(e,t),d==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},f=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",af(r)||(a[a.length]={t:"t",v:s}));break;case".":if(d!=null){for(s=u;++l<r.length&&(u=r.charAt(l))==="0";)s+=u;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=u;++l<r.length&&"0#?.,E+-%".indexOf(u=r.charAt(l))>-1;)s+=u;a[a.length]={t:"n",v:s};break;case"?":for(s=u;r.charAt(++l)===u;)s+=u;a[a.length]={t:u,v:s},f=u;break;case"*":++l,(r.charAt(l)==" "||r.charAt(l)=="*")&&++l;break;case"(":case")":a[a.length]={t:n===1?"t":u,v:u},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=u;l<r.length&&"0123456789".indexOf(r.charAt(++l))>-1;)s+=r.charAt(l);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:u,v:u},++l;break;case"$":a[a.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+r);a[a.length]={t:"t",v:u},++l;break}var S=0,O=0,U;for(l=a.length-1,f="t";l>=0;--l)switch(a[l].t){case"h":case"H":a[l].t=_,f="h",S<1&&(S=1);break;case"s":(U=a[l].v.match(/\.0+$/))&&(O=Math.max(O,U[0].length-1)),S<3&&(S=3);case"d":case"y":case"M":case"e":f=a[l].t;break;case"m":f==="s"&&(a[l].t="M",S<2&&(S=2));break;case"X":break;case"Z":S<1&&a[l].v.match(/[Hh]/)&&(S=1),S<2&&a[l].v.match(/[Mm]/)&&(S=2),S<3&&a[l].v.match(/[Ss]/)&&(S=3)}switch(S){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var R="",Y;for(l=0;l<a.length;++l)switch(a[l].t){case"t":case"T":case" ":case"D":break;case"X":a[l].v="",a[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[l].v=o7(a[l].t.charCodeAt(0),a[l].v,d,O),a[l].t="t";break;case"n":case"?":for(Y=l+1;a[Y]!=null&&((u=a[Y].t)==="?"||u==="D"||(u===" "||u==="t")&&a[Y+1]!=null&&(a[Y+1].t==="?"||a[Y+1].t==="t"&&a[Y+1].v==="/")||a[l].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(a[Y].v==="/"||a[Y].v===" "&&a[Y+1]!=null&&a[Y+1].t=="?"));)a[l].v+=a[Y].v,a[Y]={v:"",t:";"},++Y;R+=a[l].v,l=Y-1;break;case"G":a[l].t="t",a[l].v=rc(e,t);break}var te="",G,A;if(R.length>0){R.charCodeAt(0)==40?(G=e<0&&R.charCodeAt(0)===45?-e:e,A=Cs("n",R,G)):(G=e<0&&n>1?-e:e,A=Cs("n",R,G),G<0&&a[0]&&a[0].t=="t"&&(A=A.substr(1),a[0].v="-"+a[0].v)),Y=A.length-1;var C=a.length;for(l=0;l<a.length;++l)if(a[l]!=null&&a[l].t!="t"&&a[l].v.indexOf(".")>-1){C=l;break}var k=a.length;if(C===a.length&&A.indexOf("E")===-1){for(l=a.length-1;l>=0;--l)a[l]==null||"n?".indexOf(a[l].t)===-1||(Y>=a[l].v.length-1?(Y-=a[l].v.length,a[l].v=A.substr(Y+1,a[l].v.length)):Y<0?a[l].v="":(a[l].v=A.substr(0,Y+1),Y=-1),a[l].t="t",k=l);Y>=0&&k<a.length&&(a[k].v=A.substr(0,Y+1)+a[k].v)}else if(C!==a.length&&A.indexOf("E")===-1){for(Y=A.indexOf(".")-1,l=C;l>=0;--l)if(!(a[l]==null||"n?".indexOf(a[l].t)===-1)){for(m=a[l].v.indexOf(".")>-1&&l===C?a[l].v.indexOf(".")-1:a[l].v.length-1,te=a[l].v.substr(m+1);m>=0;--m)Y>=0&&(a[l].v.charAt(m)==="0"||a[l].v.charAt(m)==="#")&&(te=A.charAt(Y--)+te);a[l].v=te,a[l].t="t",k=l}for(Y>=0&&k<a.length&&(a[k].v=A.substr(0,Y+1)+a[k].v),Y=A.indexOf(".")+1,l=C;l<a.length;++l)if(!(a[l]==null||"n?(".indexOf(a[l].t)===-1&&l!==C)){for(m=a[l].v.indexOf(".")>-1&&l===C?a[l].v.indexOf(".")+1:0,te=a[l].v.substr(0,m);m<a[l].v.length;++m)Y<A.length&&(te+=A.charAt(Y++));a[l].v=te,a[l].t="t",k=l}}}for(l=0;l<a.length;++l)a[l]!=null&&"n?".indexOf(a[l].t)>-1&&(G=n>1&&e<0&&l>0&&a[l-1].v==="-"?-e:e,a[l].v=Cs(a[l].t,a[l].v,G),a[l].t="t");var V="";for(l=0;l!==a.length;++l)a[l]!=null&&(V+=a[l].v);return V}var xA=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function vA(r,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(r==t)return!0;break;case">":if(r>t)return!0;break;case"<":if(r<t)return!0;break;case"<>":if(r!=t)return!0;break;case">=":if(r>=t)return!0;break;case"<=":if(r<=t)return!0;break}return!1}function v7(r,e){var t=g7(r),n=t.length,a=t[n-1].indexOf("@");if(n<4&&a>-1&&--n,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||a>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=a>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=a>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=a>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var s=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[n,s];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var l=t[0].match(xA),u=t[1].match(xA);return vA(e,l)?[n,t[0]]:vA(e,u)?[n,t[1]]:[n,t[l!=null&&u!=null?2:1]]}return[n,s]}function ei(r,e,t){t==null&&(t={});var n="";switch(typeof r){case"string":r=="m/d/yy"&&t.dateNF?n=t.dateNF:n=r;break;case"number":r==14&&t.dateNF?n=t.dateNF:n=(t.table!=null?t.table:nt)[r],n==null&&(n=t.table&&t.table[mA[r]]||nt[mA[r]]),n==null&&(n=e7[r]||"General");break}if(up(n,0))return rc(e,t);e instanceof Date&&(e=cC(e,t.date1904));var a=v7(n,e);if(up(a[1]))return rc(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return x7(a[1],e,t,a[0])}function Rs(r,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(nt[t]==null){e<0&&(e=t);continue}if(nt[t]==r){e=t;break}}e<0&&(e=391)}return nt[e]=r,e}function Wp(r){for(var e=0;e!=392;++e)r[e]!==void 0&&Rs(r[e],e)}function sf(){nt=ZL()}var _7={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},vC=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function y7(r){var e=typeof r=="number"?nt[r]:r;return e=e.replace(vC,"(\\d+)"),new RegExp("^"+e+"$")}function T7(r,e,t){var n=-1,a=-1,s=-1,l=-1,u=-1,f=-1;(e.match(vC)||[]).forEach(function(x,_){var y=parseInt(t[_+1],10);switch(x.toLowerCase().charAt(0)){case"y":n=y;break;case"d":s=y;break;case"h":l=y;break;case"s":f=y;break;case"m":l>=0?u=y:a=y;break}}),f>=0&&u==-1&&a>=0&&(u=a,a=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var m=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return l==-1&&u==-1&&f==-1?d:n==-1&&a==-1&&s==-1?m:d+"T"+m}var E7=(function(){var r={};r.version="1.2.0";function e(){for(var A=0,C=new Array(256),k=0;k!=256;++k)A=k,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,C[k]=A;return typeof Int32Array<"u"?new Int32Array(C):C}var t=e();function n(A){var C=0,k=0,V=0,F=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(V=0;V!=256;++V)F[V]=A[V];for(V=0;V!=256;++V)for(k=A[V],C=256+V;C<4096;C+=256)k=F[C]=k>>>8^A[k&255];var M=[];for(V=1;V!=16;++V)M[V-1]=typeof Int32Array<"u"?F.subarray(V*256,V*256+256):F.slice(V*256,V*256+256);return M}var a=n(t),s=a[0],l=a[1],u=a[2],f=a[3],d=a[4],m=a[5],x=a[6],_=a[7],y=a[8],w=a[9],T=a[10],S=a[11],O=a[12],U=a[13],R=a[14];function Y(A,C){for(var k=C^-1,V=0,F=A.length;V<F;)k=k>>>8^t[(k^A.charCodeAt(V++))&255];return~k}function te(A,C){for(var k=C^-1,V=A.length-15,F=0;F<V;)k=R[A[F++]^k&255]^U[A[F++]^k>>8&255]^O[A[F++]^k>>16&255]^S[A[F++]^k>>>24]^T[A[F++]]^w[A[F++]]^y[A[F++]]^_[A[F++]]^x[A[F++]]^m[A[F++]]^d[A[F++]]^f[A[F++]]^u[A[F++]]^l[A[F++]]^s[A[F++]]^t[A[F++]];for(V+=15;F<V;)k=k>>>8^t[(k^A[F++])&255];return~k}function G(A,C){for(var k=C^-1,V=0,F=A.length,M=0,L=0;V<F;)M=A.charCodeAt(V++),M<128?k=k>>>8^t[(k^M)&255]:M<2048?(k=k>>>8^t[(k^(192|M>>6&31))&255],k=k>>>8^t[(k^(128|M&63))&255]):M>=55296&&M<57344?(M=(M&1023)+64,L=A.charCodeAt(V++)&1023,k=k>>>8^t[(k^(240|M>>8&7))&255],k=k>>>8^t[(k^(128|M>>2&63))&255],k=k>>>8^t[(k^(128|L>>6&15|(M&3)<<4))&255],k=k>>>8^t[(k^(128|L&63))&255]):(k=k>>>8^t[(k^(224|M>>12&15))&255],k=k>>>8^t[(k^(128|M>>6&63))&255],k=k>>>8^t[(k^(128|M&63))&255]);return~k}return r.table=t,r.bstr=Y,r.buf=te,r.str=G,r})(),et=(function(){var e={};e.version="1.2.1";function t(D,K){for(var z=D.split("/"),H=K.split("/"),q=0,W=0,he=Math.min(z.length,H.length);q<he;++q){if(W=z[q].length-H[q].length)return W;if(z[q]!=H[q])return z[q]<H[q]?-1:1}return z.length-H.length}function n(D){if(D.charAt(D.length-1)=="/")return D.slice(0,-1).indexOf("/")===-1?D:n(D.slice(0,-1));var K=D.lastIndexOf("/");return K===-1?D:D.slice(0,K+1)}function a(D){if(D.charAt(D.length-1)=="/")return a(D.slice(0,-1));var K=D.lastIndexOf("/");return K===-1?D:D.slice(K+1)}function s(D,K){typeof K=="string"&&(K=new Date(K));var z=K.getHours();z=z<<6|K.getMinutes(),z=z<<5|K.getSeconds()>>>1,D.write_shift(2,z);var H=K.getFullYear()-1980;H=H<<4|K.getMonth()+1,H=H<<5|K.getDate(),D.write_shift(2,H)}function l(D){var K=D.read_shift(2)&65535,z=D.read_shift(2)&65535,H=new Date,q=z&31;z>>>=5;var W=z&15;z>>>=4,H.setMilliseconds(0),H.setFullYear(z+1980),H.setMonth(W-1),H.setDate(q);var he=K&31;K>>>=5;var Te=K&63;return K>>>=6,H.setHours(K),H.setMinutes(Te),H.setSeconds(he<<1),H}function u(D){yn(D,0);for(var K={},z=0;D.l<=D.length-4;){var H=D.read_shift(2),q=D.read_shift(2),W=D.l+q,he={};switch(H){case 21589:z=D.read_shift(1),z&1&&(he.mtime=D.read_shift(4)),q>5&&(z&2&&(he.atime=D.read_shift(4)),z&4&&(he.ctime=D.read_shift(4))),he.mtime&&(he.mt=new Date(he.mtime*1e3));break}D.l=W,K[H]=he}return K}var f;function d(){return f||(f={})}function m(D,K){if(D[0]==80&&D[1]==75)return oa(D,K);if((D[0]|32)==109&&(D[1]|32)==105)return es(D,K);if(D.length<512)throw new Error("CFB file size "+D.length+" < 512");var z=3,H=512,q=0,W=0,he=0,Te=0,de=0,ge=[],pe=D.slice(0,512);yn(pe,0);var Pe=x(pe);switch(z=Pe[0],z){case 3:H=512;break;case 4:H=4096;break;case 0:if(Pe[1]==0)return oa(D,K);default:throw new Error("Major Version: Expected 3 or 4 saw "+z)}H!==512&&(pe=D.slice(0,H),yn(pe,28));var Ve=D.slice(0,H);_(pe,z);var Ge=pe.read_shift(4,"i");if(z===3&&Ge!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ge);pe.l+=4,he=pe.read_shift(4,"i"),pe.l+=4,pe.chk("00100000","Mini Stream Cutoff Size: "),Te=pe.read_shift(4,"i"),q=pe.read_shift(4,"i"),de=pe.read_shift(4,"i"),W=pe.read_shift(4,"i");for(var Me=-1,je=0;je<109&&(Me=pe.read_shift(4,"i"),!(Me<0));++je)ge[je]=Me;var We=y(D,H);S(de,W,We,H,ge);var Ht=U(We,he,ge,H);Ht[he].name="!Directory",q>0&&Te!==L&&(Ht[Te].name="!MiniFAT"),Ht[ge[0]].name="!FAT",Ht.fat_addrs=ge,Ht.ssz=H;var Gt={},or=[],En=[],ai=[];R(he,Ht,We,or,q,Gt,En,Te),w(En,ai,or),or.shift();var ii={FileIndex:En,FullPaths:ai};return K&&K.raw&&(ii.raw={header:Ve,sectors:We}),ii}function x(D){if(D[D.l]==80&&D[D.l+1]==75)return[0,0];D.chk(Ie,"Header Signature: "),D.l+=16;var K=D.read_shift(2,"u");return[D.read_shift(2,"u"),K]}function _(D,K){var z=9;switch(D.l+=2,z=D.read_shift(2)){case 9:if(K!=3)throw new Error("Sector Shift: Expected 9 saw "+z);break;case 12:if(K!=4)throw new Error("Sector Shift: Expected 12 saw "+z);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+z)}D.chk("0600","Mini Sector Shift: "),D.chk("000000000000","Reserved: ")}function y(D,K){for(var z=Math.ceil(D.length/K)-1,H=[],q=1;q<z;++q)H[q-1]=D.slice(q*K,(q+1)*K);return H[z-1]=D.slice(z*K),H}function w(D,K,z){for(var H=0,q=0,W=0,he=0,Te=0,de=z.length,ge=[],pe=[];H<de;++H)ge[H]=pe[H]=H,K[H]=z[H];for(;Te<pe.length;++Te)H=pe[Te],q=D[H].L,W=D[H].R,he=D[H].C,ge[H]===H&&(q!==-1&&ge[q]!==q&&(ge[H]=ge[q]),W!==-1&&ge[W]!==W&&(ge[H]=ge[W])),he!==-1&&(ge[he]=H),q!==-1&&H!=ge[H]&&(ge[q]=ge[H],pe.lastIndexOf(q)<Te&&pe.push(q)),W!==-1&&H!=ge[H]&&(ge[W]=ge[H],pe.lastIndexOf(W)<Te&&pe.push(W));for(H=1;H<de;++H)ge[H]===H&&(W!==-1&&ge[W]!==W?ge[H]=ge[W]:q!==-1&&ge[q]!==q&&(ge[H]=ge[q]));for(H=1;H<de;++H)if(D[H].type!==0){if(Te=H,Te!=ge[Te])do Te=ge[Te],K[H]=K[Te]+"/"+K[H];while(Te!==0&&ge[Te]!==-1&&Te!=ge[Te]);ge[H]=-1}for(K[0]+="/",H=1;H<de;++H)D[H].type!==2&&(K[H]+="/")}function T(D,K,z){for(var H=D.start,q=D.size,W=[],he=H;z&&q>0&&he>=0;)W.push(K.slice(he*M,he*M+M)),q-=M,he=Dl(z,he*4);return W.length===0?ye(0):ln(W).slice(0,D.size)}function S(D,K,z,H,q){var W=L;if(D===L){if(K!==0)throw new Error("DIFAT chain shorter than expected")}else if(D!==-1){var he=z[D],Te=(H>>>2)-1;if(!he)return;for(var de=0;de<Te&&(W=Dl(he,de*4))!==L;++de)q.push(W);S(Dl(he,H-4),K-1,z,H,q)}}function O(D,K,z,H,q){var W=[],he=[];q||(q=[]);var Te=H-1,de=0,ge=0;for(de=K;de>=0;){q[de]=!0,W[W.length]=de,he.push(D[de]);var pe=z[Math.floor(de*4/H)];if(ge=de*4&Te,H<4+ge)throw new Error("FAT boundary crossed: "+de+" 4 "+H);if(!D[pe])break;de=Dl(D[pe],ge)}return{nodes:W,data:RA([he])}}function U(D,K,z,H){var q=D.length,W=[],he=[],Te=[],de=[],ge=H-1,pe=0,Pe=0,Ve=0,Ge=0;for(pe=0;pe<q;++pe)if(Te=[],Ve=pe+K,Ve>=q&&(Ve-=q),!he[Ve]){de=[];var Me=[];for(Pe=Ve;Pe>=0;){Me[Pe]=!0,he[Pe]=!0,Te[Te.length]=Pe,de.push(D[Pe]);var je=z[Math.floor(Pe*4/H)];if(Ge=Pe*4&ge,H<4+Ge)throw new Error("FAT boundary crossed: "+Pe+" 4 "+H);if(!D[je]||(Pe=Dl(D[je],Ge),Me[Pe]))break}W[Ve]={nodes:Te,data:RA([de])}}return W}function R(D,K,z,H,q,W,he,Te){for(var de=0,ge=H.length?2:0,pe=K[D].data,Pe=0,Ve=0,Ge;Pe<pe.length;Pe+=128){var Me=pe.slice(Pe,Pe+128);yn(Me,64),Ve=Me.read_shift(2),Ge=Q_(Me,0,Ve-ge),H.push(Ge);var je={name:Ge,type:Me.read_shift(1),color:Me.read_shift(1),L:Me.read_shift(4,"i"),R:Me.read_shift(4,"i"),C:Me.read_shift(4,"i"),clsid:Me.read_shift(16),state:Me.read_shift(4,"i"),start:0,size:0},We=Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2);We!==0&&(je.ct=Y(Me,Me.l-8));var Ht=Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2);Ht!==0&&(je.mt=Y(Me,Me.l-8)),je.start=Me.read_shift(4,"i"),je.size=Me.read_shift(4,"i"),je.size<0&&je.start<0&&(je.size=je.type=0,je.start=L,je.name=""),je.type===5?(de=je.start,q>0&&de!==L&&(K[de].name="!StreamData")):je.size>=4096?(je.storage="fat",K[je.start]===void 0&&(K[je.start]=O(z,je.start,K.fat_addrs,K.ssz)),K[je.start].name=je.name,je.content=K[je.start].data.slice(0,je.size)):(je.storage="minifat",je.size<0?je.size=0:de!==L&&je.start!==L&&K[de]&&(je.content=T(je,K[de].data,(K[Te]||{}).data))),je.content&&yn(je.content,0),W[Ge]=je,he.push(je)}}function Y(D,K){return new Date((ya(D,K+4)/1e7*Math.pow(2,32)+ya(D,K)/1e7-11644473600)*1e3)}function te(D,K){return d(),m(f.readFileSync(D),K)}function G(D,K){var z=K&&K.type;switch(z||_t&&Buffer.isBuffer(D)&&(z="buffer"),z||"base64"){case"file":return te(D,K);case"base64":return m(Ta(Ia(D)),K);case"binary":return m(Ta(D),K)}return m(D,K)}function A(D,K){var z=K||{},H=z.root||"Root Entry";if(D.FullPaths||(D.FullPaths=[]),D.FileIndex||(D.FileIndex=[]),D.FullPaths.length!==D.FileIndex.length)throw new Error("inconsistent CFB structure");D.FullPaths.length===0&&(D.FullPaths[0]=H+"/",D.FileIndex[0]={name:H,type:5}),z.CLSID&&(D.FileIndex[0].clsid=z.CLSID),C(D)}function C(D){var K="Sh33tJ5";if(!et.find(D,"/"+K)){var z=ye(4);z[0]=55,z[1]=z[3]=50,z[2]=54,D.FileIndex.push({name:K,type:2,content:z,size:4,L:69,R:69,C:69}),D.FullPaths.push(D.FullPaths[0]+K),k(D)}}function k(D,K){A(D);for(var z=!1,H=!1,q=D.FullPaths.length-1;q>=0;--q){var W=D.FileIndex[q];switch(W.type){case 0:H?z=!0:(D.FileIndex.pop(),D.FullPaths.pop());break;case 1:case 2:case 5:H=!0,isNaN(W.R*W.L*W.C)&&(z=!0),W.R>-1&&W.L>-1&&W.R==W.L&&(z=!0);break;default:z=!0;break}}if(!(!z&&!K)){var he=new Date(1987,1,19),Te=0,de=Object.create?Object.create(null):{},ge=[];for(q=0;q<D.FullPaths.length;++q)de[D.FullPaths[q]]=!0,D.FileIndex[q].type!==0&&ge.push([D.FullPaths[q],D.FileIndex[q]]);for(q=0;q<ge.length;++q){var pe=n(ge[q][0]);H=de[pe],H||(ge.push([pe,{name:a(pe).replace("/",""),type:1,clsid:ae,ct:he,mt:he,content:null}]),de[pe]=!0)}for(ge.sort(function(Ge,Me){return t(Ge[0],Me[0])}),D.FullPaths=[],D.FileIndex=[],q=0;q<ge.length;++q)D.FullPaths[q]=ge[q][0],D.FileIndex[q]=ge[q][1];for(q=0;q<ge.length;++q){var Pe=D.FileIndex[q],Ve=D.FullPaths[q];if(Pe.name=a(Ve).replace("/",""),Pe.L=Pe.R=Pe.C=-(Pe.color=1),Pe.size=Pe.content?Pe.content.length:0,Pe.start=0,Pe.clsid=Pe.clsid||ae,q===0)Pe.C=ge.length>1?1:-1,Pe.size=0,Pe.type=5;else if(Ve.slice(-1)=="/"){for(Te=q+1;Te<ge.length&&n(D.FullPaths[Te])!=Ve;++Te);for(Pe.C=Te>=ge.length?-1:Te,Te=q+1;Te<ge.length&&n(D.FullPaths[Te])!=n(Ve);++Te);Pe.R=Te>=ge.length?-1:Te,Pe.type=1}else n(D.FullPaths[q+1]||"")==n(Ve)&&(Pe.R=q+1),Pe.type=2}}}function V(D,K){var z=K||{};if(z.fileType=="mad")return uf(D,z);switch(k(D),z.fileType){case"zip":return br(D,z)}var H=(function(Ge){for(var Me=0,je=0,We=0;We<Ge.FileIndex.length;++We){var Ht=Ge.FileIndex[We];if(Ht.content){var Gt=Ht.content.length;Gt>0&&(Gt<4096?Me+=Gt+63>>6:je+=Gt+511>>9)}}for(var or=Ge.FullPaths.length+3>>2,En=Me+7>>3,ai=Me+127>>7,ii=En+je+or+ai,ca=ii+127>>7,zs=ca<=109?0:Math.ceil((ca-109)/127);ii+ca+zs+127>>7>ca;)zs=++ca<=109?0:Math.ceil((ca-109)/127);var wn=[1,zs,ca,ai,or,je,Me,0];return Ge.FileIndex[0].size=Me<<6,wn[7]=(Ge.FileIndex[0].start=wn[0]+wn[1]+wn[2]+wn[3]+wn[4]+wn[5])+(wn[6]+7>>3),wn})(D),q=ye(H[7]<<9),W=0,he=0;{for(W=0;W<8;++W)q.write_shift(1,Re[W]);for(W=0;W<8;++W)q.write_shift(2,0);for(q.write_shift(2,62),q.write_shift(2,3),q.write_shift(2,65534),q.write_shift(2,9),q.write_shift(2,6),W=0;W<3;++W)q.write_shift(2,0);for(q.write_shift(4,0),q.write_shift(4,H[2]),q.write_shift(4,H[0]+H[1]+H[2]+H[3]-1),q.write_shift(4,0),q.write_shift(4,4096),q.write_shift(4,H[3]?H[0]+H[1]+H[2]-1:L),q.write_shift(4,H[3]),q.write_shift(-4,H[1]?H[0]-1:L),q.write_shift(4,H[1]),W=0;W<109;++W)q.write_shift(-4,W<H[2]?H[1]+W:-1)}if(H[1])for(he=0;he<H[1];++he){for(;W<236+he*127;++W)q.write_shift(-4,W<H[2]?H[1]+W:-1);q.write_shift(-4,he===H[1]-1?L:he+1)}var Te=function(Ge){for(he+=Ge;W<he-1;++W)q.write_shift(-4,W+1);Ge&&(++W,q.write_shift(-4,L))};for(he=W=0,he+=H[1];W<he;++W)q.write_shift(-4,le.DIFSECT);for(he+=H[2];W<he;++W)q.write_shift(-4,le.FATSECT);Te(H[3]),Te(H[4]);for(var de=0,ge=0,pe=D.FileIndex[0];de<D.FileIndex.length;++de)pe=D.FileIndex[de],pe.content&&(ge=pe.content.length,!(ge<4096)&&(pe.start=he,Te(ge+511>>9)));for(Te(H[6]+7>>3);q.l&511;)q.write_shift(-4,le.ENDOFCHAIN);for(he=W=0,de=0;de<D.FileIndex.length;++de)pe=D.FileIndex[de],pe.content&&(ge=pe.content.length,!(!ge||ge>=4096)&&(pe.start=he,Te(ge+63>>6)));for(;q.l&511;)q.write_shift(-4,le.ENDOFCHAIN);for(W=0;W<H[4]<<2;++W){var Pe=D.FullPaths[W];if(!Pe||Pe.length===0){for(de=0;de<17;++de)q.write_shift(4,0);for(de=0;de<3;++de)q.write_shift(4,-1);for(de=0;de<12;++de)q.write_shift(4,0);continue}pe=D.FileIndex[W],W===0&&(pe.start=pe.size?pe.start-1:L);var Ve=W===0&&z.root||pe.name;if(ge=2*(Ve.length+1),q.write_shift(64,Ve,"utf16le"),q.write_shift(2,ge),q.write_shift(1,pe.type),q.write_shift(1,pe.color),q.write_shift(-4,pe.L),q.write_shift(-4,pe.R),q.write_shift(-4,pe.C),pe.clsid)q.write_shift(16,pe.clsid,"hex");else for(de=0;de<4;++de)q.write_shift(4,0);q.write_shift(4,pe.state||0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,pe.start),q.write_shift(4,pe.size),q.write_shift(4,0)}for(W=1;W<D.FileIndex.length;++W)if(pe=D.FileIndex[W],pe.size>=4096)if(q.l=pe.start+1<<9,_t&&Buffer.isBuffer(pe.content))pe.content.copy(q,q.l,0,pe.size),q.l+=pe.size+511&-512;else{for(de=0;de<pe.size;++de)q.write_shift(1,pe.content[de]);for(;de&511;++de)q.write_shift(1,0)}for(W=1;W<D.FileIndex.length;++W)if(pe=D.FileIndex[W],pe.size>0&&pe.size<4096)if(_t&&Buffer.isBuffer(pe.content))pe.content.copy(q,q.l,0,pe.size),q.l+=pe.size+63&-64;else{for(de=0;de<pe.size;++de)q.write_shift(1,pe.content[de]);for(;de&63;++de)q.write_shift(1,0)}if(_t)q.l=q.length;else for(;q.l<q.length;)q.write_shift(1,0);return q}function F(D,K){var z=D.FullPaths.map(function(de){return de.toUpperCase()}),H=z.map(function(de){var ge=de.split("/");return ge[ge.length-(de.slice(-1)=="/"?2:1)]}),q=!1;K.charCodeAt(0)===47?(q=!0,K=z[0].slice(0,-1)+K):q=K.indexOf("/")!==-1;var W=K.toUpperCase(),he=q===!0?z.indexOf(W):H.indexOf(W);if(he!==-1)return D.FileIndex[he];var Te=!W.match(vh);for(W=W.replace(Kn,""),Te&&(W=W.replace(vh,"!")),he=0;he<z.length;++he)if((Te?z[he].replace(vh,"!"):z[he]).replace(Kn,"")==W||(Te?H[he].replace(vh,"!"):H[he]).replace(Kn,"")==W)return D.FileIndex[he];return null}var M=64,L=-2,Ie="d0cf11e0a1b11ae1",Re=[208,207,17,224,161,177,26,225],ae="00000000000000000000000000000000",le={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:L,FREESECT:-1,HEADER_SIGNATURE:Ie,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ae,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Fe(D,K,z){d();var H=V(D,z);f.writeFileSync(K,H)}function ie(D){for(var K=new Array(D.length),z=0;z<D.length;++z)K[z]=String.fromCharCode(D[z]);return K.join("")}function Ne(D,K){var z=V(D,K);switch(K&&K.type||"buffer"){case"file":return d(),f.writeFileSync(K.filename,z),z;case"binary":return typeof z=="string"?z:ie(z);case"base64":return Zh(typeof z=="string"?z:ie(z));case"buffer":if(_t)return Buffer.isBuffer(z)?z:Vs(z);case"array":return typeof z=="string"?Ta(z):z}return z}var Q;function N(D){try{var K=D.InflateRaw,z=new K;if(z._processChunk(new Uint8Array([3,0]),z._finishFlushFlag),z.bytesRead)Q=D;else throw new Error("zlib does not expose bytesRead")}catch(H){console.error("cannot use native zlib: "+(H.message||H))}}function J(D,K){if(!Q)return Ji(D,K);var z=Q.InflateRaw,H=new z,q=H._processChunk(D.slice(D.l),H._finishFlushFlag);return D.l+=H.bytesRead,q}function X(D){return Q?Q.deflateRawSync(D):dt(D)}var ee=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ce=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],we=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function De(D){var K=(D<<1|D<<11)&139536|(D<<5|D<<15)&558144;return(K>>16|K>>8|K)&255}for(var Ae=typeof Uint8Array<"u",Oe=Ae?new Uint8Array(256):[],st=0;st<256;++st)Oe[st]=De(st);function Z(D,K){var z=Oe[D&255];return K<=8?z>>>8-K:(z=z<<8|Oe[D>>8&255],K<=16?z>>>16-K:(z=z<<8|Oe[D>>16&255],z>>>24-K))}function Ft(D,K){var z=K&7,H=K>>>3;return(D[H]|(z<=6?0:D[H+1]<<8))>>>z&3}function lt(D,K){var z=K&7,H=K>>>3;return(D[H]|(z<=5?0:D[H+1]<<8))>>>z&7}function Rt(D,K){var z=K&7,H=K>>>3;return(D[H]|(z<=4?0:D[H+1]<<8))>>>z&15}function ct(D,K){var z=K&7,H=K>>>3;return(D[H]|(z<=3?0:D[H+1]<<8))>>>z&31}function He(D,K){var z=K&7,H=K>>>3;return(D[H]|(z<=1?0:D[H+1]<<8))>>>z&127}function sr(D,K,z){var H=K&7,q=K>>>3,W=(1<<z)-1,he=D[q]>>>H;return z<8-H||(he|=D[q+1]<<8-H,z<16-H)||(he|=D[q+2]<<16-H,z<24-H)||(he|=D[q+3]<<24-H),he&W}function Dt(D,K,z){var H=K&7,q=K>>>3;return H<=5?D[q]|=(z&7)<<H:(D[q]|=z<<H&255,D[q+1]=(z&7)>>8-H),K+3}function zt(D,K,z){var H=K&7,q=K>>>3;return z=(z&1)<<H,D[q]|=z,K+1}function rn(D,K,z){var H=K&7,q=K>>>3;return z<<=H,D[q]|=z&255,z>>>=8,D[q+1]=z,K+8}function Qi(D,K,z){var H=K&7,q=K>>>3;return z<<=H,D[q]|=z&255,z>>>=8,D[q+1]=z&255,D[q+2]=z>>>8,K+16}function sa(D,K){var z=D.length,H=2*z>K?2*z:K+5,q=0;if(z>=K)return D;if(_t){var W=fA(H);if(D.copy)D.copy(W);else for(;q<D.length;++q)W[q]=D[q];return W}else if(Ae){var he=new Uint8Array(H);if(he.set)he.set(D);else for(;q<z;++q)he[q]=D[q];return he}return D.length=H,D}function jt(D){for(var K=new Array(D),z=0;z<D;++z)K[z]=0;return K}function un(D,K,z){var H=1,q=0,W=0,he=0,Te=0,de=D.length,ge=Ae?new Uint16Array(32):jt(32);for(W=0;W<32;++W)ge[W]=0;for(W=de;W<z;++W)D[W]=0;de=D.length;var pe=Ae?new Uint16Array(de):jt(de);for(W=0;W<de;++W)ge[q=D[W]]++,H<q&&(H=q),pe[W]=0;for(ge[0]=0,W=1;W<=H;++W)ge[W+16]=Te=Te+ge[W-1]<<1;for(W=0;W<de;++W)Te=D[W],Te!=0&&(pe[W]=ge[Te+16]++);var Pe=0;for(W=0;W<de;++W)if(Pe=D[W],Pe!=0)for(Te=Z(pe[W],H)>>H-Pe,he=(1<<H+4-Pe)-1;he>=0;--he)K[Te|he<<Pe]=Pe&15|W<<4;return H}var Xn=Ae?new Uint16Array(512):jt(512),ri=Ae?new Uint16Array(32):jt(32);if(!Ae){for(var gr=0;gr<512;++gr)Xn[gr]=0;for(gr=0;gr<32;++gr)ri[gr]=0}(function(){for(var D=[],K=0;K<32;K++)D.push(5);un(D,ri,32);var z=[];for(K=0;K<=143;K++)z.push(8);for(;K<=255;K++)z.push(9);for(;K<=279;K++)z.push(7);for(;K<=287;K++)z.push(8);un(z,Xn,288)})();var Wn=(function(){for(var K=Ae?new Uint8Array(32768):[],z=0,H=0;z<we.length-1;++z)for(;H<we[z+1];++H)K[H]=z;for(;H<32768;++H)K[H]=29;var q=Ae?new Uint8Array(259):[];for(z=0,H=0;z<ce.length-1;++z)for(;H<ce[z+1];++H)q[H]=z;function W(Te,de){for(var ge=0;ge<Te.length;){var pe=Math.min(65535,Te.length-ge),Pe=ge+pe==Te.length;for(de.write_shift(1,+Pe),de.write_shift(2,pe),de.write_shift(2,~pe&65535);pe-- >0;)de[de.l++]=Te[ge++]}return de.l}function he(Te,de){for(var ge=0,pe=0,Pe=Ae?new Uint16Array(32768):[];pe<Te.length;){var Ve=Math.min(65535,Te.length-pe);if(Ve<10){for(ge=Dt(de,ge,+(pe+Ve==Te.length)),ge&7&&(ge+=8-(ge&7)),de.l=ge/8|0,de.write_shift(2,Ve),de.write_shift(2,~Ve&65535);Ve-- >0;)de[de.l++]=Te[pe++];ge=de.l*8;continue}ge=Dt(de,ge,+(pe+Ve==Te.length)+2);for(var Ge=0;Ve-- >0;){var Me=Te[pe];Ge=(Ge<<5^Me)&32767;var je=-1,We=0;if((je=Pe[Ge])&&(je|=pe&-32768,je>pe&&(je-=32768),je<pe))for(;Te[je+We]==Te[pe+We]&&We<250;)++We;if(We>2){Me=q[We],Me<=22?ge=rn(de,ge,Oe[Me+1]>>1)-1:(rn(de,ge,3),ge+=5,rn(de,ge,Oe[Me-23]>>5),ge+=3);var Ht=Me<8?0:Me-4>>2;Ht>0&&(Qi(de,ge,We-ce[Me]),ge+=Ht),Me=K[pe-je],ge=rn(de,ge,Oe[Me]>>3),ge-=3;var Gt=Me<4?0:Me-2>>1;Gt>0&&(Qi(de,ge,pe-je-we[Me]),ge+=Gt);for(var or=0;or<We;++or)Pe[Ge]=pe&32767,Ge=(Ge<<5^Te[pe])&32767,++pe;Ve-=We-1}else Me<=143?Me=Me+48:ge=zt(de,ge,1),ge=rn(de,ge,Oe[Me]),Pe[Ge]=pe&32767,++pe}ge=rn(de,ge,0)-1}return de.l=(ge+7)/8|0,de.l}return function(de,ge){return de.length<8?W(de,ge):he(de,ge)}})();function dt(D){var K=ye(50+Math.floor(D.length*1.1)),z=Wn(D,K);return K.slice(0,z)}var cr=Ae?new Uint16Array(32768):jt(32768),fn=Ae?new Uint16Array(32768):jt(32768),Vt=Ae?new Uint16Array(128):jt(128),ur=1,Ln=1;function Tr(D,K){var z=ct(D,K)+257;K+=5;var H=ct(D,K)+1;K+=5;var q=Rt(D,K)+4;K+=4;for(var W=0,he=Ae?new Uint8Array(19):jt(19),Te=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],de=1,ge=Ae?new Uint8Array(8):jt(8),pe=Ae?new Uint8Array(8):jt(8),Pe=he.length,Ve=0;Ve<q;++Ve)he[ee[Ve]]=W=lt(D,K),de<W&&(de=W),ge[W]++,K+=3;var Ge=0;for(ge[0]=0,Ve=1;Ve<=de;++Ve)pe[Ve]=Ge=Ge+ge[Ve-1]<<1;for(Ve=0;Ve<Pe;++Ve)(Ge=he[Ve])!=0&&(Te[Ve]=pe[Ge]++);var Me=0;for(Ve=0;Ve<Pe;++Ve)if(Me=he[Ve],Me!=0){Ge=Oe[Te[Ve]]>>8-Me;for(var je=(1<<7-Me)-1;je>=0;--je)Vt[Ge|je<<Me]=Me&7|Ve<<3}var We=[];for(de=1;We.length<z+H;)switch(Ge=Vt[He(D,K)],K+=Ge&7,Ge>>>=3){case 16:for(W=3+Ft(D,K),K+=2,Ge=We[We.length-1];W-- >0;)We.push(Ge);break;case 17:for(W=3+lt(D,K),K+=3;W-- >0;)We.push(0);break;case 18:for(W=11+He(D,K),K+=7;W-- >0;)We.push(0);break;default:We.push(Ge),de<Ge&&(de=Ge);break}var Ht=We.slice(0,z),Gt=We.slice(z);for(Ve=z;Ve<286;++Ve)Ht[Ve]=0;for(Ve=H;Ve<30;++Ve)Gt[Ve]=0;return ur=un(Ht,cr,286),Ln=un(Gt,fn,30),K}function _c(D,K){if(D[0]==3&&!(D[1]&3))return[jo(K),2];for(var z=0,H=0,q=fA(K||1<<18),W=0,he=q.length>>>0,Te=0,de=0;(H&1)==0;){if(H=lt(D,z),z+=3,H>>>1)H>>1==1?(Te=9,de=5):(z=Tr(D,z),Te=ur,de=Ln);else{z&7&&(z+=8-(z&7));var ge=D[z>>>3]|D[(z>>>3)+1]<<8;if(z+=32,ge>0)for(!K&&he<W+ge&&(q=sa(q,W+ge),he=q.length);ge-- >0;)q[W++]=D[z>>>3],z+=8;continue}for(;;){!K&&he<W+32767&&(q=sa(q,W+32767),he=q.length);var pe=sr(D,z,Te),Pe=H>>>1==1?Xn[pe]:cr[pe];if(z+=Pe&15,Pe>>>=4,(Pe>>>8&255)===0)q[W++]=Pe;else{if(Pe==256)break;Pe-=257;var Ve=Pe<8?0:Pe-4>>2;Ve>5&&(Ve=0);var Ge=W+ce[Pe];Ve>0&&(Ge+=sr(D,z,Ve),z+=Ve),pe=sr(D,z,de),Pe=H>>>1==1?ri[pe]:fn[pe],z+=Pe&15,Pe>>>=4;var Me=Pe<4?0:Pe-2>>1,je=we[Pe];for(Me>0&&(je+=sr(D,z,Me),z+=Me),!K&&he<Ge&&(q=sa(q,Ge+100),he=q.length);W<Ge;)q[W]=q[W-je],++W}}}return K?[q,z+7>>>3]:[q.slice(0,W),z+7>>>3]}function Ji(D,K){var z=D.slice(D.l||0),H=_c(z,K);return D.l+=H[1],H[0]}function Qo(D,K){if(D)typeof console<"u"&&console.error(K);else throw new Error(K)}function oa(D,K){var z=D;yn(z,0);var H=[],q=[],W={FileIndex:H,FullPaths:q};A(W,{root:K.root});for(var he=z.length-4;(z[he]!=80||z[he+1]!=75||z[he+2]!=5||z[he+3]!=6)&&he>=0;)--he;z.l=he+4,z.l+=4;var Te=z.read_shift(2);z.l+=6;var de=z.read_shift(4);for(z.l=de,he=0;he<Te;++he){z.l+=20;var ge=z.read_shift(4),pe=z.read_shift(4),Pe=z.read_shift(2),Ve=z.read_shift(2),Ge=z.read_shift(2);z.l+=8;var Me=z.read_shift(4),je=u(z.slice(z.l+Pe,z.l+Pe+Ve));z.l+=Pe+Ve+Ge;var We=z.l;z.l=Me+4,Zi(z,ge,pe,W,je),z.l=We}return W}function Zi(D,K,z,H,q){D.l+=2;var W=D.read_shift(2),he=D.read_shift(2),Te=l(D);if(W&8257)throw new Error("Unsupported ZIP encryption");for(var de=D.read_shift(4),ge=D.read_shift(4),pe=D.read_shift(4),Pe=D.read_shift(2),Ve=D.read_shift(2),Ge="",Me=0;Me<Pe;++Me)Ge+=String.fromCharCode(D[D.l++]);if(Ve){var je=u(D.slice(D.l,D.l+Ve));(je[21589]||{}).mt&&(Te=je[21589].mt),((q||{})[21589]||{}).mt&&(Te=q[21589].mt)}D.l+=Ve;var We=D.slice(D.l,D.l+ge);switch(he){case 8:We=J(D,pe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+he)}var Ht=!1;W&8&&(de=D.read_shift(4),de==134695760&&(de=D.read_shift(4),Ht=!0),ge=D.read_shift(4),pe=D.read_shift(4)),ge!=K&&Qo(Ht,"Bad compressed size: "+K+" != "+ge),pe!=z&&Qo(Ht,"Bad uncompressed size: "+z+" != "+pe),rs(H,Ge,We,{unsafe:!0,mt:Te})}function br(D,K){var z=K||{},H=[],q=[],W=ye(1),he=z.compression?8:0,Te=0,de=0,ge=0,pe=0,Pe=0,Ve=D.FullPaths[0],Ge=Ve,Me=D.FileIndex[0],je=[],We=0;for(de=1;de<D.FullPaths.length;++de)if(Ge=D.FullPaths[de].slice(Ve.length),Me=D.FileIndex[de],!(!Me.size||!Me.content||Ge=="Sh33tJ5")){var Ht=pe,Gt=ye(Ge.length);for(ge=0;ge<Ge.length;++ge)Gt.write_shift(1,Ge.charCodeAt(ge)&127);Gt=Gt.slice(0,Gt.l),je[Pe]=E7.buf(Me.content,0);var or=Me.content;he==8&&(or=X(or)),W=ye(30),W.write_shift(4,67324752),W.write_shift(2,20),W.write_shift(2,Te),W.write_shift(2,he),Me.mt?s(W,Me.mt):W.write_shift(4,0),W.write_shift(-4,je[Pe]),W.write_shift(4,or.length),W.write_shift(4,Me.content.length),W.write_shift(2,Gt.length),W.write_shift(2,0),pe+=W.length,H.push(W),pe+=Gt.length,H.push(Gt),pe+=or.length,H.push(or),W=ye(46),W.write_shift(4,33639248),W.write_shift(2,0),W.write_shift(2,20),W.write_shift(2,Te),W.write_shift(2,he),W.write_shift(4,0),W.write_shift(-4,je[Pe]),W.write_shift(4,or.length),W.write_shift(4,Me.content.length),W.write_shift(2,Gt.length),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(4,0),W.write_shift(4,Ht),We+=W.l,q.push(W),We+=Gt.length,q.push(Gt),++Pe}return W=ye(22),W.write_shift(4,101010256),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(2,Pe),W.write_shift(2,Pe),W.write_shift(4,We),W.write_shift(4,pe),W.write_shift(2,0),ln([ln(H),ln(q),W])}var Vn={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ca(D,K){if(D.ctype)return D.ctype;var z=D.name||"",H=z.match(/\.([^\.]+)$/);return H&&Vn[H[1]]||K&&(H=(z=K).match(/[\.\\]([^\.\\])+$/),H&&Vn[H[1]])?Vn[H[1]]:"application/octet-stream"}function la(D){for(var K=Zh(D),z=[],H=0;H<K.length;H+=76)z.push(K.slice(H,H+76));return z.join(`\r
`)+`\r
`}function cf(D){var K=D.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ge){var pe=ge.charCodeAt(0).toString(16).toUpperCase();return"="+(pe.length==1?"0"+pe:pe)});K=K.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),K.charAt(0)==`
`&&(K="=0D"+K.slice(1)),K=K.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var z=[],H=K.split(`\r
`),q=0;q<H.length;++q){var W=H[q];if(W.length==0){z.push("");continue}for(var he=0;he<W.length;){var Te=76,de=W.slice(he,he+Te);de.charAt(Te-1)=="="?Te--:de.charAt(Te-2)=="="?Te-=2:de.charAt(Te-3)=="="&&(Te-=3),de=W.slice(he,he+Te),he+=Te,he<W.length&&(de+="="),z.push(de)}}return z.join(`\r
`)}function yc(D){for(var K=[],z=0;z<D.length;++z){for(var H=D[z];z<=D.length&&H.charAt(H.length-1)=="=";)H=H.slice(0,H.length-1)+D[++z];K.push(H)}for(var q=0;q<K.length;++q)K[q]=K[q].replace(/[=][0-9A-Fa-f]{2}/g,function(W){return String.fromCharCode(parseInt(W.slice(1),16))});return Ta(K.join(`\r
`))}function Ra(D,K,z){for(var H="",q="",W="",he,Te=0;Te<10;++Te){var de=K[Te];if(!de||de.match(/^\s*$/))break;var ge=de.match(/^(.*?):\s*([^\s].*)$/);if(ge)switch(ge[1].toLowerCase()){case"content-location":H=ge[2].trim();break;case"content-type":W=ge[2].trim();break;case"content-transfer-encoding":q=ge[2].trim();break}}switch(++Te,q.toLowerCase()){case"base64":he=Ta(Ia(K.slice(Te).join("")));break;case"quoted-printable":he=yc(K.slice(Te));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+q)}var pe=rs(D,H.slice(z.length),he,{unsafe:!0});W&&(pe.ctype=W)}function es(D,K){if(ie(D.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var z=K&&K.root||"",H=(_t&&Buffer.isBuffer(D)?D.toString("binary"):ie(D)).split(`\r
`),q=0,W="";for(q=0;q<H.length;++q)if(W=H[q],!!/^Content-Location:/i.test(W)&&(W=W.slice(W.indexOf("file")),z||(z=W.slice(0,W.lastIndexOf("/")+1)),W.slice(0,z.length)!=z))for(;z.length>0&&(z=z.slice(0,z.length-1),z=z.slice(0,z.lastIndexOf("/")+1),W.slice(0,z.length)!=z););var he=(H[1]||"").match(/boundary="(.*?)"/);if(!he)throw new Error("MAD cannot find boundary");var Te="--"+(he[1]||""),de=[],ge=[],pe={FileIndex:de,FullPaths:ge};A(pe);var Pe,Ve=0;for(q=0;q<H.length;++q){var Ge=H[q];Ge!==Te&&Ge!==Te+"--"||(Ve++&&Ra(pe,H.slice(Pe,q),z),Pe=q)}return pe}function uf(D,K){var z=K||{},H=z.boundary||"SheetJS";H="------="+H;for(var q=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+H.slice(2)+'"',"","",""],W=D.FullPaths[0],he=W,Te=D.FileIndex[0],de=1;de<D.FullPaths.length;++de)if(he=D.FullPaths[de].slice(W.length),Te=D.FileIndex[de],!(!Te.size||!Te.content||he=="Sh33tJ5")){he=he.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(We){return"_x"+We.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(We){return"_u"+We.charCodeAt(0).toString(16)+"_"});for(var ge=Te.content,pe=_t&&Buffer.isBuffer(ge)?ge.toString("binary"):ie(ge),Pe=0,Ve=Math.min(1024,pe.length),Ge=0,Me=0;Me<=Ve;++Me)(Ge=pe.charCodeAt(Me))>=32&&Ge<128&&++Pe;var je=Pe>=Ve*4/5;q.push(H),q.push("Content-Location: "+(z.root||"file:///C:/SheetJS/")+he),q.push("Content-Transfer-Encoding: "+(je?"quoted-printable":"base64")),q.push("Content-Type: "+Ca(Te,he)),q.push(""),q.push(je?cf(pe):la(pe))}return q.push(H+`--\r
`),q.join(`\r
`)}function ts(D){var K={};return A(K,D),K}function rs(D,K,z,H){var q=H&&H.unsafe;q||A(D);var W=!q&&et.find(D,K);if(!W){var he=D.FullPaths[0];K.slice(0,he.length)==he?he=K:(he.slice(-1)!="/"&&(he+="/"),he=(he+K).replace("//","/")),W={name:a(K),type:2},D.FileIndex.push(W),D.FullPaths.push(he),q||et.utils.cfb_gc(D)}return W.content=z,W.size=z?z.length:0,H&&(H.CLSID&&(W.clsid=H.CLSID),H.mt&&(W.mt=H.mt),H.ct&&(W.ct=H.ct)),W}function Jo(D,K){A(D);var z=et.find(D,K);if(z){for(var H=0;H<D.FileIndex.length;++H)if(D.FileIndex[H]==z)return D.FileIndex.splice(H,1),D.FullPaths.splice(H,1),!0}return!1}function ns(D,K,z){A(D);var H=et.find(D,K);if(H){for(var q=0;q<D.FileIndex.length;++q)if(D.FileIndex[q]==H)return D.FileIndex[q].name=a(z),D.FullPaths[q]=z,!0}return!1}function ni(D){k(D,!0)}return e.find=F,e.read=G,e.parse=m,e.write=Ne,e.writeFile=Fe,e.utils={cfb_new:ts,cfb_add:rs,cfb_del:Jo,cfb_mov:ns,cfb_gc:ni,ReadShift:Rh,CheckField:UC,prep_blob:yn,bconcat:ln,use_zlib:N,_deflateRaw:dt,_inflateRaw:Ji,consts:le},e})();function w7(r){return typeof r=="string"?Xp(r):Array.isArray(r)?YL(r):r}function A0(r,e,t){if(typeof Deno<"u"){if(t&&typeof e=="string")switch(t){case"utf8":e=new TextEncoder(t).encode(e);break;case"binary":e=Xp(e);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(r,e)}var n=t=="utf8"?ji(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,r);if(typeof Blob<"u"){var a=new Blob([w7(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,r);if(typeof saveAs<"u")return saveAs(a,r);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:r,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=r,l.href=s,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(r);return u.open("w"),u.encoding="binary",Array.isArray(e)&&(e=Wo(e)),u.write(e),u.close(),e}catch(f){if(!f.message||!f.message.match(/onstruct/))throw f}throw new Error("cannot save file "+r)}function S7(r){if(typeof Deno<"u")return Deno.readFileSync(r);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(r);e.open("r"),e.encoding="binary";var t=e.read();return e.close(),t}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+r)}function Nr(r){for(var e=Object.keys(r),t=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(r,e[n])&&t.push(e[n]);return t}function _A(r,e){for(var t=[],n=Nr(r),a=0;a!==n.length;++a)t[r[n[a]][e]]==null&&(t[r[n[a]][e]]=n[a]);return t}function Yp(r){for(var e=[],t=Nr(r),n=0;n!==t.length;++n)e[r[t[n]]]=t[n];return e}function $p(r){for(var e=[],t=Nr(r),n=0;n!==t.length;++n)e[r[t[n]]]=parseInt(t[n],10);return e}function A7(r){for(var e=[],t=Nr(r),n=0;n!==t.length;++n)e[r[t[n]]]==null&&(e[r[t[n]]]=[]),e[r[t[n]]].push(t[n]);return e}var hp=new Date(1899,11,30,0,0,0);function en(r,e){var t=r.getTime(),n=hp.getTime()+(r.getTimezoneOffset()-hp.getTimezoneOffset())*6e4;return(t-n)/(1440*60*1e3)}var _C=new Date,b7=hp.getTime()+(_C.getTimezoneOffset()-hp.getTimezoneOffset())*6e4,yA=_C.getTimezoneOffset();function Qp(r){var e=new Date;return e.setTime(r*24*60*60*1e3+b7),e.getTimezoneOffset()!==yA&&e.setTime(e.getTime()+(e.getTimezoneOffset()-yA)*6e4),e}function I7(r){var e=0,t=0,n=!1,a=r.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+r+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(t=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":t*=24;case"H":t*=60;case"M":if(n)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=t*parseInt(a[s],10)}return e}var TA=new Date("2017-02-19T19:06:09.000Z"),yC=isNaN(TA.getFullYear())?new Date("2/19/17"):TA,k7=yC.getFullYear()==2017;function mr(r,e){var t=new Date(r);if(k7)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(r instanceof Date)return r;if(yC.getFullYear()==1917&&!isNaN(t.getFullYear())){var n=t.getFullYear();return r.indexOf(""+n)>-1||t.setFullYear(t.getFullYear()+100),t}var a=r.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return r.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function nc(r,e){if(_t&&Buffer.isBuffer(r)){if(e){if(r[0]==255&&r[1]==254)return ji(r.slice(2).toString("utf16le"));if(r[1]==254&&r[2]==255)return ji(oC(r.slice(2).toString("binary")))}return r.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(r[0]==255&&r[1]==254)return ji(new TextDecoder("utf-16le").decode(r.slice(2)));if(r[0]==254&&r[1]==255)return ji(new TextDecoder("utf-16be").decode(r.slice(2)))}var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(r)&&(r=new Uint8Array(r)),new TextDecoder("latin1").decode(r).replace(/[]/g,function(s){return t[s]||s})}catch{}for(var n=[],a=0;a!=r.length;++a)n.push(String.fromCharCode(r[a]));return n.join("")}function pr(r){if(typeof JSON<"u"&&!Array.isArray(r))return JSON.parse(JSON.stringify(r));if(typeof r!="object"||r==null)return r;if(r instanceof Date)return new Date(r.getTime());var e={};for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=pr(r[t]));return e}function Cr(r,e){for(var t="";t.length<e;)t+=r;return t}function Ti(r){var e=Number(r);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(r))return e;var t=1,n=r.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return t=-t,s}),!isNaN(e=Number(n)))?e/t:e}var C7=["january","february","march","april","may","june","july","august","september","october","november","december"];function Wu(r){var e=new Date(r),t=new Date(NaN),n=e.getYear(),a=e.getMonth(),s=e.getDate();if(isNaN(s))return t;var l=r.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&C7.indexOf(l)==-1)return t}else if(l.match(/[a-z]/))return t;return n<0||n>8099?t:(a>0||s>1)&&n!=101?e:r.match(/[^-0-9:,\/\\]/)?t:e}var R7=(function(){var r="abacaba".split(/(:?b)/i).length==5;return function(t,n,a){if(r||typeof n=="string")return t.split(n);for(var s=t.split(n),l=[s[0]],u=1;u<s.length;++u)l.push(a),l.push(s[u]);return l}})();function TC(r){return r?r.content&&r.type?nc(r.content,!0):r.data?xh(r.data):r.asNodeBuffer&&_t?xh(r.asNodeBuffer().toString("binary")):r.asBinary?xh(r.asBinary()):r._data&&r._data.getContent?xh(nc(Array.prototype.slice.call(r._data.getContent(),0))):null:null}function EC(r){if(!r)return null;if(r.data)return cA(r.data);if(r.asNodeBuffer&&_t)return r.asNodeBuffer();if(r._data&&r._data.getContent){var e=r._data.getContent();return typeof e=="string"?cA(e):Array.prototype.slice.call(e)}return r.content&&r.type?r.content:null}function D7(r){return r&&r.name.slice(-4)===".bin"?EC(r):TC(r)}function Ka(r,e){for(var t=r.FullPaths||Nr(r.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<t.length;++s){var l=t[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==l||a==l)return r.files?r.files[t[s]]:r.FileIndex[s]}return null}function q_(r,e){var t=Ka(r,e);if(t==null)throw new Error("Cannot find file "+e+" in zip");return t}function Kr(r,e,t){if(!t)return D7(q_(r,e));if(!e)return null;try{return Kr(r,e)}catch{return null}}function Ea(r,e,t){if(!t)return TC(q_(r,e));if(!e)return null;try{return Ea(r,e)}catch{return null}}function N7(r,e,t){return EC(q_(r,e))}function EA(r){for(var e=r.FullPaths||Nr(r.files),t=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&t.push(e[n].replace(/^Root Entry[\/]/,""));return t.sort()}function vt(r,e,t){if(r.FullPaths){if(typeof t=="string"){var n;return _t?n=Vs(t):n=$L(t),et.utils.cfb_add(r,e,n)}et.utils.cfb_add(r,e,t)}else r.file(e,t)}function K_(){return et.utils.cfb_new()}function wC(r,e){switch(e.type){case"base64":return et.read(r,{type:"base64"});case"binary":return et.read(r,{type:"binary"});case"buffer":case"array":return et.read(r,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function _h(r,e){if(r.charAt(0)=="/")return r.slice(1);var t=e.split("/");e.slice(-1)!="/"&&t.pop();for(var n=r.split("/");n.length!==0;){var a=n.shift();a===".."?t.pop():a!=="."&&t.push(a)}return t.join("/")}var Vr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,O7=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,wA=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,F7=/<[^>]*>/g,Pn=Vr.match(wA)?wA:F7,M7=/<\w*:/,P7=/<(\/?)\w+:/;function it(r,e,t){for(var n={},a=0,s=0;a!==r.length&&!((s=r.charCodeAt(a))===32||s===10||s===13);++a);if(e||(n[0]=r.slice(0,a)),a===r.length)return n;var l=r.match(O7),u=0,f="",d=0,m="",x="",_=1;if(l)for(d=0;d!=l.length;++d){for(x=l[d],s=0;s!=x.length&&x.charCodeAt(s)!==61;++s);for(m=x.slice(0,s).trim();x.charCodeAt(s+1)==32;)++s;for(_=(a=x.charCodeAt(s+1))==34||a==39?1:0,f=x.slice(s+1+_,x.length-_),u=0;u!=m.length&&m.charCodeAt(u)!==58;++u);if(u===m.length)m.indexOf("_")>0&&(m=m.slice(0,m.indexOf("_"))),n[m]=f,n[m.toLowerCase()]=f;else{var y=(u===5&&m.slice(0,5)==="xmlns"?"xmlns":"")+m.slice(u+1);if(n[y]&&m.slice(u-3,u)=="ext")continue;n[y]=f,n[y.toLowerCase()]=f}}return n}function Yi(r){return r.replace(P7,"<$1")}var SC={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},X_=Yp(SC),Nt=(function(){var r=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function t(n){var a=n+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(r,function(u,f){return SC[u]||String.fromCharCode(parseInt(f,u.indexOf("x")>-1?16:10))||u}).replace(e,function(u,f){return String.fromCharCode(parseInt(f,16))});var l=a.indexOf("]]>");return t(a.slice(0,s))+a.slice(s+9,l)+t(a.slice(l+3))}})(),W_=/[&<>'"]/g,L7=/[\u0000-\u0008\u000b-\u001f]/g;function Qt(r){var e=r+"";return e.replace(W_,function(t){return X_[t]}).replace(L7,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function SA(r){return Qt(r).replace(/ /g,"_x0020_")}var AC=/[\u0000-\u001f]/g;function Y_(r){var e=r+"";return e.replace(W_,function(t){return X_[t]}).replace(/\n/g,"<br/>").replace(AC,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function V7(r){var e=r+"";return e.replace(W_,function(t){return X_[t]}).replace(AC,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}var AA=(function(){var r=/&#(\d+);/g;function e(t,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(r,e)}})();function B7(r){return r.replace(/(\r\n|[\r\n])/g,"&#10;")}function dr(r){switch(r){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function _x(r){for(var e="",t=0,n=0,a=0,s=0,l=0,u=0;t<r.length;){if(n=r.charCodeAt(t++),n<128){e+=String.fromCharCode(n);continue}if(a=r.charCodeAt(t++),n>191&&n<224){l=(n&31)<<6,l|=a&63,e+=String.fromCharCode(l);continue}if(s=r.charCodeAt(t++),n<240){e+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}l=r.charCodeAt(t++),u=((n&7)<<18|(a&63)<<12|(s&63)<<6|l&63)-65536,e+=String.fromCharCode(55296+(u>>>10&1023)),e+=String.fromCharCode(56320+(u&1023))}return e}function bA(r){var e=jo(2*r.length),t,n,a=1,s=0,l=0,u;for(n=0;n<r.length;n+=a)a=1,(u=r.charCodeAt(n))<128?t=u:u<224?(t=(u&31)*64+(r.charCodeAt(n+1)&63),a=2):u<240?(t=(u&15)*4096+(r.charCodeAt(n+1)&63)*64+(r.charCodeAt(n+2)&63),a=3):(a=4,t=(u&7)*262144+(r.charCodeAt(n+1)&63)*4096+(r.charCodeAt(n+2)&63)*64+(r.charCodeAt(n+3)&63),t-=65536,l=55296+(t>>>10&1023),t=56320+(t&1023)),l!==0&&(e[s++]=l&255,e[s++]=l>>>8,l=0),e[s++]=t%256,e[s++]=t>>>8;return e.slice(0,s).toString("ucs2")}function IA(r){return Vs(r,"binary").toString("utf8")}var om="foo bar baz",ir=_t&&(IA(om)==_x(om)&&IA||bA(om)==_x(om)&&bA)||_x,ji=_t?function(r){return Vs(r,"utf8").toString("binary")}:function(r){for(var e=[],t=0,n=0,a=0;t<r.length;)switch(n=r.charCodeAt(t++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=r.charCodeAt(t++)-56320+(n<<10),e.push(String.fromCharCode(240+(a>>18&7))),e.push(String.fromCharCode(144+(a>>12&63))),e.push(String.fromCharCode(128+(a>>6&63))),e.push(String.fromCharCode(128+(a&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},t0=(function(){var r={};return function(t,n){var a=t+"|"+(n||"");return r[a]?r[a]:r[a]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",n||"")}})(),bC=(function(){var r=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<r.length;++a)n=n.replace(r[a][0],r[a][1]);return n}})(),U7=(function(){var r={};return function(t){return r[t]!==void 0?r[t]:r[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}})(),z7=/<\/?(?:vt:)?variant>/g,j7=/<(?:vt:)([^>]*)>([\s\S]*)</;function kA(r,e){var t=it(r),n=r.match(U7(t.baseType))||[],a=[];if(n.length!=t.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+t.size);return a}return n.forEach(function(s){var l=s.replace(z7,"").match(j7);l&&a.push({v:ir(l[2]),t:l[1]})}),a}var IC=/(^\s|\s$|\n)/;function Tn(r,e){return"<"+r+(e.match(IC)?' xml:space="preserve"':"")+">"+e+"</"+r+">"}function r0(r){return Nr(r).map(function(e){return" "+e+'="'+r[e]+'"'}).join("")}function Be(r,e,t){return"<"+r+(t!=null?r0(t):"")+(e!=null?(e.match(IC)?' xml:space="preserve"':"")+">"+e+"</"+r:"/")+">"}function dv(r,e){try{return r.toISOString().replace(/\.\d*/,"")}catch(t){if(e)throw t}return""}function H7(r,e){switch(typeof r){case"string":var t=Be("vt:lpwstr",Qt(r));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return Be((r|0)==r?"vt:i4":"vt:r8",Qt(String(r)));case"boolean":return Be("vt:bool",r?"true":"false")}if(r instanceof Date)return Be("vt:filetime",dv(r));throw new Error("Unable to serialize "+r)}function $_(r){if(_t&&Buffer.isBuffer(r))return r.toString("utf8");if(typeof r=="string")return r;if(typeof Uint8Array<"u"&&r instanceof Uint8Array)return ir(Wo(j_(r)));throw new Error("Bad input format: expected Buffer or string")}var n0=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Qr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},dc=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],_a={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function G7(r,e){for(var t=1-2*(r[e+7]>>>7),n=((r[e+7]&127)<<4)+(r[e+6]>>>4&15),a=r[e+6]&15,s=5;s>=0;--s)a=a*256+r[e+s];return n==2047?a==0?t*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),t*Math.pow(2,n-52)*a)}function q7(r,e,t){var n=(e<0||1/e==-1/0?1:0)<<7,a=0,s=0,l=n?-e:e;isFinite(l)?l==0?a=s=0:(a=Math.floor(Math.log(l)/Math.LN2),s=l*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(e)?26985:0);for(var u=0;u<=5;++u,s/=256)r[t+u]=s&255;r[t+6]=(a&15)<<4|s&15,r[t+7]=a>>4|n}var CA=function(r){for(var e=[],t=10240,n=0;n<r[0].length;++n)if(r[0][n])for(var a=0,s=r[0][n].length;a<s;a+=t)e.push.apply(e,r[0][n].slice(a,a+t));return e},RA=_t?function(r){return r[0].length>0&&Buffer.isBuffer(r[0][0])?Buffer.concat(r[0].map(function(e){return Buffer.isBuffer(e)?e:Vs(e)})):CA(r)}:CA,DA=function(r,e,t){for(var n=[],a=e;a<t;a+=2)n.push(String.fromCharCode(bs(r,a)));return n.join("").replace(Kn,"")},Q_=_t?function(r,e,t){return Buffer.isBuffer(r)?r.toString("utf16le",e,t).replace(Kn,""):DA(r,e,t)}:DA,NA=function(r,e,t){for(var n=[],a=e;a<e+t;++a)n.push(("0"+r[a].toString(16)).slice(-2));return n.join("")},kC=_t?function(r,e,t){return Buffer.isBuffer(r)?r.toString("hex",e,e+t):NA(r,e,t)}:NA,OA=function(r,e,t){for(var n=[],a=e;a<t;a++)n.push(String.fromCharCode(_u(r,a)));return n.join("")},b0=_t?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf8",t,n):OA(e,t,n)}:OA,CC=function(r,e){var t=ya(r,e);return t>0?b0(r,e+4,e+4+t-1):""},RC=CC,DC=function(r,e){var t=ya(r,e);return t>0?b0(r,e+4,e+4+t-1):""},NC=DC,OC=function(r,e){var t=2*ya(r,e);return t>0?b0(r,e+4,e+4+t-1):""},FC=OC,MC=function(e,t){var n=ya(e,t);return n>0?Q_(e,t+4,t+4+n):""},PC=MC,LC=function(r,e){var t=ya(r,e);return t>0?b0(r,e+4,e+4+t):""},VC=LC,BC=function(r,e){return G7(r,e)},dp=BC,J_=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};_t&&(RC=function(e,t){if(!Buffer.isBuffer(e))return CC(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},NC=function(e,t){if(!Buffer.isBuffer(e))return DC(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},FC=function(e,t){if(!Buffer.isBuffer(e))return OC(e,t);var n=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n-1)},PC=function(e,t){if(!Buffer.isBuffer(e))return MC(e,t);var n=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n)},VC=function(e,t){if(!Buffer.isBuffer(e))return LC(e,t);var n=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+n)},dp=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):BC(e,t)},J_=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var _u=function(r,e){return r[e]},bs=function(r,e){return r[e+1]*256+r[e]},K7=function(r,e){var t=r[e+1]*256+r[e];return t<32768?t:(65535-t+1)*-1},ya=function(r,e){return r[e+3]*(1<<24)+(r[e+2]<<16)+(r[e+1]<<8)+r[e]},Dl=function(r,e){return r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e]},X7=function(r,e){return r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]};function Rh(r,e){var t="",n,a,s=[],l,u,f,d;switch(e){case"dbcs":if(d=this.l,_t&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*r).toString("utf16le");else for(f=0;f<r;++f)t+=String.fromCharCode(bs(this,d)),d+=2;r*=2;break;case"utf8":t=b0(this,this.l,this.l+r);break;case"utf16le":r*=2,t=Q_(this,this.l,this.l+r);break;case"wstr":return Rh.call(this,r,"dbcs");case"lpstr-ansi":t=RC(this,this.l),r=4+ya(this,this.l);break;case"lpstr-cp":t=NC(this,this.l),r=4+ya(this,this.l);break;case"lpwstr":t=FC(this,this.l),r=4+2*ya(this,this.l);break;case"lpp4":r=4+ya(this,this.l),t=PC(this,this.l),r&2&&(r+=2);break;case"8lpp4":r=4+ya(this,this.l),t=VC(this,this.l),r&3&&(r+=4-(r&3));break;case"cstr":for(r=0,t="";(l=_u(this,this.l+r++))!==0;)s.push(sm(l));t=s.join("");break;case"_wstr":for(r=0,t="";(l=bs(this,this.l+r))!==0;)s.push(sm(l)),r+=2;r+=2,t=s.join("");break;case"dbcs-cont":for(t="",d=this.l,f=0;f<r;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return l=_u(this,d),this.l=d+1,u=Rh.call(this,r-f,l?"dbcs-cont":"sbcs-cont"),s.join("")+u;s.push(sm(bs(this,d))),d+=2}t=s.join(""),r*=2;break;case"cpstr":case"sbcs-cont":for(t="",d=this.l,f=0;f!=r;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return l=_u(this,d),this.l=d+1,u=Rh.call(this,r-f,l?"dbcs-cont":"sbcs-cont"),s.join("")+u;s.push(sm(_u(this,d))),d+=1}t=s.join("");break;default:switch(r){case 1:return n=_u(this,this.l),this.l++,n;case 2:return n=(e==="i"?K7:bs)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(n=(r>0?Dl:X7)(this,this.l),this.l+=4,n):(a=ya(this,this.l),this.l+=4,a);case 8:case-8:if(e==="f")return r==8?a=dp(this,this.l):a=dp([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;r=8;case 16:t=kC(this,this.l,r);break}}return this.l+=r,t}var W7=function(r,e,t){r[t]=e&255,r[t+1]=e>>>8&255,r[t+2]=e>>>16&255,r[t+3]=e>>>24&255},Y7=function(r,e,t){r[t]=e&255,r[t+1]=e>>8&255,r[t+2]=e>>16&255,r[t+3]=e>>24&255},$7=function(r,e,t){r[t]=e&255,r[t+1]=e>>>8&255};function Q7(r,e,t){var n=0,a=0;if(t==="dbcs"){for(a=0;a!=e.length;++a)$7(this,e.charCodeAt(a),this.l+2*a);n=2*e.length}else if(t==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=e.length;++a)this[this.l+a]=e.charCodeAt(a)&255;n=e.length}else if(t==="hex"){for(;a<r;++a)this[this.l++]=parseInt(e.slice(2*a,2*a+2),16)||0;return this}else if(t==="utf16le"){var s=Math.min(this.l+r,this.length);for(a=0;a<Math.min(e.length,r);++a){var l=e.charCodeAt(a);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(r){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,W7(this,e,this.l);break;case 8:if(n=8,t==="f"){q7(this,e,this.l);break}case 16:break;case-4:n=4,Y7(this,e,this.l);break}return this.l+=n,this}function UC(r,e){var t=kC(this,this.l,r.length>>1);if(t!==r)throw new Error(e+"Expected "+r+" saw "+t);this.l+=r.length>>1}function yn(r,e){r.l=e,r.read_shift=Rh,r.chk=UC,r.write_shift=Q7}function Mn(r,e){r.l+=e}function ye(r){var e=jo(r);return yn(e,0),e}function Bs(r,e,t){if(r){var n,a,s;yn(r,r.l||0);for(var l=r.length,u=0,f=0;r.l<l;){u=r.read_shift(1),u&128&&(u=(u&127)+((r.read_shift(1)&127)<<7));var d=c0[u]||c0[65535];for(n=r.read_shift(1),s=n&127,a=1;a<4&&n&128;++a)s+=((n=r.read_shift(1))&127)<<7*a;f=r.l+s;var m=d.f&&d.f(r,s,t);if(r.l=f,e(m,d,u))return}}}function aa(){var r=[],e=_t?256:2048,t=function(d){var m=ye(d);return yn(m,0),m},n=t(e),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&r.push(n),n=null)},s=function(d){return n&&d<n.length-n.l?n:(a(),n=t(Math.max(d+1,e)))},l=function(){return a(),ln(r)},u=function(d){a(),n=d,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:u,end:l,_bufs:r}}function Ce(r,e,t,n){var a=+e,s;if(!isNaN(a)){n||(n=c0[a].p||(t||[]).length||0),s=1+(a>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var l=r.next(s);a<=127?l.write_shift(1,a):(l.write_shift(1,(a&127)+128),l.write_shift(1,a>>7));for(var u=0;u!=4;++u)if(n>=128)l.write_shift(1,(n&127)+128),n>>=7;else{l.write_shift(1,n);break}n>0&&J_(t)&&r.push(t)}}function Dh(r,e,t){var n=pr(r);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!t||t.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function FA(r,e,t){var n=pr(r);return n.s=Dh(n.s,e.s,t),n.e=Dh(n.e,e.s,t),n}function Nh(r,e){if(r.cRel&&r.c<0)for(r=pr(r);r.c<0;)r.c+=e>8?16384:256;if(r.rRel&&r.r<0)for(r=pr(r);r.r<0;)r.r+=e>8?1048576:e>5?65536:16384;var t=at(r);return!r.cRel&&r.cRel!=null&&(t=eV(t)),!r.rRel&&r.rRel!=null&&(t=J7(t)),t}function yx(r,e){return r.s.r==0&&!r.s.rRel&&r.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!r.e.rRel?(r.s.cRel?"":"$")+wr(r.s.c)+":"+(r.e.cRel?"":"$")+wr(r.e.c):r.s.c==0&&!r.s.cRel&&r.e.c==(e.biff>=12?16383:255)&&!r.e.cRel?(r.s.rRel?"":"$")+Lr(r.s.r)+":"+(r.e.rRel?"":"$")+Lr(r.e.r):Nh(r.s,e.biff)+":"+Nh(r.e,e.biff)}function Z_(r){return parseInt(Z7(r),10)-1}function Lr(r){return""+(r+1)}function J7(r){return r.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Z7(r){return r.replace(/\$(\d+)$/,"$1")}function ey(r){for(var e=tV(r),t=0,n=0;n!==e.length;++n)t=26*t+e.charCodeAt(n)-64;return t-1}function wr(r){if(r<0)throw new Error("invalid column "+r);var e="";for(++r;r;r=Math.floor((r-1)/26))e=String.fromCharCode((r-1)%26+65)+e;return e}function eV(r){return r.replace(/^([A-Z])/,"$$$1")}function tV(r){return r.replace(/^\$([A-Z])/,"$1")}function rV(r){return r.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Sr(r){for(var e=0,t=0,n=0;n<r.length;++n){var a=r.charCodeAt(n);a>=48&&a<=57?e=10*e+(a-48):a>=65&&a<=90&&(t=26*t+(a-64))}return{c:t-1,r:e-1}}function at(r){for(var e=r.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(r.r+1)}function ia(r){var e=r.indexOf(":");return e==-1?{s:Sr(r),e:Sr(r)}:{s:Sr(r.slice(0,e)),e:Sr(r.slice(e+1))}}function gt(r,e){return typeof e>"u"||typeof e=="number"?gt(r.s,r.e):(typeof r!="string"&&(r=at(r)),typeof e!="string"&&(e=at(e)),r==e?r:r+":"+e)}function Ot(r){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,n=0,a=0,s=r.length;for(t=0;n<s&&!((a=r.charCodeAt(n)-64)<1||a>26);++n)t=26*t+a;for(e.s.c=--t,t=0;n<s&&!((a=r.charCodeAt(n)-48)<0||a>9);++n)t=10*t+a;if(e.s.r=--t,n===s||a!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,t=0;n!=s&&!((a=r.charCodeAt(n)-64)<1||a>26);++n)t=26*t+a;for(e.e.c=--t,t=0;n!=s&&!((a=r.charCodeAt(n)-48)<0||a>9);++n)t=10*t+a;return e.e.r=--t,e}function MA(r,e){var t=r.t=="d"&&e instanceof Date;if(r.z!=null)try{return r.w=ei(r.z,t?en(e):e)}catch{}try{return r.w=ei((r.XF||{}).numFmtId||(t?14:0),t?en(e):e)}catch{return""+e}}function Ps(r,e,t){return r==null||r.t==null||r.t=="z"?"":r.w!==void 0?r.w:(r.t=="d"&&!r.z&&t&&t.dateNF&&(r.z=t.dateNF),r.t=="e"?Us[r.v]||r.v:e==null?MA(r,r.v):MA(r,e))}function Yo(r,e){var t=e&&e.sheet?e.sheet:"Sheet1",n={};return n[t]=r,{SheetNames:[t],Sheets:n}}function zC(r,e,t){var n=t||{},a=r?Array.isArray(r):n.dense,s=r||(a?[]:{}),l=0,u=0;if(s&&n.origin!=null){if(typeof n.origin=="number")l=n.origin;else{var f=typeof n.origin=="string"?Sr(n.origin):n.origin;l=f.r,u=f.c}s["!ref"]||(s["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var m=Ot(s["!ref"]);d.s.c=m.s.c,d.s.r=m.s.r,d.e.c=Math.max(d.e.c,m.e.c),d.e.r=Math.max(d.e.r,m.e.r),l==-1&&(d.e.r=l=m.e.r+1)}for(var x=0;x!=e.length;++x)if(e[x]){if(!Array.isArray(e[x]))throw new Error("aoa_to_sheet expects an array of arrays");for(var _=0;_!=e[x].length;++_)if(!(typeof e[x][_]>"u")){var y={v:e[x][_]},w=l+x,T=u+_;if(d.s.r>w&&(d.s.r=w),d.s.c>T&&(d.s.c=T),d.e.r<w&&(d.e.r=w),d.e.c<T&&(d.e.c=T),e[x][_]&&typeof e[x][_]=="object"&&!Array.isArray(e[x][_])&&!(e[x][_]instanceof Date))y=e[x][_];else if(Array.isArray(y.v)&&(y.f=e[x][_][1],y.v=y.v[0]),y.v===null)if(y.f)y.t="n";else if(n.nullError)y.t="e",y.v=0;else if(n.sheetStubs)y.t="z";else continue;else typeof y.v=="number"?y.t="n":typeof y.v=="boolean"?y.t="b":y.v instanceof Date?(y.z=n.dateNF||nt[14],n.cellDates?(y.t="d",y.w=ei(y.z,en(y.v))):(y.t="n",y.v=en(y.v),y.w=ei(y.z,y.v))):y.t="s";if(a)s[w]||(s[w]=[]),s[w][T]&&s[w][T].z&&(y.z=s[w][T].z),s[w][T]=y;else{var S=at({c:T,r:w});s[S]&&s[S].z&&(y.z=s[S].z),s[S]=y}}}return d.s.c<1e7&&(s["!ref"]=gt(d)),s}function of(r,e){return zC(null,r,e)}function nV(r){return r.read_shift(4,"i")}function Ei(r,e){return e||(e=ye(4)),e.write_shift(4,r),e}function On(r){var e=r.read_shift(4);return e===0?"":r.read_shift(e,"dbcs")}function cn(r,e){var t=!1;return e==null&&(t=!0,e=ye(4+2*r.length)),e.write_shift(4,r.length),r.length>0&&e.write_shift(0,r,"dbcs"),t?e.slice(0,e.l):e}function aV(r){return{ich:r.read_shift(2),ifnt:r.read_shift(2)}}function iV(r,e){return e||(e=ye(4)),e.write_shift(2,0),e.write_shift(2,0),e}function ty(r,e){var t=r.l,n=r.read_shift(1),a=On(r),s=[],l={t:a,h:a};if((n&1)!==0){for(var u=r.read_shift(4),f=0;f!=u;++f)s.push(aV(r));l.r=s}else l.r=[{ich:0,ifnt:0}];return r.l=t+e,l}function sV(r,e){var t=!1;return e==null&&(t=!0,e=ye(15+4*r.t.length)),e.write_shift(1,0),cn(r.t,e),t?e.slice(0,e.l):e}var oV=ty;function lV(r,e){var t=!1;return e==null&&(t=!0,e=ye(23+4*r.t.length)),e.write_shift(1,1),cn(r.t,e),e.write_shift(4,1),iV({},e),t?e.slice(0,e.l):e}function ti(r){var e=r.read_shift(4),t=r.read_shift(2);return t+=r.read_shift(1)<<16,r.l++,{c:e,iStyleRef:t}}function mc(r,e){return e==null&&(e=ye(8)),e.write_shift(-4,r.c),e.write_shift(3,r.iStyleRef||r.s),e.write_shift(1,0),e}function pc(r){var e=r.read_shift(2);return e+=r.read_shift(1)<<16,r.l++,{c:-1,iStyleRef:e}}function gc(r,e){return e==null&&(e=ye(4)),e.write_shift(3,r.iStyleRef||r.s),e.write_shift(1,0),e}var cV=On,jC=cn;function ry(r){var e=r.read_shift(4);return e===0||e===4294967295?"":r.read_shift(e,"dbcs")}function mp(r,e){var t=!1;return e==null&&(t=!0,e=ye(127)),e.write_shift(4,r.length>0?r.length:4294967295),r.length>0&&e.write_shift(0,r,"dbcs"),t?e.slice(0,e.l):e}var uV=On,mv=ry,ny=mp;function ay(r){var e=r.slice(r.l,r.l+4),t=e[0]&1,n=e[0]&2;r.l+=4;var a=n===0?dp([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Dl(e,0)>>2;return t?a/100:a}function HC(r,e){e==null&&(e=ye(4));var t=0,n=0,a=r*100;if(r==(r|0)&&r>=-536870912&&r<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,t=1),n)e.write_shift(-4,((t?a:r)<<2)+(t+2));else throw new Error("unsupported RkNumber "+r)}function GC(r){var e={s:{},e:{}};return e.s.r=r.read_shift(4),e.e.r=r.read_shift(4),e.s.c=r.read_shift(4),e.e.c=r.read_shift(4),e}function fV(r,e){return e||(e=ye(16)),e.write_shift(4,r.s.r),e.write_shift(4,r.e.r),e.write_shift(4,r.s.c),e.write_shift(4,r.e.c),e}var xc=GC,lf=fV;function Dn(r){if(r.length-r.l<8)throw"XLS Xnum Buffer underflow";return r.read_shift(8,"f")}function ac(r,e){return(e||ye(8)).write_shift(8,r,"f")}function hV(r){var e={},t=r.read_shift(1),n=t>>>1,a=r.read_shift(1),s=r.read_shift(2,"i"),l=r.read_shift(1),u=r.read_shift(1),f=r.read_shift(1);switch(r.l++,n){case 0:e.auto=1;break;case 1:e.index=a;var d=zl[a];d&&(e.rgb=i0(d));break;case 2:e.rgb=i0([l,u,f]);break;case 3:e.theme=a;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function pp(r,e){if(e||(e=ye(8)),!r||r.auto)return e.write_shift(4,0),e.write_shift(4,0),e;r.index!=null?(e.write_shift(1,2),e.write_shift(1,r.index)):r.theme!=null?(e.write_shift(1,6),e.write_shift(1,r.theme)):(e.write_shift(1,5),e.write_shift(1,0));var t=r.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),e.write_shift(2,t),!r.rgb||r.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=r.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function dV(r){var e=r.read_shift(1);r.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function mV(r,e){e||(e=ye(2));var t=(r.italic?2:0)|(r.strike?8:0)|(r.outline?16:0)|(r.shadow?32:0)|(r.condense?64:0)|(r.extend?128:0);return e.write_shift(1,t),e.write_shift(1,0),e}function qC(r,e){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=r.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return t[r.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return r.l-=4,r.read_shift(0,e==1?"lpstr":"lpwstr")}function pV(r){return qC(r,1)}function gV(r){return qC(r,2)}var iy=2,ra=3,lm=11,PA=12,gp=19,cm=64,xV=65,vV=71,_V=4108,yV=4126,on=80,KC=81,TV=[on,KC],pv={1:{n:"CodePage",t:iy},2:{n:"Category",t:on},3:{n:"PresentationFormat",t:on},4:{n:"ByteCount",t:ra},5:{n:"LineCount",t:ra},6:{n:"ParagraphCount",t:ra},7:{n:"SlideCount",t:ra},8:{n:"NoteCount",t:ra},9:{n:"HiddenCount",t:ra},10:{n:"MultimediaClipCount",t:ra},11:{n:"ScaleCrop",t:lm},12:{n:"HeadingPairs",t:_V},13:{n:"TitlesOfParts",t:yV},14:{n:"Manager",t:on},15:{n:"Company",t:on},16:{n:"LinksUpToDate",t:lm},17:{n:"CharacterCount",t:ra},19:{n:"SharedDoc",t:lm},22:{n:"HyperlinksChanged",t:lm},23:{n:"AppVersion",t:ra,p:"version"},24:{n:"DigSig",t:xV},26:{n:"ContentType",t:on},27:{n:"ContentStatus",t:on},28:{n:"Language",t:on},29:{n:"Version",t:on},255:{},2147483648:{n:"Locale",t:gp},2147483651:{n:"Behavior",t:gp},1919054434:{}},gv={1:{n:"CodePage",t:iy},2:{n:"Title",t:on},3:{n:"Subject",t:on},4:{n:"Author",t:on},5:{n:"Keywords",t:on},6:{n:"Comments",t:on},7:{n:"Template",t:on},8:{n:"LastAuthor",t:on},9:{n:"RevNumber",t:on},10:{n:"EditTime",t:cm},11:{n:"LastPrinted",t:cm},12:{n:"CreatedDate",t:cm},13:{n:"ModifiedDate",t:cm},14:{n:"PageCount",t:ra},15:{n:"WordCount",t:ra},16:{n:"CharCount",t:ra},17:{n:"Thumbnail",t:vV},18:{n:"Application",t:on},19:{n:"DocSecurity",t:ra},255:{},2147483648:{n:"Locale",t:gp},2147483651:{n:"Behavior",t:gp},1919054434:{}},LA={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},EV=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function wV(r){return r.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var SV=wV([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),zl=pr(SV),Us={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},XC={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},xv={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},um={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function sy(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function AV(r){var e=sy();if(!r||!r.match)return e;var t={};if((r.match(Pn)||[]).forEach(function(n){var a=it(n);switch(a[0].replace(M7,"<")){case"<?xml":break;case"<Types":e.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[a.Extension]=a.ContentType;break;case"<Override":e[xv[a.ContentType]]!==void 0&&e[xv[a.ContentType]].push(a.PartName);break}}),e.xmlns!==Qr.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=t,delete e.calcchains,e}function WC(r,e){var t=A7(xv),n=[],a;n[n.length]=Vr,n[n.length]=Be("Types",null,{xmlns:Qr.CT,"xmlns:xsd":Qr.xsd,"xmlns:xsi":Qr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(f){return Be("Default",null,{Extension:f[0],ContentType:f[1]})}));var s=function(f){r[f]&&r[f].length>0&&(a=r[f][0],n[n.length]=Be("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:um[f][e.bookType]||um[f].xlsx}))},l=function(f){(r[f]||[]).forEach(function(d){n[n.length]=Be("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:um[f][e.bookType]||um[f].xlsx})})},u=function(f){(r[f]||[]).forEach(function(d){n[n.length]=Be("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:t[f][0]})})};return s("workbooks"),l("sheets"),l("charts"),u("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),l("metadata"),u("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Tt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function a0(r){var e=r.lastIndexOf("/");return r.slice(0,e+1)+"_rels/"+r.slice(e+1)+".rels"}function Oh(r,e){var t={"!id":{}};if(!r)return t;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(r.match(Pn)||[]).forEach(function(a){var s=it(a);if(s[0]==="<Relationship"){var l={};l.Type=s.Type,l.Target=s.Target,l.Id=s.Id,s.TargetMode&&(l.TargetMode=s.TargetMode);var u=s.TargetMode==="External"?s.Target:_h(s.Target,e);t[u]=l,n[s.Id]=l}}),t["!id"]=n,t}function Cu(r){var e=[Vr,Be("Relationships",null,{xmlns:Qr.RELS})];return Nr(r["!id"]).forEach(function(t){e[e.length]=Be("Relationship",null,r["!id"][t])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Yt(r,e,t,n,a,s){if(a||(a={}),r["!id"]||(r["!id"]={}),r["!idx"]||(r["!idx"]=1),e<0)for(e=r["!idx"];r["!id"]["rId"+e];++e);if(r["!idx"]=e+1,a.Id="rId"+e,a.Type=n,a.Target=t,[Tt.HLINK,Tt.XPATH,Tt.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),r["!id"][a.Id])throw new Error("Cannot rewrite rId "+e);return r["!id"][a.Id]=a,r[("/"+a.Target).replace("//","/")]=a,e}var bV="application/vnd.oasis.opendocument.spreadsheet";function IV(r,e){for(var t=$_(r),n,a;n=n0.exec(t);)switch(n[3]){case"manifest":break;case"file-entry":if(a=it(n[0],!1),a.path=="/"&&a.type!==bV)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function kV(r){var e=[Vr];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<r.length;++t)e.push('  <manifest:file-entry manifest:full-path="'+r[t][0]+'" manifest:media-type="'+r[t][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function VA(r,e,t){return['  <rdf:Description rdf:about="'+r+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function CV(r,e){return['  <rdf:Description rdf:about="'+r+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function RV(r){var e=[Vr];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=r.length;++t)e.push(VA(r[t][0],r[t][1])),e.push(CV("",r[t][0]));return e.push(VA("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function YC(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+lp.version+"</meta:generator></office:meta></office:document-meta>"}var Za=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],DV=(function(){for(var r=new Array(Za.length),e=0;e<Za.length;++e){var t=Za[e],n="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);r[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return r})();function $C(r){var e={};r=ir(r);for(var t=0;t<Za.length;++t){var n=Za[t],a=r.match(DV[t]);a!=null&&a.length>0&&(e[n[1]]=Nt(a[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=mr(e[n[1]]))}return e}function Tx(r,e,t,n,a){a[r]!=null||e==null||e===""||(a[r]=e,e=Qt(e),n[n.length]=t?Be(r,e,t):Tn(r,e))}function QC(r,e){var t=e||{},n=[Vr,Be("cp:coreProperties",null,{"xmlns:cp":Qr.CORE_PROPS,"xmlns:dc":Qr.dc,"xmlns:dcterms":Qr.dcterms,"xmlns:dcmitype":Qr.dcmitype,"xmlns:xsi":Qr.xsi})],a={};if(!r&&!t.Props)return n.join("");r&&(r.CreatedDate!=null&&Tx("dcterms:created",typeof r.CreatedDate=="string"?r.CreatedDate:dv(r.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),r.ModifiedDate!=null&&Tx("dcterms:modified",typeof r.ModifiedDate=="string"?r.ModifiedDate:dv(r.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var s=0;s!=Za.length;++s){var l=Za[s],u=t.Props&&t.Props[l[1]]!=null?t.Props[l[1]]:r?r[l[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&Tx(l[0],u,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var jl=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],JC=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function ZC(r,e,t,n){var a=[];if(typeof r=="string")a=kA(r,n);else for(var s=0;s<r.length;++s)a=a.concat(r[s].map(function(m){return{v:m}}));var l=typeof e=="string"?kA(e,n).map(function(m){return m.v}):e,u=0,f=0;if(l.length>0)for(var d=0;d!==a.length;d+=2){switch(f=+a[d+1].v,a[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":t.Worksheets=f,t.SheetNames=l.slice(u,u+f);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":t.NamedRanges=f,t.DefinedNames=l.slice(u,u+f);break;case"Charts":case"Diagramme":t.Chartsheets=f,t.ChartNames=l.slice(u,u+f);break}u+=f}}function NV(r,e,t){var n={};return e||(e={}),r=ir(r),jl.forEach(function(a){var s=(r.match(t0(a[0]))||[])[1];switch(a[2]){case"string":s&&(e[a[1]]=Nt(s));break;case"bool":e[a[1]]=s==="true";break;case"raw":var l=r.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));l&&l.length>0&&(n[a[1]]=l[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&ZC(n.HeadingPairs,n.TitlesOfParts,e,t),e}function e3(r){var e=[],t=Be;return r||(r={}),r.Application="SheetJS",e[e.length]=Vr,e[e.length]=Be("Properties",null,{xmlns:Qr.EXT_PROPS,"xmlns:vt":Qr.vt}),jl.forEach(function(n){if(r[n[1]]!==void 0){var a;switch(n[2]){case"string":a=Qt(String(r[n[1]]));break;case"bool":a=r[n[1]]?"true":"false";break}a!==void 0&&(e[e.length]=t(n[0],a))}}),e[e.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(r.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=t("TitlesOfParts",t("vt:vector",r.SheetNames.map(function(n){return"<vt:lpstr>"+Qt(n)+"</vt:lpstr>"}).join(""),{size:r.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var OV=/<[^>]+>[^<]*/g;function FV(r,e){var t={},n="",a=r.match(OV);if(a)for(var s=0;s!=a.length;++s){var l=a[s],u=it(l);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Nt(u.name);break;case"</property>":n=null;break;default:if(l.indexOf("<vt:")===0){var f=l.split(">"),d=f[0].slice(4),m=f[1];switch(d){case"lpstr":case"bstr":case"lpwstr":t[n]=Nt(m);break;case"bool":t[n]=dr(m);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[n]=parseInt(m,10);break;case"r4":case"r8":case"decimal":t[n]=parseFloat(m);break;case"filetime":case"date":t[n]=mr(m);break;case"cy":case"error":t[n]=Nt(m);break;default:if(d.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",l,d,f)}}else if(l.slice(0,2)!=="</"){if(e.WTF)throw new Error(l)}}}return t}function t3(r){var e=[Vr,Be("Properties",null,{xmlns:Qr.CUST_PROPS,"xmlns:vt":Qr.vt})];if(!r)return e.join("");var t=1;return Nr(r).forEach(function(a){++t,e[e.length]=Be("property",H7(r[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:Qt(a)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var vv={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Ex;function MV(r,e,t){Ex||(Ex=Yp(vv)),e=Ex[e]||e,r[e]=t}function PV(r,e){var t=[];return Nr(vv).map(function(n){for(var a=0;a<Za.length;++a)if(Za[a][1]==n)return Za[a];for(a=0;a<jl.length;++a)if(jl[a][1]==n)return jl[a];throw n}).forEach(function(n){if(r[n[1]]!=null){var a=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:r[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),t.push(Tn(vv[n[1]]||n[1],a))}}),Be("DocumentProperties",t.join(""),{xmlns:_a.o})}function LV(r,e){var t=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return r&&Nr(r).forEach(function(s){if(Object.prototype.hasOwnProperty.call(r,s)){for(var l=0;l<Za.length;++l)if(s==Za[l][1])return;for(l=0;l<jl.length;++l)if(s==jl[l][1])return;for(l=0;l<t.length;++l)if(s==t[l])return;var u=r[s],f="string";typeof u=="number"?(f="float",u=String(u)):u===!0||u===!1?(f="boolean",u=u?"1":"0"):u=String(u),a.push(Be(SA(s),u,{"dt:dt":f}))}}),e&&Nr(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(r&&Object.prototype.hasOwnProperty.call(r,s))){var l=e[s],u="string";typeof l=="number"?(u="float",l=String(l)):l===!0||l===!1?(u="boolean",l=l?"1":"0"):l instanceof Date?(u="dateTime.tz",l=l.toISOString()):l=String(l),a.push(Be(SA(s),l,{"dt:dt":u}))}}),"<"+n+' xmlns="'+_a.o+'">'+a.join("")+"</"+n+">"}function oy(r){var e=r.read_shift(4),t=r.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function VV(r){var e=typeof r=="string"?new Date(Date.parse(r)):r,t=e.getTime()/1e3+11644473600,n=t%Math.pow(2,32),a=(t-n)/Math.pow(2,32);n*=1e7,a*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),a+=s);var l=ye(8);return l.write_shift(4,n),l.write_shift(4,a),l}function r3(r,e,t){var n=r.l,a=r.read_shift(0,"lpstr-cp");if(t)for(;r.l-n&3;)++r.l;return a}function n3(r,e,t){var n=r.read_shift(0,"lpwstr");return n}function a3(r,e,t){return e===31?n3(r):r3(r,e,t)}function _v(r,e,t){return a3(r,e,t===!1?0:4)}function BV(r,e){if(!e)throw new Error("VtUnalignedString must have positive length");return a3(r,e,0)}function UV(r){for(var e=r.read_shift(4),t=[],n=0;n!=e;++n){var a=r.l;t[n]=r.read_shift(0,"lpwstr").replace(Kn,""),r.l-a&2&&(r.l+=2)}return t}function zV(r){for(var e=r.read_shift(4),t=[],n=0;n!=e;++n)t[n]=r.read_shift(0,"lpstr-cp").replace(Kn,"");return t}function jV(r){var e=r.l,t=xp(r,KC);r[r.l]==0&&r[r.l+1]==0&&r.l-e&2&&(r.l+=2);var n=xp(r,ra);return[t,n]}function HV(r){for(var e=r.read_shift(4),t=[],n=0;n<e/2;++n)t.push(jV(r));return t}function BA(r,e){for(var t=r.read_shift(4),n={},a=0;a!=t;++a){var s=r.read_shift(4),l=r.read_shift(4);n[s]=r.read_shift(l,e===1200?"utf16le":"utf8").replace(Kn,"").replace(vh,"!"),e===1200&&l%2&&(r.l+=2)}return r.l&3&&(r.l=r.l>>3<<2),n}function i3(r){var e=r.read_shift(4),t=r.slice(r.l,r.l+e);return r.l+=e,(e&3)>0&&(r.l+=4-(e&3)&3),t}function GV(r){var e={};return e.Size=r.read_shift(4),r.l+=e.Size+3-(e.Size-1)%4,e}function xp(r,e,t){var n=r.read_shift(2),a,s=t||{};if(r.l+=2,e!==PA&&n!==e&&TV.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===PA?n:e){case 2:return a=r.read_shift(2,"i"),s.raw||(r.l+=2),a;case 3:return a=r.read_shift(4,"i"),a;case 11:return r.read_shift(4)!==0;case 19:return a=r.read_shift(4),a;case 30:return r3(r,n,4).replace(Kn,"");case 31:return n3(r);case 64:return oy(r);case 65:return i3(r);case 71:return GV(r);case 80:return _v(r,n,!s.raw).replace(Kn,"");case 81:return BV(r,n).replace(Kn,"");case 4108:return HV(r);case 4126:case 4127:return n==4127?UV(r):zV(r);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function UA(r,e){var t=ye(4),n=ye(4);switch(t.write_shift(4,r==80?31:r),r){case 3:n.write_shift(-4,e);break;case 5:n=ye(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=VV(e);break;case 31:case 80:for(n=ye(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+e)}return ln([t,n])}function zA(r,e){var t=r.l,n=r.read_shift(4),a=r.read_shift(4),s=[],l=0,u=0,f=-1,d={};for(l=0;l!=a;++l){var m=r.read_shift(4),x=r.read_shift(4);s[l]=[m,x+t]}s.sort(function(U,R){return U[1]-R[1]});var _={};for(l=0;l!=a;++l){if(r.l!==s[l][1]){var y=!0;if(l>0&&e)switch(e[s[l-1][0]].t){case 2:r.l+2===s[l][1]&&(r.l+=2,y=!1);break;case 80:r.l<=s[l][1]&&(r.l=s[l][1],y=!1);break;case 4108:r.l<=s[l][1]&&(r.l=s[l][1],y=!1);break}if((!e||l==0)&&r.l<=s[l][1]&&(y=!1,r.l=s[l][1]),y)throw new Error("Read Error: Expected address "+s[l][1]+" at "+r.l+" :"+l)}if(e){var w=e[s[l][0]];if(_[w.n]=xp(r,w.t,{raw:!0}),w.p==="version"&&(_[w.n]=String(_[w.n]>>16)+"."+("0000"+String(_[w.n]&65535)).slice(-4)),w.n=="CodePage")switch(_[w.n]){case 0:_[w.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:vi(u=_[w.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+_[w.n])}}else if(s[l][0]===1){if(u=_.CodePage=xp(r,iy),vi(u),f!==-1){var T=r.l;r.l=s[f][1],d=BA(r,u),r.l=T}}else if(s[l][0]===0){if(u===0){f=l,r.l=s[l+1][1];continue}d=BA(r,u)}else{var S=d[s[l][0]],O;switch(r[r.l]){case 65:r.l+=4,O=i3(r);break;case 30:r.l+=4,O=_v(r,r[r.l-4]).replace(/\u0000+$/,"");break;case 31:r.l+=4,O=_v(r,r[r.l-4]).replace(/\u0000+$/,"");break;case 3:r.l+=4,O=r.read_shift(4,"i");break;case 19:r.l+=4,O=r.read_shift(4);break;case 5:r.l+=4,O=r.read_shift(8,"f");break;case 11:r.l+=4,O=Pr(r,4);break;case 64:r.l+=4,O=mr(oy(r));break;default:throw new Error("unparsed value: "+r[r.l])}_[S]=O}}return r.l=t+n,_}var s3=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function qV(r){switch(typeof r){case"boolean":return 11;case"number":return(r|0)==r?3:5;case"string":return 31;case"object":if(r instanceof Date)return 64;break}return-1}function jA(r,e,t){var n=ye(8),a=[],s=[],l=8,u=0,f=ye(8),d=ye(8);if(f.write_shift(4,2),f.write_shift(4,1200),d.write_shift(4,1),s.push(f),a.push(d),l+=8+f.length,!e){d=ye(8),d.write_shift(4,0),a.unshift(d);var m=[ye(4)];for(m[0].write_shift(4,r.length),u=0;u<r.length;++u){var x=r[u][0];for(f=ye(8+2*(x.length+1)+(x.length%2?0:2)),f.write_shift(4,u+2),f.write_shift(4,x.length+1),f.write_shift(0,x,"dbcs");f.l!=f.length;)f.write_shift(1,0);m.push(f)}f=ln(m),s.unshift(f),l+=8+f.length}for(u=0;u<r.length;++u)if(!(e&&!e[r[u][0]])&&!(s3.indexOf(r[u][0])>-1||JC.indexOf(r[u][0])>-1)&&r[u][1]!=null){var _=r[u][1],y=0;if(e){y=+e[r[u][0]];var w=t[y];if(w.p=="version"&&typeof _=="string"){var T=_.split(".");_=(+T[0]<<16)+(+T[1]||0)}f=UA(w.t,_)}else{var S=qV(_);S==-1&&(S=31,_=String(_)),f=UA(S,_)}s.push(f),d=ye(8),d.write_shift(4,e?y:2+u),a.push(d),l+=8+f.length}var O=8*(s.length+1);for(u=0;u<s.length;++u)a[u].write_shift(4,O),O+=s[u].length;return n.write_shift(4,l),n.write_shift(4,s.length),ln([n].concat(a).concat(s))}function HA(r,e,t){var n=r.content;if(!n)return{};yn(n,0);var a,s,l,u,f=0;n.chk("feff","Byte Order: "),n.read_shift(2);var d=n.read_shift(4),m=n.read_shift(16);if(m!==et.utils.consts.HEADER_CLSID&&m!==t)throw new Error("Bad PropertySet CLSID "+m);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),u=n.read_shift(4),a===1&&u!==n.l)throw new Error("Length mismatch: "+u+" !== "+n.l);a===2&&(l=n.read_shift(16),f=n.read_shift(4));var x=zA(n,e),_={SystemIdentifier:d};for(var y in x)_[y]=x[y];if(_.FMTID=s,a===1)return _;if(f-n.l==2&&(n.l+=2),n.l!==f)throw new Error("Length mismatch 2: "+n.l+" !== "+f);var w;try{w=zA(n,null)}catch{}for(y in w)_[y]=w[y];return _.FMTID=[s,l],_}function GA(r,e,t,n,a,s){var l=ye(a?68:48),u=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,et.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,a?2:1),l.write_shift(16,e,"hex"),l.write_shift(4,a?68:48);var f=jA(r,t,n);if(u.push(f),a){var d=jA(a,null,null);l.write_shift(16,s,"hex"),l.write_shift(4,68+f.length),u.push(d)}return ln(u)}function Ao(r,e){return r.read_shift(e),null}function KV(r,e){e||(e=ye(r));for(var t=0;t<r;++t)e.write_shift(1,0);return e}function XV(r,e,t){for(var n=[],a=r.l+e;r.l<a;)n.push(t(r,a-r.l));if(a!==r.l)throw new Error("Slurp error");return n}function Pr(r,e){return r.read_shift(e)===1}function jn(r,e){return e||(e=ye(2)),e.write_shift(2,+!!r),e}function Xr(r){return r.read_shift(2,"u")}function Xa(r,e){return e||(e=ye(2)),e.write_shift(2,r),e}function o3(r,e){return XV(r,e,Xr)}function WV(r){var e=r.read_shift(1),t=r.read_shift(1);return t===1?e:e===1}function l3(r,e,t){return t||(t=ye(2)),t.write_shift(1,e=="e"?+r:+!!r),t.write_shift(1,e=="e"?1:0),t}function I0(r,e,t){var n=r.read_shift(t&&t.biff>=12?2:1),a="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var s=r.read_shift(1);s&&(a="dbcs-cont")}else t.biff==12&&(a="wstr");t.biff>=2&&t.biff<=5&&(a="cpstr");var l=n?r.read_shift(n,a):"";return l}function YV(r){var e=r.read_shift(2),t=r.read_shift(1),n=t&4,a=t&8,s=1+(t&1),l=0,u,f={};a&&(l=r.read_shift(2)),n&&(u=r.read_shift(4));var d=s==2?"dbcs-cont":"sbcs-cont",m=e===0?"":r.read_shift(e,d);return a&&(r.l+=4*l),n&&(r.l+=u),f.t=m,a||(f.raw="<t>"+f.t+"</t>",f.r=f.t),f}function $V(r){var e=r.t||"",t=ye(3);t.write_shift(2,e.length),t.write_shift(1,1);var n=ye(2*e.length);n.write_shift(2*e.length,e,"utf16le");var a=[t,n];return ln(a)}function ic(r,e,t){var n;if(t){if(t.biff>=2&&t.biff<=5)return r.read_shift(e,"cpstr");if(t.biff>=12)return r.read_shift(e,"dbcs-cont")}var a=r.read_shift(1);return a===0?n=r.read_shift(e,"sbcs-cont"):n=r.read_shift(e,"dbcs-cont"),n}function k0(r,e,t){var n=r.read_shift(t&&t.biff==2?1:2);return n===0?(r.l++,""):ic(r,n,t)}function vc(r,e,t){if(t.biff>5)return k0(r,e,t);var n=r.read_shift(1);return n===0?(r.l++,""):r.read_shift(n,t.biff<=4||!r.lens?"cpstr":"sbcs-cont")}function c3(r,e,t){return t||(t=ye(3+2*r.length)),t.write_shift(2,r.length),t.write_shift(1,1),t.write_shift(31,r,"utf16le"),t}function QV(r){var e=r.read_shift(1);r.l++;var t=r.read_shift(2);return r.l+=2,[e,t]}function JV(r){var e=r.read_shift(4),t=r.l,n=!1;e>24&&(r.l+=e-24,r.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),r.l=t);var a=r.read_shift((n?e-24:e)>>1,"utf16le").replace(Kn,"");return n&&(r.l+=24),a}function ZV(r){for(var e=r.read_shift(2),t="";e-- >0;)t+="../";var n=r.read_shift(0,"lpstr-ansi");if(r.l+=2,r.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=r.read_shift(4);if(a===0)return t+n.replace(/\\/g,"/");var s=r.read_shift(4);if(r.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=r.read_shift(s>>1,"utf16le").replace(Kn,"");return t+l}function eB(r,e){var t=r.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return JV(r);case"0303000000000000c000000000000046":return ZV(r);default:throw new Error("Unsupported Moniker "+t)}}function fm(r){var e=r.read_shift(4),t=e>0?r.read_shift(e,"utf16le").replace(Kn,""):"";return t}function qA(r,e){e||(e=ye(6+r.length*2)),e.write_shift(4,1+r.length);for(var t=0;t<r.length;++t)e.write_shift(2,r.charCodeAt(t));return e.write_shift(2,0),e}function tB(r,e){var t=r.l+e,n=r.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=r.read_shift(2);r.l+=2;var s,l,u,f,d="",m,x;a&16&&(s=fm(r,t-r.l)),a&128&&(l=fm(r,t-r.l)),(a&257)===257&&(u=fm(r,t-r.l)),(a&257)===1&&(f=eB(r,t-r.l)),a&8&&(d=fm(r,t-r.l)),a&32&&(m=r.read_shift(16)),a&64&&(x=oy(r)),r.l=t;var _=l||u||f||"";_&&d&&(_+="#"+d),_||(_="#"+d),a&2&&_.charAt(0)=="/"&&_.charAt(1)!="/"&&(_="file://"+_);var y={Target:_};return m&&(y.guid=m),x&&(y.time=x),s&&(y.Tooltip=s),y}function rB(r){var e=ye(512),t=0,n=r.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),s=a>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var l=[8,6815827,6619237,4849780,83];for(t=0;t<l.length;++t)e.write_shift(4,l[t]);if(s==28)n=n.slice(1),qA(n,e);else if(s&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<l.length;++t)e.write_shift(1,parseInt(l[t],16));var u=a>-1?n.slice(0,a):n;for(e.write_shift(4,2*(u.length+1)),t=0;t<u.length;++t)e.write_shift(2,u.charCodeAt(t));e.write_shift(2,0),s&8&&qA(a>-1?n.slice(a+1):"",e)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<l.length;++t)e.write_shift(1,parseInt(l[t],16));for(var f=0;n.slice(f*3,f*3+3)=="../"||n.slice(f*3,f*3+3)=="..\\";)++f;for(e.write_shift(2,f),e.write_shift(4,n.length-3*f+1),t=0;t<n.length-3*f;++t)e.write_shift(1,n.charCodeAt(t+3*f)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),t=0;t<6;++t)e.write_shift(4,0)}return e.slice(0,e.l)}function u3(r){var e=r.read_shift(1),t=r.read_shift(1),n=r.read_shift(1),a=r.read_shift(1);return[e,t,n,a]}function f3(r,e){var t=u3(r);return t[3]=0,t}function $i(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2);return{r:e,c:t,ixfe:n}}function sc(r,e,t,n){return n||(n=ye(6)),n.write_shift(2,r),n.write_shift(2,e),n.write_shift(2,t||0),n}function nB(r){var e=r.read_shift(2),t=r.read_shift(2);return r.l+=8,{type:e,flags:t}}function aB(r,e,t){return e===0?"":vc(r,e,t)}function iB(r,e,t){var n=t.biff>8?4:2,a=r.read_shift(n),s=r.read_shift(n,"i"),l=r.read_shift(n,"i");return[a,s,l]}function h3(r){var e=r.read_shift(2),t=ay(r);return[e,t]}function sB(r,e,t){r.l+=4,e-=4;var n=r.l+e,a=I0(r,e,t),s=r.read_shift(2);if(n-=r.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return r.l+=s,a}function Jp(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2),a=r.read_shift(2);return{s:{c:n,r:e},e:{c:a,r:t}}}function d3(r,e){return e||(e=ye(8)),e.write_shift(2,r.s.r),e.write_shift(2,r.e.r),e.write_shift(2,r.s.c),e.write_shift(2,r.e.c),e}function m3(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(1),a=r.read_shift(1);return{s:{c:n,r:e},e:{c:a,r:t}}}var oB=m3;function p3(r){r.l+=4;var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2);return r.l+=12,[t,e,n]}function lB(r){var e={};return r.l+=4,r.l+=16,e.fSharedNote=r.read_shift(2),r.l+=4,e}function cB(r){var e={};return r.l+=4,r.cf=r.read_shift(2),e}function bn(r){r.l+=2,r.l+=r.read_shift(2)}var uB={0:bn,4:bn,5:bn,6:bn,7:cB,8:bn,9:bn,10:bn,11:bn,12:bn,13:lB,14:bn,15:bn,16:bn,17:bn,18:bn,19:bn,20:bn,21:p3};function fB(r,e){for(var t=r.l+e,n=[];r.l<t;){var a=r.read_shift(2);r.l-=2;try{n.push(uB[a](r,t-r.l))}catch{return r.l=t,n}}return r.l!=t&&(r.l=t),n}function hm(r,e){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=r.read_shift(2),e-=2,e>=2&&(t.dt=r.read_shift(2),r.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return r.read_shift(e),t}function ly(r,e,t){var n=1536,a=16;switch(t.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=ye(a);return s.write_shift(2,n),s.write_shift(2,e),a>4&&s.write_shift(2,29282),a>6&&s.write_shift(2,1997),a>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function hB(r,e){return e===0||r.read_shift(2),1200}function dB(r,e,t){if(t.enc)return r.l+=e,"";var n=r.l,a=vc(r,0,t);return r.read_shift(e+n-r.l),a}function mB(r,e){var t=!e||e.biff==8,n=ye(t?112:54);for(n.write_shift(e.biff==8?2:1,7),t&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(t?0:536870912));n.l<n.length;)n.write_shift(1,t?0:32);return n}function pB(r,e,t){var n=t&&t.biff==8||e==2?r.read_shift(2):(r.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function gB(r,e,t){var n=r.read_shift(4),a=r.read_shift(1)&3,s=r.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var l=I0(r,0,t);return l.length===0&&(l="Sheet1"),{pos:n,hs:a,dt:s,name:l}}function xB(r,e){var t=!e||e.biff>=8?2:1,n=ye(8+t*r.name.length);n.write_shift(4,r.pos),n.write_shift(1,r.hs||0),n.write_shift(1,r.dt),n.write_shift(1,r.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(t*r.name.length,r.name,e.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function vB(r,e){for(var t=r.l+e,n=r.read_shift(4),a=r.read_shift(4),s=[],l=0;l!=a&&r.l<t;++l)s.push(YV(r));return s.Count=n,s.Unique=a,s}function _B(r,e){var t=ye(8);t.write_shift(4,r.Count),t.write_shift(4,r.Unique);for(var n=[],a=0;a<r.length;++a)n[a]=$V(r[a]);var s=ln([t].concat(n));return s.parts=[t.length].concat(n.map(function(l){return l.length})),s}function yB(r,e){var t={};return t.dsst=r.read_shift(2),r.l+=e-2,t}function TB(r){var e={};e.r=r.read_shift(2),e.c=r.read_shift(2),e.cnt=r.read_shift(2)-e.c;var t=r.read_shift(2);r.l+=4;var n=r.read_shift(1);return r.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=t/20),e}function EB(r){var e=nB(r);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var t=r.read_shift(4);return t!==0}function wB(r){return r.read_shift(2),r.read_shift(4)}function KA(r,e,t){var n=0;t&&t.biff==2||(n=r.read_shift(2));var a=r.read_shift(2);t&&t.biff==2&&(n=1-(a>>15),a&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,a]}function SB(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(2),a=r.read_shift(2),s=r.read_shift(2),l=r.read_shift(2),u=r.read_shift(2),f=r.read_shift(2),d=r.read_shift(2);return{Pos:[e,t],Dim:[n,a],Flags:s,CurTab:l,FirstTab:u,Selected:f,TabRatio:d}}function AB(){var r=ye(18);return r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,29280),r.write_shift(2,17600),r.write_shift(2,56),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,1),r.write_shift(2,500),r}function bB(r,e,t){if(t&&t.biff>=2&&t.biff<5)return{};var n=r.read_shift(2);return{RTL:n&64}}function IB(r){var e=ye(18),t=1718;return r&&r.RTL&&(t|=64),e.write_shift(2,t),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function kB(){}function CB(r,e,t){var n={dyHeight:r.read_shift(2),fl:r.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:r.l+=2;break;default:r.l+=10;break}return n.name=I0(r,0,t),n}function RB(r,e){var t=r.name||"Arial",n=e&&e.biff==5,a=n?15+t.length:16+2*t.length,s=ye(a);return s.write_shift(2,r.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,t.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le"),s}function DB(r){var e=$i(r);return e.isst=r.read_shift(4),e}function NB(r,e,t,n){var a=ye(10);return sc(r,e,n,a),a.write_shift(4,t),a}function OB(r,e,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=r.l+e,a=$i(r);t.biff==2&&r.l++;var s=k0(r,n-r.l,t);return a.val=s,a}function FB(r,e,t,n,a){var s=!a||a.biff==8,l=ye(8+ +s+(1+s)*t.length);return sc(r,e,n,l),l.write_shift(2,t.length),s&&l.write_shift(1,1),l.write_shift((1+s)*t.length,t,s?"utf16le":"sbcs"),l}function MB(r,e,t){var n=r.read_shift(2),a=vc(r,0,t);return[n,a]}function PB(r,e,t,n){var a=t&&t.biff==5;n||(n=ye(a?3+e.length:5+2*e.length)),n.write_shift(2,r),n.write_shift(a?1:2,e.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*e.length,e,a?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var LB=vc;function XA(r,e,t){var n=r.l+e,a=t.biff==8||!t.biff?4:2,s=r.read_shift(a),l=r.read_shift(a),u=r.read_shift(2),f=r.read_shift(2);return r.l=n,{s:{r:s,c:u},e:{r:l,c:f}}}function VB(r,e){var t=e.biff==8||!e.biff?4:2,n=ye(2*t+6);return n.write_shift(t,r.s.r),n.write_shift(t,r.e.r+1),n.write_shift(2,r.s.c),n.write_shift(2,r.e.c+1),n.write_shift(2,0),n}function BB(r){var e=r.read_shift(2),t=r.read_shift(2),n=h3(r);return{r:e,c:t,ixfe:n[0],rknum:n[1]}}function UB(r,e){for(var t=r.l+e-2,n=r.read_shift(2),a=r.read_shift(2),s=[];r.l<t;)s.push(h3(r));if(r.l!==t)throw new Error("MulRK read error");var l=r.read_shift(2);if(s.length!=l-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:l,rkrec:s}}function zB(r,e){for(var t=r.l+e-2,n=r.read_shift(2),a=r.read_shift(2),s=[];r.l<t;)s.push(r.read_shift(2));if(r.l!==t)throw new Error("MulBlank read error");var l=r.read_shift(2);if(s.length!=l-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:l,ixfe:s}}function jB(r,e,t,n){var a={},s=r.read_shift(4),l=r.read_shift(4),u=r.read_shift(4),f=r.read_shift(2);return a.patternType=EV[u>>26],n.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=l&15,a.dgRight=l>>4&15,a.dgTop=l>>8&15,a.dgBottom=l>>12&15,a.icvLeft=l>>16&127,a.icvRight=l>>23&127,a.grbitDiag=l>>30&3,a.icvTop=u&127,a.icvBottom=u>>7&127,a.icvDiag=u>>14&127,a.dgDiag=u>>21&15,a.icvFore=f&127,a.icvBack=f>>7&127,a.fsxButton=f>>14&1),a}function HB(r,e,t){var n={};return n.ifnt=r.read_shift(2),n.numFmtId=r.read_shift(2),n.flags=r.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=jB(r,e,n.fStyle,t),n}function WA(r,e,t,n){var a=t&&t.biff==5;n||(n=ye(a?16:20)),n.write_shift(2,0),r.style?(n.write_shift(2,r.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,r.numFmtId||0),n.write_shift(2,e<<4));var s=0;return r.numFmtId>0&&a&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function GB(r){r.l+=4;var e=[r.read_shift(2),r.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function qB(r){var e=ye(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function YA(r,e,t){var n=$i(r);(t.biff==2||e==9)&&++r.l;var a=WV(r);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function KB(r,e,t,n,a,s){var l=ye(8);return sc(r,e,n,l),l3(t,s,l),l}function XB(r,e,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=$i(r),a=Dn(r);return n.val=a,n}function WB(r,e,t,n){var a=ye(14);return sc(r,e,n,a),ac(t,a),a}var $A=aB;function YB(r,e,t){var n=r.l+e,a=r.read_shift(2),s=r.read_shift(2);if(t.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var l=ic(r,s),u=[];n>r.l;)u.push(k0(r));return[s,a,l,u]}function QA(r,e,t){var n=r.read_shift(2),a,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return t.sbcch===14849&&(a=sB(r,e-2,t)),s.body=a||r.read_shift(e-2),typeof a=="string"&&(s.Name=a),s}var $B=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function JA(r,e,t){var n=r.l+e,a=r.read_shift(2),s=r.read_shift(1),l=r.read_shift(1),u=r.read_shift(t&&t.biff==2?1:2),f=0;(!t||t.biff>=5)&&(t.biff!=5&&(r.l+=2),f=r.read_shift(2),t.biff==5&&(r.l+=2),r.l+=4);var d=ic(r,l,t);a&32&&(d=$B[d.charCodeAt(0)]);var m=n-r.l;t&&t.biff==2&&--m;var x=n==r.l||u===0||!(m>0)?[]:fG(r,m,t,u);return{chKey:s,Name:d,itab:f,rgce:x}}function g3(r,e,t){if(t.biff<8)return QB(r,e,t);for(var n=[],a=r.l+e,s=r.read_shift(t.biff>8?4:2);s--!==0;)n.push(iB(r,t.biff>8?12:6,t));if(r.l!=a)throw new Error("Bad ExternSheet: "+r.l+" != "+a);return n}function QB(r,e,t){r[r.l+1]==3&&r[r.l]++;var n=I0(r,e,t);return n.charCodeAt(0)==3?n.slice(1):n}function JB(r,e,t){if(t.biff<8){r.l+=e;return}var n=r.read_shift(2),a=r.read_shift(2),s=ic(r,n,t),l=ic(r,a,t);return[s,l]}function ZB(r,e,t){var n=m3(r);r.l++;var a=r.read_shift(1);return e-=8,[hG(r,e,t),a,n]}function ZA(r,e,t){var n=oB(r);switch(t.biff){case 2:r.l++,e-=7;break;case 3:case 4:r.l+=2,e-=8;break;default:r.l+=6,e-=12}return[n,cG(r,e,t)]}function eU(r){var e=r.read_shift(4)!==0,t=r.read_shift(4)!==0,n=r.read_shift(4);return[e,t,n]}function tU(r,e,t){if(!(t.biff<8)){var n=r.read_shift(2),a=r.read_shift(2),s=r.read_shift(2),l=r.read_shift(2),u=vc(r,0,t);return t.biff<8&&r.read_shift(1),[{r:n,c:a},u,l,s]}}function rU(r,e,t){return tU(r,e,t)}function nU(r,e){for(var t=[],n=r.read_shift(2);n--;)t.push(Jp(r));return t}function aU(r){var e=ye(2+r.length*8);e.write_shift(2,r.length);for(var t=0;t<r.length;++t)d3(r[t],e);return e}function iU(r,e,t){if(t&&t.biff<8)return oU(r,e,t);var n=p3(r),a=fB(r,e-22,n[1]);return{cmo:n,ft:a}}var sU={8:function(r,e){var t=r.l+e;r.l+=10;var n=r.read_shift(2);r.l+=4,r.l+=2,r.l+=2,r.l+=2,r.l+=4;var a=r.read_shift(1);return r.l+=a,r.l=t,{fmt:n}}};function oU(r,e,t){r.l+=4;var n=r.read_shift(2),a=r.read_shift(2),s=r.read_shift(2);r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=2,r.l+=6,e-=36;var l=[];return l.push((sU[n]||Mn)(r,e,t)),{cmo:[a,n,s],ft:l}}function lU(r,e,t){var n=r.l,a="";try{r.l+=4;var s=(t.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(s)==-1?r.l+=6:l=QV(r,6,t);var u=r.read_shift(2);r.read_shift(2),Xr(r,2);var f=r.read_shift(2);r.l+=f;for(var d=1;d<r.lens.length-1;++d){if(r.l-n!=r.lens[d])throw new Error("TxO: bad continue record");var m=r[r.l],x=ic(r,r.lens[d+1]-r.lens[d]-1);if(a+=x,a.length>=(m?u:2*u))break}if(a.length!==u&&a.length!==u*2)throw new Error("cchText: "+u+" != "+a.length);return r.l=n+e,{t:a}}catch{return r.l=n+e,{t:a}}}function cU(r,e){var t=Jp(r);r.l+=16;var n=tB(r,e-24);return[t,n]}function uU(r){var e=ye(24),t=Sr(r[0]);e.write_shift(2,t.r),e.write_shift(2,t.r),e.write_shift(2,t.c),e.write_shift(2,t.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)e.write_shift(1,parseInt(n[a],16));return ln([e,rB(r[1])])}function fU(r,e){r.read_shift(2);var t=Jp(r),n=r.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Kn,""),[t,n]}function hU(r){var e=r[1].Tooltip,t=ye(10+2*(e.length+1));t.write_shift(2,2048);var n=Sr(r[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var a=0;a<e.length;++a)t.write_shift(2,e.charCodeAt(a));return t.write_shift(2,0),t}function dU(r){var e=[0,0],t;return t=r.read_shift(2),e[0]=LA[t]||t,t=r.read_shift(2),e[1]=LA[t]||t,e}function mU(r){return r||(r=ye(4)),r.write_shift(2,1),r.write_shift(2,1),r}function pU(r){for(var e=r.read_shift(2),t=[];e-- >0;)t.push(f3(r));return t}function gU(r){for(var e=r.read_shift(2),t=[];e-- >0;)t.push(f3(r));return t}function xU(r){r.l+=2;var e={cxfs:0,crc:0};return e.cxfs=r.read_shift(2),e.crc=r.read_shift(4),e}function x3(r,e,t){if(!t.cellStyles)return Mn(r,e);var n=t&&t.biff>=12?4:2,a=r.read_shift(n),s=r.read_shift(n),l=r.read_shift(n),u=r.read_shift(n),f=r.read_shift(2);n==2&&(r.l+=2);var d={s:a,e:s,w:l,ixfe:u,flags:f};return(t.biff>=5||!t.biff)&&(d.level=f>>8&7),d}function vU(r,e){var t=ye(12);t.write_shift(2,e),t.write_shift(2,e),t.write_shift(2,r.width*256),t.write_shift(2,0);var n=0;return r.hidden&&(n|=1),t.write_shift(1,n),n=r.level||0,t.write_shift(1,n),t.write_shift(2,0),t}function _U(r,e){var t={};return e<32||(r.l+=16,t.header=Dn(r),t.footer=Dn(r),r.l+=2),t}function yU(r,e,t){var n={area:!1};if(t.biff!=5)return r.l+=e,n;var a=r.read_shift(1);return r.l+=3,a&16&&(n.area=!0),n}function TU(r){for(var e=ye(2*r),t=0;t<r;++t)e.write_shift(2,t+1);return e}var EU=$i,wU=o3,SU=k0;function AU(r){var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(4),a={fmt:e,env:t,len:n,data:r.slice(r.l,r.l+n)};return r.l+=n,a}function bU(r,e,t){t.biffguess&&t.biff==5&&(t.biff=2);var n=$i(r);++r.l;var a=vc(r,e-7,t);return n.t="str",n.val=a,n}function IU(r){var e=$i(r);++r.l;var t=Dn(r);return e.t="n",e.val=t,e}function kU(r,e,t){var n=ye(15);return N0(n,r,e),n.write_shift(8,t,"f"),n}function CU(r){var e=$i(r);++r.l;var t=r.read_shift(2);return e.t="n",e.val=t,e}function RU(r,e,t){var n=ye(9);return N0(n,r,e),n.write_shift(2,t),n}function DU(r){var e=r.read_shift(1);return e===0?(r.l++,""):r.read_shift(e,"sbcs-cont")}function NU(r,e){r.l+=6,r.l+=2,r.l+=1,r.l+=3,r.l+=1,r.l+=e-13}function OU(r,e,t){var n=r.l+e,a=$i(r),s=r.read_shift(2),l=ic(r,s,t);return r.l=n,a.t="str",a.val=l,a}var FU=[2,3,48,49,131,139,140,245],yv=(function(){var r={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Yp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(u,f){var d=[],m=jo(1);switch(f.type){case"base64":m=Ta(Ia(u));break;case"binary":m=Ta(u);break;case"buffer":case"array":m=u;break}yn(m,0);var x=m.read_shift(1),_=!!(x&136),y=!1,w=!1;switch(x){case 2:break;case 3:break;case 48:y=!0,_=!0;break;case 49:y=!0,_=!0;break;case 131:break;case 139:break;case 140:w=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+x.toString(16))}var T=0,S=521;x==2&&(T=m.read_shift(2)),m.l+=3,x!=2&&(T=m.read_shift(4)),T>1048576&&(T=1e6),x!=2&&(S=m.read_shift(2));var O=m.read_shift(2),U=f.codepage||1252;x!=2&&(m.l+=16,m.read_shift(1),m[m.l]!==0&&(U=r[m[m.l]]),m.l+=1,m.l+=2),w&&(m.l+=36);for(var R=[],Y={},te=Math.min(m.length,x==2?521:S-10-(y?264:0)),G=w?32:11;m.l<te&&m[m.l]!=13;)switch(Y={},Y.name=Jh.utils.decode(U,m.slice(m.l,m.l+G)).replace(/[\u0000\r\n].*$/g,""),m.l+=G,Y.type=String.fromCharCode(m.read_shift(1)),x!=2&&!w&&(Y.offset=m.read_shift(4)),Y.len=m.read_shift(1),x==2&&(Y.offset=m.read_shift(2)),Y.dec=m.read_shift(1),Y.name.length&&R.push(Y),x!=2&&(m.l+=w?13:14),Y.type){case"B":(!y||Y.len!=8)&&f.WTF&&console.log("Skipping "+Y.name+":"+Y.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+Y.name+":"+Y.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+Y.type)}if(m[m.l]!==13&&(m.l=S-1),m.read_shift(1)!==13)throw new Error("DBF Terminator not found "+m.l+" "+m[m.l]);m.l=S;var A=0,C=0;for(d[0]=[],C=0;C!=R.length;++C)d[0][C]=R[C].name;for(;T-- >0;){if(m[m.l]===42){m.l+=O;continue}for(++m.l,d[++A]=[],C=0,C=0;C!=R.length;++C){var k=m.slice(m.l,m.l+R[C].len);m.l+=R[C].len,yn(k,0);var V=Jh.utils.decode(U,k);switch(R[C].type){case"C":V.trim().length&&(d[A][C]=V.replace(/\s+$/,""));break;case"D":V.length===8?d[A][C]=new Date(+V.slice(0,4),+V.slice(4,6)-1,+V.slice(6,8)):d[A][C]=V;break;case"F":d[A][C]=parseFloat(V.trim());break;case"+":case"I":d[A][C]=w?k.read_shift(-4,"i")^2147483648:k.read_shift(4,"i");break;case"L":switch(V.trim().toUpperCase()){case"Y":case"T":d[A][C]=!0;break;case"N":case"F":d[A][C]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+V+"|")}break;case"M":if(!_)throw new Error("DBF Unexpected MEMO for type "+x.toString(16));d[A][C]="##MEMO##"+(w?parseInt(V.trim(),10):k.read_shift(4));break;case"N":V=V.replace(/\u0000/g,"").trim(),V&&V!="."&&(d[A][C]=+V||0);break;case"@":d[A][C]=new Date(k.read_shift(-8,"f")-621356832e5);break;case"T":d[A][C]=new Date((k.read_shift(4)-2440588)*864e5+k.read_shift(4));break;case"Y":d[A][C]=k.read_shift(4,"i")/1e4+k.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[A][C]=-k.read_shift(-8,"f");break;case"B":if(y&&R[C].len==8){d[A][C]=k.read_shift(8,"f");break}case"G":case"P":k.l+=R[C].len;break;case"0":if(R[C].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+R[C].type)}}}if(x!=2&&m.l<m.length&&m[m.l++]!=26)throw new Error("DBF EOF Marker missing "+(m.l-1)+" of "+m.length+" "+m[m.l-1].toString(16));return f&&f.sheetRows&&(d=d.slice(0,f.sheetRows)),f.DBF=R,d}function n(u,f){var d=f||{};d.dateNF||(d.dateNF="yyyymmdd");var m=of(t(u,d),d);return m["!cols"]=d.DBF.map(function(x){return{wch:x.len,DBF:x}}),delete d.DBF,m}function a(u,f){try{return Yo(n(u,f),f)}catch(d){if(f&&f.WTF)throw d}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function l(u,f){var d=f||{};if(+d.codepage>=0&&vi(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var m=aa(),x=yp(u,{header:1,raw:!0,cellDates:!0}),_=x[0],y=x.slice(1),w=u["!cols"]||[],T=0,S=0,O=0,U=1;for(T=0;T<_.length;++T){if(((w[T]||{}).DBF||{}).name){_[T]=w[T].DBF.name,++O;continue}if(_[T]!=null){if(++O,typeof _[T]=="number"&&(_[T]=_[T].toString(10)),typeof _[T]!="string")throw new Error("DBF Invalid column name "+_[T]+" |"+typeof _[T]+"|");if(_.indexOf(_[T])!==T){for(S=0;S<1024;++S)if(_.indexOf(_[T]+"_"+S)==-1){_[T]+="_"+S;break}}}}var R=Ot(u["!ref"]),Y=[],te=[],G=[];for(T=0;T<=R.e.c-R.s.c;++T){var A="",C="",k=0,V=[];for(S=0;S<y.length;++S)y[S][T]!=null&&V.push(y[S][T]);if(V.length==0||_[T]==null){Y[T]="?";continue}for(S=0;S<V.length;++S){switch(typeof V[S]){case"number":C="B";break;case"string":C="C";break;case"boolean":C="L";break;case"object":C=V[S]instanceof Date?"D":"C";break;default:C="C"}k=Math.max(k,String(V[S]).length),A=A&&A!=C?"C":C}k>250&&(k=250),C=((w[T]||{}).DBF||{}).type,C=="C"&&w[T].DBF.len>k&&(k=w[T].DBF.len),A=="B"&&C=="N"&&(A="N",G[T]=w[T].DBF.dec,k=w[T].DBF.len),te[T]=A=="C"||C=="N"?k:s[A]||0,U+=te[T],Y[T]=A}var F=m.next(32);for(F.write_shift(4,318902576),F.write_shift(4,y.length),F.write_shift(2,296+32*O),F.write_shift(2,U),T=0;T<4;++T)F.write_shift(4,0);for(F.write_shift(4,0|(+e[sC]||3)<<8),T=0,S=0;T<_.length;++T)if(_[T]!=null){var M=m.next(32),L=(_[T].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);M.write_shift(1,L,"sbcs"),M.write_shift(1,Y[T]=="?"?"C":Y[T],"sbcs"),M.write_shift(4,S),M.write_shift(1,te[T]||s[Y[T]]||0),M.write_shift(1,G[T]||0),M.write_shift(1,2),M.write_shift(4,0),M.write_shift(1,0),M.write_shift(4,0),M.write_shift(4,0),S+=te[T]||s[Y[T]]||0}var Ie=m.next(264);for(Ie.write_shift(4,13),T=0;T<65;++T)Ie.write_shift(4,0);for(T=0;T<y.length;++T){var Re=m.next(U);for(Re.write_shift(1,0),S=0;S<_.length;++S)if(_[S]!=null)switch(Y[S]){case"L":Re.write_shift(1,y[T][S]==null?63:y[T][S]?84:70);break;case"B":Re.write_shift(8,y[T][S]||0,"f");break;case"N":var ae="0";for(typeof y[T][S]=="number"&&(ae=y[T][S].toFixed(G[S]||0)),O=0;O<te[S]-ae.length;++O)Re.write_shift(1,32);Re.write_shift(1,ae,"sbcs");break;case"D":y[T][S]?(Re.write_shift(4,("0000"+y[T][S].getFullYear()).slice(-4),"sbcs"),Re.write_shift(2,("00"+(y[T][S].getMonth()+1)).slice(-2),"sbcs"),Re.write_shift(2,("00"+y[T][S].getDate()).slice(-2),"sbcs")):Re.write_shift(8,"00000000","sbcs");break;case"C":var le=String(y[T][S]!=null?y[T][S]:"").slice(0,te[S]);for(Re.write_shift(1,le,"sbcs"),O=0;O<te[S]-le.length;++O)Re.write_shift(1,32);break}}return m.next(1).write_shift(1,26),m.end()}return{to_workbook:a,to_sheet:n,from_sheet:l}})(),v3=(function(){var r={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Nr(r).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(_,y){var w=r[y];return typeof w=="number"?uA(w):w},n=function(_,y,w){var T=y.charCodeAt(0)-32<<4|w.charCodeAt(0)-48;return T==59?_:uA(T)};r["|"]=254;function a(_,y){switch(y.type){case"base64":return s(Ia(_),y);case"binary":return s(_,y);case"buffer":return s(_t&&Buffer.isBuffer(_)?_.toString("binary"):Wo(_),y);case"array":return s(nc(_),y)}throw new Error("Unrecognized type "+y.type)}function s(_,y){var w=_.split(/[\n\r]+/),T=-1,S=-1,O=0,U=0,R=[],Y=[],te=null,G={},A=[],C=[],k=[],V=0,F;for(+y.codepage>=0&&vi(+y.codepage);O!==w.length;++O){V=0;var M=w[O].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,t),L=M.replace(/;;/g,"\0").split(";").map(function(ee){return ee.replace(/\u0000/g,";")}),Ie=L[0],Re;if(M.length>0)switch(Ie){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":L[1].charAt(0)=="P"&&Y.push(M.slice(3).replace(/;;/g,";"));break;case"C":var ae=!1,le=!1,Fe=!1,ie=!1,Ne=-1,Q=-1;for(U=1;U<L.length;++U)switch(L[U].charAt(0)){case"A":break;case"X":S=parseInt(L[U].slice(1))-1,le=!0;break;case"Y":for(T=parseInt(L[U].slice(1))-1,le||(S=0),F=R.length;F<=T;++F)R[F]=[];break;case"K":Re=L[U].slice(1),Re.charAt(0)==='"'?Re=Re.slice(1,Re.length-1):Re==="TRUE"?Re=!0:Re==="FALSE"?Re=!1:isNaN(Ti(Re))?isNaN(Wu(Re).getDate())||(Re=mr(Re)):(Re=Ti(Re),te!==null&&af(te)&&(Re=Qp(Re))),ae=!0;break;case"E":ie=!0;var N=Ru(L[U].slice(1),{r:T,c:S});R[T][S]=[R[T][S],N];break;case"S":Fe=!0,R[T][S]=[R[T][S],"S5S"];break;case"G":break;case"R":Ne=parseInt(L[U].slice(1))-1;break;case"C":Q=parseInt(L[U].slice(1))-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+M)}if(ae&&(R[T][S]&&R[T][S].length==2?R[T][S][0]=Re:R[T][S]=Re,te=null),Fe){if(ie)throw new Error("SYLK shared formula cannot have own formula");var J=Ne>-1&&R[Ne][Q];if(!J||!J[1])throw new Error("SYLK shared formula cannot find base");R[T][S][1]=P3(J[1],{r:T-Ne,c:S-Q})}break;case"F":var X=0;for(U=1;U<L.length;++U)switch(L[U].charAt(0)){case"X":S=parseInt(L[U].slice(1))-1,++X;break;case"Y":for(T=parseInt(L[U].slice(1))-1,F=R.length;F<=T;++F)R[F]=[];break;case"M":V=parseInt(L[U].slice(1))/20;break;case"F":break;case"G":break;case"P":te=Y[parseInt(L[U].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(k=L[U].slice(1).split(" "),F=parseInt(k[0],10);F<=parseInt(k[1],10);++F)V=parseInt(k[2],10),C[F-1]=V===0?{hidden:!0}:{wch:V},Ho(C[F-1]);break;case"C":S=parseInt(L[U].slice(1))-1,C[S]||(C[S]={});break;case"R":T=parseInt(L[U].slice(1))-1,A[T]||(A[T]={}),V>0?(A[T].hpt=V,A[T].hpx=$u(V)):V===0&&(A[T].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+M)}X<1&&(te=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+M)}}return A.length>0&&(G["!rows"]=A),C.length>0&&(G["!cols"]=C),y&&y.sheetRows&&(R=R.slice(0,y.sheetRows)),[R,G]}function l(_,y){var w=a(_,y),T=w[0],S=w[1],O=of(T,y);return Nr(S).forEach(function(U){O[U]=S[U]}),O}function u(_,y){return Yo(l(_,y),y)}function f(_,y,w,T){var S="C;Y"+(w+1)+";X"+(T+1)+";K";switch(_.t){case"n":S+=_.v||0,_.f&&!_.F&&(S+=";E"+my(_.f,{r:w,c:T}));break;case"b":S+=_.v?"TRUE":"FALSE";break;case"e":S+=_.w||_.v;break;case"d":S+='"'+(_.w||_.v)+'"';break;case"s":S+='"'+_.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return S}function d(_,y){y.forEach(function(w,T){var S="F;W"+(T+1)+" "+(T+1)+" ";w.hidden?S+="0":(typeof w.width=="number"&&!w.wpx&&(w.wpx=s0(w.width)),typeof w.wpx=="number"&&!w.wch&&(w.wch=o0(w.wpx)),typeof w.wch=="number"&&(S+=Math.round(w.wch))),S.charAt(S.length-1)!=" "&&_.push(S)})}function m(_,y){y.forEach(function(w,T){var S="F;";w.hidden?S+="M0;":w.hpt?S+="M"+20*w.hpt+";":w.hpx&&(S+="M"+20*l0(w.hpx)+";"),S.length>2&&_.push(S+"R"+(T+1))})}function x(_,y){var w=["ID;PWXL;N;E"],T=[],S=Ot(_["!ref"]),O,U=Array.isArray(_),R=`\r
`;w.push("P;PGeneral"),w.push("F;P0;DG0G8;M255"),_["!cols"]&&d(w,_["!cols"]),_["!rows"]&&m(w,_["!rows"]),w.push("B;Y"+(S.e.r-S.s.r+1)+";X"+(S.e.c-S.s.c+1)+";D"+[S.s.c,S.s.r,S.e.c,S.e.r].join(" "));for(var Y=S.s.r;Y<=S.e.r;++Y)for(var te=S.s.c;te<=S.e.c;++te){var G=at({r:Y,c:te});O=U?(_[Y]||[])[te]:_[G],!(!O||O.v==null&&(!O.f||O.F))&&T.push(f(O,_,Y,te))}return w.join(R)+R+T.join(R)+R+"E"+R}return{to_workbook:u,to_sheet:l,from_sheet:x}})(),_3=(function(){function r(s,l){switch(l.type){case"base64":return e(Ia(s),l);case"binary":return e(s,l);case"buffer":return e(_t&&Buffer.isBuffer(s)?s.toString("binary"):Wo(s),l);case"array":return e(nc(s),l)}throw new Error("Unrecognized type "+l.type)}function e(s,l){for(var u=s.split(`
`),f=-1,d=-1,m=0,x=[];m!==u.length;++m){if(u[m].trim()==="BOT"){x[++f]=[],d=0;continue}if(!(f<0)){var _=u[m].trim().split(","),y=_[0],w=_[1];++m;for(var T=u[m]||"";(T.match(/["]/g)||[]).length&1&&m<u.length-1;)T+=`
`+u[++m];switch(T=T.trim(),+y){case-1:if(T==="BOT"){x[++f]=[],d=0;continue}else if(T!=="EOD")throw new Error("Unrecognized DIF special command "+T);break;case 0:T==="TRUE"?x[f][d]=!0:T==="FALSE"?x[f][d]=!1:isNaN(Ti(w))?isNaN(Wu(w).getDate())?x[f][d]=w:x[f][d]=mr(w):x[f][d]=Ti(w),++d;break;case 1:T=T.slice(1,T.length-1),T=T.replace(/""/g,'"'),T&&T.match(/^=".*"$/)&&(T=T.slice(2,-1)),x[f][d++]=T!==""?T:null;break}if(T==="EOD")break}}return l&&l.sheetRows&&(x=x.slice(0,l.sheetRows)),x}function t(s,l){return of(r(s,l),l)}function n(s,l){return Yo(t(s,l),l)}var a=(function(){var s=function(f,d,m,x,_){f.push(d),f.push(m+","+x),f.push('"'+_.replace(/"/g,'""')+'"')},l=function(f,d,m,x){f.push(d+","+m),f.push(d==1?'"'+x.replace(/"/g,'""')+'"':x)};return function(f){var d=[],m=Ot(f["!ref"]),x,_=Array.isArray(f);s(d,"TABLE",0,1,"sheetjs"),s(d,"VECTORS",0,m.e.r-m.s.r+1,""),s(d,"TUPLES",0,m.e.c-m.s.c+1,""),s(d,"DATA",0,0,"");for(var y=m.s.r;y<=m.e.r;++y){l(d,-1,0,"BOT");for(var w=m.s.c;w<=m.e.c;++w){var T=at({r:y,c:w});if(x=_?(f[y]||[])[w]:f[T],!x){l(d,1,0,"");continue}switch(x.t){case"n":var S=x.w;!S&&x.v!=null&&(S=x.v),S==null?x.f&&!x.F?l(d,1,0,"="+x.f):l(d,1,0,""):l(d,0,S,"V");break;case"b":l(d,0,x.v?1:0,x.v?"TRUE":"FALSE");break;case"s":l(d,1,0,isNaN(x.v)?x.v:'="'+x.v+'"');break;case"d":x.w||(x.w=ei(x.z||nt[14],en(mr(x.v)))),l(d,0,x.w,"V");break;default:l(d,1,0,"")}}}l(d,-1,0,"EOD");var O=`\r
`,U=d.join(O);return U}})();return{to_workbook:n,to_sheet:t,from_sheet:a}})(),y3=(function(){function r(x){return x.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(x){return x.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(x,_){for(var y=x.split(`
`),w=-1,T=-1,S=0,O=[];S!==y.length;++S){var U=y[S].trim().split(":");if(U[0]==="cell"){var R=Sr(U[1]);if(O.length<=R.r)for(w=O.length;w<=R.r;++w)O[w]||(O[w]=[]);switch(w=R.r,T=R.c,U[2]){case"t":O[w][T]=r(U[3]);break;case"v":O[w][T]=+U[3];break;case"vtf":var Y=U[U.length-1];case"vtc":switch(U[3]){case"nl":O[w][T]=!!+U[4];break;default:O[w][T]=+U[4];break}U[2]=="vtf"&&(O[w][T]=[O[w][T],Y])}}}return _&&_.sheetRows&&(O=O.slice(0,_.sheetRows)),O}function n(x,_){return of(t(x,_),_)}function a(x,_){return Yo(n(x,_),_)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function d(x){if(!x||!x["!ref"])return"";for(var _=[],y=[],w,T="",S=ia(x["!ref"]),O=Array.isArray(x),U=S.s.r;U<=S.e.r;++U)for(var R=S.s.c;R<=S.e.c;++R)if(T=at({r:U,c:R}),w=O?(x[U]||[])[R]:x[T],!(!w||w.v==null||w.t==="z")){switch(y=["cell",T,"t"],w.t){case"s":case"str":y.push(e(w.v));break;case"n":w.f?(y[2]="vtf",y[3]="n",y[4]=w.v,y[5]=e(w.f)):(y[2]="v",y[3]=w.v);break;case"b":y[2]="vt"+(w.f?"f":"c"),y[3]="nl",y[4]=w.v?"1":"0",y[5]=e(w.f||(w.v?"TRUE":"FALSE"));break;case"d":var Y=en(mr(w.v));y[2]="vtc",y[3]="nd",y[4]=""+Y,y[5]=w.w||ei(w.z||nt[14],Y);break;case"e":continue}_.push(y.join(":"))}return _.push("sheet:c:"+(S.e.c-S.s.c+1)+":r:"+(S.e.r-S.s.r+1)+":tvf:1"),_.push("valueformat:1:text-wiki"),_.join(`
`)}function m(x){return[s,l,u,l,d(x),f].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:m}})(),Yu=(function(){function r(m,x,_,y,w){w.raw?x[_][y]=m:m===""||(m==="TRUE"?x[_][y]=!0:m==="FALSE"?x[_][y]=!1:isNaN(Ti(m))?isNaN(Wu(m).getDate())?x[_][y]=m:x[_][y]=mr(m):x[_][y]=Ti(m))}function e(m,x){var _=x||{},y=[];if(!m||m.length===0)return y;for(var w=m.split(/[\r\n]/),T=w.length-1;T>=0&&w[T].length===0;)--T;for(var S=10,O=0,U=0;U<=T;++U)O=w[U].indexOf(" "),O==-1?O=w[U].length:O++,S=Math.max(S,O);for(U=0;U<=T;++U){y[U]=[];var R=0;for(r(w[U].slice(0,S).trim(),y,U,R,_),R=1;R<=(w[U].length-S)/10+1;++R)r(w[U].slice(S+(R-1)*10,S+R*10).trim(),y,U,R,_)}return _.sheetRows&&(y=y.slice(0,_.sheetRows)),y}var t={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(m){for(var x={},_=!1,y=0,w=0;y<m.length;++y)(w=m.charCodeAt(y))==34?_=!_:!_&&w in t&&(x[w]=(x[w]||0)+1);w=[];for(y in x)Object.prototype.hasOwnProperty.call(x,y)&&w.push([x[y],y]);if(!w.length){x=n;for(y in x)Object.prototype.hasOwnProperty.call(x,y)&&w.push([x[y],y])}return w.sort(function(T,S){return T[0]-S[0]||n[T[1]]-n[S[1]]}),t[w.pop()[1]]||44}function s(m,x){var _=x||{},y="",w=_.dense?[]:{},T={s:{c:0,r:0},e:{c:0,r:0}};m.slice(0,4)=="sep="?m.charCodeAt(5)==13&&m.charCodeAt(6)==10?(y=m.charAt(4),m=m.slice(7)):m.charCodeAt(5)==13||m.charCodeAt(5)==10?(y=m.charAt(4),m=m.slice(6)):y=a(m.slice(0,1024)):_&&_.FS?y=_.FS:y=a(m.slice(0,1024));var S=0,O=0,U=0,R=0,Y=0,te=y.charCodeAt(0),G=!1,A=0,C=m.charCodeAt(0);m=m.replace(/\r\n/mg,`
`);var k=_.dateNF!=null?y7(_.dateNF):null;function V(){var F=m.slice(R,Y),M={};if(F.charAt(0)=='"'&&F.charAt(F.length-1)=='"'&&(F=F.slice(1,-1).replace(/""/g,'"')),F.length===0)M.t="z";else if(_.raw)M.t="s",M.v=F;else if(F.trim().length===0)M.t="s",M.v=F;else if(F.charCodeAt(0)==61)F.charCodeAt(1)==34&&F.charCodeAt(F.length-1)==34?(M.t="s",M.v=F.slice(2,-1).replace(/""/g,'"')):Yj(F)?(M.t="n",M.f=F.slice(1)):(M.t="s",M.v=F);else if(F=="TRUE")M.t="b",M.v=!0;else if(F=="FALSE")M.t="b",M.v=!1;else if(!isNaN(U=Ti(F)))M.t="n",_.cellText!==!1&&(M.w=F),M.v=U;else if(!isNaN(Wu(F).getDate())||k&&F.match(k)){M.z=_.dateNF||nt[14];var L=0;k&&F.match(k)&&(F=T7(F,_.dateNF,F.match(k)||[]),L=1),_.cellDates?(M.t="d",M.v=mr(F,L)):(M.t="n",M.v=en(mr(F,L))),_.cellText!==!1&&(M.w=ei(M.z,M.v instanceof Date?en(M.v):M.v)),_.cellNF||delete M.z}else M.t="s",M.v=F;if(M.t=="z"||(_.dense?(w[S]||(w[S]=[]),w[S][O]=M):w[at({c:O,r:S})]=M),R=Y+1,C=m.charCodeAt(R),T.e.c<O&&(T.e.c=O),T.e.r<S&&(T.e.r=S),A==te)++O;else if(O=0,++S,_.sheetRows&&_.sheetRows<=S)return!0}e:for(;Y<m.length;++Y)switch(A=m.charCodeAt(Y)){case 34:C===34&&(G=!G);break;case te:case 10:case 13:if(!G&&V())break e;break}return Y-R>0&&V(),w["!ref"]=gt(T),w}function l(m,x){return!(x&&x.PRN)||x.FS||m.slice(0,4)=="sep="||m.indexOf("	")>=0||m.indexOf(",")>=0||m.indexOf(";")>=0?s(m,x):of(e(m,x),x)}function u(m,x){var _="",y=x.type=="string"?[0,0,0,0]:Ey(m,x);switch(x.type){case"base64":_=Ia(m);break;case"binary":_=m;break;case"buffer":x.codepage==65001?_=m.toString("utf8"):x.codepage&&typeof Jh<"u"||(_=_t&&Buffer.isBuffer(m)?m.toString("binary"):Wo(m));break;case"array":_=nc(m);break;case"string":_=m;break;default:throw new Error("Unrecognized type "+x.type)}return y[0]==239&&y[1]==187&&y[2]==191?_=ir(_.slice(3)):x.type!="string"&&x.type!="buffer"&&x.codepage==65001?_=ir(_):x.type=="binary"&&typeof Jh<"u",_.slice(0,19)=="socialcalc:version:"?y3.to_sheet(x.type=="string"?_:ir(_),x):l(_,x)}function f(m,x){return Yo(u(m,x),x)}function d(m){for(var x=[],_=Ot(m["!ref"]),y,w=Array.isArray(m),T=_.s.r;T<=_.e.r;++T){for(var S=[],O=_.s.c;O<=_.e.c;++O){var U=at({r:T,c:O});if(y=w?(m[T]||[])[O]:m[U],!y||y.v==null){S.push("          ");continue}for(var R=(y.w||(Ps(y),y.w)||"").slice(0,10);R.length<10;)R+=" ";S.push(R+(O===0?" ":""))}x.push(S.join(""))}return x.join(`
`)}return{to_workbook:f,to_sheet:u,from_sheet:d}})();function MU(r,e){var t=e||{},n=!!t.WTF;t.WTF=!0;try{var a=v3.to_workbook(r,t);return t.WTF=n,a}catch(s){if(t.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Yu.to_workbook(r,e)}}var Hl=(function(){function r(N,J,X){if(N){yn(N,N.l||0);for(var ee=X.Enum||Ne;N.l<N.length;){var ce=N.read_shift(2),we=ee[ce]||ee[65535],De=N.read_shift(2),Ae=N.l+De,Oe=we.f&&we.f(N,De,X);if(N.l=Ae,J(Oe,we,ce))return}}}function e(N,J){switch(J.type){case"base64":return t(Ta(Ia(N)),J);case"binary":return t(Ta(N),J);case"buffer":case"array":return t(N,J)}throw"Unsupported type "+J.type}function t(N,J){if(!N)return N;var X=J||{},ee=X.dense?[]:{},ce="Sheet1",we="",De=0,Ae={},Oe=[],st=[],Z={s:{r:0,c:0},e:{r:0,c:0}},Ft=X.sheetRows||0;if(N[2]==0&&(N[3]==8||N[3]==9)&&N.length>=16&&N[14]==5&&N[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(N[2]==2)X.Enum=Ne,r(N,function(He,sr,Dt){switch(Dt){case 0:X.vers=He,He>=4096&&(X.qpro=!0);break;case 6:Z=He;break;case 204:He&&(we=He);break;case 222:we=He;break;case 15:case 51:X.qpro||(He[1].v=He[1].v.slice(1));case 13:case 14:case 16:Dt==14&&(He[2]&112)==112&&(He[2]&15)>1&&(He[2]&15)<15&&(He[1].z=X.dateNF||nt[14],X.cellDates&&(He[1].t="d",He[1].v=Qp(He[1].v))),X.qpro&&He[3]>De&&(ee["!ref"]=gt(Z),Ae[ce]=ee,Oe.push(ce),ee=X.dense?[]:{},Z={s:{r:0,c:0},e:{r:0,c:0}},De=He[3],ce=we||"Sheet"+(De+1),we="");var zt=X.dense?(ee[He[0].r]||[])[He[0].c]:ee[at(He[0])];if(zt){zt.t=He[1].t,zt.v=He[1].v,He[1].z!=null&&(zt.z=He[1].z),He[1].f!=null&&(zt.f=He[1].f);break}X.dense?(ee[He[0].r]||(ee[He[0].r]=[]),ee[He[0].r][He[0].c]=He[1]):ee[at(He[0])]=He[1];break}},X);else if(N[2]==26||N[2]==14)X.Enum=Q,N[2]==14&&(X.qpro=!0,N.l=0),r(N,function(He,sr,Dt){switch(Dt){case 204:ce=He;break;case 22:He[1].v=He[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(He[3]>De&&(ee["!ref"]=gt(Z),Ae[ce]=ee,Oe.push(ce),ee=X.dense?[]:{},Z={s:{r:0,c:0},e:{r:0,c:0}},De=He[3],ce="Sheet"+(De+1)),Ft>0&&He[0].r>=Ft)break;X.dense?(ee[He[0].r]||(ee[He[0].r]=[]),ee[He[0].r][He[0].c]=He[1]):ee[at(He[0])]=He[1],Z.e.c<He[0].c&&(Z.e.c=He[0].c),Z.e.r<He[0].r&&(Z.e.r=He[0].r);break;case 27:He[14e3]&&(st[He[14e3][0]]=He[14e3][1]);break;case 1537:st[He[0]]=He[1],He[0]==De&&(ce=He[1]);break}},X);else throw new Error("Unrecognized LOTUS BOF "+N[2]);if(ee["!ref"]=gt(Z),Ae[we||ce]=ee,Oe.push(we||ce),!st.length)return{SheetNames:Oe,Sheets:Ae};for(var lt={},Rt=[],ct=0;ct<st.length;++ct)Ae[Oe[ct]]?(Rt.push(st[ct]||Oe[ct]),lt[st[ct]]=Ae[st[ct]]||Ae[Oe[ct]]):(Rt.push(st[ct]),lt[st[ct]]={"!ref":"A1"});return{SheetNames:Rt,Sheets:lt}}function n(N,J){var X=J||{};if(+X.codepage>=0&&vi(+X.codepage),X.type=="string")throw new Error("Cannot write WK1 to JS string");var ee=aa(),ce=Ot(N["!ref"]),we=Array.isArray(N),De=[];Ue(ee,0,s(1030)),Ue(ee,6,f(ce));for(var Ae=Math.min(ce.e.r,8191),Oe=ce.s.r;Oe<=Ae;++Oe)for(var st=Lr(Oe),Z=ce.s.c;Z<=ce.e.c;++Z){Oe===ce.s.r&&(De[Z]=wr(Z));var Ft=De[Z]+st,lt=we?(N[Oe]||[])[Z]:N[Ft];if(!(!lt||lt.t=="z"))if(lt.t=="n")(lt.v|0)==lt.v&&lt.v>=-32768&&lt.v<=32767?Ue(ee,13,y(Oe,Z,lt.v)):Ue(ee,14,T(Oe,Z,lt.v));else{var Rt=Ps(lt);Ue(ee,15,x(Oe,Z,Rt.slice(0,239)))}}return Ue(ee,1),ee.end()}function a(N,J){var X=J||{};if(+X.codepage>=0&&vi(+X.codepage),X.type=="string")throw new Error("Cannot write WK3 to JS string");var ee=aa();Ue(ee,0,l(N));for(var ce=0,we=0;ce<N.SheetNames.length;++ce)(N.Sheets[N.SheetNames[ce]]||{})["!ref"]&&Ue(ee,27,ie(N.SheetNames[ce],we++));var De=0;for(ce=0;ce<N.SheetNames.length;++ce){var Ae=N.Sheets[N.SheetNames[ce]];if(!(!Ae||!Ae["!ref"])){for(var Oe=Ot(Ae["!ref"]),st=Array.isArray(Ae),Z=[],Ft=Math.min(Oe.e.r,8191),lt=Oe.s.r;lt<=Ft;++lt)for(var Rt=Lr(lt),ct=Oe.s.c;ct<=Oe.e.c;++ct){lt===Oe.s.r&&(Z[ct]=wr(ct));var He=Z[ct]+Rt,sr=st?(Ae[lt]||[])[ct]:Ae[He];if(!(!sr||sr.t=="z"))if(sr.t=="n")Ue(ee,23,V(lt,ct,De,sr.v));else{var Dt=Ps(sr);Ue(ee,22,A(lt,ct,De,Dt.slice(0,239)))}}++De}}return Ue(ee,1),ee.end()}function s(N){var J=ye(2);return J.write_shift(2,N),J}function l(N){var J=ye(26);J.write_shift(2,4096),J.write_shift(2,4),J.write_shift(4,0);for(var X=0,ee=0,ce=0,we=0;we<N.SheetNames.length;++we){var De=N.SheetNames[we],Ae=N.Sheets[De];if(!(!Ae||!Ae["!ref"])){++ce;var Oe=ia(Ae["!ref"]);X<Oe.e.r&&(X=Oe.e.r),ee<Oe.e.c&&(ee=Oe.e.c)}}return X>8191&&(X=8191),J.write_shift(2,X),J.write_shift(1,ce),J.write_shift(1,ee),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(1,1),J.write_shift(1,2),J.write_shift(4,0),J.write_shift(4,0),J}function u(N,J,X){var ee={s:{c:0,r:0},e:{c:0,r:0}};return J==8&&X.qpro?(ee.s.c=N.read_shift(1),N.l++,ee.s.r=N.read_shift(2),ee.e.c=N.read_shift(1),N.l++,ee.e.r=N.read_shift(2),ee):(ee.s.c=N.read_shift(2),ee.s.r=N.read_shift(2),J==12&&X.qpro&&(N.l+=2),ee.e.c=N.read_shift(2),ee.e.r=N.read_shift(2),J==12&&X.qpro&&(N.l+=2),ee.s.c==65535&&(ee.s.c=ee.e.c=ee.s.r=ee.e.r=0),ee)}function f(N){var J=ye(8);return J.write_shift(2,N.s.c),J.write_shift(2,N.s.r),J.write_shift(2,N.e.c),J.write_shift(2,N.e.r),J}function d(N,J,X){var ee=[{c:0,r:0},{t:"n",v:0},0,0];return X.qpro&&X.vers!=20768?(ee[0].c=N.read_shift(1),ee[3]=N.read_shift(1),ee[0].r=N.read_shift(2),N.l+=2):(ee[2]=N.read_shift(1),ee[0].c=N.read_shift(2),ee[0].r=N.read_shift(2)),ee}function m(N,J,X){var ee=N.l+J,ce=d(N,J,X);if(ce[1].t="s",X.vers==20768){N.l++;var we=N.read_shift(1);return ce[1].v=N.read_shift(we,"utf8"),ce}return X.qpro&&N.l++,ce[1].v=N.read_shift(ee-N.l,"cstr"),ce}function x(N,J,X){var ee=ye(7+X.length);ee.write_shift(1,255),ee.write_shift(2,J),ee.write_shift(2,N),ee.write_shift(1,39);for(var ce=0;ce<ee.length;++ce){var we=X.charCodeAt(ce);ee.write_shift(1,we>=128?95:we)}return ee.write_shift(1,0),ee}function _(N,J,X){var ee=d(N,J,X);return ee[1].v=N.read_shift(2,"i"),ee}function y(N,J,X){var ee=ye(7);return ee.write_shift(1,255),ee.write_shift(2,J),ee.write_shift(2,N),ee.write_shift(2,X,"i"),ee}function w(N,J,X){var ee=d(N,J,X);return ee[1].v=N.read_shift(8,"f"),ee}function T(N,J,X){var ee=ye(13);return ee.write_shift(1,255),ee.write_shift(2,J),ee.write_shift(2,N),ee.write_shift(8,X,"f"),ee}function S(N,J,X){var ee=N.l+J,ce=d(N,J,X);if(ce[1].v=N.read_shift(8,"f"),X.qpro)N.l=ee;else{var we=N.read_shift(2);Y(N.slice(N.l,N.l+we),ce),N.l+=we}return ce}function O(N,J,X){var ee=J&32768;return J&=-32769,J=(ee?N:0)+(J>=8192?J-16384:J),(ee?"":"$")+(X?wr(J):Lr(J))}var U={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},R=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function Y(N,J){yn(N,0);for(var X=[],ee=0,ce="",we="",De="",Ae="";N.l<N.length;){var Oe=N[N.l++];switch(Oe){case 0:X.push(N.read_shift(8,"f"));break;case 1:we=O(J[0].c,N.read_shift(2),!0),ce=O(J[0].r,N.read_shift(2),!1),X.push(we+ce);break;case 2:{var st=O(J[0].c,N.read_shift(2),!0),Z=O(J[0].r,N.read_shift(2),!1);we=O(J[0].c,N.read_shift(2),!0),ce=O(J[0].r,N.read_shift(2),!1),X.push(st+Z+":"+we+ce)}break;case 3:if(N.l<N.length){console.error("WK1 premature formula end");return}break;case 4:X.push("("+X.pop()+")");break;case 5:X.push(N.read_shift(2));break;case 6:{for(var Ft="";Oe=N[N.l++];)Ft+=String.fromCharCode(Oe);X.push('"'+Ft.replace(/"/g,'""')+'"')}break;case 8:X.push("-"+X.pop());break;case 23:X.push("+"+X.pop());break;case 22:X.push("NOT("+X.pop()+")");break;case 20:case 21:Ae=X.pop(),De=X.pop(),X.push(["AND","OR"][Oe-20]+"("+De+","+Ae+")");break;default:if(Oe<32&&R[Oe])Ae=X.pop(),De=X.pop(),X.push(De+R[Oe]+Ae);else if(U[Oe]){if(ee=U[Oe][1],ee==69&&(ee=N[N.l++]),ee>X.length){console.error("WK1 bad formula parse 0x"+Oe.toString(16)+":|"+X.join("|")+"|");return}var lt=X.slice(-ee);X.length-=ee,X.push(U[Oe][0]+"("+lt.join(",")+")")}else return Oe<=7?console.error("WK1 invalid opcode "+Oe.toString(16)):Oe<=24?console.error("WK1 unsupported op "+Oe.toString(16)):Oe<=30?console.error("WK1 invalid opcode "+Oe.toString(16)):Oe<=115?console.error("WK1 unsupported function opcode "+Oe.toString(16)):console.error("WK1 unrecognized opcode "+Oe.toString(16))}}X.length==1?J[1].f=""+X[0]:console.error("WK1 bad formula parse |"+X.join("|")+"|")}function te(N){var J=[{c:0,r:0},{t:"n",v:0},0];return J[0].r=N.read_shift(2),J[3]=N[N.l++],J[0].c=N[N.l++],J}function G(N,J){var X=te(N);return X[1].t="s",X[1].v=N.read_shift(J-4,"cstr"),X}function A(N,J,X,ee){var ce=ye(6+ee.length);ce.write_shift(2,N),ce.write_shift(1,X),ce.write_shift(1,J),ce.write_shift(1,39);for(var we=0;we<ee.length;++we){var De=ee.charCodeAt(we);ce.write_shift(1,De>=128?95:De)}return ce.write_shift(1,0),ce}function C(N,J){var X=te(N);X[1].v=N.read_shift(2);var ee=X[1].v>>1;if(X[1].v&1)switch(ee&7){case 0:ee=(ee>>3)*5e3;break;case 1:ee=(ee>>3)*500;break;case 2:ee=(ee>>3)/20;break;case 3:ee=(ee>>3)/200;break;case 4:ee=(ee>>3)/2e3;break;case 5:ee=(ee>>3)/2e4;break;case 6:ee=(ee>>3)/16;break;case 7:ee=(ee>>3)/64;break}return X[1].v=ee,X}function k(N,J){var X=te(N),ee=N.read_shift(4),ce=N.read_shift(4),we=N.read_shift(2);if(we==65535)return ee===0&&ce===3221225472?(X[1].t="e",X[1].v=15):ee===0&&ce===3489660928?(X[1].t="e",X[1].v=42):X[1].v=0,X;var De=we&32768;return we=(we&32767)-16446,X[1].v=(1-De*2)*(ce*Math.pow(2,we+32)+ee*Math.pow(2,we)),X}function V(N,J,X,ee){var ce=ye(14);if(ce.write_shift(2,N),ce.write_shift(1,X),ce.write_shift(1,J),ee==0)return ce.write_shift(4,0),ce.write_shift(4,0),ce.write_shift(2,65535),ce;var we=0,De=0,Ae=0,Oe=0;return ee<0&&(we=1,ee=-ee),De=Math.log2(ee)|0,ee/=Math.pow(2,De-31),Oe=ee>>>0,(Oe&2147483648)==0&&(ee/=2,++De,Oe=ee>>>0),ee-=Oe,Oe|=2147483648,Oe>>>=0,ee*=Math.pow(2,32),Ae=ee>>>0,ce.write_shift(4,Ae),ce.write_shift(4,Oe),De+=16383+(we?32768:0),ce.write_shift(2,De),ce}function F(N,J){var X=k(N);return N.l+=J-14,X}function M(N,J){var X=te(N),ee=N.read_shift(4);return X[1].v=ee>>6,X}function L(N,J){var X=te(N),ee=N.read_shift(8,"f");return X[1].v=ee,X}function Ie(N,J){var X=L(N);return N.l+=J-10,X}function Re(N,J){return N[N.l+J-1]==0?N.read_shift(J,"cstr"):""}function ae(N,J){var X=N[N.l++];X>J-1&&(X=J-1);for(var ee="";ee.length<X;)ee+=String.fromCharCode(N[N.l++]);return ee}function le(N,J,X){if(!(!X.qpro||J<21)){var ee=N.read_shift(1);N.l+=17,N.l+=1,N.l+=2;var ce=N.read_shift(J-21,"cstr");return[ee,ce]}}function Fe(N,J){for(var X={},ee=N.l+J;N.l<ee;){var ce=N.read_shift(2);if(ce==14e3){for(X[ce]=[0,""],X[ce][0]=N.read_shift(2);N[N.l];)X[ce][1]+=String.fromCharCode(N[N.l]),N.l++;N.l++}}return X}function ie(N,J){var X=ye(5+N.length);X.write_shift(2,14e3),X.write_shift(2,J);for(var ee=0;ee<N.length;++ee){var ce=N.charCodeAt(ee);X[X.l++]=ce>127?95:ce}return X[X.l++]=0,X}var Ne={0:{n:"BOF",f:Xr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:_},14:{n:"NUMBER",f:w},15:{n:"LABEL",f:m},16:{n:"FORMULA",f:S},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:m},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Re},222:{n:"SHEETNAMELP",f:ae},65535:{n:""}},Q={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:G},23:{n:"NUMBER17",f:k},24:{n:"NUMBER18",f:C},25:{n:"FORMULA19",f:F},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Fe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:M},38:{n:"??"},39:{n:"NUMBER27",f:L},40:{n:"FORMULA28",f:Ie},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Re},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:le},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:e}})();function PU(r){var e={},t=r.match(Pn),n=0,a=!1;if(t)for(;n!=t.length;++n){var s=it(t[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=B_[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return e}var LU=(function(){var r=t0("t"),e=t0("rPr");function t(s){var l=s.match(r);if(!l)return{t:"s",v:""};var u={t:"s",v:Nt(l[1])},f=s.match(e);return f&&(u.s=PU(f[1])),u}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(l){return l.replace(n,"").split(a).map(t).filter(function(u){return u.v})}})(),VU=(function(){var e=/(\r\n|\n)/g;function t(a,s,l){var u=[];a.u&&u.push("text-decoration: underline;"),a.uval&&u.push("text-underline-style:"+a.uval+";"),a.sz&&u.push("font-size:"+a.sz+"pt;"),a.outline&&u.push("text-effect: outline;"),a.shadow&&u.push("text-shadow: auto;"),s.push('<span style="'+u.join("")+'">'),a.b&&(s.push("<b>"),l.push("</b>")),a.i&&(s.push("<i>"),l.push("</i>")),a.strike&&(s.push("<s>"),l.push("</s>"));var f=a.valign||"";return f=="superscript"||f=="super"?f="sup":f=="subscript"&&(f="sub"),f!=""&&(s.push("<"+f+">"),l.push("</"+f+">")),l.push("</span>"),a}function n(a){var s=[[],a.v,[]];return a.v?(a.s&&t(a.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}})(),BU=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,UU=/<(?:\w+:)?r>/,zU=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function cy(r,e){var t=e?e.cellHTML:!0,n={};return r?(r.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Nt(ir(r.slice(r.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=ir(r),t&&(n.h=Y_(n.t))):r.match(UU)&&(n.r=ir(r),n.t=Nt(ir((r.replace(zU,"").match(BU)||[]).join("").replace(Pn,""))),t&&(n.h=VU(LU(n.r)))),n):{t:""}}var jU=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,HU=/<(?:\w+:)?(?:si|sstItem)>/g,GU=/<\/(?:\w+:)?(?:si|sstItem)>/;function qU(r,e){var t=[],n="";if(!r)return t;var a=r.match(jU);if(a){n=a[2].replace(HU,"").split(GU);for(var s=0;s!=n.length;++s){var l=cy(n[s].trim(),e);l!=null&&(t[t.length]=l)}a=it(a[1]),t.Count=a.count,t.Unique=a.uniqueCount}return t}var KU=/^\s|\s$|[\t\n\r]/;function T3(r,e){if(!e.bookSST)return"";var t=[Vr];t[t.length]=Be("sst",null,{xmlns:dc[0],count:r.Count,uniqueCount:r.Unique});for(var n=0;n!=r.length;++n)if(r[n]!=null){var a=r[n],s="<si>";a.r?s+=a.r:(s+="<t",a.t||(a.t=""),a.t.match(KU)&&(s+=' xml:space="preserve"'),s+=">"+Qt(a.t)+"</t>"),s+="</si>",t[t.length]=s}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function XU(r){return[r.read_shift(4),r.read_shift(4)]}function WU(r,e){var t=[],n=!1;return Bs(r,function(s,l,u){switch(u){case 159:t.Count=s[0],t.Unique=s[1];break;case 19:t.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(l.T,!n||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),t}function YU(r,e){return e||(e=ye(8)),e.write_shift(4,r.Count),e.write_shift(4,r.Unique),e}var $U=sV;function QU(r){var e=aa();Ce(e,159,YU(r));for(var t=0;t<r.length;++t)Ce(e,19,$U(r[t]));return Ce(e,160),e.end()}function E3(r){for(var e=[],t=r.split(""),n=0;n<t.length;++n)e[n]=t[n].charCodeAt(0);return e}function Ds(r,e){var t={};return t.Major=r.read_shift(2),t.Minor=r.read_shift(2),e>=4&&(r.l+=e-4),t}function JU(r){var e={};return e.id=r.read_shift(0,"lpp4"),e.R=Ds(r,4),e.U=Ds(r,4),e.W=Ds(r,4),e}function ZU(r){for(var e=r.read_shift(4),t=r.l+e-4,n={},a=r.read_shift(4),s=[];a-- >0;)s.push({t:r.read_shift(4),v:r.read_shift(0,"lpp4")});if(n.name=r.read_shift(0,"lpp4"),n.comps=s,r.l!=t)throw new Error("Bad DataSpaceMapEntry: "+r.l+" != "+t);return n}function ez(r){var e=[];r.l+=4;for(var t=r.read_shift(4);t-- >0;)e.push(ZU(r));return e}function tz(r){var e=[];r.l+=4;for(var t=r.read_shift(4);t-- >0;)e.push(r.read_shift(0,"lpp4"));return e}function rz(r){var e={};return r.read_shift(4),r.l+=4,e.id=r.read_shift(0,"lpp4"),e.name=r.read_shift(0,"lpp4"),e.R=Ds(r,4),e.U=Ds(r,4),e.W=Ds(r,4),e}function nz(r){var e=rz(r);if(e.ename=r.read_shift(0,"8lpp4"),e.blksz=r.read_shift(4),e.cmode=r.read_shift(4),r.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function w3(r,e){var t=r.l+e,n={};n.Flags=r.read_shift(4)&63,r.l+=4,n.AlgID=r.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=r.read_shift(4),n.KeySize=r.read_shift(4),n.ProviderType=r.read_shift(4),r.l+=8,n.CSPName=r.read_shift(t-r.l>>1,"utf16le"),r.l=t,n}function S3(r,e){var t={},n=r.l+e;return r.l+=4,t.Salt=r.slice(r.l,r.l+16),r.l+=16,t.Verifier=r.slice(r.l,r.l+16),r.l+=16,r.read_shift(4),t.VerifierHash=r.slice(r.l,n),r.l=n,t}function az(r){var e=Ds(r);switch(e.Minor){case 2:return[e.Minor,iz(r)];case 3:return[e.Minor,sz()];case 4:return[e.Minor,oz(r)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function iz(r){var e=r.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var t=r.read_shift(4),n=w3(r,t),a=S3(r,r.length-r.l);return{t:"Std",h:n,v:a}}function sz(){throw new Error("File is password-protected: ECMA-376 Extensible")}function oz(r){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];r.l+=4;var t=r.read_shift(r.length-r.l,"utf8"),n={};return t.replace(Pn,function(s){var l=it(s);switch(Yi(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(u){n[u]=l[u]});break;case"<dataIntegrity":n.encryptedHmacKey=l.encryptedHmacKey,n.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(l);break;default:throw l[0]}}),n}function lz(r,e){var t={},n=t.EncryptionVersionInfo=Ds(r,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);t.Flags=r.read_shift(4),e-=4;var a=r.read_shift(4);return e-=4,t.EncryptionHeader=w3(r,a),e-=a,t.EncryptionVerifier=S3(r,e),t}function cz(r){var e={},t=e.EncryptionVersionInfo=Ds(r,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return e.Salt=r.read_shift(16),e.EncryptedVerifier=r.read_shift(16),e.EncryptedVerifierHash=r.read_shift(16),e}function uy(r){var e=0,t,n=E3(r),a=n.length+1,s,l,u,f,d;for(t=jo(a),t[0]=n.length,s=1;s!=a;++s)t[s]=n[s-1];for(s=a-1;s>=0;--s)l=t[s],u=(e&16384)===0?0:1,f=e<<1&32767,d=u|f,e=d^l;return e^52811}var A3=(function(){var r=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(l){return(l/2|l*128)&255},a=function(l,u){return n(l^u)},s=function(l){for(var u=e[l.length-1],f=104,d=l.length-1;d>=0;--d)for(var m=l[d],x=0;x!=7;++x)m&64&&(u^=t[f]),m*=2,--f;return u};return function(l){for(var u=E3(l),f=s(u),d=u.length,m=jo(16),x=0;x!=16;++x)m[x]=0;var _,y,w;for((d&1)===1&&(_=f>>8,m[d]=a(r[0],_),--d,_=f&255,y=u[u.length-1],m[d]=a(y,_));d>0;)--d,_=f>>8,m[d]=a(u[d],_),--d,_=f&255,m[d]=a(u[d],_);for(d=15,w=15-u.length;w>0;)_=f>>8,m[d]=a(r[w],_),--d,--w,_=f&255,m[d]=a(u[d],_),--d,--w;return m}})(),uz=function(r,e,t,n,a){a||(a=e),n||(n=A3(r));var s,l;for(s=0;s!=e.length;++s)l=e[s],l^=n[t],l=(l>>5|l<<3)&255,a[s]=l,++t;return[a,t,n]},fz=function(r){var e=0,t=A3(r);return function(n){var a=uz("",n,e,t);return e=a[1],a[0]}};function hz(r,e,t,n){var a={key:Xr(r),verificationBytes:Xr(r)};return t.password&&(a.verifier=uy(t.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=fz(t.password)),a}function dz(r,e,t){var n=t||{};return n.Info=r.read_shift(2),r.l-=2,n.Info===1?n.Data=cz(r):n.Data=lz(r,e),n}function mz(r,e,t){var n={Type:t.biff>=8?r.read_shift(2):0};return n.Type?dz(r,e-2,n):hz(r,t.biff>=8?e:e-2,t,n),n}var b3=(function(){function r(a,s){switch(s.type){case"base64":return e(Ia(a),s);case"binary":return e(a,s);case"buffer":return e(_t&&Buffer.isBuffer(a)?a.toString("binary"):Wo(a),s);case"array":return e(nc(a),s)}throw new Error("Unrecognized type "+s.type)}function e(a,s){var l=s||{},u=l.dense?[]:{},f=a.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(m,x){Array.isArray(u)&&(u[x]=[]);for(var _=/\\\w+\b/g,y=0,w,T=-1;w=_.exec(m);){switch(w[0]){case"\\cell":var S=m.slice(y,_.lastIndex-w[0].length);if(S[0]==" "&&(S=S.slice(1)),++T,S.length){var O={v:S,t:"s"};Array.isArray(u)?u[x][T]=O:u[at({r:x,c:T})]=O}break}y=_.lastIndex}T>d.e.c&&(d.e.c=T)}),u["!ref"]=gt(d),u}function t(a,s){return Yo(r(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],l=Ot(a["!ref"]),u,f=Array.isArray(a),d=l.s.r;d<=l.e.r;++d){s.push("\\trowd\\trautofit1");for(var m=l.s.c;m<=l.e.c;++m)s.push("\\cellx"+(m+1));for(s.push("\\pard\\intbl"),m=l.s.c;m<=l.e.c;++m){var x=at({r:d,c:m});u=f?(a[d]||[])[m]:a[x],!(!u||u.v==null&&(!u.f||u.F))&&(s.push(" "+(u.w||(Ps(u),u.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:t,to_sheet:r,from_sheet:n}})();function pz(r){var e=r.slice(r[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function i0(r){for(var e=0,t=1;e!=3;++e)t=t*256+(r[e]>255?255:r[e]<0?0:r[e]);return t.toString(16).toUpperCase().slice(1)}function gz(r){var e=r[0]/255,t=r[1]/255,n=r[2]/255,a=Math.max(e,t,n),s=Math.min(e,t,n),l=a-s;if(l===0)return[0,0,e];var u=0,f=0,d=a+s;switch(f=l/(d>1?2-d:d),a){case e:u=((t-n)/l+6)%6;break;case t:u=(n-e)/l+2;break;case n:u=(e-t)/l+4;break}return[u/6,f,d/2]}function xz(r){var e=r[0],t=r[1],n=r[2],a=t*2*(n<.5?n:1-n),s=n-a/2,l=[s,s,s],u=6*e,f;if(t!==0)switch(u|0){case 0:case 6:f=a*u,l[0]+=a,l[1]+=f;break;case 1:f=a*(2-u),l[0]+=f,l[1]+=a;break;case 2:f=a*(u-2),l[1]+=a,l[2]+=f;break;case 3:f=a*(4-u),l[1]+=f,l[2]+=a;break;case 4:f=a*(u-4),l[2]+=a,l[0]+=f;break;case 5:f=a*(6-u),l[2]+=f,l[0]+=a;break}for(var d=0;d!=3;++d)l[d]=Math.round(l[d]*255);return l}function vp(r,e){if(e===0)return r;var t=gz(pz(r));return e<0?t[2]=t[2]*(1+e):t[2]=1-(1-t[2])*(1-e),i0(xz(t))}var I3=6,vz=15,_z=1,Rn=I3;function s0(r){return Math.floor((r+Math.round(128/Rn)/256)*Rn)}function o0(r){return Math.floor((r-5)/Rn*100+.5)/100}function _p(r){return Math.round((r*Rn+5)/Rn*256)/256}function wx(r){return _p(o0(s0(r)))}function fy(r){var e=Math.abs(r-wx(r)),t=Rn;if(e>.005)for(Rn=_z;Rn<vz;++Rn)Math.abs(r-wx(r))<=e&&(e=Math.abs(r-wx(r)),t=Rn);Rn=t}function Ho(r){r.width?(r.wpx=s0(r.width),r.wch=o0(r.wpx),r.MDW=Rn):r.wpx?(r.wch=o0(r.wpx),r.width=_p(r.wch),r.MDW=Rn):typeof r.wch=="number"&&(r.width=_p(r.wch),r.wpx=s0(r.width),r.MDW=Rn),r.customWidth&&delete r.customWidth}var yz=96,k3=yz;function l0(r){return r*96/k3}function $u(r){return r*k3/96}var Tz={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Ez(r,e,t,n){e.Borders=[];var a={},s=!1;(r[0].match(Pn)||[]).forEach(function(l){var u=it(l);switch(Yi(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},u.diagonalUp&&(a.diagonalUp=dr(u.diagonalUp)),u.diagonalDown&&(a.diagonalDown=dr(u.diagonalDown)),e.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+u[0]+" in borders")}})}function wz(r,e,t,n){e.Fills=[];var a={},s=!1;(r[0].match(Pn)||[]).forEach(function(l){var u=it(l);switch(Yi(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},e.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":u.patternType&&(a.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),u.indexed&&(a.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(a.bgColor.theme=parseInt(u.theme,10)),u.tint&&(a.bgColor.tint=parseFloat(u.tint)),u.rgb&&(a.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),u.theme&&(a.fgColor.theme=parseInt(u.theme,10)),u.tint&&(a.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(a.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+u[0]+" in fills")}})}function Sz(r,e,t,n){e.Fonts=[];var a={},s=!1;(r[0].match(Pn)||[]).forEach(function(l){var u=it(l);switch(Yi(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(a),a={};break;case"<name":u.val&&(a.name=ir(u.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=u.val?dr(u.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=u.val?dr(u.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(u.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=u.val?dr(u.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=u.val?dr(u.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=u.val?dr(u.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=u.val?dr(u.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=u.val?dr(u.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":u.val&&(a.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(a.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(a.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(a.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=B_[parseInt(u.val,10)];break;case"<color":if(a.color||(a.color={}),u.auto&&(a.color.auto=dr(u.auto)),u.rgb)a.color.rgb=u.rgb.slice(-6);else if(u.indexed){a.color.index=parseInt(u.indexed,10);var f=zl[a.color.index];a.color.index==81&&(f=zl[1]),f||(f=zl[1]),a.color.rgb=f[0].toString(16)+f[1].toString(16)+f[2].toString(16)}else u.theme&&(a.color.theme=parseInt(u.theme,10),u.tint&&(a.color.tint=parseFloat(u.tint)),u.theme&&t.themeElements&&t.themeElements.clrScheme&&(a.color.rgb=vp(t.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+u[0]+" in fonts")}})}function Az(r,e,t){e.NumberFmt=[];for(var n=Nr(nt),a=0;a<n.length;++a)e.NumberFmt[n[a]]=nt[n[a]];var s=r[0].match(Pn);if(s)for(a=0;a<s.length;++a){var l=it(s[a]);switch(Yi(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=Nt(ir(l.formatCode)),f=parseInt(l.numFmtId,10);if(e.NumberFmt[f]=u,f>0){if(f>392){for(f=392;f>60&&e.NumberFmt[f]!=null;--f);e.NumberFmt[f]=u}Rs(u,f)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function bz(r){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var n=t[0];n<=t[1];++n)r[n]!=null&&(e[e.length]=Be("numFmt",null,{numFmtId:n,formatCode:Qt(r[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Be("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var dm=["numFmtId","fillId","fontId","borderId","xfId"],mm=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Iz(r,e,t){e.CellXf=[];var n,a=!1;(r[0].match(Pn)||[]).forEach(function(s){var l=it(s),u=0;switch(Yi(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=l,delete n[0],u=0;u<dm.length;++u)n[dm[u]]&&(n[dm[u]]=parseInt(n[dm[u]],10));for(u=0;u<mm.length;++u)n[mm[u]]&&(n[mm[u]]=dr(n[mm[u]]));if(e.NumberFmt&&n.numFmtId>392){for(u=392;u>60;--u)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[u]){n.numFmtId=u;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var f={};l.vertical&&(f.vertical=l.vertical),l.horizontal&&(f.horizontal=l.horizontal),l.textRotation!=null&&(f.textRotation=l.textRotation),l.indent&&(f.indent=l.indent),l.wrapText&&(f.wrapText=dr(l.wrapText)),n.alignment=f;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(t&&t.WTF&&!a)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function kz(r){var e=[];return e[e.length]=Be("cellXfs",null),r.forEach(function(t){e[e.length]=Be("xf",null,t)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Be("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var Cz=(function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,f,d){var m={};if(!u)return m;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var x;return(x=u.match(e))&&Az(x,m,d),(x=u.match(a))&&Sz(x,m,f,d),(x=u.match(n))&&wz(x,m,f,d),(x=u.match(s))&&Ez(x,m,f,d),(x=u.match(t))&&Iz(x,m,d),m}})();function C3(r,e){var t=[Vr,Be("styleSheet",null,{xmlns:dc[0],"xmlns:vt":Qr.vt})],n;return r.SSF&&(n=bz(r.SSF))!=null&&(t[t.length]=n),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=kz(e.cellXfs))&&(t[t.length]=n),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function Rz(r,e){var t=r.read_shift(2),n=On(r);return[t,n]}function Dz(r,e,t){t||(t=ye(6+4*e.length)),t.write_shift(2,r),cn(e,t);var n=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),n}function Nz(r,e,t){var n={};n.sz=r.read_shift(2)/20;var a=dV(r);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=r.read_shift(2);switch(s===700&&(n.bold=1),r.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var l=r.read_shift(1);l!=0&&(n.underline=l);var u=r.read_shift(1);u>0&&(n.family=u);var f=r.read_shift(1);switch(f>0&&(n.charset=f),r.l++,n.color=hV(r),r.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=On(r),n}function Oz(r,e){e||(e=ye(153)),e.write_shift(2,r.sz*20),mV(r,e),e.write_shift(2,r.bold?700:400);var t=0;r.vertAlign=="superscript"?t=1:r.vertAlign=="subscript"&&(t=2),e.write_shift(2,t),e.write_shift(1,r.underline||0),e.write_shift(1,r.family||0),e.write_shift(1,r.charset||0),e.write_shift(1,0),pp(r.color,e);var n=0;return n=2,e.write_shift(1,n),cn(r.name,e),e.length>e.l?e.slice(0,e.l):e}var Fz=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Sx,Mz=Mn;function eb(r,e){e||(e=ye(84)),Sx||(Sx=Yp(Fz));var t=Sx[r.patternType];t==null&&(t=40),e.write_shift(4,t);var n=0;if(t!=40)for(pp({auto:1},e),pp({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function Pz(r,e){var t=r.l+e,n=r.read_shift(2),a=r.read_shift(2);return r.l=t,{ixfe:n,numFmtId:a}}function R3(r,e,t){t||(t=ye(16)),t.write_shift(2,e||0),t.write_shift(2,r.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var n=0;return t.write_shift(1,n),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function fh(r,e){return e||(e=ye(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var Lz=Mn;function Vz(r,e){return e||(e=ye(51)),e.write_shift(1,0),fh(null,e),fh(null,e),fh(null,e),fh(null,e),fh(null,e),e.length>e.l?e.slice(0,e.l):e}function Bz(r,e){return e||(e=ye(52)),e.write_shift(4,r.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),mp(r.name||"",e),e.length>e.l?e.slice(0,e.l):e}function Uz(r,e,t){var n=ye(2052);return n.write_shift(4,r),mp(e,n),mp(t,n),n.length>n.l?n.slice(0,n.l):n}function zz(r,e,t){var n={};n.NumberFmt=[];for(var a in nt)n.NumberFmt[a]=nt[a];n.CellXf=[],n.Fonts=[];var s=[],l=!1;return Bs(r,function(f,d,m){switch(m){case 44:n.NumberFmt[f[0]]=f[1],Rs(f[1],f[0]);break;case 43:n.Fonts.push(f),f.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(f.color.rgb=vp(e.themeElements.clrScheme[f.color.theme].rgb,f.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(f);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:s.push(m),l=!0;break;case 38:s.pop(),l=!1;break;default:if(d.T>0)s.push(m);else if(d.T<0)s.pop();else if(!l||t.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+m.toString(16))}}),n}function jz(r,e){if(e){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&++t}),t!=0&&(Ce(r,615,Ei(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&Ce(r,44,Dz(a,e[a]))}),Ce(r,616))}}function Hz(r){var e=1;Ce(r,611,Ei(e)),Ce(r,43,Oz({sz:12,color:{theme:1},name:"Calibri",family:2})),Ce(r,612)}function Gz(r){var e=2;Ce(r,603,Ei(e)),Ce(r,45,eb({patternType:"none"})),Ce(r,45,eb({patternType:"gray125"})),Ce(r,604)}function qz(r){var e=1;Ce(r,613,Ei(e)),Ce(r,46,Vz()),Ce(r,614)}function Kz(r){var e=1;Ce(r,626,Ei(e)),Ce(r,47,R3({numFmtId:0},65535)),Ce(r,627)}function Xz(r,e){Ce(r,617,Ei(e.length)),e.forEach(function(t){Ce(r,47,R3(t,0))}),Ce(r,618)}function Wz(r){var e=1;Ce(r,619,Ei(e)),Ce(r,48,Bz({xfId:0,name:"Normal"})),Ce(r,620)}function Yz(r){var e=0;Ce(r,505,Ei(e)),Ce(r,506)}function $z(r){var e=0;Ce(r,508,Uz(e,"TableStyleMedium9","PivotStyleMedium4")),Ce(r,509)}function Qz(r,e){var t=aa();return Ce(t,278),jz(t,r.SSF),Hz(t),Gz(t),qz(t),Kz(t),Xz(t,e.cellXfs),Wz(t),Yz(t),$z(t),Ce(t,279),t.end()}var Jz=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Zz(r,e,t){e.themeElements.clrScheme=[];var n={};(r[0].match(Pn)||[]).forEach(function(a){var s=it(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[Jz.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function ej(){}function tj(){}var rj=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,nj=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,aj=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function ij(r,e,t){e.themeElements={};var n;[["clrScheme",rj,Zz],["fontScheme",nj,ej],["fmtScheme",aj,tj]].forEach(function(a){if(!(n=r.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,e,t)})}var sj=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function D3(r,e){(!r||r.length===0)&&(r=hy());var t,n={};if(!(t=r.match(sj)))throw new Error("themeElements not found in theme");return ij(t[0],n,e),n.raw=r,n}function hy(r,e){if(e&&e.themeXLSX)return e.themeXLSX;if(r&&typeof r.raw=="string")return r.raw;var t=[Vr];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function oj(r,e,t){var n=r.l+e,a=r.read_shift(4);if(a!==124226){if(!t.cellStyles){r.l=n;return}var s=r.slice(r.l);r.l=n;var l;try{l=wC(s,{type:"array"})}catch{return}var u=Ea(l,"theme/theme/theme1.xml",!0);if(u)return D3(u,t)}}function lj(r){return r.read_shift(4)}function cj(r){var e={};switch(e.xclrType=r.read_shift(2),e.nTintShade=r.read_shift(2),e.xclrType){case 0:r.l+=4;break;case 1:e.xclrValue=uj(r,4);break;case 2:e.xclrValue=u3(r);break;case 3:e.xclrValue=lj(r);break;case 4:r.l+=4;break}return r.l+=8,e}function uj(r,e){return Mn(r,e)}function fj(r,e){return Mn(r,e)}function hj(r){var e=r.read_shift(2),t=r.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=cj(r);break;case 6:n[1]=fj(r,t);break;case 14:case 15:n[1]=r.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+t)}return n}function dj(r,e){var t=r.l+e;r.l+=2;var n=r.read_shift(2);r.l+=2;for(var a=r.read_shift(2),s=[];a-- >0;)s.push(hj(r,t-r.l));return{ixfe:n,ext:s}}function mj(r,e){e.forEach(function(t){t[0]})}function pj(r,e){return{flags:r.read_shift(4),version:r.read_shift(4),name:On(r)}}function gj(r){var e=ye(12+2*r.name.length);return e.write_shift(4,r.flags),e.write_shift(4,r.version),cn(r.name,e),e.slice(0,e.l)}function xj(r){for(var e=[],t=r.read_shift(4);t-- >0;)e.push([r.read_shift(4),r.read_shift(4)]);return e}function vj(r){var e=ye(4+8*r.length);e.write_shift(4,r.length);for(var t=0;t<r.length;++t)e.write_shift(4,r[t][0]),e.write_shift(4,r[t][1]);return e}function _j(r,e){var t=ye(8+2*e.length);return t.write_shift(4,r),cn(e,t),t.slice(0,t.l)}function yj(r){return r.l+=4,r.read_shift(4)!=0}function Tj(r,e){var t=ye(8);return t.write_shift(4,r),t.write_shift(4,1),t}function Ej(r,e,t){var n={Types:[],Cell:[],Value:[]},a=t||{},s=[],l=!1,u=2;return Bs(r,function(f,d,m){switch(m){case 335:n.Types.push({name:f.name});break;case 51:f.forEach(function(x){u==1?n.Cell.push({type:n.Types[x[0]-1].name,index:x[1]}):u==0&&n.Value.push({type:n.Types[x[0]-1].name,index:x[1]})});break;case 337:u=f?1:0;break;case 338:u=2;break;case 35:s.push(m),l=!0;break;case 36:s.pop(),l=!1;break;default:if(!d.T){if(!l||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}}),n}function wj(){var r=aa();return Ce(r,332),Ce(r,334,Ei(1)),Ce(r,335,gj({name:"XLDAPR",version:12e4,flags:3496657072})),Ce(r,336),Ce(r,339,_j(1,"XLDAPR")),Ce(r,52),Ce(r,35,Ei(514)),Ce(r,4096,Ei(0)),Ce(r,4097,Xa(1)),Ce(r,36),Ce(r,53),Ce(r,340),Ce(r,337,Tj(1)),Ce(r,51,vj([[1,0]])),Ce(r,338),Ce(r,333),r.end()}function Sj(r,e,t){var n={Types:[],Cell:[],Value:[]};if(!r)return n;var a=!1,s=2,l;return r.replace(Pn,function(u){var f=it(u);switch(Yi(f[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:f.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<n.Types.length;++d)n.Types[d].name==f.name&&(l=n.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[f.t-1].name,index:+f.v}):s==0&&n.Value.push({type:n.Types[f.t-1].name,index:+f.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+f.i);break;default:if(!a&&t.WTF)throw new Error("unrecognized "+f[0]+" in metadata")}return u}),n}function N3(){var r=[Vr];return r.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),r.join("")}function Aj(r){var e=[];if(!r)return e;var t=1;return(r.match(Pn)||[]).forEach(function(n){var a=it(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?t=a.i:a.i=t,e.push(a);break}}),e}function bj(r){var e={};e.i=r.read_shift(4);var t={};t.r=r.read_shift(4),t.c=r.read_shift(4),e.r=at(t);var n=r.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function Ij(r,e,t){var n=[];return Bs(r,function(s,l,u){switch(u){case 63:n.push(s);break;default:if(!l.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function kj(r,e,t,n){if(!r)return r;var a=n||{},s=!1;Bs(r,function(u,f,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!f.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},a)}function Cj(r,e){if(!r)return"??";var t=(r.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][t].Target}var Tu=1024;function O3(r,e){for(var t=[21600,21600],n=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),a=[Be("xml",null,{"xmlns:v":_a.v,"xmlns:o":_a.o,"xmlns:x":_a.x,"xmlns:mv":_a.mv}).replace(/\/>/,">"),Be("o:shapelayout",Be("o:idmap",null,{"v:ext":"edit",data:r}),{"v:ext":"edit"}),Be("v:shapetype",[Be("v:stroke",null,{joinstyle:"miter"}),Be("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:n})];Tu<r*1e3;)Tu+=1e3;return e.forEach(function(s){var l=Sr(s[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var f=u.type=="gradient"?Be("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=Be("v:fill",f,u),m={on:"t",obscured:"t"};++Tu,a=a.concat(["<v:shape"+r0({id:"_x0000_s"+Tu,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,Be("v:shadow",null,m),Be("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Tn("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),Tn("x:AutoFill","False"),Tn("x:Row",String(l.r)),Tn("x:Column",String(l.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function tb(r,e,t,n){var a=Array.isArray(r),s;e.forEach(function(l){var u=Sr(l.ref);if(a?(r[u.r]||(r[u.r]=[]),s=r[u.r][u.c]):s=r[l.ref],!s){s={t:"z"},a?r[u.r][u.c]=s:r[l.ref]=s;var f=Ot(r["!ref"]||"BDWGO1000001:A1");f.s.r>u.r&&(f.s.r=u.r),f.e.r<u.r&&(f.e.r=u.r),f.s.c>u.c&&(f.s.c=u.c),f.e.c<u.c&&(f.e.c=u.c);var d=gt(f);d!==r["!ref"]&&(r["!ref"]=d)}s.c||(s.c=[]);var m={a:l.author,t:l.t,r:l.r,T:t};l.h&&(m.h=l.h);for(var x=s.c.length-1;x>=0;--x){if(!t&&s.c[x].T)return;t&&!s.c[x].T&&s.c.splice(x,1)}if(t&&n){for(x=0;x<n.length;++x)if(m.a==n[x].id){m.a=n[x].name||m.a;break}}s.c.push(m)})}function Rj(r,e){if(r.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],n=[],a=r.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var u=l.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&t.push(u[1])}});var s=r.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var u=l.match(/<(?:\w+:)?comment[^>]*>/);if(u){var f=it(u[0]),d={author:f.authorId&&t[f.authorId]||"sheetjsghost",ref:f.ref,guid:f.guid},m=Sr(f.ref);if(!(e.sheetRows&&e.sheetRows<=m.r)){var x=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),_=!!x&&!!x[1]&&cy(x[1])||{r:"",t:"",h:""};d.r=_.r,_.r=="<t></t>"&&(_.t=_.h=""),d.t=(_.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(d.h=_.h),n.push(d)}}}}),n}function F3(r){var e=[Vr,Be("comments",null,{xmlns:dc[0]})],t=[];return e.push("<authors>"),r.forEach(function(n){n[1].forEach(function(a){var s=Qt(a.a);t.indexOf(s)==-1&&(t.push(s),e.push("<author>"+s+"</author>")),a.T&&a.ID&&t.indexOf("tc="+a.ID)==-1&&(t.push("tc="+a.ID),e.push("<author>tc="+a.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),r.forEach(function(n){var a=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=t.indexOf("tc="+n[1][0].ID):n[1].forEach(function(f){f.a&&(a=t.indexOf(Qt(f.a))),s.push(f.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),s.length<=1)e.push(Tn("t",Qt(s[0]||"")));else{for(var l=`Comment:
    `+s[0]+`
`,u=1;u<s.length;++u)l+=`Reply:
    `+s[u]+`
`;e.push(Tn("t",Qt(l)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function Dj(r,e){var t=[],n=!1,a={},s=0;return r.replace(Pn,function(u,f){var d=it(u);switch(Yi(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":a.t!=null&&t.push(a);break;case"<text>":case"<text":s=f+u.length;break;case"</text>":a.t=r.slice(s,f).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return u}),t}function Nj(r,e,t){var n=[Vr,Be("ThreadedComments",null,{xmlns:Qr.TCMNT}).replace(/[\/]>/,">")];return r.forEach(function(a){var s="";(a[1]||[]).forEach(function(l,u){if(!l.T){delete l.ID;return}l.a&&e.indexOf(l.a)==-1&&e.push(l.a);var f={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};u==0?s=f.id:f.parentId=s,l.ID=f.id,l.a&&(f.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(l.a)).slice(-12)+"}"),n.push(Be("threadedComment",Tn("text",l.t||""),f))})}),n.push("</ThreadedComments>"),n.join("")}function Oj(r,e){var t=[],n=!1;return r.replace(Pn,function(s){var l=it(s);switch(Yi(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return s}),t}function Fj(r){var e=[Vr,Be("personList",null,{xmlns:Qr.TCMNT,"xmlns:x":dc[0]}).replace(/[\/]>/,">")];return r.forEach(function(t,n){e.push(Be("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:t,providerId:"None"}))}),e.push("</personList>"),e.join("")}function Mj(r){var e={};e.iauthor=r.read_shift(4);var t=xc(r);return e.rfx=t.s,e.ref=at(t.s),r.l+=16,e}function Pj(r,e){return e==null&&(e=ye(36)),e.write_shift(4,r[1].iauthor),lf(r[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var Lj=On;function Vj(r){return cn(r.slice(0,54))}function Bj(r,e){var t=[],n=[],a={},s=!1;return Bs(r,function(u,f,d){switch(d){case 632:n.push(u);break;case 635:a=u;break;case 637:a.t=u.t,a.h=u.h,a.r=u.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,e.sheetRows&&a.rfx&&e.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,t.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!f.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),t}function Uj(r){var e=aa(),t=[];return Ce(e,628),Ce(e,630),r.forEach(function(n){n[1].forEach(function(a){t.indexOf(a.a)>-1||(t.push(a.a.slice(0,54)),Ce(e,632,Vj(a.a)))})}),Ce(e,631),Ce(e,633),r.forEach(function(n){n[1].forEach(function(a){a.iauthor=t.indexOf(a.a);var s={s:Sr(n[0]),e:Sr(n[0])};Ce(e,635,Pj([s,a])),a.t&&a.t.length>0&&Ce(e,637,lV(a)),Ce(e,636),delete a.iauthor})}),Ce(e,634),Ce(e,629),e.end()}var zj="application/vnd.ms-office.vbaProject";function jj(r){var e=et.utils.cfb_new({root:"R"});return r.FullPaths.forEach(function(t,n){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var a=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");et.utils.cfb_add(e,a,r.FileIndex[n].content)}}),et.write(e)}function Hj(r,e){e.FullPaths.forEach(function(t,n){if(n!=0){var a=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&et.utils.cfb_add(r,a,e.FileIndex[n].content)}})}var M3=["xlsb","xlsm","xlam","biff8","xla"];function Gj(){return{"!type":"dialog"}}function qj(){return{"!type":"dialog"}}function Kj(){return{"!type":"macro"}}function Xj(){return{"!type":"macro"}}var Ru=(function(){var r=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(n,a,s,l){var u=!1,f=!1;s.length==0?f=!0:s.charAt(0)=="["&&(f=!0,s=s.slice(1,-1)),l.length==0?u=!0:l.charAt(0)=="["&&(u=!0,l=l.slice(1,-1));var d=s.length>0?parseInt(s,10)|0:0,m=l.length>0?parseInt(l,10)|0:0;return u?m+=e.c:--m,f?d+=e.r:--d,a+(u?"":"$")+wr(m)+(f?"":"$")+Lr(d)}return function(a,s){return e=s,a.replace(r,t)}})(),dy=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,my=(function(){return function(e,t){return e.replace(dy,function(n,a,s,l,u,f){var d=ey(l)-(s?0:t.c),m=Z_(f)-(u?0:t.r),x=m==0?"":u?m+1:"["+m+"]",_=d==0?"":s?d+1:"["+d+"]";return a+"R"+x+"C"+_})}})();function P3(r,e){return r.replace(dy,function(t,n,a,s,l,u){return n+(a=="$"?a+s:wr(ey(s)+e.c))+(l=="$"?l+u:Lr(Z_(u)+e.r))})}function Wj(r,e,t){var n=ia(e),a=n.s,s=Sr(t),l={r:s.r-a.r,c:s.c-a.c};return P3(r,l)}function Yj(r){return r.length!=1}function rb(r){return r.replace(/_xlfn\./g,"")}function Gr(r){r.l+=1}function Go(r,e){var t=r.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function L3(r,e,t){var n=2;if(t){if(t.biff>=2&&t.biff<=5)return V3(r);t.biff==12&&(n=4)}var a=r.read_shift(n),s=r.read_shift(n),l=Go(r),u=Go(r);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:s,c:u[0],cRel:u[1],rRel:u[2]}}}function V3(r){var e=Go(r),t=Go(r),n=r.read_shift(1),a=r.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:t[0],c:a,cRel:t[1],rRel:t[2]}}}function $j(r,e,t){if(t.biff<8)return V3(r);var n=r.read_shift(t.biff==12?4:2),a=r.read_shift(t.biff==12?4:2),s=Go(r),l=Go(r);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function B3(r,e,t){if(t&&t.biff>=2&&t.biff<=5)return Qj(r);var n=r.read_shift(t&&t.biff==12?4:2),a=Go(r);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function Qj(r){var e=Go(r),t=r.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function Jj(r){var e=r.read_shift(2),t=r.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function Zj(r,e,t){var n=t&&t.biff?t.biff:8;if(n>=2&&n<=5)return eH(r);var a=r.read_shift(n>=12?4:2),s=r.read_shift(2),l=(s&16384)>>14,u=(s&32768)>>15;if(s&=16383,u==1)for(;a>524287;)a-=1048576;if(l==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:l,rRel:u}}function eH(r){var e=r.read_shift(2),t=r.read_shift(1),n=(e&32768)>>15,a=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),a==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:a,rRel:n}}function tH(r,e,t){var n=(r[r.l++]&96)>>5,a=L3(r,t.biff>=2&&t.biff<=5?6:8,t);return[n,a]}function rH(r,e,t){var n=(r[r.l++]&96)>>5,a=r.read_shift(2,"i"),s=8;if(t)switch(t.biff){case 5:r.l+=12,s=6;break;case 12:s=12;break}var l=L3(r,s,t);return[n,a,l]}function nH(r,e,t){var n=(r[r.l++]&96)>>5;return r.l+=t&&t.biff>8?12:t.biff<8?6:8,[n]}function aH(r,e,t){var n=(r[r.l++]&96)>>5,a=r.read_shift(2),s=8;if(t)switch(t.biff){case 5:r.l+=12,s=6;break;case 12:s=12;break}return r.l+=s,[n,a]}function iH(r,e,t){var n=(r[r.l++]&96)>>5,a=$j(r,e-1,t);return[n,a]}function sH(r,e,t){var n=(r[r.l++]&96)>>5;return r.l+=t.biff==2?6:t.biff==12?14:7,[n]}function nb(r){var e=r[r.l+1]&1,t=1;return r.l+=4,[e,t]}function oH(r,e,t){r.l+=2;for(var n=r.read_shift(t&&t.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(r.read_shift(t&&t.biff==2?1:2));return a}function lH(r,e,t){var n=r[r.l+1]&255?1:0;return r.l+=2,[n,r.read_shift(t&&t.biff==2?1:2)]}function cH(r,e,t){var n=r[r.l+1]&255?1:0;return r.l+=2,[n,r.read_shift(t&&t.biff==2?1:2)]}function uH(r){var e=r[r.l+1]&255?1:0;return r.l+=2,[e,r.read_shift(2)]}function fH(r,e,t){var n=r[r.l+1]&255?1:0;return r.l+=t&&t.biff==2?3:4,[n]}function U3(r){var e=r.read_shift(1),t=r.read_shift(1);return[e,t]}function hH(r){return r.read_shift(2),U3(r)}function dH(r){return r.read_shift(2),U3(r)}function mH(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var a=B3(r,0,t);return[n,a]}function pH(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var a=Zj(r,0,t);return[n,a]}function gH(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var a=r.read_shift(2);t&&t.biff==5&&(r.l+=12);var s=B3(r,0,t);return[n,a,s]}function xH(r,e,t){var n=(r[r.l]&96)>>5;r.l+=1;var a=r.read_shift(t&&t.biff<=3?1:2);return[yG[a],H3[a],n]}function vH(r,e,t){var n=r[r.l++],a=r.read_shift(1),s=t&&t.biff<=3?[n==88?-1:0,r.read_shift(1)]:_H(r);return[a,(s[0]===0?H3:_G)[s[1]]]}function _H(r){return[r[r.l+1]>>7,r.read_shift(2)&32767]}function yH(r,e,t){r.l+=t&&t.biff==2?3:4}function TH(r,e,t){if(r.l++,t&&t.biff==12)return[r.read_shift(4,"i"),0];var n=r.read_shift(2),a=r.read_shift(t&&t.biff==2?1:2);return[n,a]}function EH(r){return r.l++,Us[r.read_shift(1)]}function wH(r){return r.l++,r.read_shift(2)}function SH(r){return r.l++,r.read_shift(1)!==0}function AH(r){return r.l++,Dn(r)}function bH(r,e,t){return r.l++,I0(r,e-1,t)}function IH(r,e){var t=[r.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=Pr(r,1)?"TRUE":"FALSE",e!=12&&(r.l+=7);break;case 37:case 16:t[1]=Us[r[r.l]],r.l+=e==12?4:8;break;case 0:r.l+=8;break;case 1:t[1]=Dn(r);break;case 2:t[1]=vc(r,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function kH(r,e,t){for(var n=r.read_shift(t.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((t.biff==12?xc:Jp)(r));return a}function CH(r,e,t){var n=0,a=0;t.biff==12?(n=r.read_shift(4),a=r.read_shift(4)):(a=1+r.read_shift(1),n=1+r.read_shift(2)),t.biff>=2&&t.biff<8&&(--n,--a==0&&(a=256));for(var s=0,l=[];s!=n&&(l[s]=[]);++s)for(var u=0;u!=a;++u)l[s][u]=IH(r,t.biff);return l}function RH(r,e,t){var n=r.read_shift(1)>>>5&3,a=!t||t.biff>=8?4:2,s=r.read_shift(a);switch(t.biff){case 2:r.l+=5;break;case 3:case 4:r.l+=8;break;case 5:r.l+=12;break}return[n,0,s]}function DH(r,e,t){if(t.biff==5)return NH(r);var n=r.read_shift(1)>>>5&3,a=r.read_shift(2),s=r.read_shift(4);return[n,a,s]}function NH(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2,"i");r.l+=8;var n=r.read_shift(2);return r.l+=12,[e,t,n]}function OH(r,e,t){var n=r.read_shift(1)>>>5&3;r.l+=t&&t.biff==2?3:4;var a=r.read_shift(t&&t.biff==2?1:2);return[n,a]}function FH(r,e,t){var n=r.read_shift(1)>>>5&3,a=r.read_shift(t&&t.biff==2?1:2);return[n,a]}function MH(r,e,t){var n=r.read_shift(1)>>>5&3;return r.l+=4,t.biff<8&&r.l--,t.biff==12&&(r.l+=2),[n]}function PH(r,e,t){var n=(r[r.l++]&96)>>5,a=r.read_shift(2),s=4;if(t)switch(t.biff){case 5:s=15;break;case 12:s=6;break}return r.l+=s,[n,a]}var LH=Mn,VH=Mn,BH=Mn;function C0(r,e,t){return r.l+=2,[Jj(r)]}function py(r){return r.l+=6,[]}var UH=C0,zH=py,jH=py,HH=C0;function z3(r){return r.l+=2,[Xr(r),r.read_shift(2)&1]}var GH=C0,qH=z3,KH=py,XH=C0,WH=C0,YH=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function $H(r){r.l+=2;var e=r.read_shift(2),t=r.read_shift(2),n=r.read_shift(4),a=r.read_shift(2),s=r.read_shift(2),l=YH[t>>2&31];return{ixti:e,coltype:t&3,rt:l,idx:n,c:a,C:s}}function QH(r){return r.l+=2,[r.read_shift(4)]}function JH(r,e,t){return r.l+=5,r.l+=2,r.l+=t.biff==2?1:4,["PTGSHEET"]}function ZH(r,e,t){return r.l+=t.biff==2?4:5,["PTGENDSHEET"]}function eG(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2);return[e,t]}function tG(r){var e=r.read_shift(1)>>>5&3,t=r.read_shift(2);return[e,t]}function rG(r){return r.l+=4,[0,0]}var ab={1:{n:"PtgExp",f:TH},2:{n:"PtgTbl",f:BH},3:{n:"PtgAdd",f:Gr},4:{n:"PtgSub",f:Gr},5:{n:"PtgMul",f:Gr},6:{n:"PtgDiv",f:Gr},7:{n:"PtgPower",f:Gr},8:{n:"PtgConcat",f:Gr},9:{n:"PtgLt",f:Gr},10:{n:"PtgLe",f:Gr},11:{n:"PtgEq",f:Gr},12:{n:"PtgGe",f:Gr},13:{n:"PtgGt",f:Gr},14:{n:"PtgNe",f:Gr},15:{n:"PtgIsect",f:Gr},16:{n:"PtgUnion",f:Gr},17:{n:"PtgRange",f:Gr},18:{n:"PtgUplus",f:Gr},19:{n:"PtgUminus",f:Gr},20:{n:"PtgPercent",f:Gr},21:{n:"PtgParen",f:Gr},22:{n:"PtgMissArg",f:Gr},23:{n:"PtgStr",f:bH},26:{n:"PtgSheet",f:JH},27:{n:"PtgEndSheet",f:ZH},28:{n:"PtgErr",f:EH},29:{n:"PtgBool",f:SH},30:{n:"PtgInt",f:wH},31:{n:"PtgNum",f:AH},32:{n:"PtgArray",f:sH},33:{n:"PtgFunc",f:xH},34:{n:"PtgFuncVar",f:vH},35:{n:"PtgName",f:RH},36:{n:"PtgRef",f:mH},37:{n:"PtgArea",f:tH},38:{n:"PtgMemArea",f:OH},39:{n:"PtgMemErr",f:LH},40:{n:"PtgMemNoMem",f:VH},41:{n:"PtgMemFunc",f:FH},42:{n:"PtgRefErr",f:MH},43:{n:"PtgAreaErr",f:nH},44:{n:"PtgRefN",f:pH},45:{n:"PtgAreaN",f:iH},46:{n:"PtgMemAreaN",f:eG},47:{n:"PtgMemNoMemN",f:tG},57:{n:"PtgNameX",f:DH},58:{n:"PtgRef3d",f:gH},59:{n:"PtgArea3d",f:rH},60:{n:"PtgRefErr3d",f:PH},61:{n:"PtgAreaErr3d",f:aH},255:{}},nG={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},aG={1:{n:"PtgElfLel",f:z3},2:{n:"PtgElfRw",f:XH},3:{n:"PtgElfCol",f:UH},6:{n:"PtgElfRwV",f:WH},7:{n:"PtgElfColV",f:HH},10:{n:"PtgElfRadical",f:GH},11:{n:"PtgElfRadicalS",f:KH},13:{n:"PtgElfColS",f:zH},15:{n:"PtgElfColSV",f:jH},16:{n:"PtgElfRadicalLel",f:qH},25:{n:"PtgList",f:$H},29:{n:"PtgSxName",f:QH},255:{}},iG={0:{n:"PtgAttrNoop",f:rG},1:{n:"PtgAttrSemi",f:fH},2:{n:"PtgAttrIf",f:cH},4:{n:"PtgAttrChoose",f:oH},8:{n:"PtgAttrGoto",f:lH},16:{n:"PtgAttrSum",f:yH},32:{n:"PtgAttrBaxcel",f:nb},33:{n:"PtgAttrBaxcel",f:nb},64:{n:"PtgAttrSpace",f:hH},65:{n:"PtgAttrSpaceSemi",f:dH},128:{n:"PtgAttrIfError",f:uH},255:{}};function R0(r,e,t,n){if(n.biff<8)return Mn(r,e);for(var a=r.l+e,s=[],l=0;l!==t.length;++l)switch(t[l][0]){case"PtgArray":t[l][1]=CH(r,0,n),s.push(t[l][1]);break;case"PtgMemArea":t[l][2]=kH(r,t[l][1],n),s.push(t[l][2]);break;case"PtgExp":n&&n.biff==12&&(t[l][1][1]=r.read_shift(4),s.push(t[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[l][0]}return e=a-r.l,e!==0&&s.push(Mn(r,e)),s}function D0(r,e,t){for(var n=r.l+e,a,s,l=[];n!=r.l;)e=n-r.l,s=r[r.l],a=ab[s]||ab[nG[s]],(s===24||s===25)&&(a=(s===24?aG:iG)[r[r.l+1]]),!a||!a.f?Mn(r,e):l.push([a.n,a.f(r,e,t)]);return l}function sG(r){for(var e=[],t=0;t<r.length;++t){for(var n=r[t],a=[],s=0;s<n.length;++s){var l=n[s];if(l)switch(l[0]){case 2:a.push('"'+l[1].replace(/"/g,'""')+'"');break;default:a.push(l[1])}else a.push("")}e.push(a.join(","))}return e.join(";")}var oG={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function lG(r,e){if(!r&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(r)?"'"+r+"'":r}function j3(r,e,t){if(!r)return"SH33TJSERR0";if(t.biff>8&&(!r.XTI||!r.XTI[e]))return r.SheetNames[e];if(!r.XTI)return"SH33TJSERR6";var n=r.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":r.XTI[e-1];if(!n)return"SH33TJSERR1";var a="";if(t.biff>8)switch(r[n[0]][0]){case 357:return a=n[1]==-1?"#REF":r.SheetNames[n[1]],n[1]==n[2]?a:a+":"+r.SheetNames[n[2]];case 358:return t.SID!=null?r.SheetNames[t.SID]:"SH33TJSSAME"+r[n[0]][0];case 355:default:return"SH33TJSSRC"+r[n[0]][0]}switch(r[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":r.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+r.SheetNames[n[2]];case 14849:return r[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return r[n[0]][0][3]?(a=n[1]==-1?"#REF":r[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+r[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function ib(r,e,t){var n=j3(r,e,t);return n=="#REF"?n:lG(n,t)}function Cn(r,e,t,n,a){var s=a&&a.biff||8,l={s:{c:0,r:0}},u=[],f,d,m,x=0,_=0,y,w="";if(!r[0]||!r[0][0])return"";for(var T=-1,S="",O=0,U=r[0].length;O<U;++O){var R=r[0][O];switch(R[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=u.pop(),d=u.pop(),T>=0){switch(r[0][T][1][0]){case 0:S=Cr(" ",r[0][T][1][1]);break;case 1:S=Cr("\r",r[0][T][1][1]);break;default:if(S="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][T][1][0])}d=d+S,T=-1}u.push(d+oG[R[0]]+f);break;case"PtgIsect":f=u.pop(),d=u.pop(),u.push(d+" "+f);break;case"PtgUnion":f=u.pop(),d=u.pop(),u.push(d+","+f);break;case"PtgRange":f=u.pop(),d=u.pop(),u.push(d+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":m=Dh(R[1][1],l,a),u.push(Nh(m,s));break;case"PtgRefN":m=t?Dh(R[1][1],t,a):R[1][1],u.push(Nh(m,s));break;case"PtgRef3d":x=R[1][1],m=Dh(R[1][2],l,a),w=ib(n,x,a),u.push(w+"!"+Nh(m,s));break;case"PtgFunc":case"PtgFuncVar":var Y=R[1][0],te=R[1][1];Y||(Y=0),Y&=127;var G=Y==0?[]:u.slice(-Y);u.length-=Y,te==="User"&&(te=G.shift()),u.push(te+"("+G.join(",")+")");break;case"PtgBool":u.push(R[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(R[1]);break;case"PtgNum":u.push(String(R[1]));break;case"PtgStr":u.push('"'+R[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(R[1]);break;case"PtgAreaN":y=FA(R[1][1],t?{s:t}:l,a),u.push(yx(y,a));break;case"PtgArea":y=FA(R[1][1],l,a),u.push(yx(y,a));break;case"PtgArea3d":x=R[1][1],y=R[1][2],w=ib(n,x,a),u.push(w+"!"+yx(y,a));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":_=R[1][2];var A=(n.names||[])[_-1]||(n[0]||[])[_],C=A?A.Name:"SH33TJSNAME"+String(_);C&&C.slice(0,6)=="_xlfn."&&!a.xlfn&&(C=C.slice(6)),u.push(C);break;case"PtgNameX":var k=R[1][1];_=R[1][2];var V;if(a.biff<=5)k<0&&(k=-k),n[k]&&(V=n[k][_]);else{var F="";if(((n[k]||[])[0]||[])[0]==14849||(((n[k]||[])[0]||[])[0]==1025?n[k][_]&&n[k][_].itab>0&&(F=n.SheetNames[n[k][_].itab-1]+"!"):F=n.SheetNames[_-1]+"!"),n[k]&&n[k][_])F+=n[k][_].Name;else if(n[0]&&n[0][_])F+=n[0][_].Name;else{var M=(j3(n,k,a)||"").split(";;");M[_-1]?F=M[_-1]:F+="SH33TJSERRX"}u.push(F);break}V||(V={Name:"SH33TJSERRY"}),u.push(V.Name);break;case"PtgParen":var L="(",Ie=")";if(T>=0){switch(S="",r[0][T][1][0]){case 2:L=Cr(" ",r[0][T][1][1])+L;break;case 3:L=Cr("\r",r[0][T][1][1])+L;break;case 4:Ie=Cr(" ",r[0][T][1][1])+Ie;break;case 5:Ie=Cr("\r",r[0][T][1][1])+Ie;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+r[0][T][1][0])}T=-1}u.push(L+u.pop()+Ie);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":m={c:R[1][1],r:R[1][0]};var Re={c:t.c,r:t.r};if(n.sharedf[at(m)]){var ae=n.sharedf[at(m)];u.push(Cn(ae,l,Re,n,a))}else{var le=!1;for(f=0;f!=n.arrayf.length;++f)if(d=n.arrayf[f],!(m.c<d[0].s.c||m.c>d[0].e.c)&&!(m.r<d[0].s.r||m.r>d[0].e.r)){u.push(Cn(d[1],l,Re,n,a)),le=!0;break}le||u.push(R[1])}break;case"PtgArray":u.push("{"+sG(R[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":T=O;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+R[1].idx+"[#"+R[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(R));default:throw new Error("Unrecognized Formula Token: "+String(R))}var Fe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&T>=0&&Fe.indexOf(r[0][O][0])==-1){R=r[0][T];var ie=!0;switch(R[1][0]){case 4:ie=!1;case 0:S=Cr(" ",R[1][1]);break;case 5:ie=!1;case 1:S=Cr("\r",R[1][1]);break;default:if(S="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+R[1][0])}u.push((ie?S:"")+u.pop()+(ie?"":S)),T=-1}}if(u.length>1&&a.WTF)throw new Error("bad formula stack");return u[0]}function cG(r,e,t){var n=r.l+e,a=t.biff==2?1:2,s,l=r.read_shift(a);if(l==65535)return[[],Mn(r,e-2)];var u=D0(r,l,t);return e!==l+a&&(s=R0(r,e-l-a,u,t)),r.l=n,[u,s]}function uG(r,e,t){var n=r.l+e,a=t.biff==2?1:2,s,l=r.read_shift(a);if(l==65535)return[[],Mn(r,e-2)];var u=D0(r,l,t);return e!==l+a&&(s=R0(r,e-l-a,u,t)),r.l=n,[u,s]}function fG(r,e,t,n){var a=r.l+e,s=D0(r,n,t),l;return a!==r.l&&(l=R0(r,a-r.l,s,t)),[s,l]}function hG(r,e,t){var n=r.l+e,a,s=r.read_shift(2),l=D0(r,s,t);return s==65535?[[],Mn(r,e-2)]:(e!==s+2&&(a=R0(r,n-s-2,l,t)),[l,a])}function dG(r){var e;if(bs(r,r.l+6)!==65535)return[Dn(r),"n"];switch(r[r.l]){case 0:return r.l+=8,["String","s"];case 1:return e=r[r.l+2]===1,r.l+=8,[e,"b"];case 2:return e=r[r.l+2],r.l+=8,[e,"e"];case 3:return r.l+=8,["","s"]}return[]}function mG(r){if(r==null){var e=ye(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof r=="number")return ac(r);return ac(0)}function Ax(r,e,t){var n=r.l+e,a=$i(r);t.biff==2&&++r.l;var s=dG(r),l=r.read_shift(1);t.biff!=2&&(r.read_shift(1),t.biff>=5&&r.read_shift(4));var u=uG(r,n-r.l,t);return{cell:a,val:s[0],formula:u,shared:l>>3&1,tt:s[1]}}function pG(r,e,t,n,a){var s=sc(e,t,a),l=mG(r.v),u=ye(6),f=33;u.write_shift(2,f),u.write_shift(4,0);for(var d=ye(r.bf.length),m=0;m<r.bf.length;++m)d[m]=r.bf[m];var x=ln([s,l,u,d]);return x}function Zp(r,e,t){var n=r.read_shift(4),a=D0(r,n,t),s=r.read_shift(4),l=s>0?R0(r,s,a,t):null;return[a,l]}var gG=Zp,eg=Zp,xG=Zp,vG=Zp,_G={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},H3={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},yG={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function sb(r){return r.slice(0,3)=="of:"&&(r=r.slice(3)),r.charCodeAt(0)==61&&(r=r.slice(1),r.charCodeAt(0)==61&&(r=r.slice(1))),r=r.replace(/COM\.MICROSOFT\./g,""),r=r.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,t){return t.replace(/\./g,"")}),r=r.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),r.replace(/[;~]/g,",").replace(/\|/g,";")}function TG(r){var e="of:="+r.replace(dy,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function bx(r){var e=r.split(":"),t=e[0].split(".")[0];return[t,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function EG(r){return r.replace(/\./,"!")}var Fh={},Du={},Mh=typeof Map<"u";function gy(r,e,t){var n=0,a=r.length;if(t){if(Mh?t.has(e):Object.prototype.hasOwnProperty.call(t,e)){for(var s=Mh?t.get(e):t[e];n<s.length;++n)if(r[s[n]].t===e)return r.Count++,s[n]}}else for(;n<a;++n)if(r[n].t===e)return r.Count++,n;return r[a]={t:e},r.Count++,r.Unique++,t&&(Mh?(t.has(e)||t.set(e,[]),t.get(e).push(a)):(Object.prototype.hasOwnProperty.call(t,e)||(t[e]=[]),t[e].push(a))),a}function tg(r,e){var t={min:r+1,max:r+1},n=-1;return e.MDW&&(Rn=e.MDW),e.width!=null?t.customWidth=1:e.wpx!=null?n=o0(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(t.width=_p(n),t.customWidth=1):e.width!=null&&(t.width=e.width),e.hidden&&(t.hidden=!0),e.level!=null&&(t.outlineLevel=t.level=e.level),t}function Gl(r,e){if(r){var t=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(t=[1,1,1,1,.5,.5]),r.left==null&&(r.left=t[0]),r.right==null&&(r.right=t[1]),r.top==null&&(r.top=t[2]),r.bottom==null&&(r.bottom=t[3]),r.header==null&&(r.header=t[4]),r.footer==null&&(r.footer=t[5])}}function $o(r,e,t){var n=t.revssf[e.z!=null?e.z:"General"],a=60,s=r.length;if(n==null&&t.ssf){for(;a<392;++a)if(t.ssf[a]==null){Rs(e.z,a),t.ssf[a]=e.z,t.revssf[e.z]=n=a;break}}for(a=0;a!=s;++a)if(r[a].numFmtId===n)return a;return r[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function G3(r,e,t,n,a,s){try{n.cellNF&&(r.z=nt[e])}catch(u){if(n.WTF)throw u}if(!(r.t==="z"&&!n.cellStyles)){if(r.t==="d"&&typeof r.v=="string"&&(r.v=mr(r.v)),(!n||n.cellText!==!1)&&r.t!=="z")try{if(nt[e]==null&&Rs(_7[e]||"General",e),r.t==="e")r.w=r.w||Us[r.v];else if(e===0)if(r.t==="n")(r.v|0)===r.v?r.w=r.v.toString(10):r.w=e0(r.v);else if(r.t==="d"){var l=en(r.v);(l|0)===l?r.w=l.toString(10):r.w=e0(l)}else{if(r.v===void 0)return"";r.w=rc(r.v,Du)}else r.t==="d"?r.w=ei(e,en(r.v),Du):r.w=ei(e,r.v,Du)}catch(u){if(n.WTF)throw u}if(n.cellStyles&&t!=null)try{r.s=s.Fills[t],r.s.fgColor&&r.s.fgColor.theme&&!r.s.fgColor.rgb&&(r.s.fgColor.rgb=vp(a.themeElements.clrScheme[r.s.fgColor.theme].rgb,r.s.fgColor.tint||0),n.WTF&&(r.s.fgColor.raw_rgb=a.themeElements.clrScheme[r.s.fgColor.theme].rgb)),r.s.bgColor&&r.s.bgColor.theme&&(r.s.bgColor.rgb=vp(a.themeElements.clrScheme[r.s.bgColor.theme].rgb,r.s.bgColor.tint||0),n.WTF&&(r.s.bgColor.raw_rgb=a.themeElements.clrScheme[r.s.bgColor.theme].rgb))}catch(u){if(n.WTF&&s.Fills)throw u}}}function wG(r,e,t){if(r&&r["!ref"]){var n=Ot(r["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+t+"): "+r["!ref"])}}function SG(r,e){var t=Ot(e);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(r["!ref"]=gt(t))}var AG=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,bG=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,IG=/<(?:\w:)?hyperlink [^>]*>/mg,kG=/"(\w*:\w*)"/,CG=/<(?:\w:)?col\b[^>]*[\/]?>/g,RG=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,DG=/<(?:\w:)?pageMargins[^>]*\/>/g,q3=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,NG=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,OG=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function FG(r,e,t,n,a,s,l){if(!r)return r;n||(n={"!id":{}});var u=e.dense?[]:{},f={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",m="",x=r.match(bG);x?(d=r.slice(0,x.index),m=r.slice(x.index+x[0].length)):d=m=r;var _=d.match(q3);_?xy(_[0],u,a,t):(_=d.match(NG))&&PG(_[0],_[1]||"",u,a,t);var y=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(y>0){var w=d.slice(y,y+50).match(kG);w&&SG(u,w[1])}var T=d.match(OG);T&&T[1]&&YG(T[1],a);var S=[];if(e.cellStyles){var O=d.match(CG);O&&GG(S,O)}x&&JG(x[1],u,e,f,s,l);var U=m.match(RG);U&&(u["!autofilter"]=KG(U[0]));var R=[],Y=m.match(AG);if(Y)for(y=0;y!=Y.length;++y)R[y]=Ot(Y[y].slice(Y[y].indexOf('"')+1));var te=m.match(IG);te&&zG(u,te,n);var G=m.match(DG);if(G&&(u["!margins"]=jG(it(G[0]))),!u["!ref"]&&f.e.c>=f.s.c&&f.e.r>=f.s.r&&(u["!ref"]=gt(f)),e.sheetRows>0&&u["!ref"]){var A=Ot(u["!ref"]);e.sheetRows<=+A.e.r&&(A.e.r=e.sheetRows-1,A.e.r>f.e.r&&(A.e.r=f.e.r),A.e.r<A.s.r&&(A.s.r=A.e.r),A.e.c>f.e.c&&(A.e.c=f.e.c),A.e.c<A.s.c&&(A.s.c=A.e.c),u["!fullref"]=u["!ref"],u["!ref"]=gt(A))}return S.length>0&&(u["!cols"]=S),R.length>0&&(u["!merges"]=R),u}function MG(r){if(r.length===0)return"";for(var e='<mergeCells count="'+r.length+'">',t=0;t!=r.length;++t)e+='<mergeCell ref="'+gt(r[t])+'"/>';return e+"</mergeCells>"}function xy(r,e,t,n){var a=it(r);t.Sheets[n]||(t.Sheets[n]={}),a.codeName&&(t.Sheets[n].CodeName=Nt(ir(a.codeName)))}function PG(r,e,t,n,a){xy(r.slice(0,r.indexOf(">")),t,n,a)}function LG(r,e,t,n,a){var s=!1,l={},u=null;if(n.bookType!=="xlsx"&&e.vbaraw){var f=e.SheetNames[t];try{e.Workbook&&(f=e.Workbook.Sheets[t].CodeName||f)}catch{}s=!0,l.codeName=ji(Qt(f))}if(r&&r["!outline"]){var d={summaryBelow:1,summaryRight:1};r["!outline"].above&&(d.summaryBelow=0),r["!outline"].left&&(d.summaryRight=0),u=(u||"")+Be("outlinePr",null,d)}!s&&!u||(a[a.length]=Be("sheetPr",u,l))}var VG=["objects","scenarios","selectLockedCells","selectUnlockedCells"],BG=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function UG(r){var e={sheet:1};return VG.forEach(function(t){r[t]!=null&&r[t]&&(e[t]="1")}),BG.forEach(function(t){r[t]!=null&&!r[t]&&(e[t]="0")}),r.password&&(e.password=uy(r.password).toString(16).toUpperCase()),Be("sheetProtection",null,e)}function zG(r,e,t){for(var n=Array.isArray(r),a=0;a!=e.length;++a){var s=it(ir(e[a]),!0);if(!s.ref)return;var l=((t||{})["!id"]||[])[s.id];l?(s.Target=l.Target,s.location&&(s.Target+="#"+Nt(s.location))):(s.Target="#"+Nt(s.location),l={Target:s.Target,TargetMode:"Internal"}),s.Rel=l,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var u=Ot(s.ref),f=u.s.r;f<=u.e.r;++f)for(var d=u.s.c;d<=u.e.c;++d){var m=at({c:d,r:f});n?(r[f]||(r[f]=[]),r[f][d]||(r[f][d]={t:"z",v:void 0}),r[f][d].l=s):(r[m]||(r[m]={t:"z",v:void 0}),r[m].l=s)}}}function jG(r){var e={};return["left","right","top","bottom","header","footer"].forEach(function(t){r[t]&&(e[t]=parseFloat(r[t]))}),e}function HG(r){return Gl(r),Be("pageMargins",null,r)}function GG(r,e){for(var t=!1,n=0;n!=e.length;++n){var a=it(e[n],!0);a.hidden&&(a.hidden=dr(a.hidden));var s=parseInt(a.min,10)-1,l=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!t&&a.width&&(t=!0,fy(a.width)),Ho(a);s<=l;)r[s++]=pr(a)}}function qG(r,e){for(var t=["<cols>"],n,a=0;a!=e.length;++a)(n=e[a])&&(t[t.length]=Be("col",null,tg(a,n)));return t[t.length]="</cols>",t.join("")}function KG(r){var e={ref:(r.match(/ref="([^"]*)"/)||[])[1]};return e}function XG(r,e,t,n){var a=typeof r.ref=="string"?r.ref:gt(r.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var s=t.Workbook.Names,l=ia(a);l.s.r==l.e.r&&(l.e.r=ia(e["!ref"]).e.r,a=gt(l));for(var u=0;u<s.length;++u){var f=s[u];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==n){f.Ref="'"+t.SheetNames[n]+"'!"+a;break}}return u==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+a}),Be("autoFilter",null,{ref:a})}var WG=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function YG(r,e){e.Views||(e.Views=[{}]),(r.match(WG)||[]).forEach(function(t,n){var a=it(t);e.Views[n]||(e.Views[n]={}),+a.zoomScale&&(e.Views[n].zoom=+a.zoomScale),dr(a.rightToLeft)&&(e.Views[n].RTL=!0)})}function $G(r,e,t,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Be("sheetViews",Be("sheetView",null,a),{})}function QG(r,e,t,n){if(r.c&&t["!comments"].push([e,r.c]),r.v===void 0&&typeof r.f!="string"||r.t==="z"&&!r.f)return"";var a="",s=r.t,l=r.v;if(r.t!=="z")switch(r.t){case"b":a=r.v?"1":"0";break;case"n":a=""+r.v;break;case"e":a=Us[r.v];break;case"d":n&&n.cellDates?a=mr(r.v,-1).toISOString():(r=pr(r),r.t="n",a=""+(r.v=en(mr(r.v)))),typeof r.z>"u"&&(r.z=nt[14]);break;default:a=r.v;break}var u=Tn("v",Qt(a)),f={r:e},d=$o(n.cellXfs,r,n);switch(d!==0&&(f.s=d),r.t){case"n":break;case"d":f.t="d";break;case"b":f.t="b";break;case"e":f.t="e";break;case"z":break;default:if(r.v==null){delete r.t;break}if(r.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){u=Tn("v",""+gy(n.Strings,r.v,n.revStrings)),f.t="s";break}f.t="str";break}if(r.t!=s&&(r.t=s,r.v=l),typeof r.f=="string"&&r.f){var m=r.F&&r.F.slice(0,e.length)==e?{t:"array",ref:r.F}:null;u=Be("f",Qt(r.f),m)+(r.v!=null?u:"")}return r.l&&t["!links"].push([e,r.l]),r.D&&(f.cm=1),Be("c",u,f)}var JG=(function(){var r=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=t0("v"),l=t0("f");return function(f,d,m,x,_,y){for(var w=0,T="",S=[],O=[],U=0,R=0,Y=0,te="",G,A,C=0,k=0,V,F,M=0,L=0,Ie=Array.isArray(y.CellXf),Re,ae=[],le=[],Fe=Array.isArray(d),ie=[],Ne={},Q=!1,N=!!m.sheetStubs,J=f.split(e),X=0,ee=J.length;X!=ee;++X){T=J[X].trim();var ce=T.length;if(ce!==0){var we=0;e:for(w=0;w<ce;++w)switch(T[w]){case">":if(T[w-1]!="/"){++w;break e}if(m&&m.cellStyles){if(A=it(T.slice(we,w),!0),C=A.r!=null?parseInt(A.r,10):C+1,k=-1,m.sheetRows&&m.sheetRows<C)continue;Ne={},Q=!1,A.ht&&(Q=!0,Ne.hpt=parseFloat(A.ht),Ne.hpx=$u(Ne.hpt)),A.hidden=="1"&&(Q=!0,Ne.hidden=!0),A.outlineLevel!=null&&(Q=!0,Ne.level=+A.outlineLevel),Q&&(ie[C-1]=Ne)}break;case"<":we=w;break}if(we>=w)break;if(A=it(T.slice(we,w),!0),C=A.r!=null?parseInt(A.r,10):C+1,k=-1,!(m.sheetRows&&m.sheetRows<C)){x.s.r>C-1&&(x.s.r=C-1),x.e.r<C-1&&(x.e.r=C-1),m&&m.cellStyles&&(Ne={},Q=!1,A.ht&&(Q=!0,Ne.hpt=parseFloat(A.ht),Ne.hpx=$u(Ne.hpt)),A.hidden=="1"&&(Q=!0,Ne.hidden=!0),A.outlineLevel!=null&&(Q=!0,Ne.level=+A.outlineLevel),Q&&(ie[C-1]=Ne)),S=T.slice(w).split(r);for(var De=0;De!=S.length&&S[De].trim().charAt(0)=="<";++De);for(S=S.slice(De),w=0;w!=S.length;++w)if(T=S[w].trim(),T.length!==0){if(O=T.match(t),U=w,R=0,Y=0,T="<c "+(T.slice(0,1)=="<"?">":"")+T,O!=null&&O.length===2){for(U=0,te=O[1],R=0;R!=te.length&&!((Y=te.charCodeAt(R)-64)<1||Y>26);++R)U=26*U+Y;--U,k=U}else++k;for(R=0;R!=T.length&&T.charCodeAt(R)!==62;++R);if(++R,A=it(T.slice(0,R),!0),A.r||(A.r=at({r:C-1,c:k})),te=T.slice(R),G={t:""},(O=te.match(s))!=null&&O[1]!==""&&(G.v=Nt(O[1])),m.cellFormula){if((O=te.match(l))!=null&&O[1]!==""){if(G.f=Nt(ir(O[1])).replace(/\r\n/g,`
`),m.xlfn||(G.f=rb(G.f)),O[0].indexOf('t="array"')>-1)G.F=(te.match(a)||[])[1],G.F.indexOf(":")>-1&&ae.push([Ot(G.F),G.F]);else if(O[0].indexOf('t="shared"')>-1){F=it(O[0]);var Ae=Nt(ir(O[1]));m.xlfn||(Ae=rb(Ae)),le[parseInt(F.si,10)]=[F,Ae,A.r]}}else(O=te.match(/<f[^>]*\/>/))&&(F=it(O[0]),le[F.si]&&(G.f=Wj(le[F.si][1],le[F.si][2],A.r)));var Oe=Sr(A.r);for(R=0;R<ae.length;++R)Oe.r>=ae[R][0].s.r&&Oe.r<=ae[R][0].e.r&&Oe.c>=ae[R][0].s.c&&Oe.c<=ae[R][0].e.c&&(G.F=ae[R][1])}if(A.t==null&&G.v===void 0)if(G.f||G.F)G.v=0,G.t="n";else if(N)G.t="z";else continue;else G.t=A.t||"n";switch(x.s.c>k&&(x.s.c=k),x.e.c<k&&(x.e.c=k),G.t){case"n":if(G.v==""||G.v==null){if(!N)continue;G.t="z"}else G.v=parseFloat(G.v);break;case"s":if(typeof G.v>"u"){if(!N)continue;G.t="z"}else V=Fh[parseInt(G.v,10)],G.v=V.t,G.r=V.r,m.cellHTML&&(G.h=V.h);break;case"str":G.t="s",G.v=G.v!=null?ir(G.v):"",m.cellHTML&&(G.h=Y_(G.v));break;case"inlineStr":O=te.match(n),G.t="s",O!=null&&(V=cy(O[1]))?(G.v=V.t,m.cellHTML&&(G.h=V.h)):G.v="";break;case"b":G.v=dr(G.v);break;case"d":m.cellDates?G.v=mr(G.v,1):(G.v=en(mr(G.v,1)),G.t="n");break;case"e":(!m||m.cellText!==!1)&&(G.w=G.v),G.v=XC[G.v];break}if(M=L=0,Re=null,Ie&&A.s!==void 0&&(Re=y.CellXf[A.s],Re!=null&&(Re.numFmtId!=null&&(M=Re.numFmtId),m.cellStyles&&Re.fillId!=null&&(L=Re.fillId))),G3(G,M,L,m,_,y),m.cellDates&&Ie&&G.t=="n"&&af(nt[M])&&(G.t="d",G.v=Qp(G.v)),A.cm&&m.xlmeta){var st=(m.xlmeta.Cell||[])[+A.cm-1];st&&st.type=="XLDAPR"&&(G.D=!0)}if(Fe){var Z=Sr(A.r);d[Z.r]||(d[Z.r]=[]),d[Z.r][Z.c]=G}else d[A.r]=G}}}}ie.length>0&&(d["!rows"]=ie)}})();function ZG(r,e,t,n){var a=[],s=[],l=Ot(r["!ref"]),u="",f,d="",m=[],x=0,_=0,y=r["!rows"],w=Array.isArray(r),T={r:d},S,O=-1;for(_=l.s.c;_<=l.e.c;++_)m[_]=wr(_);for(x=l.s.r;x<=l.e.r;++x){for(s=[],d=Lr(x),_=l.s.c;_<=l.e.c;++_){f=m[_]+d;var U=w?(r[x]||[])[_]:r[f];U!==void 0&&(u=QG(U,f,r,e))!=null&&s.push(u)}(s.length>0||y&&y[x])&&(T={r:d},y&&y[x]&&(S=y[x],S.hidden&&(T.hidden=1),O=-1,S.hpx?O=l0(S.hpx):S.hpt&&(O=S.hpt),O>-1&&(T.ht=O,T.customHeight=1),S.level&&(T.outlineLevel=S.level)),a[a.length]=Be("row",s.join(""),T))}if(y)for(;x<y.length;++x)y&&y[x]&&(T={r:x+1},S=y[x],S.hidden&&(T.hidden=1),O=-1,S.hpx?O=l0(S.hpx):S.hpt&&(O=S.hpt),O>-1&&(T.ht=O,T.customHeight=1),S.level&&(T.outlineLevel=S.level),a[a.length]=Be("row","",T));return a.join("")}function K3(r,e,t,n){var a=[Vr,Be("worksheet",null,{xmlns:dc[0],"xmlns:r":Qr.r})],s=t.SheetNames[r],l=0,u="",f=t.Sheets[s];f==null&&(f={});var d=f["!ref"]||"A1",m=Ot(d);if(m.e.c>16383||m.e.r>1048575){if(e.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");m.e.c=Math.min(m.e.c,16383),m.e.r=Math.min(m.e.c,1048575),d=gt(m)}n||(n={}),f["!comments"]=[];var x=[];LG(f,t,r,e,a),a[a.length]=Be("dimension",null,{ref:d}),a[a.length]=$G(f,e,r,t),e.sheetFormat&&(a[a.length]=Be("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),f["!cols"]!=null&&f["!cols"].length>0&&(a[a.length]=qG(f,f["!cols"])),a[l=a.length]="<sheetData/>",f["!links"]=[],f["!ref"]!=null&&(u=ZG(f,e),u.length>0&&(a[a.length]=u)),a.length>l+1&&(a[a.length]="</sheetData>",a[l]=a[l].replace("/>",">")),f["!protect"]&&(a[a.length]=UG(f["!protect"])),f["!autofilter"]!=null&&(a[a.length]=XG(f["!autofilter"],f,t,r)),f["!merges"]!=null&&f["!merges"].length>0&&(a[a.length]=MG(f["!merges"]));var _=-1,y,w=-1;return f["!links"].length>0&&(a[a.length]="<hyperlinks>",f["!links"].forEach(function(T){T[1].Target&&(y={ref:T[0]},T[1].Target.charAt(0)!="#"&&(w=Yt(n,-1,Qt(T[1].Target).replace(/#.*$/,""),Tt.HLINK),y["r:id"]="rId"+w),(_=T[1].Target.indexOf("#"))>-1&&(y.location=Qt(T[1].Target.slice(_+1))),T[1].Tooltip&&(y.tooltip=Qt(T[1].Tooltip)),a[a.length]=Be("hyperlink",null,y))}),a[a.length]="</hyperlinks>"),delete f["!links"],f["!margins"]!=null&&(a[a.length]=HG(f["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(a[a.length]=Tn("ignoredErrors",Be("ignoredError",null,{numberStoredAsText:1,sqref:d}))),x.length>0&&(w=Yt(n,-1,"../drawings/drawing"+(r+1)+".xml",Tt.DRAW),a[a.length]=Be("drawing",null,{"r:id":"rId"+w}),f["!drawing"]=x),f["!comments"].length>0&&(w=Yt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Tt.VML),a[a.length]=Be("legacyDrawing",null,{"r:id":"rId"+w}),f["!legacy"]=w),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function eq(r,e){var t={},n=r.l+e;t.r=r.read_shift(4),r.l+=4;var a=r.read_shift(2);r.l+=1;var s=r.read_shift(1);return r.l=n,s&7&&(t.level=s&7),s&16&&(t.hidden=!0),s&32&&(t.hpt=a/20),t}function tq(r,e,t){var n=ye(145),a=(t["!rows"]||[])[r]||{};n.write_shift(4,r),n.write_shift(4,0);var s=320;a.hpx?s=l0(a.hpx)*20:a.hpt&&(s=a.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var l=0;a.level&&(l|=a.level),a.hidden&&(l|=16),(a.hpx||a.hpt)&&(l|=32),n.write_shift(1,l),n.write_shift(1,0);var u=0,f=n.l;n.l+=4;for(var d={r,c:0},m=0;m<16;++m)if(!(e.s.c>m+1<<10||e.e.c<m<<10)){for(var x=-1,_=-1,y=m<<10;y<m+1<<10;++y){d.c=y;var w=Array.isArray(t)?(t[d.r]||[])[d.c]:t[at(d)];w&&(x<0&&(x=y),_=y)}x<0||(++u,n.write_shift(4,x),n.write_shift(4,_))}var T=n.l;return n.l=f,n.write_shift(4,u),n.l=T,n.length>n.l?n.slice(0,n.l):n}function rq(r,e,t,n){var a=tq(n,t,e);(a.length>17||(e["!rows"]||[])[n])&&Ce(r,0,a)}var nq=xc,aq=lf;function iq(){}function sq(r,e){var t={},n=r[r.l];return++r.l,t.above=!(n&64),t.left=!(n&128),r.l+=18,t.name=cV(r),t}function oq(r,e,t){t==null&&(t=ye(84+4*r.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),t.write_shift(1,n);for(var a=1;a<3;++a)t.write_shift(1,0);return pp({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),jC(r,t),t.slice(0,t.l)}function lq(r){var e=ti(r);return[e]}function cq(r,e,t){return t==null&&(t=ye(8)),mc(e,t)}function uq(r){var e=pc(r);return[e]}function fq(r,e,t){return t==null&&(t=ye(4)),gc(e,t)}function hq(r){var e=ti(r),t=r.read_shift(1);return[e,t,"b"]}function dq(r,e,t){return t==null&&(t=ye(9)),mc(e,t),t.write_shift(1,r.v?1:0),t}function mq(r){var e=pc(r),t=r.read_shift(1);return[e,t,"b"]}function pq(r,e,t){return t==null&&(t=ye(5)),gc(e,t),t.write_shift(1,r.v?1:0),t}function gq(r){var e=ti(r),t=r.read_shift(1);return[e,t,"e"]}function xq(r,e,t){return t==null&&(t=ye(9)),mc(e,t),t.write_shift(1,r.v),t}function vq(r){var e=pc(r),t=r.read_shift(1);return[e,t,"e"]}function _q(r,e,t){return t==null&&(t=ye(8)),gc(e,t),t.write_shift(1,r.v),t.write_shift(2,0),t.write_shift(1,0),t}function yq(r){var e=ti(r),t=r.read_shift(4);return[e,t,"s"]}function Tq(r,e,t){return t==null&&(t=ye(12)),mc(e,t),t.write_shift(4,e.v),t}function Eq(r){var e=pc(r),t=r.read_shift(4);return[e,t,"s"]}function wq(r,e,t){return t==null&&(t=ye(8)),gc(e,t),t.write_shift(4,e.v),t}function Sq(r){var e=ti(r),t=Dn(r);return[e,t,"n"]}function Aq(r,e,t){return t==null&&(t=ye(16)),mc(e,t),ac(r.v,t),t}function X3(r){var e=pc(r),t=Dn(r);return[e,t,"n"]}function bq(r,e,t){return t==null&&(t=ye(12)),gc(e,t),ac(r.v,t),t}function Iq(r){var e=ti(r),t=ay(r);return[e,t,"n"]}function kq(r,e,t){return t==null&&(t=ye(12)),mc(e,t),HC(r.v,t),t}function Cq(r){var e=pc(r),t=ay(r);return[e,t,"n"]}function Rq(r,e,t){return t==null&&(t=ye(8)),gc(e,t),HC(r.v,t),t}function Dq(r){var e=ti(r),t=ty(r);return[e,t,"is"]}function Nq(r){var e=ti(r),t=On(r);return[e,t,"str"]}function Oq(r,e,t){return t==null&&(t=ye(12+4*r.v.length)),mc(e,t),cn(r.v,t),t.length>t.l?t.slice(0,t.l):t}function Fq(r){var e=pc(r),t=On(r);return[e,t,"str"]}function Mq(r,e,t){return t==null&&(t=ye(8+4*r.v.length)),gc(e,t),cn(r.v,t),t.length>t.l?t.slice(0,t.l):t}function Pq(r,e,t){var n=r.l+e,a=ti(r);a.r=t["!row"];var s=r.read_shift(1),l=[a,s,"b"];if(t.cellFormula){r.l+=2;var u=eg(r,n-r.l,t);l[3]=Cn(u,null,a,t.supbooks,t)}else r.l=n;return l}function Lq(r,e,t){var n=r.l+e,a=ti(r);a.r=t["!row"];var s=r.read_shift(1),l=[a,s,"e"];if(t.cellFormula){r.l+=2;var u=eg(r,n-r.l,t);l[3]=Cn(u,null,a,t.supbooks,t)}else r.l=n;return l}function Vq(r,e,t){var n=r.l+e,a=ti(r);a.r=t["!row"];var s=Dn(r),l=[a,s,"n"];if(t.cellFormula){r.l+=2;var u=eg(r,n-r.l,t);l[3]=Cn(u,null,a,t.supbooks,t)}else r.l=n;return l}function Bq(r,e,t){var n=r.l+e,a=ti(r);a.r=t["!row"];var s=On(r),l=[a,s,"str"];if(t.cellFormula){r.l+=2;var u=eg(r,n-r.l,t);l[3]=Cn(u,null,a,t.supbooks,t)}else r.l=n;return l}var Uq=xc,zq=lf;function jq(r,e){return e==null&&(e=ye(4)),e.write_shift(4,r),e}function Hq(r,e){var t=r.l+e,n=xc(r),a=ry(r),s=On(r),l=On(r),u=On(r);r.l=t;var f={rfx:n,relId:a,loc:s,display:u};return l&&(f.Tooltip=l),f}function Gq(r,e){var t=ye(50+4*(r[1].Target.length+(r[1].Tooltip||"").length));lf({s:Sr(r[0]),e:Sr(r[0])},t),ny("rId"+e,t);var n=r[1].Target.indexOf("#"),a=n==-1?"":r[1].Target.slice(n+1);return cn(a||"",t),cn(r[1].Tooltip||"",t),cn("",t),t.slice(0,t.l)}function qq(){}function Kq(r,e,t){var n=r.l+e,a=GC(r),s=r.read_shift(1),l=[a];if(l[2]=s,t.cellFormula){var u=gG(r,n-r.l,t);l[1]=u}else r.l=n;return l}function Xq(r,e,t){var n=r.l+e,a=xc(r),s=[a];if(t.cellFormula){var l=vG(r,n-r.l,t);s[1]=l,r.l=n}else r.l=n;return s}function Wq(r,e,t){t==null&&(t=ye(18));var n=tg(r,e);t.write_shift(-4,r),t.write_shift(-4,r),t.write_shift(4,(n.width||10)*256),t.write_shift(4,0);var a=0;return e.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),e.level&&(a|=e.level<<8),t.write_shift(2,a),t}var W3=["left","right","top","bottom","header","footer"];function Yq(r){var e={};return W3.forEach(function(t){e[t]=Dn(r)}),e}function $q(r,e){return e==null&&(e=ye(48)),Gl(r),W3.forEach(function(t){ac(r[t],e)}),e}function Qq(r){var e=r.read_shift(2);return r.l+=28,{RTL:e&32}}function Jq(r,e,t){t==null&&(t=ye(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function Zq(r){var e=ye(24);return e.write_shift(4,4),e.write_shift(4,1),lf(r,e),e}function eK(r,e){return e==null&&(e=ye(66)),e.write_shift(2,r.password?uy(r.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?e.write_shift(4,r[t[0]]!=null&&!r[t[0]]?1:0):e.write_shift(4,r[t[0]]!=null&&r[t[0]]?0:1)}),e}function tK(){}function rK(){}function nK(r,e,t,n,a,s,l){if(!r)return r;var u=e||{};n||(n={"!id":{}});var f=u.dense?[]:{},d,m={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=!1,_=!1,y,w,T,S,O,U,R,Y,te,G=[];u.biff=12,u["!row"]=0;var A=0,C=!1,k=[],V={},F=u.supbooks||a.supbooks||[[]];if(F.sharedf=V,F.arrayf=k,F.SheetNames=a.SheetNames||a.Sheets.map(function(Fe){return Fe.name}),!u.supbooks&&(u.supbooks=F,a.Names))for(var M=0;M<a.Names.length;++M)F[0][M+1]=a.Names[M];var L=[],Ie=[],Re=!1;c0[16]={n:"BrtShortReal",f:X3};var ae;if(Bs(r,function(ie,Ne,Q){if(!_)switch(Q){case 148:d=ie;break;case 0:y=ie,u.sheetRows&&u.sheetRows<=y.r&&(_=!0),Y=Lr(S=y.r),u["!row"]=y.r,(ie.hidden||ie.hpt||ie.level!=null)&&(ie.hpt&&(ie.hpx=$u(ie.hpt)),Ie[ie.r]=ie);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(w={t:ie[2]},ie[2]){case"n":w.v=ie[1];break;case"s":R=Fh[ie[1]],w.v=R.t,w.r=R.r;break;case"b":w.v=!!ie[1];break;case"e":w.v=ie[1],u.cellText!==!1&&(w.w=Us[w.v]);break;case"str":w.t="s",w.v=ie[1];break;case"is":w.t="s",w.v=ie[1].t;break}if((T=l.CellXf[ie[0].iStyleRef])&&G3(w,T.numFmtId,null,u,s,l),O=ie[0].c==-1?O+1:ie[0].c,u.dense?(f[S]||(f[S]=[]),f[S][O]=w):f[wr(O)+Y]=w,u.cellFormula){for(C=!1,A=0;A<k.length;++A){var N=k[A];y.r>=N[0].s.r&&y.r<=N[0].e.r&&O>=N[0].s.c&&O<=N[0].e.c&&(w.F=gt(N[0]),C=!0)}!C&&ie.length>3&&(w.f=ie[3])}if(m.s.r>y.r&&(m.s.r=y.r),m.s.c>O&&(m.s.c=O),m.e.r<y.r&&(m.e.r=y.r),m.e.c<O&&(m.e.c=O),u.cellDates&&T&&w.t=="n"&&af(nt[T.numFmtId])){var J=Ml(w.v);J&&(w.t="d",w.v=new Date(J.y,J.m-1,J.d,J.H,J.M,J.S,J.u))}ae&&(ae.type=="XLDAPR"&&(w.D=!0),ae=void 0);break;case 1:case 12:if(!u.sheetStubs||x)break;w={t:"z",v:void 0},O=ie[0].c==-1?O+1:ie[0].c,u.dense?(f[S]||(f[S]=[]),f[S][O]=w):f[wr(O)+Y]=w,m.s.r>y.r&&(m.s.r=y.r),m.s.c>O&&(m.s.c=O),m.e.r<y.r&&(m.e.r=y.r),m.e.c<O&&(m.e.c=O),ae&&(ae.type=="XLDAPR"&&(w.D=!0),ae=void 0);break;case 176:G.push(ie);break;case 49:ae=((u.xlmeta||{}).Cell||[])[ie-1];break;case 494:var X=n["!id"][ie.relId];for(X?(ie.Target=X.Target,ie.loc&&(ie.Target+="#"+ie.loc),ie.Rel=X):ie.relId==""&&(ie.Target="#"+ie.loc),S=ie.rfx.s.r;S<=ie.rfx.e.r;++S)for(O=ie.rfx.s.c;O<=ie.rfx.e.c;++O)u.dense?(f[S]||(f[S]=[]),f[S][O]||(f[S][O]={t:"z",v:void 0}),f[S][O].l=ie):(U=at({c:O,r:S}),f[U]||(f[U]={t:"z",v:void 0}),f[U].l=ie);break;case 426:if(!u.cellFormula)break;k.push(ie),te=u.dense?f[S][O]:f[wr(O)+Y],te.f=Cn(ie[1],m,{r:y.r,c:O},F,u),te.F=gt(ie[0]);break;case 427:if(!u.cellFormula)break;V[at(ie[0].s)]=ie[1],te=u.dense?f[S][O]:f[wr(O)+Y],te.f=Cn(ie[1],m,{r:y.r,c:O},F,u);break;case 60:if(!u.cellStyles)break;for(;ie.e>=ie.s;)L[ie.e--]={width:ie.w/256,hidden:!!(ie.flags&1),level:ie.level},Re||(Re=!0,fy(ie.w/256)),Ho(L[ie.e+1]);break;case 161:f["!autofilter"]={ref:gt(ie)};break;case 476:f["!margins"]=ie;break;case 147:a.Sheets[t]||(a.Sheets[t]={}),ie.name&&(a.Sheets[t].CodeName=ie.name),(ie.above||ie.left)&&(f["!outline"]={above:ie.above,left:ie.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),ie.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:x=!0;break;case 36:x=!1;break;case 37:x=!0;break;case 38:x=!1;break;default:if(!Ne.T){if(!x||u.WTF)throw new Error("Unexpected record 0x"+Q.toString(16))}}},u),delete u.supbooks,delete u["!row"],!f["!ref"]&&(m.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(f["!ref"]=gt(d||m)),u.sheetRows&&f["!ref"]){var le=Ot(f["!ref"]);u.sheetRows<=+le.e.r&&(le.e.r=u.sheetRows-1,le.e.r>m.e.r&&(le.e.r=m.e.r),le.e.r<le.s.r&&(le.s.r=le.e.r),le.e.c>m.e.c&&(le.e.c=m.e.c),le.e.c<le.s.c&&(le.s.c=le.e.c),f["!fullref"]=f["!ref"],f["!ref"]=gt(le))}return G.length>0&&(f["!merges"]=G),L.length>0&&(f["!cols"]=L),Ie.length>0&&(f["!rows"]=Ie),f}function aK(r,e,t,n,a,s,l){if(e.v===void 0)return!1;var u="";switch(e.t){case"b":u=e.v?"1":"0";break;case"d":e=pr(e),e.z=e.z||nt[14],e.v=en(mr(e.v)),e.t="n";break;case"n":case"e":u=""+e.v;break;default:u=e.v;break}var f={r:t,c:n};switch(f.s=$o(a.cellXfs,e,a),e.l&&s["!links"].push([at(f),e.l]),e.c&&s["!comments"].push([at(f),e.c]),e.t){case"s":case"str":return a.bookSST?(u=gy(a.Strings,e.v,a.revStrings),f.t="s",f.v=u,l?Ce(r,18,wq(e,f)):Ce(r,7,Tq(e,f))):(f.t="str",l?Ce(r,17,Mq(e,f)):Ce(r,6,Oq(e,f))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?l?Ce(r,13,Rq(e,f)):Ce(r,2,kq(e,f)):l?Ce(r,16,bq(e,f)):Ce(r,5,Aq(e,f)),!0;case"b":return f.t="b",l?Ce(r,15,pq(e,f)):Ce(r,4,dq(e,f)),!0;case"e":return f.t="e",l?Ce(r,14,_q(e,f)):Ce(r,3,xq(e,f)),!0}return l?Ce(r,12,fq(e,f)):Ce(r,1,cq(e,f)),!0}function iK(r,e,t,n){var a=Ot(e["!ref"]||"A1"),s,l="",u=[];Ce(r,145);var f=Array.isArray(e),d=a.e.r;e["!rows"]&&(d=Math.max(a.e.r,e["!rows"].length-1));for(var m=a.s.r;m<=d;++m){l=Lr(m),rq(r,e,a,m);var x=!1;if(m<=a.e.r)for(var _=a.s.c;_<=a.e.c;++_){m===a.s.r&&(u[_]=wr(_)),s=u[_]+l;var y=f?(e[m]||[])[_]:e[s];if(!y){x=!1;continue}x=aK(r,y,m,_,n,e,x)}}Ce(r,146)}function sK(r,e){!e||!e["!merges"]||(Ce(r,177,jq(e["!merges"].length)),e["!merges"].forEach(function(t){Ce(r,176,zq(t))}),Ce(r,178))}function oK(r,e){!e||!e["!cols"]||(Ce(r,390),e["!cols"].forEach(function(t,n){t&&Ce(r,60,Wq(n,t))}),Ce(r,391))}function lK(r,e){!e||!e["!ref"]||(Ce(r,648),Ce(r,649,Zq(Ot(e["!ref"]))),Ce(r,650))}function cK(r,e,t){e["!links"].forEach(function(n){if(n[1].Target){var a=Yt(t,-1,n[1].Target.replace(/#.*$/,""),Tt.HLINK);Ce(r,494,Gq(n,a))}}),delete e["!links"]}function uK(r,e,t,n){if(e["!comments"].length>0){var a=Yt(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Tt.VML);Ce(r,551,ny("rId"+a)),e["!legacy"]=a}}function fK(r,e,t,n){if(e["!autofilter"]){var a=e["!autofilter"],s=typeof a.ref=="string"?a.ref:gt(a.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var l=t.Workbook.Names,u=ia(s);u.s.r==u.e.r&&(u.e.r=ia(e["!ref"]).e.r,s=gt(u));for(var f=0;f<l.length;++f){var d=l[f];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==n){d.Ref="'"+t.SheetNames[n]+"'!"+s;break}}f==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+s}),Ce(r,161,lf(Ot(s))),Ce(r,162)}}function hK(r,e,t){Ce(r,133),Ce(r,137,Jq(e,t)),Ce(r,138),Ce(r,134)}function dK(r,e){e["!protect"]&&Ce(r,535,eK(e["!protect"]))}function mK(r,e,t,n){var a=aa(),s=t.SheetNames[r],l=t.Sheets[s]||{},u=s;try{t&&t.Workbook&&(u=t.Workbook.Sheets[r].CodeName||u)}catch{}var f=Ot(l["!ref"]||"A1");if(f.e.c>16383||f.e.r>1048575){if(e.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],Ce(a,129),(t.vbaraw||l["!outline"])&&Ce(a,147,oq(u,l["!outline"])),Ce(a,148,aq(f)),hK(a,l,t.Workbook),oK(a,l),iK(a,l,r,e),dK(a,l),fK(a,l,t,r),sK(a,l),cK(a,l,n),l["!margins"]&&Ce(a,476,$q(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&lK(a,l),uK(a,l,r,n),Ce(a,130),a.end()}function pK(r){var e=[],t=r.match(/^<c:numCache>/),n;(r.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var l=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(e[+l[1]]=t?+l[2]:l[2])});var a=Nt((r.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(r.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,a,n]}function gK(r,e,t,n,a,s){var l=s||{"!type":"chart"};if(!r)return s;var u=0,f=0,d="A",m={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(r.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(x){var _=pK(x);m.s.r=m.s.c=0,m.e.c=u,d=wr(u),_[0].forEach(function(y,w){l[d+Lr(w)]={t:"n",v:y,z:_[1]},f=w}),m.e.r<f&&(m.e.r=f),++u}),u>0&&(l["!ref"]=gt(m)),l}function xK(r,e,t,n,a){if(!r)return r;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},l,u=r.match(q3);return u&&xy(u[0],s,a,t),(l=r.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=l[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function vK(r,e){r.l+=10;var t=On(r);return{name:t}}function _K(r,e,t,n,a){if(!r)return r;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},l=!1;return Bs(r,function(f,d,m){switch(m){case 550:s["!rel"]=f;break;case 651:a.Sheets[t]||(a.Sheets[t]={}),f.name&&(a.Sheets[t].CodeName=f.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!l||e.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var vy=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],yK=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],TK=[],EK=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function ob(r,e){for(var t=0;t!=r.length;++t)for(var n=r[t],a=0;a!=e.length;++a){var s=e[a];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=dr(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function lb(r,e){for(var t=0;t!=e.length;++t){var n=e[t];if(r[n[0]]==null)r[n[0]]=n[1];else switch(n[2]){case"bool":typeof r[n[0]]=="string"&&(r[n[0]]=dr(r[n[0]]));break;case"int":typeof r[n[0]]=="string"&&(r[n[0]]=parseInt(r[n[0]],10));break}}}function Y3(r){lb(r.WBProps,vy),lb(r.CalcPr,EK),ob(r.WBView,yK),ob(r.Sheets,TK),Du.date1904=dr(r.WBProps.date1904)}function wK(r){return!r.Workbook||!r.Workbook.WBProps?"false":dr(r.Workbook.WBProps.date1904)?"true":"false"}var SK="][*?/\\".split("");function $3(r,e){if(r.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return SK.forEach(function(n){if(r.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function AK(r,e,t){r.forEach(function(n,a){$3(n);for(var s=0;s<a;++s)if(n==r[s])throw new Error("Duplicate Sheet Name: "+n);if(t){var l=e&&e[a]&&e[a].CodeName||n;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function bK(r){if(!r||!r.SheetNames||!r.Sheets)throw new Error("Invalid Workbook");if(!r.SheetNames.length)throw new Error("Workbook is empty");var e=r.Workbook&&r.Workbook.Sheets||[];AK(r.SheetNames,e,!!r.vbaraw);for(var t=0;t<r.SheetNames.length;++t)wG(r.Sheets[r.SheetNames[t]],r.SheetNames[t],t)}var IK=/<\w+:workbook/;function kK(r,e){if(!r)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},l=0;if(r.replace(Pn,function(f,d){var m=it(f);switch(Yi(m[0])){case"<?xml":break;case"<workbook":f.match(IK)&&(a="xmlns"+f.match(/<(\w+):/)[1]),t.xmlns=m[a];break;case"</workbook>":break;case"<fileVersion":delete m[0],t.AppVersion=m;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":vy.forEach(function(x){if(m[x[0]]!=null)switch(x[2]){case"bool":t.WBProps[x[0]]=dr(m[x[0]]);break;case"int":t.WBProps[x[0]]=parseInt(m[x[0]],10);break;default:t.WBProps[x[0]]=m[x[0]]}}),m.codeName&&(t.WBProps.CodeName=ir(m.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete m[0],t.WBView.push(m);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(m.state){case"hidden":m.Hidden=1;break;case"veryHidden":m.Hidden=2;break;default:m.Hidden=0}delete m.state,m.name=Nt(ir(m.name)),delete m[0],t.Sheets.push(m);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=ir(m.name),m.comment&&(s.Comment=m.comment),m.localSheetId&&(s.Sheet=+m.localSheetId),dr(m.hidden||"0")&&(s.Hidden=!0),l=d+f.length;break;case"</definedName>":s.Ref=Nt(ir(r.slice(l,d))),t.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete m[0],t.CalcPr=m;break;case"<calcPr/>":delete m[0],t.CalcPr=m;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+m[0]+" in workbook")}return f}),dc.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return Y3(t),t}function Q3(r){var e=[Vr];e[e.length]=Be("workbook",null,{xmlns:dc[0],"xmlns:r":Qr.r});var t=r.Workbook&&(r.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};r.Workbook&&r.Workbook.WBProps&&(vy.forEach(function(u){r.Workbook.WBProps[u[0]]!=null&&r.Workbook.WBProps[u[0]]!=u[1]&&(n[u[0]]=r.Workbook.WBProps[u[0]])}),r.Workbook.WBProps.CodeName&&(n.codeName=r.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=Be("workbookPr",null,n);var a=r.Workbook&&r.Workbook.Sheets||[],s=0;if(a&&a[0]&&a[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=r.SheetNames.length&&!(!a[s]||!a[s].Hidden);++s);s==r.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=r.SheetNames.length;++s){var l={name:Qt(r.SheetNames[s].slice(0,31))};if(l.sheetId=""+(s+1),l["r:id"]="rId"+(s+1),a[s])switch(a[s].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}e[e.length]=Be("sheet",null,l)}return e[e.length]="</sheets>",t&&(e[e.length]="<definedNames>",r.Workbook&&r.Workbook.Names&&r.Workbook.Names.forEach(function(u){var f={name:u.Name};u.Comment&&(f.comment=u.Comment),u.Sheet!=null&&(f.localSheetId=""+u.Sheet),u.Hidden&&(f.hidden="1"),u.Ref&&(e[e.length]=Be("definedName",Qt(u.Ref),f))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function CK(r,e){var t={};return t.Hidden=r.read_shift(4),t.iTabID=r.read_shift(4),t.strRelID=mv(r),t.name=On(r),t}function RK(r,e){return e||(e=ye(127)),e.write_shift(4,r.Hidden),e.write_shift(4,r.iTabID),ny(r.strRelID,e),cn(r.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function DK(r,e){var t={},n=r.read_shift(4);t.defaultThemeVersion=r.read_shift(4);var a=e>8?On(r):"";return a.length>0&&(t.CodeName=a),t.autoCompressPictures=!!(n&65536),t.backupFile=!!(n&64),t.checkCompatibility=!!(n&4096),t.date1904=!!(n&1),t.filterPrivacy=!!(n&8),t.hidePivotFieldList=!!(n&1024),t.promptedSolutions=!!(n&16),t.publishItems=!!(n&2048),t.refreshAllConnections=!!(n&262144),t.saveExternalLinkValues=!!(n&128),t.showBorderUnselectedTables=!!(n&4),t.showInkAnnotation=!!(n&32),t.showObjects=["all","placeholders","none"][n>>13&3],t.showPivotChartFilter=!!(n&32768),t.updateLinks=["userSet","never","always"][n>>8&3],t}function NK(r,e){e||(e=ye(72));var t=0;return r&&r.filterPrivacy&&(t|=8),e.write_shift(4,t),e.write_shift(4,0),jC(r&&r.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function OK(r,e){var t={};return r.read_shift(4),t.ArchID=r.read_shift(4),r.l+=e-8,t}function FK(r,e,t){var n=r.l+e;r.l+=4,r.l+=1;var a=r.read_shift(4),s=uV(r),l=xG(r,0,t),u=ry(r);r.l=n;var f={Name:s,Ptg:l};return a<268435455&&(f.Sheet=a),u&&(f.Comment=u),f}function MK(r,e){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;e||(e={}),e.biff=12;var s=[],l=[[]];return l.SheetNames=[],l.XTI=[],c0[16]={n:"BrtFRTArchID$",f:OK},Bs(r,function(f,d,m){switch(m){case 156:l.SheetNames.push(f.name),t.Sheets.push(f);break;case 153:t.WBProps=f;break;case 39:f.Sheet!=null&&(e.SID=f.Sheet),f.Ref=Cn(f.Ptg,null,null,l,e),delete e.SID,delete f.Ptg,s.push(f);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([m,f]):l[0]=[m,f],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(f),l.XTI=l.XTI.concat(f);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(m),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(m),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!d.T){if(!a||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}},e),Y3(t),t.Names=s,t.supbooks=l,t}function PK(r,e){Ce(r,143);for(var t=0;t!=e.SheetNames.length;++t){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[t]&&e.Workbook.Sheets[t].Hidden||0,a={Hidden:n,iTabID:t+1,strRelID:"rId"+(t+1),name:e.SheetNames[t]};Ce(r,156,RK(a))}Ce(r,144)}function LK(r,e){e||(e=ye(127));for(var t=0;t!=4;++t)e.write_shift(4,0);return cn("SheetJS",e),cn(lp.version,e),cn(lp.version,e),cn("7262",e),e.length>e.l?e.slice(0,e.l):e}function VK(r,e){e||(e=ye(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,r),e.write_shift(4,r);var t=120;return e.write_shift(1,t),e.length>e.l?e.slice(0,e.l):e}function BK(r,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var t=e.Workbook.Sheets,n=0,a=-1,s=-1;n<t.length;++n)!t[n]||!t[n].Hidden&&a==-1?a=n:t[n].Hidden==1&&s==-1&&(s=n);s>a||(Ce(r,135),Ce(r,158,VK(a)),Ce(r,136))}}function UK(r,e){var t=aa();return Ce(t,131),Ce(t,128,LK()),Ce(t,153,NK(r.Workbook&&r.Workbook.WBProps||null)),BK(t,r),PK(t,r),Ce(t,132),t.end()}function zK(r,e,t){return e.slice(-4)===".bin"?MK(r,t):kK(r,t)}function jK(r,e,t,n,a,s,l,u){return e.slice(-4)===".bin"?nK(r,n,t,a,s,l,u):FG(r,n,t,a,s,l,u)}function HK(r,e,t,n,a,s,l,u){return e.slice(-4)===".bin"?_K(r,n,t,a,s):xK(r,n,t,a,s)}function GK(r,e,t,n,a,s,l,u){return e.slice(-4)===".bin"?Kj():Xj()}function qK(r,e,t,n,a,s,l,u){return e.slice(-4)===".bin"?Gj():qj()}function KK(r,e,t,n){return e.slice(-4)===".bin"?zz(r,t,n):Cz(r,t,n)}function XK(r,e,t){return D3(r,t)}function WK(r,e,t){return e.slice(-4)===".bin"?WU(r,t):qU(r,t)}function YK(r,e,t){return e.slice(-4)===".bin"?Bj(r,t):Rj(r,t)}function $K(r,e,t){return e.slice(-4)===".bin"?Ij(r):Aj(r)}function QK(r,e,t,n){return t.slice(-4)===".bin"?kj(r,e,t,n):void 0}function JK(r,e,t){return e.slice(-4)===".bin"?Ej(r,e,t):Sj(r,e,t)}function ZK(r,e,t){return(e.slice(-4)===".bin"?UK:Q3)(r)}function eX(r,e,t,n,a){return(e.slice(-4)===".bin"?mK:K3)(r,t,n,a)}function tX(r,e,t){return(e.slice(-4)===".bin"?Qz:C3)(r,t)}function rX(r,e,t){return(e.slice(-4)===".bin"?QU:T3)(r,t)}function nX(r,e,t){return(e.slice(-4)===".bin"?Uj:F3)(r)}function aX(r){return(r.slice(-4)===".bin"?wj:N3)()}var J3=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Z3=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function mi(r,e){var t=r.split(/\s+/),n=[];if(n[0]=t[0],t.length===1)return n;var a=r.match(J3),s,l,u,f;if(a)for(f=0;f!=a.length;++f)s=a[f].match(Z3),(l=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?u="xmlns"+s[1].slice(6):u=s[1].slice(l+1),n[u]=s[2].slice(1,s[2].length-1));return n}function iX(r){var e=r.split(/\s+/),t={};if(e.length===1)return t;var n=r.match(J3),a,s,l,u;if(n)for(u=0;u!=n.length;++u)a=n[u].match(Z3),(s=a[1].indexOf(":"))===-1?t[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(s+1),t[l]=a[2].slice(1,a[2].length-1));return t}var Ph;function sX(r,e){var t=Ph[r]||Nt(r);return t==="General"?rc(e):ei(t,e)}function oX(r,e,t,n){var a=n;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=dr(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=mr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}r[Nt(e)]=a}function lX(r,e,t){if(r.t!=="z"){if(!t||t.cellText!==!1)try{r.t==="e"?r.w=r.w||Us[r.v]:e==="General"?r.t==="n"?(r.v|0)===r.v?r.w=r.v.toString(10):r.w=e0(r.v):r.w=rc(r.v):r.w=sX(e||"General",r.v)}catch(s){if(t.WTF)throw s}try{var n=Ph[e]||e||"General";if(t.cellNF&&(r.z=n),t.cellDates&&r.t=="n"&&af(n)){var a=Ml(r.v);a&&(r.t="d",r.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(t.WTF)throw s}}}function cX(r,e,t){if(t.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=Tz[n.Pattern]||n.Pattern)}r[e.ID]=e}function uX(r,e,t,n,a,s,l,u,f,d){var m="General",x=n.StyleID,_={};d=d||{};var y=[],w=0;for(x===void 0&&u&&(x=u.StyleID),x===void 0&&l&&(x=l.StyleID);s[x]!==void 0&&(s[x].nf&&(m=s[x].nf),s[x].Interior&&y.push(s[x].Interior),!!s[x].Parent);)x=s[x].Parent;switch(t.Type){case"Boolean":n.t="b",n.v=dr(r);break;case"String":n.t="s",n.r=AA(Nt(r)),n.v=r.indexOf("<")>-1?Nt(e||r).replace(/<.*?>/g,""):n.r;break;case"DateTime":r.slice(-1)!="Z"&&(r+="Z"),n.v=(mr(r)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=Nt(r):n.v<60&&(n.v=n.v-1),(!m||m=="General")&&(m="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+r),n.t||(n.t="n");break;case"Error":n.t="e",n.v=XC[r],d.cellText!==!1&&(n.w=r);break;default:r==""&&e==""?n.t="z":(n.t="s",n.v=AA(e||r));break}if(lX(n,m,d),d.cellFormula!==!1)if(n.Formula){var T=Nt(n.Formula);T.charCodeAt(0)==61&&(T=T.slice(1)),n.f=Ru(T,a),delete n.Formula,n.ArrayRange=="RC"?n.F=Ru("RC:RC",a):n.ArrayRange&&(n.F=Ru(n.ArrayRange,a),f.push([Ot(n.F),n.F]))}else for(w=0;w<f.length;++w)a.r>=f[w][0].s.r&&a.r<=f[w][0].e.r&&a.c>=f[w][0].s.c&&a.c<=f[w][0].e.c&&(n.F=f[w][1]);d.cellStyles&&(y.forEach(function(S){!_.patternType&&S.patternType&&(_.patternType=S.patternType)}),n.s=_),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function fX(r){r.t=r.v||"",r.t=r.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.v=r.w=r.ixfe=void 0}function Ix(r,e){var t=e||{};sf();var n=xh($_(r));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(n=ir(n));var a=n.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var l=pr(t);return l.type="string",Yu.to_workbook(n,l)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(sr){a.indexOf("<"+sr)>=0&&(s=!0)}),s)return $X(n,t);Ph={"General Number":"General","General Date":nt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":nt[15],"Short Date":nt[14],"Long Time":nt[19],"Medium Time":nt[18],"Short Time":nt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:nt[2],Standard:nt[4],Percent:nt[10],Scientific:nt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,f=[],d,m={},x=[],_=t.dense?[]:{},y="",w={},T={},S=mi('<Data ss:Type="String">'),O=0,U=0,R=0,Y={s:{r:2e6,c:2e6},e:{r:0,c:0}},te={},G={},A="",C=0,k=[],V={},F={},M=0,L=[],Ie=[],Re={},ae=[],le,Fe=!1,ie=[],Ne=[],Q={},N=0,J=0,X={Sheets:[],WBProps:{date1904:!1}},ee={};n0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ce="";u=n0.exec(n);)switch(u[3]=(ce=u[3]).toLowerCase()){case"data":if(ce=="data"){if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&f.push([u[3],!0]);break}if(f[f.length-1][1])break;u[1]==="/"?uX(n.slice(O,u.index),A,S,f[f.length-1][0]=="comment"?Re:w,{c:U,r:R},te,ae[U],T,ie,t):(A="",S=mi(u[0]),O=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(Ie.length>0&&(w.c=Ie),(!t.sheetRows||t.sheetRows>R)&&w.v!==void 0&&(t.dense?(_[R]||(_[R]=[]),_[R][U]=w):_[wr(U)+Lr(R)]=w),w.HRef&&(w.l={Target:Nt(w.HRef)},w.HRefScreenTip&&(w.l.Tooltip=w.HRefScreenTip),delete w.HRef,delete w.HRefScreenTip),(w.MergeAcross||w.MergeDown)&&(N=U+(parseInt(w.MergeAcross,10)|0),J=R+(parseInt(w.MergeDown,10)|0),k.push({s:{c:U,r:R},e:{c:N,r:J}})),!t.sheetStubs)w.MergeAcross?U=N+1:++U;else if(w.MergeAcross||w.MergeDown){for(var we=U;we<=N;++we)for(var De=R;De<=J;++De)(we>U||De>R)&&(t.dense?(_[De]||(_[De]=[]),_[De][we]={t:"z"}):_[wr(we)+Lr(De)]={t:"z"});U=N+1}else++U;else w=iX(u[0]),w.Index&&(U=+w.Index-1),U<Y.s.c&&(Y.s.c=U),U>Y.e.c&&(Y.e.c=U),u[0].slice(-2)==="/>"&&++U,Ie=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(R<Y.s.r&&(Y.s.r=R),R>Y.e.r&&(Y.e.r=R),u[0].slice(-2)==="/>"&&(T=mi(u[0]),T.Index&&(R=+T.Index-1)),U=0,++R):(T=mi(u[0]),T.Index&&(R=+T.Index-1),Q={},(T.AutoFitHeight=="0"||T.Height)&&(Q.hpx=parseInt(T.Height,10),Q.hpt=l0(Q.hpx),Ne[R]=Q),T.Hidden=="1"&&(Q.hidden=!0,Ne[R]=Q));break;case"worksheet":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));x.push(y),Y.s.r<=Y.e.r&&Y.s.c<=Y.e.c&&(_["!ref"]=gt(Y),t.sheetRows&&t.sheetRows<=Y.e.r&&(_["!fullref"]=_["!ref"],Y.e.r=t.sheetRows-1,_["!ref"]=gt(Y))),k.length&&(_["!merges"]=k),ae.length>0&&(_["!cols"]=ae),Ne.length>0&&(_["!rows"]=Ne),m[y]=_}else Y={s:{r:2e6,c:2e6},e:{r:0,c:0}},R=U=0,f.push([u[3],!1]),d=mi(u[0]),y=Nt(d.Name),_=t.dense?[]:{},k=[],ie=[],Ne=[],ee={name:y,Hidden:0},X.Sheets.push(ee);break;case"table":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else{if(u[0].slice(-2)=="/>")break;f.push([u[3],!1]),ae=[],Fe=!1}break;case"style":u[1]==="/"?cX(te,G,t):G=mi(u[0]);break;case"numberformat":G.nf=Nt(mi(u[0]).Format||"General"),Ph[G.nf]&&(G.nf=Ph[G.nf]);for(var Ae=0;Ae!=392&&nt[Ae]!=G.nf;++Ae);if(Ae==392){for(Ae=57;Ae!=392;++Ae)if(nt[Ae]==null){Rs(G.nf,Ae);break}}break;case"column":if(f[f.length-1][0]!=="table")break;if(le=mi(u[0]),le.Hidden&&(le.hidden=!0,delete le.Hidden),le.Width&&(le.wpx=parseInt(le.Width,10)),!Fe&&le.wpx>10){Fe=!0,Rn=I3;for(var Oe=0;Oe<ae.length;++Oe)ae[Oe]&&Ho(ae[Oe])}Fe&&Ho(le),ae[le.Index-1||ae.length]=le;for(var st=0;st<+le.Span;++st)ae[ae.length]=pr(le);break;case"namedrange":if(u[1]==="/")break;X.Names||(X.Names=[]);var Z=it(u[0]),Ft={Name:Z.Name,Ref:Ru(Z.RefersTo.slice(1),{r:0,c:0})};X.Sheets.length>0&&(Ft.Sheet=X.Sheets.length-1),X.Names.push(Ft);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?A+=n.slice(C,u.index):C=u.index+u[0].length;break;case"interior":if(!t.cellStyles)break;G.Interior=mi(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?MV(V,ce,n.slice(M,u.index)):M=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else f.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));fX(Re),Ie.push(Re)}else f.push([u[3],!1]),d=mi(u[0]),Re={a:d.Author};break;case"autofilter":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var lt=mi(u[0]);_["!autofilter"]={ref:Ru(lt.Range).replace(/\$/g,"")},f.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&f.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&f.push([u[3],!0]);break;case"null":break;default:if(f.length==0&&u[3]=="document"||f.length==0&&u[3]=="uof")return db(n,t);var Rt=!0;switch(f[f.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Rt=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Rt=!1}break;case"excelworkbook":switch(u[3]){case"date1904":X.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Rt=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:Rt=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(n.slice(M,u.index)){case"SheetHidden":ee.Hidden=1;break;case"SheetVeryHidden":ee.Hidden=2;break}else M=u.index+u[0].length;break;case"header":_["!margins"]||Gl(_["!margins"]={},"xlml"),isNaN(+it(u[0]).Margin)||(_["!margins"].header=+it(u[0]).Margin);break;case"footer":_["!margins"]||Gl(_["!margins"]={},"xlml"),isNaN(+it(u[0]).Margin)||(_["!margins"].footer=+it(u[0]).Margin);break;case"pagemargins":var ct=it(u[0]);_["!margins"]||Gl(_["!margins"]={},"xlml"),isNaN(+ct.Top)||(_["!margins"].top=+ct.Top),isNaN(+ct.Left)||(_["!margins"].left=+ct.Left),isNaN(+ct.Right)||(_["!margins"].right=+ct.Right),isNaN(+ct.Bottom)||(_["!margins"].bottom=+ct.Bottom);break;case"displayrighttoleft":X.Views||(X.Views=[]),X.Views[0]||(X.Views[0]={}),X.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Rt=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Rt=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Rt=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Rt=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Rt=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Rt=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Rt=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Rt=!1}break;case"smarttags":break;default:Rt=!1;break}if(Rt||u[3].match(/!\[CDATA/))break;if(!f[f.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+f.join("|");if(f[f.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?oX(F,ce,L,n.slice(M,u.index)):(L=u,M=u.index+u[0].length);break}if(t.WTF)throw"Unrecognized tag: "+u[3]+"|"+f.join("|")}var He={};return!t.bookSheets&&!t.bookProps&&(He.Sheets=m),He.SheetNames=x,He.Workbook=X,He.SSF=pr(nt),He.Props=V,He.Custprops=F,He}function Tv(r,e){switch(yy(e=e||{}),e.type||"base64"){case"base64":return Ix(Ia(r),e);case"binary":case"buffer":case"file":return Ix(r,e);case"array":return Ix(Wo(r),e)}}function hX(r,e){var t=[];return r.Props&&t.push(PV(r.Props,e)),r.Custprops&&t.push(LV(r.Props,r.Custprops)),t.join("")}function dX(){return""}function mX(r,e){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,a){var s=[];s.push(Be("NumberFormat",null,{"ss:Format":Qt(nt[n.numFmtId])}));var l={"ss:ID":"s"+(21+a)};t.push(Be("Style",s.join(""),l))}),Be("Styles",t.join(""))}function eR(r){return Be("NamedRange",null,{"ss:Name":r.Name,"ss:RefersTo":"="+my(r.Ref,{r:0,c:0})})}function pX(r){if(!((r||{}).Workbook||{}).Names)return"";for(var e=r.Workbook.Names,t=[],n=0;n<e.length;++n){var a=e[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||t.push(eR(a)))}return Be("Names",t.join(""))}function gX(r,e,t,n){if(!r||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,s=[],l=0;l<a.length;++l){var u=a[l];u.Sheet==t&&(u.Name.match(/^_xlfn\./)||s.push(eR(u)))}return s.join("")}function xX(r,e,t,n){if(!r)return"";var a=[];if(r["!margins"]&&(a.push("<PageSetup>"),r["!margins"].header&&a.push(Be("Header",null,{"x:Margin":r["!margins"].header})),r["!margins"].footer&&a.push(Be("Footer",null,{"x:Margin":r["!margins"].footer})),a.push(Be("PageMargins",null,{"x:Bottom":r["!margins"].bottom||"0.75","x:Left":r["!margins"].left||"0.7","x:Right":r["!margins"].right||"0.7","x:Top":r["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[t])if(n.Workbook.Sheets[t].Hidden)a.push(Be("Visible",n.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<t&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==t&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),r["!protect"]&&(a.push(Tn("ProtectContents","True")),r["!protect"].objects&&a.push(Tn("ProtectObjects","True")),r["!protect"].scenarios&&a.push(Tn("ProtectScenarios","True")),r["!protect"].selectLockedCells!=null&&!r["!protect"].selectLockedCells?a.push(Tn("EnableSelection","NoSelection")):r["!protect"].selectUnlockedCells!=null&&!r["!protect"].selectUnlockedCells&&a.push(Tn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){r["!protect"][l[0]]&&a.push("<"+l[1]+"/>")})),a.length==0?"":Be("WorksheetOptions",a.join(""),{xmlns:_a.x})}function vX(r){return r.map(function(e){var t=B7(e.t||""),n=Be("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return Be("Comment",n,{"ss:Author":e.a})}).join("")}function _X(r,e,t,n,a,s,l){if(!r||r.v==null&&r.f==null)return"";var u={};if(r.f&&(u["ss:Formula"]="="+Qt(my(r.f,l))),r.F&&r.F.slice(0,e.length)==e){var f=Sr(r.F.slice(e.length+1));u["ss:ArrayRange"]="RC:R"+(f.r==l.r?"":"["+(f.r-l.r)+"]")+"C"+(f.c==l.c?"":"["+(f.c-l.c)+"]")}if(r.l&&r.l.Target&&(u["ss:HRef"]=Qt(r.l.Target),r.l.Tooltip&&(u["x:HRefScreenTip"]=Qt(r.l.Tooltip))),t["!merges"])for(var d=t["!merges"],m=0;m!=d.length;++m)d[m].s.c!=l.c||d[m].s.r!=l.r||(d[m].e.c>d[m].s.c&&(u["ss:MergeAcross"]=d[m].e.c-d[m].s.c),d[m].e.r>d[m].s.r&&(u["ss:MergeDown"]=d[m].e.r-d[m].s.r));var x="",_="";switch(r.t){case"z":if(!n.sheetStubs)return"";break;case"n":x="Number",_=String(r.v);break;case"b":x="Boolean",_=r.v?"1":"0";break;case"e":x="Error",_=Us[r.v];break;case"d":x="DateTime",_=new Date(r.v).toISOString(),r.z==null&&(r.z=r.z||nt[14]);break;case"s":x="String",_=V7(r.v||"");break}var y=$o(n.cellXfs,r,n);u["ss:StyleID"]="s"+(21+y),u["ss:Index"]=l.c+1;var w=r.v!=null?_:"",T=r.t=="z"?"":'<Data ss:Type="'+x+'">'+w+"</Data>";return(r.c||[]).length>0&&(T+=vX(r.c)),Be("Cell",T,u)}function yX(r,e){var t='<Row ss:Index="'+(r+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=$u(e.hpt)),e.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(t+=' ss:Hidden="1"')),t+">"}function TX(r,e,t,n){if(!r["!ref"])return"";var a=Ot(r["!ref"]),s=r["!merges"]||[],l=0,u=[];r["!cols"]&&r["!cols"].forEach(function(S,O){Ho(S);var U=!!S.width,R=tg(O,S),Y={"ss:Index":O+1};U&&(Y["ss:Width"]=s0(R.width)),S.hidden&&(Y["ss:Hidden"]="1"),u.push(Be("Column",null,Y))});for(var f=Array.isArray(r),d=a.s.r;d<=a.e.r;++d){for(var m=[yX(d,(r["!rows"]||[])[d])],x=a.s.c;x<=a.e.c;++x){var _=!1;for(l=0;l!=s.length;++l)if(!(s[l].s.c>x)&&!(s[l].s.r>d)&&!(s[l].e.c<x)&&!(s[l].e.r<d)){(s[l].s.c!=x||s[l].s.r!=d)&&(_=!0);break}if(!_){var y={r:d,c:x},w=at(y),T=f?(r[d]||[])[x]:r[w];m.push(_X(T,w,r,e,t,n,y))}}m.push("</Row>"),m.length>2&&u.push(m.join(""))}return u.join("")}function EX(r,e,t){var n=[],a=t.SheetNames[r],s=t.Sheets[a],l=s?gX(s,e,r,t):"";return l.length>0&&n.push("<Names>"+l+"</Names>"),l=s?TX(s,e,r,t):"",l.length>0&&n.push("<Table>"+l+"</Table>"),n.push(xX(s,e,r,t)),n.join("")}function wX(r,e){e||(e={}),r.SSF||(r.SSF=pr(nt)),r.SSF&&(sf(),Wp(r.SSF),e.revssf=$p(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF,e.cellXfs=[],$o(e.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(hX(r,e)),t.push(dX()),t.push(""),t.push("");for(var n=0;n<r.SheetNames.length;++n)t.push(Be("Worksheet",EX(n,e,r),{"ss:Name":Qt(r.SheetNames[n])}));return t[2]=mX(r,e),t[3]=pX(r),Vr+Be("Workbook",t.join(""),{xmlns:_a.ss,"xmlns:o":_a.o,"xmlns:x":_a.x,"xmlns:ss":_a.ss,"xmlns:dt":_a.dt,"xmlns:html":_a.html})}function SX(r){var e={},t=r.content;if(t.l=28,e.AnsiUserType=t.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=pV(t),t.length-t.l<=4)return e;var n=t.read_shift(4);if(n==0||n>40||(t.l-=4,e.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(n=t.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=gV(t),n=t.read_shift(4),n==0||n>40))return e;t.l-=4,e.Reserved2=t.read_shift(0,"lpwstr")}var AX=[60,1084,2066,2165,2175];function bX(r,e,t,n,a){var s=n,l=[],u=t.slice(t.l,t.l+s);if(a&&a.enc&&a.enc.insitu&&u.length>0)switch(r){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(u)}l.push(u),t.l+=s;for(var f=bs(t,t.l),d=Ev[f],m=0;d!=null&&AX.indexOf(f)>-1;)s=bs(t,t.l+2),m=t.l+4,f==2066?m+=4:(f==2165||f==2175)&&(m+=12),u=t.slice(m,t.l+4+s),l.push(u),t.l+=4+s,d=Ev[f=bs(t,t.l)];var x=ln(l);yn(x,0);var _=0;x.lens=[];for(var y=0;y<l.length;++y)x.lens.push(_),_+=l[y].length;if(x.length<n)throw"XLS Record 0x"+r.toString(16)+" Truncated: "+x.length+" < "+n;return e.f(x,x.length,a)}function Pi(r,e,t){if(r.t!=="z"&&r.XF){var n=0;try{n=r.z||r.XF.numFmtId||0,e.cellNF&&(r.z=nt[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{r.t==="e"?r.w=r.w||Us[r.v]:n===0||n=="General"?r.t==="n"?(r.v|0)===r.v?r.w=r.v.toString(10):r.w=e0(r.v):r.w=rc(r.v):r.w=ei(n,r.v,{date1904:!!t,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&r.t=="n"&&af(nt[n]||String(n))){var a=Ml(r.v);a&&(r.t="d",r.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function pm(r,e,t){return{v:r,ixfe:e,t}}function IX(r,e){var t={opts:{}},n={},a=e.dense?[]:{},s={},l={},u=null,f=[],d="",m={},x,_="",y,w,T,S,O={},U=[],R,Y,te=[],G=[],A={Sheets:[],WBProps:{date1904:!1},Views:[{}]},C={},k=function(dt){return dt<8?zl[dt]:dt<64&&G[dt-8]||zl[dt]},V=function(dt,cr,fn){var Vt=cr.XF.data;if(!(!Vt||!Vt.patternType||!fn||!fn.cellStyles)){cr.s={},cr.s.patternType=Vt.patternType;var ur;(ur=i0(k(Vt.icvFore)))&&(cr.s.fgColor={rgb:ur}),(ur=i0(k(Vt.icvBack)))&&(cr.s.bgColor={rgb:ur})}},F=function(dt,cr,fn){if(!(Q>1)&&!(fn.sheetRows&&dt.r>=fn.sheetRows)){if(fn.cellStyles&&cr.XF&&cr.XF.data&&V(dt,cr,fn),delete cr.ixfe,delete cr.XF,x=dt,_=at(dt),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),dt.r<l.s.r&&(l.s.r=dt.r),dt.c<l.s.c&&(l.s.c=dt.c),dt.r+1>l.e.r&&(l.e.r=dt.r+1),dt.c+1>l.e.c&&(l.e.c=dt.c+1),fn.cellFormula&&cr.f){for(var Vt=0;Vt<U.length;++Vt)if(!(U[Vt][0].s.c>dt.c||U[Vt][0].s.r>dt.r)&&!(U[Vt][0].e.c<dt.c||U[Vt][0].e.r<dt.r)){cr.F=gt(U[Vt][0]),(U[Vt][0].s.c!=dt.c||U[Vt][0].s.r!=dt.r)&&delete cr.f,cr.f&&(cr.f=""+Cn(U[Vt][1],l,dt,ie,M));break}}fn.dense?(a[dt.r]||(a[dt.r]=[]),a[dt.r][dt.c]=cr):a[_]=cr}},M={enc:!1,sbcch:0,snames:[],sharedf:O,arrayf:U,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(M.password=e.password);var L,Ie=[],Re=[],ae=[],le=[],Fe=!1,ie=[];ie.SheetNames=M.snames,ie.sharedf=M.sharedf,ie.arrayf=M.arrayf,ie.names=[],ie.XTI=[];var Ne=0,Q=0,N=0,J=[],X=[],ee;M.codepage=1200,vi(1200);for(var ce=!1;r.l<r.length-1;){var we=r.l,De=r.read_shift(2);if(De===0&&Ne===10)break;var Ae=r.l===r.length?0:r.read_shift(2),Oe=Ev[De];if(Oe&&Oe.f){if(e.bookSheets&&Ne===133&&De!==133)break;if(Ne=De,Oe.r===2||Oe.r==12){var st=r.read_shift(2);if(Ae-=2,!M.enc&&st!==De&&((st&255)<<8|st>>8)!==De)throw new Error("rt mismatch: "+st+"!="+De);Oe.r==12&&(r.l+=10,Ae-=10)}var Z={};if(De===10?Z=Oe.f(r,Ae,M):Z=bX(De,Oe,r,Ae,M),Q==0&&[9,521,1033,2057].indexOf(Ne)===-1)continue;switch(De){case 34:t.opts.Date1904=A.WBProps.date1904=Z;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(M.enc||(r.l=0),M.enc=Z,!e.password)throw new Error("File is password-protected");if(Z.valid==null)throw new Error("Encryption scheme unsupported");if(!Z.valid)throw new Error("Password is incorrect");break;case 92:M.lastuser=Z;break;case 66:var Ft=Number(Z);switch(Ft){case 21010:Ft=1200;break;case 32768:Ft=1e4;break;case 32769:Ft=1252;break}vi(M.codepage=Ft),ce=!0;break;case 317:M.rrtabid=Z;break;case 25:M.winlocked=Z;break;case 439:t.opts.RefreshAll=Z;break;case 12:t.opts.CalcCount=Z;break;case 16:t.opts.CalcDelta=Z;break;case 17:t.opts.CalcIter=Z;break;case 13:t.opts.CalcMode=Z;break;case 14:t.opts.CalcPrecision=Z;break;case 95:t.opts.CalcSaveRecalc=Z;break;case 15:M.CalcRefMode=Z;break;case 2211:t.opts.FullCalc=Z;break;case 129:Z.fDialog&&(a["!type"]="dialog"),Z.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),Z.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:te.push(Z);break;case 430:ie.push([Z]),ie[ie.length-1].XTI=[];break;case 35:case 547:ie[ie.length-1].push(Z);break;case 24:case 536:ee={Name:Z.Name,Ref:Cn(Z.rgce,l,null,ie,M)},Z.itab>0&&(ee.Sheet=Z.itab-1),ie.names.push(ee),ie[0]||(ie[0]=[],ie[0].XTI=[]),ie[ie.length-1].push(Z),Z.Name=="_xlnm._FilterDatabase"&&Z.itab>0&&Z.rgce&&Z.rgce[0]&&Z.rgce[0][0]&&Z.rgce[0][0][0]=="PtgArea3d"&&(X[Z.itab-1]={ref:gt(Z.rgce[0][0][1][2])});break;case 22:M.ExternCount=Z;break;case 23:ie.length==0&&(ie[0]=[],ie[0].XTI=[]),ie[ie.length-1].XTI=ie[ie.length-1].XTI.concat(Z),ie.XTI=ie.XTI.concat(Z);break;case 2196:if(M.biff<8)break;ee!=null&&(ee.Comment=Z[1]);break;case 18:a["!protect"]=Z;break;case 19:Z!==0&&M.WTF&&console.error("Password verifier: "+Z);break;case 133:s[Z.pos]=Z,M.snames.push(Z.name);break;case 10:{if(--Q)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,a["!ref"]=gt(l),e.sheetRows&&e.sheetRows<=l.e.r){var lt=l.e.r;l.e.r=e.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=gt(l),l.e.r=lt}l.e.r++,l.e.c++}Ie.length>0&&(a["!merges"]=Ie),Re.length>0&&(a["!objects"]=Re),ae.length>0&&(a["!cols"]=ae),le.length>0&&(a["!rows"]=le),A.Sheets.push(C)}d===""?m=a:n[d]=a,a=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(M.biff===8&&(M.biff={9:2,521:3,1033:4}[De]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Z.BIFFVer]||8),M.biffguess=Z.BIFFVer==0,Z.BIFFVer==0&&Z.dt==4096&&(M.biff=5,ce=!0,vi(M.codepage=28591)),M.biff==8&&Z.BIFFVer==0&&Z.dt==16&&(M.biff=2),Q++)break;if(a=e.dense?[]:{},M.biff<8&&!ce&&(ce=!0,vi(M.codepage=e.codepage||1252)),M.biff<5||Z.BIFFVer==0&&Z.dt==4096){d===""&&(d="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var Rt={pos:r.l-Ae,name:d};s[Rt.pos]=Rt,M.snames.push(d)}else d=(s[we]||{name:""}).name;Z.dt==32&&(a["!type"]="chart"),Z.dt==64&&(a["!type"]="macro"),Ie=[],Re=[],M.arrayf=U=[],ae=[],le=[],Fe=!1,C={Hidden:(s[we]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(e.dense?(a[Z.r]||[])[Z.c]:a[at({c:Z.c,r:Z.r})])&&++Z.c,R={ixfe:Z.ixfe,XF:te[Z.ixfe]||{},v:Z.val,t:"n"},N>0&&(R.z=J[R.ixfe>>8&63]),Pi(R,e,t.opts.Date1904),F({c:Z.c,r:Z.r},R,e);break;case 5:case 517:R={ixfe:Z.ixfe,XF:te[Z.ixfe],v:Z.val,t:Z.t},N>0&&(R.z=J[R.ixfe>>8&63]),Pi(R,e,t.opts.Date1904),F({c:Z.c,r:Z.r},R,e);break;case 638:R={ixfe:Z.ixfe,XF:te[Z.ixfe],v:Z.rknum,t:"n"},N>0&&(R.z=J[R.ixfe>>8&63]),Pi(R,e,t.opts.Date1904),F({c:Z.c,r:Z.r},R,e);break;case 189:for(var ct=Z.c;ct<=Z.C;++ct){var He=Z.rkrec[ct-Z.c][0];R={ixfe:He,XF:te[He],v:Z.rkrec[ct-Z.c][1],t:"n"},N>0&&(R.z=J[R.ixfe>>8&63]),Pi(R,e,t.opts.Date1904),F({c:ct,r:Z.r},R,e)}break;case 6:case 518:case 1030:{if(Z.val=="String"){u=Z;break}if(R=pm(Z.val,Z.cell.ixfe,Z.tt),R.XF=te[R.ixfe],e.cellFormula){var sr=Z.formula;if(sr&&sr[0]&&sr[0][0]&&sr[0][0][0]=="PtgExp"){var Dt=sr[0][0][1][0],zt=sr[0][0][1][1],rn=at({r:Dt,c:zt});O[rn]?R.f=""+Cn(Z.formula,l,Z.cell,ie,M):R.F=((e.dense?(a[Dt]||[])[zt]:a[rn])||{}).F}else R.f=""+Cn(Z.formula,l,Z.cell,ie,M)}N>0&&(R.z=J[R.ixfe>>8&63]),Pi(R,e,t.opts.Date1904),F(Z.cell,R,e),u=Z}break;case 7:case 519:if(u)u.val=Z,R=pm(Z,u.cell.ixfe,"s"),R.XF=te[R.ixfe],e.cellFormula&&(R.f=""+Cn(u.formula,l,u.cell,ie,M)),N>0&&(R.z=J[R.ixfe>>8&63]),Pi(R,e,t.opts.Date1904),F(u.cell,R,e),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{U.push(Z);var Qi=at(Z[0].s);if(y=e.dense?(a[Z[0].s.r]||[])[Z[0].s.c]:a[Qi],e.cellFormula&&y){if(!u||!Qi||!y)break;y.f=""+Cn(Z[1],l,Z[0],ie,M),y.F=gt(Z[0])}}break;case 1212:{if(!e.cellFormula)break;if(_){if(!u)break;O[at(u.cell)]=Z[0],y=e.dense?(a[u.cell.r]||[])[u.cell.c]:a[at(u.cell)],(y||{}).f=""+Cn(Z[0],l,x,ie,M)}}break;case 253:R=pm(f[Z.isst].t,Z.ixfe,"s"),f[Z.isst].h&&(R.h=f[Z.isst].h),R.XF=te[R.ixfe],N>0&&(R.z=J[R.ixfe>>8&63]),Pi(R,e,t.opts.Date1904),F({c:Z.c,r:Z.r},R,e);break;case 513:e.sheetStubs&&(R={ixfe:Z.ixfe,XF:te[Z.ixfe],t:"z"},N>0&&(R.z=J[R.ixfe>>8&63]),Pi(R,e,t.opts.Date1904),F({c:Z.c,r:Z.r},R,e));break;case 190:if(e.sheetStubs)for(var sa=Z.c;sa<=Z.C;++sa){var jt=Z.ixfe[sa-Z.c];R={ixfe:jt,XF:te[jt],t:"z"},N>0&&(R.z=J[R.ixfe>>8&63]),Pi(R,e,t.opts.Date1904),F({c:sa,r:Z.r},R,e)}break;case 214:case 516:case 4:R=pm(Z.val,Z.ixfe,"s"),R.XF=te[R.ixfe],N>0&&(R.z=J[R.ixfe>>8&63]),Pi(R,e,t.opts.Date1904),F({c:Z.c,r:Z.r},R,e);break;case 0:case 512:Q===1&&(l=Z);break;case 252:f=Z;break;case 1054:if(M.biff==4){J[N++]=Z[1];for(var un=0;un<N+163&&nt[un]!=Z[1];++un);un>=163&&Rs(Z[1],N+163)}else Rs(Z[1],Z[0]);break;case 30:{J[N++]=Z;for(var Xn=0;Xn<N+163&&nt[Xn]!=Z;++Xn);Xn>=163&&Rs(Z,N+163)}break;case 229:Ie=Ie.concat(Z);break;case 93:Re[Z.cmo[0]]=M.lastobj=Z;break;case 438:M.lastobj.TxO=Z;break;case 127:M.lastobj.ImData=Z;break;case 440:for(S=Z[0].s.r;S<=Z[0].e.r;++S)for(T=Z[0].s.c;T<=Z[0].e.c;++T)y=e.dense?(a[S]||[])[T]:a[at({c:T,r:S})],y&&(y.l=Z[1]);break;case 2048:for(S=Z[0].s.r;S<=Z[0].e.r;++S)for(T=Z[0].s.c;T<=Z[0].e.c;++T)y=e.dense?(a[S]||[])[T]:a[at({c:T,r:S})],y&&y.l&&(y.l.Tooltip=Z[1]);break;case 28:{if(M.biff<=5&&M.biff>=2)break;y=e.dense?(a[Z[0].r]||[])[Z[0].c]:a[at(Z[0])];var ri=Re[Z[2]];y||(e.dense?(a[Z[0].r]||(a[Z[0].r]=[]),y=a[Z[0].r][Z[0].c]={t:"z"}):y=a[at(Z[0])]={t:"z"},l.e.r=Math.max(l.e.r,Z[0].r),l.s.r=Math.min(l.s.r,Z[0].r),l.e.c=Math.max(l.e.c,Z[0].c),l.s.c=Math.min(l.s.c,Z[0].c)),y.c||(y.c=[]),w={a:Z[1],t:ri.TxO.t},y.c.push(w)}break;case 2173:mj(te[Z.ixfe],Z.ext);break;case 125:{if(!M.cellStyles)break;for(;Z.e>=Z.s;)ae[Z.e--]={width:Z.w/256,level:Z.level||0,hidden:!!(Z.flags&1)},Fe||(Fe=!0,fy(Z.w/256)),Ho(ae[Z.e+1])}break;case 520:{var gr={};Z.level!=null&&(le[Z.r]=gr,gr.level=Z.level),Z.hidden&&(le[Z.r]=gr,gr.hidden=!0),Z.hpt&&(le[Z.r]=gr,gr.hpt=Z.hpt,gr.hpx=$u(Z.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Gl(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[De]]=Z;break;case 161:a["!margins"]||Gl(a["!margins"]={}),a["!margins"].header=Z.header,a["!margins"].footer=Z.footer;break;case 574:Z.RTL&&(A.Views[0].RTL=!0);break;case 146:G=Z;break;case 2198:L=Z;break;case 140:Y=Z;break;case 442:d?C.CodeName=Z||C.name:A.WBProps.CodeName=Z||"ThisWorkbook";break}}else Oe||console.error("Missing Info for XLS Record 0x"+De.toString(16)),r.l+=Ae}return t.SheetNames=Nr(s).sort(function(Wn,dt){return Number(Wn)-Number(dt)}).map(function(Wn){return s[Wn].name}),e.bookSheets||(t.Sheets=n),!t.SheetNames.length&&m["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=m)):t.Preamble=m,t.Sheets&&X.forEach(function(Wn,dt){t.Sheets[t.SheetNames[dt]]["!autofilter"]=Wn}),t.Strings=f,t.SSF=pr(nt),M.enc&&(t.Encryption=M.enc),L&&(t.Themes=L),t.Metadata={},Y!==void 0&&(t.Metadata.Country=Y),ie.names.length>0&&(A.Names=ie.names),t.Workbook=A,t}var Lh={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function kX(r,e,t){var n=et.find(r,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=HA(n,pv,Lh.DSI);for(var s in a)e[s]=a[s]}catch(d){if(t.WTF)throw d}var l=et.find(r,"/!SummaryInformation");if(l&&l.size>0)try{var u=HA(l,gv,Lh.SI);for(var f in u)e[f]==null&&(e[f]=u[f])}catch(d){if(t.WTF)throw d}e.HeadingPairs&&e.TitlesOfParts&&(ZC(e.HeadingPairs,e.TitlesOfParts,e,t),delete e.HeadingPairs,delete e.TitlesOfParts)}function CX(r,e){var t=[],n=[],a=[],s=0,l,u=_A(pv,"n"),f=_A(gv,"n");if(r.Props)for(l=Nr(r.Props),s=0;s<l.length;++s)(Object.prototype.hasOwnProperty.call(u,l[s])?t:Object.prototype.hasOwnProperty.call(f,l[s])?n:a).push([l[s],r.Props[l[s]]]);if(r.Custprops)for(l=Nr(r.Custprops),s=0;s<l.length;++s)Object.prototype.hasOwnProperty.call(r.Props||{},l[s])||(Object.prototype.hasOwnProperty.call(u,l[s])?t:Object.prototype.hasOwnProperty.call(f,l[s])?n:a).push([l[s],r.Custprops[l[s]]]);var d=[];for(s=0;s<a.length;++s)s3.indexOf(a[s][0])>-1||JC.indexOf(a[s][0])>-1||a[s][1]!=null&&d.push(a[s]);n.length&&et.utils.cfb_add(e,"/SummaryInformation",GA(n,Lh.SI,f,gv)),(t.length||d.length)&&et.utils.cfb_add(e,"/DocumentSummaryInformation",GA(t,Lh.DSI,u,pv,d.length?d:null,Lh.UDI))}function tR(r,e){e||(e={}),yy(e),z_(),e.codepage&&U_(e.codepage);var t,n;if(r.FullPaths){if(et.find(r,"/encryption"))throw new Error("File is password-protected");t=et.find(r,"!CompObj"),n=et.find(r,"/Workbook")||et.find(r,"/Book")}else{switch(e.type){case"base64":r=Ta(Ia(r));break;case"binary":r=Ta(r);break;case"buffer":break;case"array":Array.isArray(r)||(r=Array.prototype.slice.call(r));break}yn(r,0),n={content:r}}var a,s;if(t&&SX(t),e.bookProps&&!e.bookSheets)a={};else{var l=_t?"buffer":"array";if(n&&n.content)a=IX(n.content,e);else if((s=et.find(r,"PerfectOffice_MAIN"))&&s.content)a=Hl.to_workbook(s.content,(e.type=l,e));else if((s=et.find(r,"NativeContent_MAIN"))&&s.content)a=Hl.to_workbook(s.content,(e.type=l,e));else throw(s=et.find(r,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&r.FullPaths&&et.find(r,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=jj(r))}var u={};return r.FullPaths&&kX(r,u,e),a.Props=a.Custprops=u,e.bookFiles&&(a.cfb=r),a}function RX(r,e){var t=e||{},n=et.utils.cfb_new({root:"R"}),a="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":a="/Workbook",t.biff=8;break;case"biff5":a="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return et.utils.cfb_add(n,a,rR(r,t)),t.biff==8&&(r.Props||r.Custprops)&&CX(r,n),t.biff==8&&r.vbaraw&&Hj(n,et.read(r.vbaraw,{type:typeof r.vbaraw=="string"?"binary":"buffer"})),n}var c0={0:{f:eq},1:{f:lq},2:{f:Iq},3:{f:gq},4:{f:hq},5:{f:Sq},6:{f:Nq},7:{f:yq},8:{f:Bq},9:{f:Vq},10:{f:Pq},11:{f:Lq},12:{f:uq},13:{f:Cq},14:{f:vq},15:{f:mq},16:{f:X3},17:{f:Fq},18:{f:Eq},19:{f:ty},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:FK},40:{},42:{},43:{f:Nz},44:{f:Rz},45:{f:Mz},46:{f:Lz},47:{f:Pz},48:{},49:{f:nV},50:{},51:{f:xj},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:x3},62:{f:Dq},63:{f:bj},64:{f:tK},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Mn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Qq},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:sq},148:{f:nq,p:16},151:{f:qq},152:{},153:{f:DK},154:{},155:{},156:{f:CK},157:{},158:{},159:{T:1,f:XU},160:{T:-1},161:{T:1,f:xc},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Uq},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:pj},336:{T:-1},337:{f:yj,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:mv},357:{},358:{},359:{},360:{T:1},361:{},362:{f:g3},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Kq},427:{f:Xq},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Yq},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:iq},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Hq},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:mv},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Lj},633:{T:1},634:{T:-1},635:{T:1,f:Mj},636:{T:-1},637:{f:oV},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:vK},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:rK},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Ev={6:{f:Ax},10:{f:Ao},12:{f:Xr},13:{f:Xr},14:{f:Pr},15:{f:Pr},16:{f:Dn},17:{f:Pr},18:{f:Pr},19:{f:Xr},20:{f:$A},21:{f:$A},23:{f:g3},24:{f:JA},25:{f:Pr},26:{},27:{},28:{f:rU},29:{},34:{f:Pr},35:{f:QA},38:{f:Dn},39:{f:Dn},40:{f:Dn},41:{f:Dn},42:{f:Pr},43:{f:Pr},47:{f:mz},49:{f:CB},51:{f:Xr},60:{},61:{f:SB},64:{f:Pr},65:{f:kB},66:{f:Xr},77:{},80:{},81:{},82:{},85:{f:Xr},89:{},90:{},91:{},92:{f:dB},93:{f:iU},94:{},95:{f:Pr},96:{},97:{},99:{f:Pr},125:{f:x3},128:{f:GB},129:{f:pB},130:{f:Xr},131:{f:Pr},132:{f:Pr},133:{f:gB},134:{},140:{f:dU},141:{f:Xr},144:{},146:{f:gU},151:{},152:{},153:{},154:{},155:{},156:{f:Xr},157:{},158:{},160:{f:wU},161:{f:_U},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:UB},190:{f:zB},193:{f:Ao},197:{},198:{},199:{},200:{},201:{},202:{f:Pr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Xr},220:{},221:{f:Pr},222:{},224:{f:HB},225:{f:hB},226:{f:Ao},227:{},229:{f:nU},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:vB},253:{f:DB},255:{f:yB},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:o3},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Pr},353:{f:Ao},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:YB},431:{f:Pr},432:{},433:{},434:{},437:{},438:{f:lU},439:{f:Pr},440:{f:cU},441:{},442:{f:k0},443:{},444:{f:Xr},445:{},446:{},448:{f:Ao},449:{f:wB,r:2},450:{f:Ao},512:{f:XA},513:{f:EU},515:{f:XB},516:{f:OB},517:{f:YA},519:{f:SU},520:{f:TB},523:{},545:{f:ZA},549:{f:KA},566:{},574:{f:bB},638:{f:BB},659:{},1048:{},1054:{f:MB},1084:{},1212:{f:ZB},2048:{f:fU},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:hm},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ao},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:xU,r:12},2173:{f:dj,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Pr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:JB,r:12},2197:{},2198:{f:oj,r:12},2199:{},2200:{},2201:{},2202:{f:eU,r:12},2203:{f:Ao},2204:{},2205:{},2206:{},2207:{},2211:{f:EB},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Xr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:yU},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:pU},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:XA},1:{},2:{f:CU},3:{f:IU},4:{f:bU},5:{f:YA},7:{f:DU},8:{},9:{f:hm},11:{},22:{f:Xr},30:{f:LB},31:{},32:{},33:{f:ZA},36:{},37:{f:KA},50:{f:NU},62:{},52:{},67:{},68:{f:Xr},69:{},86:{},126:{},127:{f:AU},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:OU},223:{},234:{},354:{},421:{},518:{f:Ax},521:{f:hm},536:{f:JA},547:{f:QA},561:{},579:{},1030:{f:Ax},1033:{f:hm},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ue(r,e,t,n){var a=e;if(!isNaN(a)){var s=n||(t||[]).length||0,l=r.next(4);l.write_shift(2,a),l.write_shift(2,s),s>0&&J_(t)&&r.push(t)}}function DX(r,e,t,n){var a=(t||[]).length||0;if(a<=8224)return Ue(r,e,t,a);var s=e;if(!isNaN(s)){for(var l=t.parts||[],u=0,f=0,d=0;d+(l[u]||8224)<=8224;)d+=l[u]||8224,u++;var m=r.next(4);for(m.write_shift(2,s),m.write_shift(2,d),r.push(t.slice(f,f+d)),f+=d;f<a;){for(m=r.next(4),m.write_shift(2,60),d=0;d+(l[u]||8224)<=8224;)d+=l[u]||8224,u++;m.write_shift(2,d),r.push(t.slice(f,f+d)),f+=d}}}function N0(r,e,t){return r||(r=ye(7)),r.write_shift(2,e),r.write_shift(2,t),r.write_shift(2,0),r.write_shift(1,0),r}function NX(r,e,t,n){var a=ye(9);return N0(a,r,e),l3(t,n||"b",a),a}function OX(r,e,t){var n=ye(8+2*t.length);return N0(n,r,e),n.write_shift(1,t.length),n.write_shift(t.length,t,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function FX(r,e,t,n){if(e.v!=null)switch(e.t){case"d":case"n":var a=e.t=="d"?en(mr(e.v)):e.v;a==(a|0)&&a>=0&&a<65536?Ue(r,2,RU(t,n,a)):Ue(r,3,kU(t,n,a));return;case"b":case"e":Ue(r,5,NX(t,n,e.v,e.t));return;case"s":case"str":Ue(r,4,OX(t,n,(e.v||"").slice(0,255)));return}Ue(r,1,N0(null,t,n))}function MX(r,e,t,n){var a=Array.isArray(e),s=Ot(e["!ref"]||"A1"),l,u="",f=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),l=gt(s)}for(var d=s.s.r;d<=s.e.r;++d){u=Lr(d);for(var m=s.s.c;m<=s.e.c;++m){d===s.s.r&&(f[m]=wr(m)),l=f[m]+u;var x=a?(e[d]||[])[m]:e[l];x&&FX(r,x,d,m)}}}function PX(r,e){for(var t=e||{},n=aa(),a=0,s=0;s<r.SheetNames.length;++s)r.SheetNames[s]==t.sheet&&(a=s);if(a==0&&t.sheet&&r.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return Ue(n,t.biff==4?1033:t.biff==3?521:9,ly(r,16,t)),MX(n,r.Sheets[r.SheetNames[a]],a,t),Ue(n,10),n.end()}function LX(r,e,t){Ue(r,49,RB({sz:12,name:"Arial"},t))}function VX(r,e,t){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&Ue(r,1054,PB(a,e[a],t))})}function BX(r,e){var t=ye(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),Ue(r,2151,t),t=ye(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),d3(Ot(e["!ref"]||"A1"),t),t.write_shift(4,4),Ue(r,2152,t)}function UX(r,e){for(var t=0;t<16;++t)Ue(r,224,WA({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){Ue(r,224,WA(n,0,e))})}function zX(r,e){for(var t=0;t<e["!links"].length;++t){var n=e["!links"][t];Ue(r,440,uU(n)),n[1].Tooltip&&Ue(r,2048,hU(n))}delete e["!links"]}function jX(r,e){if(e){var t=0;e.forEach(function(n,a){++t<=256&&n&&Ue(r,125,vU(tg(a,n),a))})}}function HX(r,e,t,n,a){var s=16+$o(a.cellXfs,e,a);if(e.v==null&&!e.bf){Ue(r,513,sc(t,n,s));return}if(e.bf)Ue(r,6,pG(e,t,n,a,s));else switch(e.t){case"d":case"n":var l=e.t=="d"?en(mr(e.v)):e.v;Ue(r,515,WB(t,n,l,s));break;case"b":case"e":Ue(r,517,KB(t,n,e.v,s,a,e.t));break;case"s":case"str":if(a.bookSST){var u=gy(a.Strings,e.v,a.revStrings);Ue(r,253,NB(t,n,u,s))}else Ue(r,516,FB(t,n,(e.v||"").slice(0,255),s,a));break;default:Ue(r,513,sc(t,n,s))}}function GX(r,e,t){var n=aa(),a=t.SheetNames[r],s=t.Sheets[a]||{},l=(t||{}).Workbook||{},u=(l.Sheets||[])[r]||{},f=Array.isArray(s),d=e.biff==8,m,x="",_=[],y=Ot(s["!ref"]||"A1"),w=d?65536:16384;if(y.e.c>255||y.e.r>=w){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");y.e.c=Math.min(y.e.c,255),y.e.r=Math.min(y.e.c,w-1)}Ue(n,2057,ly(t,16,e)),Ue(n,13,Xa(1)),Ue(n,12,Xa(100)),Ue(n,15,jn(!0)),Ue(n,17,jn(!1)),Ue(n,16,ac(.001)),Ue(n,95,jn(!0)),Ue(n,42,jn(!1)),Ue(n,43,jn(!1)),Ue(n,130,Xa(1)),Ue(n,128,qB()),Ue(n,131,jn(!1)),Ue(n,132,jn(!1)),d&&jX(n,s["!cols"]),Ue(n,512,VB(y,e)),d&&(s["!links"]=[]);for(var T=y.s.r;T<=y.e.r;++T){x=Lr(T);for(var S=y.s.c;S<=y.e.c;++S){T===y.s.r&&(_[S]=wr(S)),m=_[S]+x;var O=f?(s[T]||[])[S]:s[m];O&&(HX(n,O,T,S,e),d&&O.l&&s["!links"].push([m,O.l]))}}var U=u.CodeName||u.name||a;return d&&Ue(n,574,IB((l.Views||[])[0])),d&&(s["!merges"]||[]).length&&Ue(n,229,aU(s["!merges"])),d&&zX(n,s),Ue(n,442,c3(U)),d&&BX(n,s),Ue(n,10),n.end()}function qX(r,e,t){var n=aa(),a=(r||{}).Workbook||{},s=a.Sheets||[],l=a.WBProps||{},u=t.biff==8,f=t.biff==5;if(Ue(n,2057,ly(r,5,t)),t.bookType=="xla"&&Ue(n,135),Ue(n,225,u?Xa(1200):null),Ue(n,193,KV(2)),f&&Ue(n,191),f&&Ue(n,192),Ue(n,226),Ue(n,92,mB("SheetJS",t)),Ue(n,66,Xa(u?1200:1252)),u&&Ue(n,353,Xa(0)),u&&Ue(n,448),Ue(n,317,TU(r.SheetNames.length)),u&&r.vbaraw&&Ue(n,211),u&&r.vbaraw){var d=l.CodeName||"ThisWorkbook";Ue(n,442,c3(d))}Ue(n,156,Xa(17)),Ue(n,25,jn(!1)),Ue(n,18,jn(!1)),Ue(n,19,Xa(0)),u&&Ue(n,431,jn(!1)),u&&Ue(n,444,Xa(0)),Ue(n,61,AB()),Ue(n,64,jn(!1)),Ue(n,141,Xa(0)),Ue(n,34,jn(wK(r)=="true")),Ue(n,14,jn(!0)),u&&Ue(n,439,jn(!1)),Ue(n,218,Xa(0)),LX(n,r,t),VX(n,r.SSF,t),UX(n,t),u&&Ue(n,352,jn(!1));var m=n.end(),x=aa();u&&Ue(x,140,mU()),u&&t.Strings&&DX(x,252,_B(t.Strings)),Ue(x,10);var _=x.end(),y=aa(),w=0,T=0;for(T=0;T<r.SheetNames.length;++T)w+=(u?12:11)+(u?2:1)*r.SheetNames[T].length;var S=m.length+w+_.length;for(T=0;T<r.SheetNames.length;++T){var O=s[T]||{};Ue(y,133,xB({pos:S,hs:O.Hidden||0,dt:0,name:r.SheetNames[T]},t)),S+=e[T].length}var U=y.end();if(w!=U.length)throw new Error("BS8 "+w+" != "+U.length);var R=[];return m.length&&R.push(m),U.length&&R.push(U),_.length&&R.push(_),ln(R)}function KX(r,e){var t=e||{},n=[];r&&!r.SSF&&(r.SSF=pr(nt)),r&&r.SSF&&(sf(),Wp(r.SSF),t.revssf=$p(r.SSF),t.revssf[r.SSF[65535]]=0,t.ssf=r.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ty(t),t.cellXfs=[],$o(t.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={});for(var a=0;a<r.SheetNames.length;++a)n[n.length]=GX(a,t,r);return n.unshift(qX(r,n,t)),ln(n)}function rR(r,e){for(var t=0;t<=r.SheetNames.length;++t){var n=r.Sheets[r.SheetNames[t]];if(!(!n||!n["!ref"])){var a=ia(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+r.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return KX(r,e);case 4:case 3:case 2:return PX(r,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function cb(r,e){var t=e||{},n=t.dense?[]:{};r=r.replace(/<!--.*?-->/g,"");var a=r.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=r.match(/<\/table/i),l=a.index,u=s&&s.index||r.length,f=R7(r.slice(l,u),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,m=0,x=0,_=0,y={s:{r:1e7,c:1e7},e:{r:0,c:0}},w=[];for(l=0;l<f.length;++l){var T=f[l].trim(),S=T.slice(0,3).toLowerCase();if(S=="<tr"){if(++d,t.sheetRows&&t.sheetRows<=d){--d;break}m=0;continue}if(!(S!="<td"&&S!="<th")){var O=T.split(/<\/t[dh]>/i);for(u=0;u<O.length;++u){var U=O[u].trim();if(U.match(/<t[dh]/i)){for(var R=U,Y=0;R.charAt(0)=="<"&&(Y=R.indexOf(">"))>-1;)R=R.slice(Y+1);for(var te=0;te<w.length;++te){var G=w[te];G.s.c==m&&G.s.r<d&&d<=G.e.r&&(m=G.e.c+1,te=-1)}var A=it(U.slice(0,U.indexOf(">")));_=A.colspan?+A.colspan:1,((x=+A.rowspan)>1||_>1)&&w.push({s:{r:d,c:m},e:{r:d+(x||1)-1,c:m+_-1}});var C=A.t||A["data-t"]||"";if(!R.length){m+=_;continue}if(R=bC(R),y.s.r>d&&(y.s.r=d),y.e.r<d&&(y.e.r=d),y.s.c>m&&(y.s.c=m),y.e.c<m&&(y.e.c=m),!R.length){m+=_;continue}var k={t:"s",v:R};t.raw||!R.trim().length||C=="s"||(R==="TRUE"?k={t:"b",v:!0}:R==="FALSE"?k={t:"b",v:!1}:isNaN(Ti(R))?isNaN(Wu(R).getDate())||(k={t:"d",v:mr(R)},t.cellDates||(k={t:"n",v:en(k.v)}),k.z=t.dateNF||nt[14]):k={t:"n",v:Ti(R)}),t.dense?(n[d]||(n[d]=[]),n[d][m]=k):n[at({r:d,c:m})]=k,m+=_}}}}return n["!ref"]=gt(y),w.length&&(n["!merges"]=w),n}function XX(r,e,t,n){for(var a=r["!merges"]||[],s=[],l=e.s.c;l<=e.e.c;++l){for(var u=0,f=0,d=0;d<a.length;++d)if(!(a[d].s.r>t||a[d].s.c>l)&&!(a[d].e.r<t||a[d].e.c<l)){if(a[d].s.r<t||a[d].s.c<l){u=-1;break}u=a[d].e.r-a[d].s.r+1,f=a[d].e.c-a[d].s.c+1;break}if(!(u<0)){var m=at({r:t,c:l}),x=n.dense?(r[t]||[])[l]:r[m],_=x&&x.v!=null&&(x.h||Y_(x.w||(Ps(x),x.w)||""))||"",y={};u>1&&(y.rowspan=u),f>1&&(y.colspan=f),n.editable?_='<span contenteditable="true">'+_+"</span>":x&&(y["data-t"]=x&&x.t||"z",x.v!=null&&(y["data-v"]=x.v),x.z!=null&&(y["data-z"]=x.z),x.l&&(x.l.Target||"#").charAt(0)!="#"&&(_='<a href="'+x.l.Target+'">'+_+"</a>")),y.id=(n.id||"sjs")+"-"+m,s.push(Be("td",_,y))}}var w="<tr>";return w+s.join("")+"</tr>"}var WX='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',YX="</body></html>";function $X(r,e){var t=r.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return Yo(cb(t[0],e),e);var n=Sy();return t.forEach(function(a,s){Ay(n,cb(a,e),"Sheet"+(s+1))}),n}function QX(r,e,t){var n=[];return n.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function nR(r,e){var t=e||{},n=t.header!=null?t.header:WX,a=t.footer!=null?t.footer:YX,s=[n],l=ia(r["!ref"]);t.dense=Array.isArray(r),s.push(QX(r,l,t));for(var u=l.s.r;u<=l.e.r;++u)s.push(XX(r,l,u,t));return s.push("</table>"+a),s.join("")}function aR(r,e,t){var n=t||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Sr(n.origin):n.origin;a=l.r,s=l.c}var u=e.getElementsByTagName("tr"),f=Math.min(n.sheetRows||1e7,u.length),d={s:{r:0,c:0},e:{r:a,c:s}};if(r["!ref"]){var m=ia(r["!ref"]);d.s.r=Math.min(d.s.r,m.s.r),d.s.c=Math.min(d.s.c,m.s.c),d.e.r=Math.max(d.e.r,m.e.r),d.e.c=Math.max(d.e.c,m.e.c),a==-1&&(d.e.r=a=m.e.r+1)}var x=[],_=0,y=r["!rows"]||(r["!rows"]=[]),w=0,T=0,S=0,O=0,U=0,R=0;for(r["!cols"]||(r["!cols"]=[]);w<u.length&&T<f;++w){var Y=u[w];if(ub(Y)){if(n.display)continue;y[T]={hidden:!0}}var te=Y.children;for(S=O=0;S<te.length;++S){var G=te[S];if(!(n.display&&ub(G))){var A=G.hasAttribute("data-v")?G.getAttribute("data-v"):G.hasAttribute("v")?G.getAttribute("v"):bC(G.innerHTML),C=G.getAttribute("data-z")||G.getAttribute("z");for(_=0;_<x.length;++_){var k=x[_];k.s.c==O+s&&k.s.r<T+a&&T+a<=k.e.r&&(O=k.e.c+1-s,_=-1)}R=+G.getAttribute("colspan")||1,((U=+G.getAttribute("rowspan")||1)>1||R>1)&&x.push({s:{r:T+a,c:O+s},e:{r:T+a+(U||1)-1,c:O+s+(R||1)-1}});var V={t:"s",v:A},F=G.getAttribute("data-t")||G.getAttribute("t")||"";A!=null&&(A.length==0?V.t=F||"z":n.raw||A.trim().length==0||F=="s"||(A==="TRUE"?V={t:"b",v:!0}:A==="FALSE"?V={t:"b",v:!1}:isNaN(Ti(A))?isNaN(Wu(A).getDate())||(V={t:"d",v:mr(A)},n.cellDates||(V={t:"n",v:en(V.v)}),V.z=n.dateNF||nt[14]):V={t:"n",v:Ti(A)})),V.z===void 0&&C!=null&&(V.z=C);var M="",L=G.getElementsByTagName("A");if(L&&L.length)for(var Ie=0;Ie<L.length&&!(L[Ie].hasAttribute("href")&&(M=L[Ie].getAttribute("href"),M.charAt(0)!="#"));++Ie);M&&M.charAt(0)!="#"&&(V.l={Target:M}),n.dense?(r[T+a]||(r[T+a]=[]),r[T+a][O+s]=V):r[at({c:O+s,r:T+a})]=V,d.e.c<O+s&&(d.e.c=O+s),O+=R}}++T}return x.length&&(r["!merges"]=(r["!merges"]||[]).concat(x)),d.e.r=Math.max(d.e.r,T-1+a),r["!ref"]=gt(d),T>=f&&(r["!fullref"]=gt((d.e.r=u.length-w+T-1+a,d))),r}function iR(r,e){var t=e||{},n=t.dense?[]:{};return aR(n,r,e)}function JX(r,e){return Yo(iR(r,e),e)}function ub(r){var e="",t=ZX(r);return t&&(e=t(r).getPropertyValue("display")),e||(e=r.style&&r.style.display),e==="none"}function ZX(r){return r.ownerDocument.defaultView&&typeof r.ownerDocument.defaultView.getComputedStyle=="function"?r.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function eW(r){var e=r.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=Nt(e.replace(/<[^>]*>/g,""));return[t]}var fb={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function sR(r,e){var t=e||{},n=$_(r),a=[],s,l,u={name:""},f="",d=0,m,x,_={},y=[],w=t.dense?[]:{},T,S,O={value:""},U="",R=0,Y=[],te=-1,G=-1,A={s:{r:1e6,c:1e7},e:{r:0,c:0}},C=0,k={},V=[],F={},M=0,L=0,Ie=[],Re=1,ae=1,le=[],Fe={Names:[]},ie={},Ne=["",""],Q=[],N={},J="",X=0,ee=!1,ce=!1,we=0;for(n0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");T=n0.exec(n);)switch(T[3]=T[3].replace(/_.*$/,"")){case"table":case"":T[1]==="/"?(A.e.c>=A.s.c&&A.e.r>=A.s.r?w["!ref"]=gt(A):w["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=A.e.r&&(w["!fullref"]=w["!ref"],A.e.r=t.sheetRows-1,w["!ref"]=gt(A)),V.length&&(w["!merges"]=V),Ie.length&&(w["!rows"]=Ie),m.name=m.||m.name,typeof JSON<"u"&&JSON.stringify(m),y.push(m.name),_[m.name]=w,ce=!1):T[0].charAt(T[0].length-2)!=="/"&&(m=it(T[0],!1),te=G=-1,A.s.r=A.s.c=1e7,A.e.r=A.e.c=0,w=t.dense?[]:{},V=[],Ie=[],ce=!0);break;case"table-row-group":T[1]==="/"?--C:++C;break;case"table-row":case"":if(T[1]==="/"){te+=Re,Re=1;break}if(x=it(T[0],!1),x.?te=x.-1:te==-1&&(te=0),Re=+x["number-rows-repeated"]||1,Re<10)for(we=0;we<Re;++we)C>0&&(Ie[te+we]={level:C});G=-1;break;case"covered-table-cell":T[1]!=="/"&&++G,t.sheetStubs&&(t.dense?(w[te]||(w[te]=[]),w[te][G]={t:"z"}):w[at({r:te,c:G})]={t:"z"}),U="",Y=[];break;case"table-cell":case"":if(T[0].charAt(T[0].length-2)==="/")++G,O=it(T[0],!1),ae=parseInt(O["number-columns-repeated"]||"1",10),S={t:"z",v:null},O.formula&&t.cellFormula!=!1&&(S.f=sb(Nt(O.formula))),(O.||O["value-type"])=="string"&&(S.t="s",S.v=Nt(O["string-value"]||""),t.dense?(w[te]||(w[te]=[]),w[te][G]=S):w[at({r:te,c:G})]=S),G+=ae-1;else if(T[1]!=="/"){++G,U="",R=0,Y=[],ae=1;var De=Re?te+Re-1:te;if(G>A.e.c&&(A.e.c=G),G<A.s.c&&(A.s.c=G),te<A.s.r&&(A.s.r=te),De>A.e.r&&(A.e.r=De),O=it(T[0],!1),Q=[],N={},S={t:O.||O["value-type"],v:null},t.cellFormula)if(O.formula&&(O.formula=Nt(O.formula)),O["number-matrix-columns-spanned"]&&O["number-matrix-rows-spanned"]&&(M=parseInt(O["number-matrix-rows-spanned"],10)||0,L=parseInt(O["number-matrix-columns-spanned"],10)||0,F={s:{r:te,c:G},e:{r:te+M-1,c:G+L-1}},S.F=gt(F),le.push([F,S.F])),O.formula)S.f=sb(O.formula);else for(we=0;we<le.length;++we)te>=le[we][0].s.r&&te<=le[we][0].e.r&&G>=le[we][0].s.c&&G<=le[we][0].e.c&&(S.F=le[we][1]);switch((O["number-columns-spanned"]||O["number-rows-spanned"])&&(M=parseInt(O["number-rows-spanned"],10)||0,L=parseInt(O["number-columns-spanned"],10)||0,F={s:{r:te,c:G},e:{r:te+M-1,c:G+L-1}},V.push(F)),O["number-columns-repeated"]&&(ae=parseInt(O["number-columns-repeated"],10)),S.t){case"boolean":S.t="b",S.v=dr(O["boolean-value"]);break;case"float":S.t="n",S.v=parseFloat(O.value);break;case"percentage":S.t="n",S.v=parseFloat(O.value);break;case"currency":S.t="n",S.v=parseFloat(O.value);break;case"date":S.t="d",S.v=mr(O["date-value"]),t.cellDates||(S.t="n",S.v=en(S.v)),S.z="m/d/yy";break;case"time":S.t="n",S.v=I7(O["time-value"])/86400,t.cellDates&&(S.t="d",S.v=Qp(S.v)),S.z="HH:MM:SS";break;case"number":S.t="n",S.v=parseFloat(O.);break;default:if(S.t==="string"||S.t==="text"||!S.t)S.t="s",O["string-value"]!=null&&(U=Nt(O["string-value"]),Y=[]);else throw new Error("Unsupported value type "+S.t)}}else{if(ee=!1,S.t==="s"&&(S.v=U||"",Y.length&&(S.R=Y),ee=R==0),ie.Target&&(S.l=ie),Q.length>0&&(S.c=Q,Q=[]),U&&t.cellText!==!1&&(S.w=U),ee&&(S.t="z",delete S.v),(!ee||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=te))for(var Ae=0;Ae<Re;++Ae){if(ae=parseInt(O["number-columns-repeated"]||"1",10),t.dense)for(w[te+Ae]||(w[te+Ae]=[]),w[te+Ae][G]=Ae==0?S:pr(S);--ae>0;)w[te+Ae][G+ae]=pr(S);else for(w[at({r:te+Ae,c:G})]=S;--ae>0;)w[at({r:te+Ae,c:G+ae})]=pr(S);A.e.c<=G&&(A.e.c=G)}ae=parseInt(O["number-columns-repeated"]||"1",10),G+=ae-1,ae=0,S={},U="",Y=[]}ie={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(T[1]==="/"){if((s=a.pop())[0]!==T[3])throw"Bad state: "+s}else T[0].charAt(T[0].length-2)!=="/"&&a.push([T[3],!0]);break;case"annotation":if(T[1]==="/"){if((s=a.pop())[0]!==T[3])throw"Bad state: "+s;N.t=U,Y.length&&(N.R=Y),N.a=J,Q.push(N)}else T[0].charAt(T[0].length-2)!=="/"&&a.push([T[3],!1]);J="",X=0,U="",R=0,Y=[];break;case"creator":T[1]==="/"?J=n.slice(X,T.index):X=T.index+T[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(T[1]==="/"){if((s=a.pop())[0]!==T[3])throw"Bad state: "+s}else T[0].charAt(T[0].length-2)!=="/"&&a.push([T[3],!1]);U="",R=0,Y=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(T[1]==="/"){if(k[u.name]=f,(s=a.pop())[0]!==T[3])throw"Bad state: "+s}else T[0].charAt(T[0].length-2)!=="/"&&(f="",u=it(T[0],!1),a.push([T[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":l=it(T[0],!1),f+=fb[T[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":l=it(T[0],!1),f+=fb[T[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(T[0].slice(-2)==="/>")break;if(T[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":f+=n.slice(d,T.index);break}else d=T.index+T[0].length;break;case"named-range":l=it(T[0],!1),Ne=bx(l["cell-range-address"]);var Oe={Name:l.name,Ref:Ne[0]+"!"+Ne[1]};ce&&(Oe.Sheet=y.length),Fe.Names.push(Oe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(T[1]==="/"&&(!O||!O["string-value"])){var st=eW(n.slice(R,T.index));U=(U.length>0?U+`
`:"")+st[0]}else it(T[0],!1),R=T.index+T[0].length;break;case"s":break;case"database-range":if(T[1]==="/")break;try{Ne=bx(it(T[0])["target-range-address"]),_[Ne[0]]["!autofilter"]={ref:Ne[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(T[1]!=="/"){if(ie=it(T[0],!1),!ie.href)break;ie.Target=Nt(ie.href),delete ie.href,ie.Target.charAt(0)=="#"&&ie.Target.indexOf(".")>-1?(Ne=bx(ie.Target.slice(1)),ie.Target="#"+Ne[0]+"!"+Ne[1]):ie.Target.match(/^\.\.[\\\/]/)&&(ie.Target=ie.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(T[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(t.WTF)throw new Error(T)}}var Z={Sheets:_,SheetNames:y,Workbook:Fe};return t.bookSheets&&delete Z.Sheets,Z}function hb(r,e){e=e||{},Ka(r,"META-INF/manifest.xml")&&IV(Kr(r,"META-INF/manifest.xml"),e);var t=Ea(r,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var n=sR(ir(t),e);return Ka(r,"meta.xml")&&(n.Props=$C(Kr(r,"meta.xml"))),n}function db(r,e){return sR(r,e)}var tW=(function(){var r=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+r0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+r+"</office:document-styles>";return function(){return Vr+e}})(),mb=(function(){var r=function(s){return Qt(s).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,n=function(s,l,u){var f=[];f.push('      <table:table table:name="'+Qt(l.SheetNames[u])+`" table:style-name="ta1">
`);var d=0,m=0,x=ia(s["!ref"]||"A1"),_=s["!merges"]||[],y=0,w=Array.isArray(s);if(s["!cols"])for(m=0;m<=x.e.c;++m)f.push("        <table:table-column"+(s["!cols"][m]?' table:style-name="co'+s["!cols"][m].ods+'"':"")+`></table:table-column>
`);var T="",S=s["!rows"]||[];for(d=0;d<x.s.r;++d)T=S[d]?' table:style-name="ro'+S[d].ods+'"':"",f.push("        <table:table-row"+T+`></table:table-row>
`);for(;d<=x.e.r;++d){for(T=S[d]?' table:style-name="ro'+S[d].ods+'"':"",f.push("        <table:table-row"+T+`>
`),m=0;m<x.s.c;++m)f.push(e);for(;m<=x.e.c;++m){var O=!1,U={},R="";for(y=0;y!=_.length;++y)if(!(_[y].s.c>m)&&!(_[y].s.r>d)&&!(_[y].e.c<m)&&!(_[y].e.r<d)){(_[y].s.c!=m||_[y].s.r!=d)&&(O=!0),U["table:number-columns-spanned"]=_[y].e.c-_[y].s.c+1,U["table:number-rows-spanned"]=_[y].e.r-_[y].s.r+1;break}if(O){f.push(t);continue}var Y=at({r:d,c:m}),te=w?(s[d]||[])[m]:s[Y];if(te&&te.f&&(U["table:formula"]=Qt(TG(te.f)),te.F&&te.F.slice(0,Y.length)==Y)){var G=ia(te.F);U["table:number-matrix-columns-spanned"]=G.e.c-G.s.c+1,U["table:number-matrix-rows-spanned"]=G.e.r-G.s.r+1}if(!te){f.push(e);continue}switch(te.t){case"b":R=te.v?"TRUE":"FALSE",U["office:value-type"]="boolean",U["office:boolean-value"]=te.v?"true":"false";break;case"n":R=te.w||String(te.v||0),U["office:value-type"]="float",U["office:value"]=te.v||0;break;case"s":case"str":R=te.v==null?"":te.v,U["office:value-type"]="string";break;case"d":R=te.w||mr(te.v).toISOString(),U["office:value-type"]="date",U["office:date-value"]=mr(te.v).toISOString(),U["table:style-name"]="ce1";break;default:f.push(e);continue}var A=r(R);if(te.l&&te.l.Target){var C=te.l.Target;C=C.charAt(0)=="#"?"#"+EG(C.slice(1)):C,C.charAt(0)!="#"&&!C.match(/^\w+:/)&&(C="../"+C),A=Be("text:a",A,{"xlink:href":C.replace(/&/g,"&amp;")})}f.push("          "+Be("table:table-cell",Be("text:p",A,{}),U)+`
`)}f.push(`        </table:table-row>
`)}return f.push(`      </table:table>
`),f.join("")},a=function(s,l){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var u=0;l.SheetNames.map(function(d){return l.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var m=0;m<d["!cols"].length;++m)if(d["!cols"][m]){var x=d["!cols"][m];if(x.width==null&&x.wpx==null&&x.wch==null)continue;Ho(x),x.ods=u;var _=d["!cols"][m].wpx+"px";s.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+_+`"/>
`),s.push(`  </style:style>
`),++u}}});var f=0;l.SheetNames.map(function(d){return l.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var m=0;m<d["!rows"].length;++m)if(d["!rows"][m]){d["!rows"][m].ods=f;var x=d["!rows"][m].hpx+"px";s.push('  <style:style style:name="ro'+f+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+x+`"/>
`),s.push(`  </style:style>
`),++f}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(l,u){var f=[Vr],d=r0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),m=r0({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(f.push("<office:document"+d+m+`>
`),f.push(YC().replace(/office:document-meta/g,"office:meta"))):f.push("<office:document-content"+d+`>
`),a(f,l),f.push(`  <office:body>
`),f.push(`    <office:spreadsheet>
`);for(var x=0;x!=l.SheetNames.length;++x)f.push(n(l.Sheets[l.SheetNames[x]],l,x));return f.push(`    </office:spreadsheet>
`),f.push(`  </office:body>
`),u.bookType=="fods"?f.push("</office:document>"):f.push("</office:document-content>"),f.join("")}})();function oR(r,e){if(e.bookType=="fods")return mb(r,e);var t=K_(),n="",a=[],s=[];return n="mimetype",vt(t,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",vt(t,n,mb(r,e)),a.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",vt(t,n,tW(r,e)),a.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",vt(t,n,Vr+YC()),a.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",vt(t,n,RV(s)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",vt(t,n,kV(a)),t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function oc(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function wv(r){return typeof TextDecoder<"u"?new TextDecoder().decode(r):ir(Wo(r))}function rW(r){return typeof TextEncoder<"u"?new TextEncoder().encode(r):Ta(ji(r))}function nW(r,e){e:for(var t=0;t<=r.length-e.length;++t){for(var n=0;n<e.length;++n)if(r[t+n]!=e[n])continue e;return!0}return!1}function qo(r){var e=r.reduce(function(a,s){return a+s.length},0),t=new Uint8Array(e),n=0;return r.forEach(function(a){t.set(a,n),n+=a.length}),t}function pb(r){return r-=r>>1&1431655765,r=(r&858993459)+(r>>2&858993459),(r+(r>>4)&252645135)*16843009>>>24}function aW(r,e){for(var t=(r[e+15]&127)<<7|r[e+14]>>1,n=r[e+14]&1,a=e+13;a>=e;--a)n=n*256+r[a];return(r[e+15]&128?-n:n)*Math.pow(10,t-6176)}function iW(r,e,t){var n=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,a=t/Math.pow(10,n-6176);r[e+15]|=n>>7,r[e+14]|=(n&127)<<1;for(var s=0;a>=1;++s,a/=256)r[e+s]=a&255;r[e+15]|=t>=0?0:128}function u0(r,e){var t=e?e[0]:0,n=r[t]&127;e:if(r[t++]>=128&&(n|=(r[t]&127)<<7,r[t++]<128||(n|=(r[t]&127)<<14,r[t++]<128)||(n|=(r[t]&127)<<21,r[t++]<128)||(n+=(r[t]&127)*Math.pow(2,28),++t,r[t++]<128)||(n+=(r[t]&127)*Math.pow(2,35),++t,r[t++]<128)||(n+=(r[t]&127)*Math.pow(2,42),++t,r[t++]<128)))break e;return e&&(e[0]=t),n}function Wt(r){var e=new Uint8Array(7);e[0]=r&127;var t=1;e:if(r>127){if(e[t-1]|=128,e[t]=r>>7&127,++t,r<=16383||(e[t-1]|=128,e[t]=r>>14&127,++t,r<=2097151)||(e[t-1]|=128,e[t]=r>>21&127,++t,r<=268435455)||(e[t-1]|=128,e[t]=r/256>>>21&127,++t,r<=34359738367)||(e[t-1]|=128,e[t]=r/65536>>>21&127,++t,r<=4398046511103))break e;e[t-1]|=128,e[t]=r/16777216>>>21&127,++t}return e.slice(0,t)}function Dr(r){var e=0,t=r[e]&127;e:if(r[e++]>=128){if(t|=(r[e]&127)<<7,r[e++]<128||(t|=(r[e]&127)<<14,r[e++]<128)||(t|=(r[e]&127)<<21,r[e++]<128))break e;t|=(r[e]&127)<<28}return t}function Lt(r){for(var e=[],t=[0];t[0]<r.length;){var n=t[0],a=u0(r,t),s=a&7;a=Math.floor(a/8);var l=0,u;if(a==0)break;switch(s){case 0:{for(var f=t[0];r[t[0]++]>=128;);u=r.slice(f,t[0])}break;case 5:l=4,u=r.slice(t[0],t[0]+l),t[0]+=l;break;case 1:l=8,u=r.slice(t[0],t[0]+l),t[0]+=l;break;case 2:l=u0(r,t),u=r.slice(t[0],t[0]+l),t[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var d={data:u,type:s};e[a]==null?e[a]=[d]:e[a].push(d)}return e}function xn(r){var e=[];return r.forEach(function(t,n){t.forEach(function(a){a.data&&(e.push(Wt(n*8+a.type)),a.type==2&&e.push(Wt(a.data.length)),e.push(a.data))})}),qo(e)}function _y(r,e){return(r==null?void 0:r.map(function(t){return e(t.data)}))||[]}function Ga(r){for(var e,t=[],n=[0];n[0]<r.length;){var a=u0(r,n),s=Lt(r.slice(n[0],n[0]+a));n[0]+=a;var l={id:Dr(s[1][0].data),messages:[]};s[2].forEach(function(u){var f=Lt(u.data),d=Dr(f[3][0].data);l.messages.push({meta:f,data:r.slice(n[0],n[0]+d)}),n[0]+=d}),(e=s[3])!=null&&e[0]&&(l.merge=Dr(s[3][0].data)>>>0>0),t.push(l)}return t}function fu(r){var e=[];return r.forEach(function(t){var n=[];n[1]=[{data:Wt(t.id),type:0}],n[2]=[],t.merge!=null&&(n[3]=[{data:Wt(+!!t.merge),type:0}]);var a=[];t.messages.forEach(function(l){a.push(l.data),l.meta[3]=[{type:0,data:Wt(l.data.length)}],n[2].push({data:xn(l.meta),type:2})});var s=xn(n);e.push(Wt(s.length)),e.push(s),a.forEach(function(l){return e.push(l)})}),qo(e)}function sW(r,e){if(r!=0)throw new Error("Unexpected Snappy chunk type ".concat(r));for(var t=[0],n=u0(e,t),a=[];t[0]<e.length;){var s=e[t[0]]&3;if(s==0){var l=e[t[0]++]>>2;if(l<60)++l;else{var u=l-59;l=e[t[0]],u>1&&(l|=e[t[0]+1]<<8),u>2&&(l|=e[t[0]+2]<<16),u>3&&(l|=e[t[0]+3]<<24),l>>>=0,l++,t[0]+=u}a.push(e.slice(t[0],t[0]+l)),t[0]+=l;continue}else{var f=0,d=0;if(s==1?(d=(e[t[0]]>>2&7)+4,f=(e[t[0]++]&224)<<3,f|=e[t[0]++]):(d=(e[t[0]++]>>2)+1,s==2?(f=e[t[0]]|e[t[0]+1]<<8,t[0]+=2):(f=(e[t[0]]|e[t[0]+1]<<8|e[t[0]+2]<<16|e[t[0]+3]<<24)>>>0,t[0]+=4)),a=[qo(a)],f==0)throw new Error("Invalid offset 0");if(f>a[0].length)throw new Error("Invalid offset beyond length");if(d>=f)for(a.push(a[0].slice(-f)),d-=f;d>=a[a.length-1].length;)a.push(a[a.length-1]),d-=a[a.length-1].length;a.push(a[0].slice(-f,-f+d))}}var m=qo(a);if(m.length!=n)throw new Error("Unexpected length: ".concat(m.length," != ").concat(n));return m}function qa(r){for(var e=[],t=0;t<r.length;){var n=r[t++],a=r[t]|r[t+1]<<8|r[t+2]<<16;t+=3,e.push(sW(n,r.slice(t,t+a))),t+=a}if(t!==r.length)throw new Error("data is not a valid framed stream!");return qo(e)}function hu(r){for(var e=[],t=0;t<r.length;){var n=Math.min(r.length-t,268435455),a=new Uint8Array(4);e.push(a);var s=Wt(n),l=s.length;e.push(s),n<=60?(l++,e.push(new Uint8Array([n-1<<2]))):n<=256?(l+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(l+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(l+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(l+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(r.slice(t,t+n)),l+=n,a[0]=0,a[1]=l&255,a[2]=l>>8&255,a[3]=l>>16&255,t+=n}return qo(e)}function oW(r,e,t,n){var a=oc(r),s=a.getUint32(4,!0),l=(n>1?12:8)+pb(s&(n>1?3470:398))*4,u=-1,f=-1,d=NaN,m=new Date(2001,0,1);s&512&&(u=a.getUint32(l,!0),l+=4),l+=pb(s&(n>1?12288:4096))*4,s&16&&(f=a.getUint32(l,!0),l+=4),s&32&&(d=a.getFloat64(l,!0),l+=8),s&64&&(m.setTime(m.getTime()+a.getFloat64(l,!0)*1e3),l+=8);var x;switch(r[2]){case 0:break;case 2:x={t:"n",v:d};break;case 3:x={t:"s",v:e[f]};break;case 5:x={t:"d",v:m};break;case 6:x={t:"b",v:d>0};break;case 7:x={t:"n",v:d/86400};break;case 8:x={t:"e",v:0};break;case 9:if(u>-1)x={t:"s",v:t[u]};else if(f>-1)x={t:"s",v:e[f]};else if(!isNaN(d))x={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(r.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(r.slice(0,4)))}return x}function lW(r,e,t){var n=oc(r),a=n.getUint32(8,!0),s=12,l=-1,u=-1,f=NaN,d=NaN,m=new Date(2001,0,1);a&1&&(f=aW(r,s),s+=16),a&2&&(d=n.getFloat64(s,!0),s+=8),a&4&&(m.setTime(m.getTime()+n.getFloat64(s,!0)*1e3),s+=8),a&8&&(u=n.getUint32(s,!0),s+=4),a&16&&(l=n.getUint32(s,!0),s+=4);var x;switch(r[1]){case 0:break;case 2:x={t:"n",v:f};break;case 3:x={t:"s",v:e[u]};break;case 5:x={t:"d",v:m};break;case 6:x={t:"b",v:d>0};break;case 7:x={t:"n",v:d/86400};break;case 8:x={t:"e",v:0};break;case 9:if(l>-1)x={t:"s",v:t[l]};else throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(a&31," : ").concat(r.slice(0,4)));break;case 10:x={t:"n",v:f};break;default:throw new Error("Unsupported cell type ".concat(r[1]," : ").concat(a&31," : ").concat(r.slice(0,4)))}return x}function kx(r,e){var t=new Uint8Array(32),n=oc(t),a=12,s=0;switch(t[0]=5,r.t){case"n":t[1]=2,iW(t,a,r.v),s|=1,a+=16;break;case"b":t[1]=6,n.setFloat64(a,r.v?1:0,!0),s|=2,a+=8;break;case"s":if(e.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));t[1]=3,n.setUint32(a,e.indexOf(r.v),!0),s|=8,a+=4;break;default:throw"unsupported cell type "+r.t}return n.setUint32(8,s,!0),t.slice(0,a)}function Cx(r,e){var t=new Uint8Array(32),n=oc(t),a=12,s=0;switch(t[0]=3,r.t){case"n":t[2]=2,n.setFloat64(a,r.v,!0),s|=32,a+=8;break;case"b":t[2]=6,n.setFloat64(a,r.v?1:0,!0),s|=32,a+=8;break;case"s":if(e.indexOf(r.v)==-1)throw new Error("Value ".concat(r.v," missing from SST!"));t[2]=3,n.setUint32(a,e.indexOf(r.v),!0),s|=16,a+=4;break;default:throw"unsupported cell type "+r.t}return n.setUint32(4,s,!0),t.slice(0,a)}function cW(r,e,t){switch(r[0]){case 0:case 1:case 2:case 3:return oW(r,e,t,r[0]);case 5:return lW(r,e,t);default:throw new Error("Unsupported payload version ".concat(r[0]))}}function kn(r){var e=Lt(r);return u0(e[1][0].data)}function gb(r,e){var t=Lt(e.data),n=Dr(t[1][0].data),a=t[3],s=[];return(a||[]).forEach(function(l){var u=Lt(l.data),f=Dr(u[1][0].data)>>>0;switch(n){case 1:s[f]=wv(u[3][0].data);break;case 8:{var d=r[kn(u[9][0].data)][0],m=Lt(d.data),x=r[kn(m[1][0].data)][0],_=Dr(x.meta[1][0].data);if(_!=2001)throw new Error("2000 unexpected reference to ".concat(_));var y=Lt(x.data);s[f]=y[3].map(function(w){return wv(w.data)}).join("")}break}}),s}function uW(r,e){var t,n,a,s,l,u,f,d,m,x,_,y,w,T,S=Lt(r),O=Dr(S[1][0].data)>>>0,U=Dr(S[2][0].data)>>>0,R=((n=(t=S[8])==null?void 0:t[0])==null?void 0:n.data)&&Dr(S[8][0].data)>0||!1,Y,te;if((s=(a=S[7])==null?void 0:a[0])!=null&&s.data&&e!=0)Y=(u=(l=S[7])==null?void 0:l[0])==null?void 0:u.data,te=(d=(f=S[6])==null?void 0:f[0])==null?void 0:d.data;else if((x=(m=S[4])==null?void 0:m[0])!=null&&x.data&&e!=1)Y=(y=(_=S[4])==null?void 0:_[0])==null?void 0:y.data,te=(T=(w=S[3])==null?void 0:w[0])==null?void 0:T.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var G=R?4:1,A=oc(Y),C=[],k=0;k<Y.length/2;++k){var V=A.getUint16(k*2,!0);V<65535&&C.push([k,V])}if(C.length!=U)throw"Expected ".concat(U," cells, found ").concat(C.length);var F=[];for(k=0;k<C.length-1;++k)F[C[k][0]]=te.subarray(C[k][1]*G,C[k+1][1]*G);return C.length>=1&&(F[C[C.length-1][0]]=te.subarray(C[C.length-1][1]*G)),{R:O,cells:F}}function fW(r,e){var t,n=Lt(e.data),a=(t=n==null?void 0:n[7])!=null&&t[0]?Dr(n[7][0].data)>>>0>0?1:0:-1,s=_y(n[5],function(l){return uW(l,a)});return{nrows:Dr(n[4][0].data)>>>0,data:s.reduce(function(l,u){return l[u.R]||(l[u.R]=[]),u.cells.forEach(function(f,d){if(l[u.R][d])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(d));l[u.R][d]=f}),l},[])}}function hW(r,e,t){var n,a=Lt(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Dr(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(Dr(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));t["!ref"]=gt(s);var l=Lt(a[4][0].data),u=gb(r,r[kn(l[4][0].data)][0]),f=(n=l[17])!=null&&n[0]?gb(r,r[kn(l[17][0].data)][0]):[],d=Lt(l[3][0].data),m=0;d[1].forEach(function(x){var _=Lt(x.data),y=r[kn(_[2][0].data)][0],w=Dr(y.meta[1][0].data);if(w!=6002)throw new Error("6001 unexpected reference to ".concat(w));var T=fW(r,y);T.data.forEach(function(S,O){S.forEach(function(U,R){var Y=at({r:m+O,c:R}),te=cW(U,u,f);te&&(t[Y]=te)})}),m+=T.nrows})}function dW(r,e){var t=Lt(e.data),n={"!ref":"A1"},a=r[kn(t[2][0].data)],s=Dr(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return hW(r,a[0],n),n}function mW(r,e){var t,n=Lt(e.data),a={name:(t=n[1])!=null&&t[0]?wv(n[1][0].data):"",sheets:[]},s=_y(n[2],kn);return s.forEach(function(l){r[l].forEach(function(u){var f=Dr(u.meta[1][0].data);f==6e3&&a.sheets.push(dW(r,u))})}),a}function pW(r,e){var t=Sy(),n=Lt(e.data),a=_y(n[1],kn);if(a.forEach(function(s){r[s].forEach(function(l){var u=Dr(l.meta[1][0].data);if(u==2){var f=mW(r,l);f.sheets.forEach(function(d,m){Ay(t,d,m==0?f.name:f.name+"_"+m,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function Rx(r){var e,t,n,a,s={},l=[];if(r.FullPaths.forEach(function(f){if(f.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),r.FileIndex.forEach(function(f){if(f.name.match(/\.iwa$/)){var d;try{d=qa(f.content)}catch(x){return console.log("?? "+f.content.length+" "+(x.message||x))}var m;try{m=Ga(d)}catch(x){return console.log("## "+(x.message||x))}m.forEach(function(x){s[x.id]=x.messages,l.push(x.id)})}}),!l.length)throw new Error("File has no messages");var u=((a=(n=(t=(e=s==null?void 0:s[1])==null?void 0:e[0])==null?void 0:t.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Dr(s[1][0].meta[1][0].data)==1&&s[1][0];if(u||l.forEach(function(f){s[f].forEach(function(d){var m=Dr(d.meta[1][0].data)>>>0;if(m==1)if(!u)u=d;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return pW(s,u)}function gW(r,e,t){var n,a,s,l;if(!((n=r[6])!=null&&n[0])||!((a=r[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var u=((l=(s=r[8])==null?void 0:s[0])==null?void 0:l.data)&&Dr(r[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var f=0,d=oc(r[7][0].data),m=0,x=[],_=oc(r[4][0].data),y=0,w=[],T=0;T<e.length;++T){if(e[T]==null){d.setUint16(T*2,65535,!0),_.setUint16(T*2,65535);continue}d.setUint16(T*2,m,!0),_.setUint16(T*2,y,!0);var S,O;switch(typeof e[T]){case"string":S=kx({t:"s",v:e[T]},t),O=Cx({t:"s",v:e[T]},t);break;case"number":S=kx({t:"n",v:e[T]},t),O=Cx({t:"n",v:e[T]},t);break;case"boolean":S=kx({t:"b",v:e[T]},t),O=Cx({t:"b",v:e[T]},t);break;default:throw new Error("Unsupported value "+e[T])}x.push(S),m+=S.length,w.push(O),y+=O.length,++f}for(r[2][0].data=Wt(f);T<r[7][0].data.length/2;++T)d.setUint16(T*2,65535,!0),_.setUint16(T*2,65535,!0);return r[6][0].data=qo(x),r[3][0].data=qo(w),f}function xW(r,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=r.Sheets[r.SheetNames[0]];r.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=ia(t["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(gt(n)));var s=yp(t,{range:n,header:1}),l=["~Sh33tJ5~"];s.forEach(function(J){return J.forEach(function(X){typeof X=="string"&&l.push(X)})});var u={},f=[],d=et.read(e.numbers,{type:"base64"});d.FileIndex.map(function(J,X){return[J,d.FullPaths[X]]}).forEach(function(J){var X=J[0],ee=J[1];if(X.type==2&&X.name.match(/\.iwa/)){var ce=X.content,we=qa(ce),De=Ga(we);De.forEach(function(Ae){f.push(Ae.id),u[Ae.id]={deps:[],location:ee,type:Dr(Ae.messages[0].meta[1][0].data)}})}}),f.sort(function(J,X){return J-X});var m=f.filter(function(J){return J>1}).map(function(J){return[J,Wt(J)]});d.FileIndex.map(function(J,X){return[J,d.FullPaths[X]]}).forEach(function(J){var X=J[0];if(J[1],!!X.name.match(/\.iwa/)){var ee=Ga(qa(X.content));ee.forEach(function(ce){ce.messages.forEach(function(we){m.forEach(function(De){ce.messages.some(function(Ae){return Dr(Ae.meta[1][0].data)!=11006&&nW(Ae.data,De[1])})&&u[De[0]].deps.push(ce.id)})})})}});for(var x=et.find(d,u[1].location),_=Ga(qa(x.content)),y,w=0;w<_.length;++w){var T=_[w];T.id==1&&(y=T)}var S=kn(Lt(y.messages[0].data)[1][0].data);for(x=et.find(d,u[S].location),_=Ga(qa(x.content)),w=0;w<_.length;++w)T=_[w],T.id==S&&(y=T);for(S=kn(Lt(y.messages[0].data)[2][0].data),x=et.find(d,u[S].location),_=Ga(qa(x.content)),w=0;w<_.length;++w)T=_[w],T.id==S&&(y=T);for(S=kn(Lt(y.messages[0].data)[2][0].data),x=et.find(d,u[S].location),_=Ga(qa(x.content)),w=0;w<_.length;++w)T=_[w],T.id==S&&(y=T);var O=Lt(y.messages[0].data);{O[6][0].data=Wt(n.e.r+1),O[7][0].data=Wt(n.e.c+1);var U=kn(O[46][0].data),R=et.find(d,u[U].location),Y=Ga(qa(R.content));{for(var te=0;te<Y.length&&Y[te].id!=U;++te);if(Y[te].id!=U)throw"Bad ColumnRowUIDMapArchive";var G=Lt(Y[te].messages[0].data);G[1]=[],G[2]=[],G[3]=[];for(var A=0;A<=n.e.c;++A){var C=[];C[1]=C[2]=[{type:0,data:Wt(A+420690)}],G[1].push({type:2,data:xn(C)}),G[2].push({type:0,data:Wt(A)}),G[3].push({type:0,data:Wt(A)})}G[4]=[],G[5]=[],G[6]=[];for(var k=0;k<=n.e.r;++k)C=[],C[1]=C[2]=[{type:0,data:Wt(k+726270)}],G[4].push({type:2,data:xn(C)}),G[5].push({type:0,data:Wt(k)}),G[6].push({type:0,data:Wt(k)});Y[te].messages[0].data=xn(G)}R.content=hu(fu(Y)),R.size=R.content.length,delete O[46];var V=Lt(O[4][0].data);{V[7][0].data=Wt(n.e.r+1);var F=Lt(V[1][0].data),M=kn(F[2][0].data);R=et.find(d,u[M].location),Y=Ga(qa(R.content));{if(Y[0].id!=M)throw"Bad HeaderStorageBucket";var L=Lt(Y[0].messages[0].data);for(k=0;k<s.length;++k){var Ie=Lt(L[2][0].data);Ie[1][0].data=Wt(k),Ie[4][0].data=Wt(s[k].length),L[2][k]={type:L[2][0].type,data:xn(Ie)}}Y[0].messages[0].data=xn(L)}R.content=hu(fu(Y)),R.size=R.content.length;var Re=kn(V[2][0].data);R=et.find(d,u[Re].location),Y=Ga(qa(R.content));{if(Y[0].id!=Re)throw"Bad HeaderStorageBucket";for(L=Lt(Y[0].messages[0].data),A=0;A<=n.e.c;++A)Ie=Lt(L[2][0].data),Ie[1][0].data=Wt(A),Ie[4][0].data=Wt(n.e.r+1),L[2][A]={type:L[2][0].type,data:xn(Ie)};Y[0].messages[0].data=xn(L)}R.content=hu(fu(Y)),R.size=R.content.length;var ae=kn(V[4][0].data);(function(){for(var J=et.find(d,u[ae].location),X=Ga(qa(J.content)),ee,ce=0;ce<X.length;++ce){var we=X[ce];we.id==ae&&(ee=we)}var De=Lt(ee.messages[0].data);{De[3]=[];var Ae=[];l.forEach(function(Z,Ft){Ae[1]=[{type:0,data:Wt(Ft)}],Ae[2]=[{type:0,data:Wt(1)}],Ae[3]=[{type:2,data:rW(Z)}],De[3].push({type:2,data:xn(Ae)})})}ee.messages[0].data=xn(De);var Oe=fu(X),st=hu(Oe);J.content=st,J.size=J.content.length})();var le=Lt(V[3][0].data);{var Fe=le[1][0];delete le[2];var ie=Lt(Fe.data);{var Ne=kn(ie[2][0].data);(function(){for(var J=et.find(d,u[Ne].location),X=Ga(qa(J.content)),ee,ce=0;ce<X.length;++ce){var we=X[ce];we.id==Ne&&(ee=we)}var De=Lt(ee.messages[0].data);{delete De[6],delete le[7];var Ae=new Uint8Array(De[5][0].data);De[5]=[];for(var Oe=0,st=0;st<=n.e.r;++st){var Z=Lt(Ae);Oe+=gW(Z,s[st],l),Z[1][0].data=Wt(st),De[5].push({data:xn(Z),type:2})}De[1]=[{type:0,data:Wt(n.e.c+1)}],De[2]=[{type:0,data:Wt(n.e.r+1)}],De[3]=[{type:0,data:Wt(Oe)}],De[4]=[{type:0,data:Wt(n.e.r+1)}]}ee.messages[0].data=xn(De);var Ft=fu(X),lt=hu(Ft);J.content=lt,J.size=J.content.length})()}Fe.data=xn(ie)}V[3][0].data=xn(le)}O[4][0].data=xn(V)}y.messages[0].data=xn(O);var Q=fu(_),N=hu(Q);return x.content=N,x.size=x.content.length,d}function lR(r){return function(t){for(var n=0;n!=r.length;++n){var a=r[n];t[a[0]]===void 0&&(t[a[0]]=a[1]),a[2]==="n"&&(t[a[0]]=Number(t[a[0]]))}}}function yy(r){lR([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(r)}function Ty(r){lR([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(r)}function vW(r){return Tt.WS.indexOf(r)>-1?"sheet":r==Tt.CS?"chart":r==Tt.DS?"dialog":r==Tt.MS?"macro":r&&r.length?r:"sheet"}function _W(r,e){if(!r)return 0;try{r=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,r["!id"][n.id].Target,vW(r["!id"][n.id].Type)]})}catch{return null}return!r||r.length===0?null:r}function yW(r,e,t,n,a,s,l,u,f,d,m,x){try{s[n]=Oh(Ea(r,t,!0),e);var _=Kr(r,e),y;switch(u){case"sheet":y=jK(_,e,a,f,s[n],d,m,x);break;case"chart":if(y=HK(_,e,a,f,s[n],d,m,x),!y||!y["!drawel"])break;var w=_h(y["!drawel"].Target,e),T=a0(w),S=Cj(Ea(r,w,!0),Oh(Ea(r,T,!0),w)),O=_h(S,w),U=a0(O);y=gK(Ea(r,O,!0),O,f,Oh(Ea(r,U,!0),O),d,y);break;case"macro":y=GK(_,e,a,f,s[n],d,m,x);break;case"dialog":y=qK(_,e,a,f,s[n],d,m,x);break;default:throw new Error("Unrecognized sheet type "+u)}l[n]=y;var R=[];s&&s[n]&&Nr(s[n]).forEach(function(Y){var te="";if(s[n][Y].Type==Tt.CMNT){te=_h(s[n][Y].Target,e);var G=YK(Kr(r,te,!0),te,f);if(!G||!G.length)return;tb(y,G,!1)}s[n][Y].Type==Tt.TCMNT&&(te=_h(s[n][Y].Target,e),R=R.concat(Dj(Kr(r,te,!0),f)))}),R&&R.length&&tb(y,R,!0,f.people||[])}catch(Y){if(f.WTF)throw Y}}function ja(r){return r.charAt(0)=="/"?r.slice(1):r}function TW(r,e){if(sf(),e=e||{},yy(e),Ka(r,"META-INF/manifest.xml")||Ka(r,"objectdata.xml"))return hb(r,e);if(Ka(r,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Rx<"u"){if(r.FileIndex)return Rx(r);var t=et.utils.cfb_new();return EA(r).forEach(function(Ie){vt(t,Ie,N7(r,Ie))}),Rx(t)}throw new Error("Unsupported NUMBERS file")}if(!Ka(r,"[Content_Types].xml"))throw Ka(r,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ka(r,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=EA(r),a=AV(Ea(r,"[Content_Types].xml")),s=!1,l,u;if(a.workbooks.length===0&&(u="xl/workbook.xml",Kr(r,u,!0)&&a.workbooks.push(u)),a.workbooks.length===0){if(u="xl/workbook.bin",!Kr(r,u,!0))throw new Error("Could not find workbook");a.workbooks.push(u),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var f={},d={};if(!e.bookSheets&&!e.bookProps){if(Fh=[],a.sst)try{Fh=WK(Kr(r,ja(a.sst)),a.sst,e)}catch(Ie){if(e.WTF)throw Ie}e.cellStyles&&a.themes.length&&(f=XK(Ea(r,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],e)),a.style&&(d=KK(Kr(r,ja(a.style)),a.style,f,e))}a.links.map(function(Ie){try{var Re=Oh(Ea(r,a0(ja(Ie))),Ie);return QK(Kr(r,ja(Ie)),Re,Ie,e)}catch{}});var m=zK(Kr(r,ja(a.workbooks[0])),a.workbooks[0],e),x={},_="";a.coreprops.length&&(_=Kr(r,ja(a.coreprops[0]),!0),_&&(x=$C(_)),a.extprops.length!==0&&(_=Kr(r,ja(a.extprops[0]),!0),_&&NV(_,x,e)));var y={};(!e.bookSheets||e.bookProps)&&a.custprops.length!==0&&(_=Ea(r,ja(a.custprops[0]),!0),_&&(y=FV(_,e)));var w={};if((e.bookSheets||e.bookProps)&&(m.Sheets?l=m.Sheets.map(function(Re){return Re.name}):x.Worksheets&&x.SheetNames.length>0&&(l=x.SheetNames),e.bookProps&&(w.Props=x,w.Custprops=y),e.bookSheets&&typeof l<"u"&&(w.SheetNames=l),e.bookSheets?w.SheetNames:e.bookProps))return w;l={};var T={};e.bookDeps&&a.calcchain&&(T=$K(Kr(r,ja(a.calcchain)),a.calcchain));var S=0,O={},U,R;{var Y=m.Sheets;x.Worksheets=Y.length,x.SheetNames=[];for(var te=0;te!=Y.length;++te)x.SheetNames[te]=Y[te].name}var G=s?"bin":"xml",A=a.workbooks[0].lastIndexOf("/"),C=(a.workbooks[0].slice(0,A+1)+"_rels/"+a.workbooks[0].slice(A+1)+".rels").replace(/^\//,"");Ka(r,C)||(C="xl/_rels/workbook."+G+".rels");var k=Oh(Ea(r,C,!0),C.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(e.xlmeta=JK(Kr(r,ja(a.metadata[0])),a.metadata[0],e)),(a.people||[]).length>=1&&(e.people=Oj(Kr(r,ja(a.people[0])),e)),k&&(k=_W(k,m.Sheets));var V=Kr(r,"xl/worksheets/sheet.xml",!0)?1:0;e:for(S=0;S!=x.Worksheets;++S){var F="sheet";if(k&&k[S]?(U="xl/"+k[S][1].replace(/[\/]?xl\//,""),Ka(r,U)||(U=k[S][1]),Ka(r,U)||(U=C.replace(/_rels\/.*$/,"")+k[S][1]),F=k[S][2]):(U="xl/worksheets/sheet"+(S+1-V)+"."+G,U=U.replace(/sheet0\./,"sheet.")),R=U.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(S!=e.sheets)continue e;break;case"string":if(x.SheetNames[S].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var M=!1,L=0;L!=e.sheets.length;++L)typeof e.sheets[L]=="number"&&e.sheets[L]==S&&(M=1),typeof e.sheets[L]=="string"&&e.sheets[L].toLowerCase()==x.SheetNames[S].toLowerCase()&&(M=1);if(!M)continue e}}yW(r,U,R,x.SheetNames[S],S,O,l,F,e,m,f,d)}return w={Directory:a,Workbook:m,Props:x,Custprops:y,Deps:T,Sheets:l,SheetNames:x.SheetNames,Strings:Fh,Styles:d,Themes:f,SSF:pr(nt)},e&&e.bookFiles&&(r.files?(w.keys=n,w.files=r.files):(w.keys=[],w.files={},r.FullPaths.forEach(function(Ie,Re){Ie=Ie.replace(/^Root Entry[\/]/,""),w.keys.push(Ie),w.files[Ie]=r.FileIndex[Re]}))),e&&e.bookVBA&&(a.vba.length>0?w.vbaraw=Kr(r,ja(a.vba[0]),!0):a.defaults&&a.defaults.bin===zj&&(w.vbaraw=Kr(r,"xl/vbaProject.bin",!0))),w}function EW(r,e){var t=e||{},n="Workbook",a=et.find(r,n);try{if(n="/!DataSpaces/Version",a=et.find(r,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(JU(a.content),n="/!DataSpaces/DataSpaceMap",a=et.find(r,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=ez(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=et.find(r,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=tz(a.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=et.find(r,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);nz(a.content)}catch{}if(n="/EncryptionInfo",a=et.find(r,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var u=az(a.content);if(n="/EncryptedPackage",a=et.find(r,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],a.content,t.password||"",t);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],a.content,t.password||"",t);throw new Error("File is password-protected")}function wW(r,e){return e.bookType=="ods"?oR(r,e):e.bookType=="numbers"?xW(r,e):e.bookType=="xlsb"?SW(r,e):AW(r,e)}function SW(r,e){Tu=1024,r&&!r.SSF&&(r.SSF=pr(nt)),r&&r.SSF&&(sf(),Wp(r.SSF),e.revssf=$p(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Mh?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t=e.bookType=="xlsb"?"bin":"xml",n=M3.indexOf(e.bookType)>-1,a=sy();Ty(e=e||{});var s=K_(),l="",u=0;if(e.cellXfs=[],$o(e.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),l="docProps/core.xml",vt(s,l,QC(r.Props,e)),a.coreprops.push(l),Yt(e.rels,2,l,Tt.CORE_PROPS),l="docProps/app.xml",!(r.Props&&r.Props.SheetNames))if(!r.Workbook||!r.Workbook.Sheets)r.Props.SheetNames=r.SheetNames;else{for(var f=[],d=0;d<r.SheetNames.length;++d)(r.Workbook.Sheets[d]||{}).Hidden!=2&&f.push(r.SheetNames[d]);r.Props.SheetNames=f}for(r.Props.Worksheets=r.Props.SheetNames.length,vt(s,l,e3(r.Props)),a.extprops.push(l),Yt(e.rels,3,l,Tt.EXT_PROPS),r.Custprops!==r.Props&&Nr(r.Custprops||{}).length>0&&(l="docProps/custom.xml",vt(s,l,t3(r.Custprops)),a.custprops.push(l),Yt(e.rels,4,l,Tt.CUST_PROPS)),u=1;u<=r.SheetNames.length;++u){var m={"!id":{}},x=r.Sheets[r.SheetNames[u-1]],_=(x||{})["!type"]||"sheet";switch(_){case"chart":default:l="xl/worksheets/sheet"+u+"."+t,vt(s,l,eX(u-1,l,e,r,m)),a.sheets.push(l),Yt(e.wbrels,-1,"worksheets/sheet"+u+"."+t,Tt.WS[0])}if(x){var y=x["!comments"],w=!1,T="";y&&y.length>0&&(T="xl/comments"+u+"."+t,vt(s,T,nX(y,T)),a.comments.push(T),Yt(m,-1,"../comments"+u+"."+t,Tt.CMNT),w=!0),x["!legacy"]&&w&&vt(s,"xl/drawings/vmlDrawing"+u+".vml",O3(u,x["!comments"])),delete x["!comments"],delete x["!legacy"]}m["!id"].rId1&&vt(s,a0(l),Cu(m))}return e.Strings!=null&&e.Strings.length>0&&(l="xl/sharedStrings."+t,vt(s,l,rX(e.Strings,l,e)),a.strs.push(l),Yt(e.wbrels,-1,"sharedStrings."+t,Tt.SST)),l="xl/workbook."+t,vt(s,l,ZK(r,l)),a.workbooks.push(l),Yt(e.rels,1,l,Tt.WB),l="xl/theme/theme1.xml",vt(s,l,hy(r.Themes,e)),a.themes.push(l),Yt(e.wbrels,-1,"theme/theme1.xml",Tt.THEME),l="xl/styles."+t,vt(s,l,tX(r,l,e)),a.styles.push(l),Yt(e.wbrels,-1,"styles."+t,Tt.STY),r.vbaraw&&n&&(l="xl/vbaProject.bin",vt(s,l,r.vbaraw),a.vba.push(l),Yt(e.wbrels,-1,"vbaProject.bin",Tt.VBA)),l="xl/metadata."+t,vt(s,l,aX(l)),a.metadata.push(l),Yt(e.wbrels,-1,"metadata."+t,Tt.XLMETA),vt(s,"[Content_Types].xml",WC(a,e)),vt(s,"_rels/.rels",Cu(e.rels)),vt(s,"xl/_rels/workbook."+t+".rels",Cu(e.wbrels)),delete e.revssf,delete e.ssf,s}function AW(r,e){Tu=1024,r&&!r.SSF&&(r.SSF=pr(nt)),r&&r.SSF&&(sf(),Wp(r.SSF),e.revssf=$p(r.SSF),e.revssf[r.SSF[65535]]=0,e.ssf=r.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Mh?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t="xml",n=M3.indexOf(e.bookType)>-1,a=sy();Ty(e=e||{});var s=K_(),l="",u=0;if(e.cellXfs=[],$o(e.cellXfs,{},{revssf:{General:0}}),r.Props||(r.Props={}),l="docProps/core.xml",vt(s,l,QC(r.Props,e)),a.coreprops.push(l),Yt(e.rels,2,l,Tt.CORE_PROPS),l="docProps/app.xml",!(r.Props&&r.Props.SheetNames))if(!r.Workbook||!r.Workbook.Sheets)r.Props.SheetNames=r.SheetNames;else{for(var f=[],d=0;d<r.SheetNames.length;++d)(r.Workbook.Sheets[d]||{}).Hidden!=2&&f.push(r.SheetNames[d]);r.Props.SheetNames=f}r.Props.Worksheets=r.Props.SheetNames.length,vt(s,l,e3(r.Props)),a.extprops.push(l),Yt(e.rels,3,l,Tt.EXT_PROPS),r.Custprops!==r.Props&&Nr(r.Custprops||{}).length>0&&(l="docProps/custom.xml",vt(s,l,t3(r.Custprops)),a.custprops.push(l),Yt(e.rels,4,l,Tt.CUST_PROPS));var m=["SheetJ5"];for(e.tcid=0,u=1;u<=r.SheetNames.length;++u){var x={"!id":{}},_=r.Sheets[r.SheetNames[u-1]],y=(_||{})["!type"]||"sheet";switch(y){case"chart":default:l="xl/worksheets/sheet"+u+"."+t,vt(s,l,K3(u-1,e,r,x)),a.sheets.push(l),Yt(e.wbrels,-1,"worksheets/sheet"+u+"."+t,Tt.WS[0])}if(_){var w=_["!comments"],T=!1,S="";if(w&&w.length>0){var O=!1;w.forEach(function(U){U[1].forEach(function(R){R.T==!0&&(O=!0)})}),O&&(S="xl/threadedComments/threadedComment"+u+"."+t,vt(s,S,Nj(w,m,e)),a.threadedcomments.push(S),Yt(x,-1,"../threadedComments/threadedComment"+u+"."+t,Tt.TCMNT)),S="xl/comments"+u+"."+t,vt(s,S,F3(w)),a.comments.push(S),Yt(x,-1,"../comments"+u+"."+t,Tt.CMNT),T=!0}_["!legacy"]&&T&&vt(s,"xl/drawings/vmlDrawing"+u+".vml",O3(u,_["!comments"])),delete _["!comments"],delete _["!legacy"]}x["!id"].rId1&&vt(s,a0(l),Cu(x))}return e.Strings!=null&&e.Strings.length>0&&(l="xl/sharedStrings."+t,vt(s,l,T3(e.Strings,e)),a.strs.push(l),Yt(e.wbrels,-1,"sharedStrings."+t,Tt.SST)),l="xl/workbook."+t,vt(s,l,Q3(r)),a.workbooks.push(l),Yt(e.rels,1,l,Tt.WB),l="xl/theme/theme1.xml",vt(s,l,hy(r.Themes,e)),a.themes.push(l),Yt(e.wbrels,-1,"theme/theme1.xml",Tt.THEME),l="xl/styles."+t,vt(s,l,C3(r,e)),a.styles.push(l),Yt(e.wbrels,-1,"styles."+t,Tt.STY),r.vbaraw&&n&&(l="xl/vbaProject.bin",vt(s,l,r.vbaraw),a.vba.push(l),Yt(e.wbrels,-1,"vbaProject.bin",Tt.VBA)),l="xl/metadata."+t,vt(s,l,N3()),a.metadata.push(l),Yt(e.wbrels,-1,"metadata."+t,Tt.XLMETA),m.length>1&&(l="xl/persons/person.xml",vt(s,l,Fj(m)),a.people.push(l),Yt(e.wbrels,-1,"persons/person.xml",Tt.PEOPLE)),vt(s,"[Content_Types].xml",WC(a,e)),vt(s,"_rels/.rels",Cu(e.rels)),vt(s,"xl/_rels/workbook."+t+".rels",Cu(e.wbrels)),delete e.revssf,delete e.ssf,s}function Ey(r,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];case"base64":t=Ia(r.slice(0,12));break;case"binary":t=r;break;case"array":return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function bW(r,e){return et.find(r,"EncryptedPackage")?EW(r,e):tR(r,e)}function IW(r,e){var t,n=r,a=e||{};return a.type||(a.type=_t&&Buffer.isBuffer(r)?"buffer":"base64"),t=wC(n,a),TW(t,a)}function cR(r,e){var t=0;e:for(;t<r.length;)switch(r.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return Tv(r.slice(t),e);default:break e}return Yu.to_workbook(r,e)}function kW(r,e){var t="",n=Ey(r,e);switch(e.type){case"base64":t=Ia(r);break;case"binary":t=r;break;case"buffer":t=r.toString("binary");break;case"array":t=nc(r);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(t=ir(t)),e.type="binary",cR(t,e)}function CW(r,e){var t=r;return e.type=="base64"&&(t=Ia(t)),t=Jh.utils.decode(1200,t.slice(2),"str"),e.type="binary",cR(t,e)}function RW(r){return r.match(/[^\x00-\x7F]/)?ji(r):r}function Dx(r,e,t,n){return n?(t.type="string",Yu.to_workbook(r,t)):Yu.to_workbook(e,t)}function Sv(r,e){z_();var t=e||{};if(typeof ArrayBuffer<"u"&&r instanceof ArrayBuffer)return Sv(new Uint8Array(r),(t=pr(t),t.type="array",t));typeof Uint8Array<"u"&&r instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var n=r,a=[0,0,0,0],s=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),Du={},t.dateNF&&(Du.dateNF=t.dateNF),t.type||(t.type=_t&&Buffer.isBuffer(r)?"buffer":"base64"),t.type=="file"&&(t.type=_t?"buffer":"binary",n=S7(r),typeof Uint8Array<"u"&&!_t&&(t.type="array")),t.type=="string"&&(s=!0,t.type="binary",t.codepage=65001,n=RW(r)),t.type=="array"&&typeof Uint8Array<"u"&&r instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),u=new Uint8Array(l);if(u.foo="bar",!u.foo)return t=pr(t),t.type="array",Sv(j_(n),t)}switch((a=Ey(n,t))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return bW(et.read(n,t),t);break;case 9:if(a[1]<=8)return tR(n,t);break;case 60:return Tv(n,t);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return MU(n,t);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return _3.to_workbook(n,t);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?IW(n,t):Dx(r,n,t,s);case 239:return a[3]===60?Tv(n,t):Dx(r,n,t,s);case 255:if(a[1]===254)return CW(n,t);if(a[1]===0&&a[2]===2&&a[3]===0)return Hl.to_workbook(n,t);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Hl.to_workbook(n,t);break;case 3:case 131:case 139:case 140:return yv.to_workbook(n,t);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return b3.to_workbook(n,t);break;case 10:case 13:case 32:return kW(n,t);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return FU.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?yv.to_workbook(n,t):Dx(r,n,t,s)}function uR(r,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return A0(e.file,et.write(r,{type:_t?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return et.write(r,e)}function DW(r,e){var t=pr(e||{}),n=wW(r,t);return NW(n,t)}function NW(r,e){var t={},n=_t?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(t.compression="DEFLATE"),e.password)t.type=n;else switch(e.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":t.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var a=r.FullPaths?et.write(r,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!e.compression}):r.generate(t);if(typeof Deno<"u"&&typeof a=="string"){if(e.type=="binary"||e.type=="base64")return a;a=new Uint8Array(Xp(a))}return e.password&&typeof encrypt_agile<"u"?uR(encrypt_agile(a,e.password),e):e.type==="file"?A0(e.file,a):e.type=="string"?ir(a):a}function OW(r,e){var t=e||{},n=RX(r,t);return uR(n,t)}function Vi(r,e,t){t||(t="");var n=t+r;switch(e.type){case"base64":return Zh(ji(n));case"binary":return ji(n);case"string":return r;case"file":return A0(e.file,n,"utf8");case"buffer":return _t?Vs(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Vi(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function FW(r,e){switch(e.type){case"base64":return Zh(r);case"binary":return r;case"string":return r;case"file":return A0(e.file,r,"binary");case"buffer":return _t?Vs(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function gm(r,e){switch(e.type){case"string":case"base64":case"binary":for(var t="",n=0;n<r.length;++n)t+=String.fromCharCode(r[n]);return e.type=="base64"?Zh(t):e.type=="string"?ir(t):t;case"file":return A0(e.file,r);case"buffer":return r;default:throw new Error("Unrecognized type "+e.type)}}function fR(r,e){z_(),bK(r);var t=pr(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var n=fR(r,t);return t.type="array",Xp(n)}var a=0;if(t.sheet&&(typeof t.sheet=="number"?a=t.sheet:a=r.SheetNames.indexOf(t.sheet),!r.SheetNames[a]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return Vi(wX(r,t),t);case"slk":case"sylk":return Vi(v3.from_sheet(r.Sheets[r.SheetNames[a]],t),t);case"htm":case"html":return Vi(nR(r.Sheets[r.SheetNames[a]],t),t);case"txt":return FW(hR(r.Sheets[r.SheetNames[a]],t),t);case"csv":return Vi(wy(r.Sheets[r.SheetNames[a]],t),t,"\uFEFF");case"dif":return Vi(_3.from_sheet(r.Sheets[r.SheetNames[a]],t),t);case"dbf":return gm(yv.from_sheet(r.Sheets[r.SheetNames[a]],t),t);case"prn":return Vi(Yu.from_sheet(r.Sheets[r.SheetNames[a]],t),t);case"rtf":return Vi(b3.from_sheet(r.Sheets[r.SheetNames[a]],t),t);case"eth":return Vi(y3.from_sheet(r.Sheets[r.SheetNames[a]],t),t);case"fods":return Vi(oR(r,t),t);case"wk1":return gm(Hl.sheet_to_wk1(r.Sheets[r.SheetNames[a]],t),t);case"wk3":return gm(Hl.book_to_wk3(r,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),gm(rR(r,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),OW(r,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return DW(r,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function MW(r){if(!r.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=r.file.slice(r.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(r.bookType=t.slice(1)),r.bookType=e[r.bookType]||r.bookType}}function PW(r,e,t){var n={};return n.type="file",n.file=e,MW(n),fR(r,n)}function LW(r,e,t,n,a,s,l,u){var f=Lr(t),d=u.defval,m=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),x=!0,_=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(_,"__rowNum__",{value:t,enumerable:!1})}catch{_.__rowNum__=t}else _.__rowNum__=t;if(!l||r[t])for(var y=e.s.c;y<=e.e.c;++y){var w=l?r[t][y]:r[n[y]+f];if(w===void 0||w.t===void 0){if(d===void 0)continue;s[y]!=null&&(_[s[y]]=d);continue}var T=w.v;switch(w.t){case"z":if(T==null)break;continue;case"e":T=T==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+w.t)}if(s[y]!=null){if(T==null)if(w.t=="e"&&T===null)_[s[y]]=null;else if(d!==void 0)_[s[y]]=d;else if(m&&T===null)_[s[y]]=null;else continue;else _[s[y]]=m&&(w.t!=="n"||w.t==="n"&&u.rawNumbers!==!1)?T:Ps(w,T,u);T!=null&&(x=!1)}}return{row:_,isempty:x}}function yp(r,e){if(r==null||r["!ref"]==null)return[];var t={t:"n",v:0},n=0,a=1,s=[],l=0,u="",f={s:{r:0,c:0},e:{r:0,c:0}},d=e||{},m=d.range!=null?d.range:r["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof m){case"string":f=Ot(m);break;case"number":f=Ot(r["!ref"]),f.s.r=m;break;default:f=m}n>0&&(a=0);var x=Lr(f.s.r),_=[],y=[],w=0,T=0,S=Array.isArray(r),O=f.s.r,U=0,R={};S&&!r[O]&&(r[O]=[]);var Y=d.skipHidden&&r["!cols"]||[],te=d.skipHidden&&r["!rows"]||[];for(U=f.s.c;U<=f.e.c;++U)if(!(Y[U]||{}).hidden)switch(_[U]=wr(U),t=S?r[O][U]:r[_[U]+x],n){case 1:s[U]=U-f.s.c;break;case 2:s[U]=_[U];break;case 3:s[U]=d.header[U-f.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),u=l=Ps(t,null,d),T=R[l]||0,!T)R[l]=1;else{do u=l+"_"+T++;while(R[u]);R[l]=T,R[u]=1}s[U]=u}for(O=f.s.r+a;O<=f.e.r;++O)if(!(te[O]||{}).hidden){var G=LW(r,f,O,_,n,s,S,d);(G.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(y[w++]=G.row)}return y.length=w,y}var xb=/"/g;function VW(r,e,t,n,a,s,l,u){for(var f=!0,d=[],m="",x=Lr(t),_=e.s.c;_<=e.e.c;++_)if(n[_]){var y=u.dense?(r[t]||[])[_]:r[n[_]+x];if(y==null)m="";else if(y.v!=null){f=!1,m=""+(u.rawNumbers&&y.t=="n"?y.v:Ps(y,null,u));for(var w=0,T=0;w!==m.length;++w)if((T=m.charCodeAt(w))===a||T===s||T===34||u.forceQuotes){m='"'+m.replace(xb,'""')+'"';break}m=="ID"&&(m='"ID"')}else y.f!=null&&!y.F?(f=!1,m="="+y.f,m.indexOf(",")>=0&&(m='"'+m.replace(xb,'""')+'"')):m="";d.push(m)}return u.blankrows===!1&&f?null:d.join(l)}function wy(r,e){var t=[],n=e??{};if(r==null||r["!ref"]==null)return"";var a=Ot(r["!ref"]),s=n.FS!==void 0?n.FS:",",l=s.charCodeAt(0),u=n.RS!==void 0?n.RS:`
`,f=u.charCodeAt(0),d=new RegExp((s=="|"?"\\|":s)+"+$"),m="",x=[];n.dense=Array.isArray(r);for(var _=n.skipHidden&&r["!cols"]||[],y=n.skipHidden&&r["!rows"]||[],w=a.s.c;w<=a.e.c;++w)(_[w]||{}).hidden||(x[w]=wr(w));for(var T=0,S=a.s.r;S<=a.e.r;++S)(y[S]||{}).hidden||(m=VW(r,a,S,x,l,f,s,n),m!=null&&(n.strip&&(m=m.replace(d,"")),(m||n.blankrows!==!1)&&t.push((T++?u:"")+m)));return delete n.dense,t.join("")}function hR(r,e){e||(e={}),e.FS="	",e.RS=`
`;var t=wy(r,e);return t}function BW(r){var e="",t,n="";if(r==null||r["!ref"]==null)return[];var a=Ot(r["!ref"]),s="",l=[],u,f=[],d=Array.isArray(r);for(u=a.s.c;u<=a.e.c;++u)l[u]=wr(u);for(var m=a.s.r;m<=a.e.r;++m)for(s=Lr(m),u=a.s.c;u<=a.e.c;++u)if(e=l[u]+s,t=d?(r[m]||[])[u]:r[e],n="",t!==void 0){if(t.F!=null){if(e=t.F,!t.f)continue;n=t.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(t.f!=null)n=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)n=""+t.v;else if(t.t=="b")n=t.v?"TRUE":"FALSE";else if(t.w!==void 0)n="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?n="'"+t.v:n=""+t.v}}f[f.length]=e+"="+n}return f}function dR(r,e,t){var n=t||{},a=+!n.skipHeader,s=r||{},l=0,u=0;if(s&&n.origin!=null)if(typeof n.origin=="number")l=n.origin;else{var f=typeof n.origin=="string"?Sr(n.origin):n.origin;l=f.r,u=f.c}var d,m={s:{c:0,r:0},e:{c:u,r:l+e.length-1+a}};if(s["!ref"]){var x=Ot(s["!ref"]);m.e.c=Math.max(m.e.c,x.e.c),m.e.r=Math.max(m.e.r,x.e.r),l==-1&&(l=x.e.r+1,m.e.r=l+e.length-1+a)}else l==-1&&(l=0,m.e.r=e.length-1+a);var _=n.header||[],y=0;e.forEach(function(T,S){Nr(T).forEach(function(O){(y=_.indexOf(O))==-1&&(_[y=_.length]=O);var U=T[O],R="z",Y="",te=at({c:u+y,r:l+S+a});d=f0(s,te),U&&typeof U=="object"&&!(U instanceof Date)?s[te]=U:(typeof U=="number"?R="n":typeof U=="boolean"?R="b":typeof U=="string"?R="s":U instanceof Date?(R="d",n.cellDates||(R="n",U=en(U)),Y=n.dateNF||nt[14]):U===null&&n.nullError&&(R="e",U=0),d?(d.t=R,d.v=U,delete d.w,delete d.R,Y&&(d.z=Y)):s[te]=d={t:R,v:U},Y&&(d.z=Y))})}),m.e.c=Math.max(m.e.c,u+_.length-1);var w=Lr(l);if(a)for(y=0;y<_.length;++y)s[wr(y+u)+w]={t:"s",v:_[y]};return s["!ref"]=gt(m),s}function UW(r,e){return dR(null,r,e)}function f0(r,e,t){if(typeof e=="string"){if(Array.isArray(r)){var n=Sr(e);return r[n.r]||(r[n.r]=[]),r[n.r][n.c]||(r[n.r][n.c]={t:"z"})}return r[e]||(r[e]={t:"z"})}return typeof e!="number"?f0(r,at(e)):f0(r,at({r:e,c:t||0}))}function zW(r,e){if(typeof e=="number"){if(e>=0&&r.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=r.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function Sy(){return{SheetNames:[],Sheets:{}}}function Ay(r,e,t,n){var a=1;if(!t)for(;a<=65535&&r.SheetNames.indexOf(t="Sheet"+a)!=-1;++a,t=void 0);if(!t||r.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&r.SheetNames.indexOf(t)>=0){var s=t.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var l=s&&s[1]||t;for(++a;a<=65535&&r.SheetNames.indexOf(t=l+a)!=-1;++a);}if($3(t),r.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return r.SheetNames.push(t),r.Sheets[t]=e,t}function jW(r,e,t){r.Workbook||(r.Workbook={}),r.Workbook.Sheets||(r.Workbook.Sheets=[]);var n=zW(r,e);switch(r.Workbook.Sheets[n]||(r.Workbook.Sheets[n]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}r.Workbook.Sheets[n].Hidden=t}function HW(r,e){return r.z=e,r}function mR(r,e,t){return e?(r.l={Target:e},t&&(r.l.Tooltip=t)):delete r.l,r}function GW(r,e,t){return mR(r,"#"+e,t)}function qW(r,e,t){r.c||(r.c=[]),r.c.push({t:e,a:t||"SheetJS"})}function KW(r,e,t,n){for(var a=typeof e!="string"?e:Ot(e),s=typeof e=="string"?e:gt(e),l=a.s.r;l<=a.e.r;++l)for(var u=a.s.c;u<=a.e.c;++u){var f=f0(r,l,u);f.t="n",f.F=s,delete f.v,l==a.s.r&&u==a.s.c&&(f.f=t,n&&(f.D=!0))}return r}var xm={encode_col:wr,encode_row:Lr,encode_cell:at,encode_range:gt,decode_col:ey,decode_row:Z_,split_cell:rV,decode_cell:Sr,decode_range:ia,format_cell:Ps,sheet_add_aoa:zC,sheet_add_json:dR,sheet_add_dom:aR,aoa_to_sheet:of,json_to_sheet:UW,table_to_sheet:iR,table_to_book:JX,sheet_to_csv:wy,sheet_to_txt:hR,sheet_to_json:yp,sheet_to_html:nR,sheet_to_formulae:BW,sheet_to_row_object_array:yp,sheet_get_cell:f0,book_new:Sy,book_append_sheet:Ay,book_set_sheet_visibility:jW,cell_set_number_format:HW,cell_set_hyperlink:mR,cell_set_internal_link:GW,cell_add_comment:qW,sheet_set_array_formula:KW,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const XW=()=>{const{dbData:r,setDbData:e,categories:t,setCategories:n,setCurrentYear:a}=ka(),s=Qe.useCallback(()=>{if(Object.keys(r).length===0){alert("  .");return}const u=xm.book_new(),f=Object.keys(r).sort((d,m)=>{const[x,_]=d.split("-"),[y,w]=m.split("-");return x!==y?parseInt(x)-parseInt(y):parseInt(_)-parseInt(w)});for(const d of f){const m=r[d];if(!m||m.items.length===0)continue;const[x,_]=d.split("-"),y=d.replace("-",""),w=[[`${x} ${_}`],["","","","","",""]];m.items.sort((S,O)=>S.day-O.day).forEach(S=>{w.push([S.category,S.name||S.details,S.type==="fixed"?"":"",S.amount.toLocaleString(),S.day?`${parseInt(_)}/${S.day}`:"",S.memo||""])});const T=xm.aoa_to_sheet(w);xm.book_append_sheet(u,T,y)}PW(u,`SmartSpend__${new Date().toISOString().split("T")[0]}.xlsx`)},[r]),l=Qe.useCallback(u=>{const f=u.target.files[0];if(!f)return;const d=new FileReader;d.onload=m=>{let x;try{const _=m.target.result;x=Sv(_,{type:"array",cellDates:!0})}catch(_){console.error("Error parsing Excel file:",_),alert("   .");return}try{const _=JSON.parse(JSON.stringify(r)),y=[...t],w=Y=>`${Y.category}|${Y.name}|${Y.amount}|${Y.type}|${Y.day}|${Y.memo||""}`,T={};for(const Y in _)T[Y]=new Set(_[Y].items.map(w));let S=0,O=0,U=null,R=Date.now();for(const Y of x.SheetNames){const te=x.Sheets[Y];if(!te)continue;const G=xm.sheet_to_json(te,{header:1});if(G.length<2)continue;const A=G[0]&&G[0][0];if(!A||typeof A!="string")continue;const C=A.match(/(\d{4})/),k=A.match(/(\d{1,2})/);if(!C||!k)continue;const V=parseInt(C[1]),F=parseInt(k[1]),M=`${V}-${F}`;U||(U=V),_[M]||(_[M]={items:[]},T[M]=new Set);for(let L=2;L<G.length;L++){const Ie=G[L];if(!Ie||Ie.length===0)continue;const Re=Ie[0],ae=Ie[1],le=Ie[2],Fe=Ie[3],ie=parseInt(typeof Fe=="string"?Fe.replace(/,/g,""):Fe),Ne=Ie[4],Q=Ie[5]||"";let N;if(Ne instanceof Date?N=Ne.getDate():typeof Ne=="string"&&Ne.includes("/")?N=parseInt(Ne.split("/")[1]):N=parseInt(Ne),!Re||!ae||isNaN(ie))continue;const J={id:R++,category:Re,name:ae,amount:ie,type:le===""?"fixed":"variable",day:isNaN(N)?null:N,details:ae,memo:Q},X=w(J);if(T[M].has(X)){O++;continue}if(_[M].items.push(J),T[M].add(X),S++,!y.some(ee=>ee.name===Re)){const ee=op[y.length%op.length];y.push({id:`c${y.length+1}_${Date.now()}`,name:Re,...ee})}}}n(y),e(_),U&&a(U),alert(`  !
-  : ${S} 
-  : ${O} `)}catch(_){console.error("Error processing Excel:",_),alert("Excel    .")}},d.readAsArrayBuffer(f),u.target.files=null},[r,t,n,e,a]);return{handleDownloadExcel:s,handleFileUpload:l}},WW=()=>{const{setIsCategoryModalOpen:r,syncStatus:e,manualSync:t,userId:n}=ka(),{handleSaveData:a,resetData:s}=nf(),{handleDownloadExcel:l,handleFileUpload:u}=XW(),{user:f,signOut:d}=Qk(),x=(()=>{switch(e){case"syncing":return{icon:B.jsx(oA,{size:18,className:"text-blue-500 animate-spin"}),text:" ...",color:"text-blue-500"};case"synced":return{icon:B.jsx(sA,{size:18,className:"text-green-500"}),text:"",color:"text-green-500"};case"error":return{icon:B.jsx(mL,{size:18,className:"text-red-500"}),text:" ",color:"text-red-500"};default:return{icon:B.jsx(sA,{size:18,className:"text-gray-400"}),text:" ",color:"text-gray-400"}}})(),_=async()=>{window.confirm("?")&&await d()};return B.jsxs("div",{className:"flex-1 overflow-y-auto pb-24 p-5 animate-in fade-in duration-300",children:[B.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[B.jsx("div",{className:"w-16 h-16 bg-gray-200 rounded-full flex items-center justify-center overflow-hidden",children:f!=null&&f.photoURL?B.jsx("img",{src:f.photoURL,alt:"",className:"w-full h-full object-cover"}):B.jsx(LL,{size:32,className:"text-gray-400"})}),B.jsxs("div",{className:"flex-1",children:[B.jsx("h2",{className:"text-lg font-bold text-gray-900",children:(f==null?void 0:f.displayName)||""}),B.jsx("p",{className:"text-xs text-gray-500",children:(f==null?void 0:f.email)||" "})]}),B.jsxs("div",{className:`flex items-center gap-1.5 px-3 py-1.5 rounded-full bg-gray-100 ${x.color}`,children:[x.icon,B.jsx("span",{className:"text-xs font-medium",children:x.text})]})]}),B.jsxs("div",{className:"space-y-4",children:[B.jsxs("section",{className:"bg-white rounded-xl border border-gray-100 overflow-hidden",children:[B.jsx("h3",{className:"text-xs font-bold text-gray-400 p-4 pb-0 mb-2 uppercase",children:""}),B.jsxs("div",{children:[B.jsxs("div",{onClick:t,className:"p-4 flex justify-between items-center border-b border-gray-50 hover:bg-gray-50 cursor-pointer",children:[B.jsxs("div",{className:"flex items-center gap-3",children:[B.jsx(oA,{size:18,className:`text-blue-500 ${e==="syncing"?"animate-spin":""}`}),B.jsx("span",{className:"text-sm font-medium",children:" "})]}),B.jsx(So,{size:16,className:"text-gray-400"})]}),B.jsxs("div",{onClick:_,className:"p-4 flex justify-between items-center hover:bg-gray-50 cursor-pointer",children:[B.jsxs("div",{className:"flex items-center gap-3",children:[B.jsx(EL,{size:18,className:"text-gray-500"}),B.jsx("span",{className:"text-sm font-medium",children:""})]}),B.jsx(So,{size:16,className:"text-gray-400"})]})]})]}),B.jsxs("section",{className:"bg-white rounded-xl border border-gray-100 overflow-hidden",children:[B.jsx("h3",{className:"text-xs font-bold text-gray-400 p-4 pb-0 mb-2 uppercase",children:" "}),B.jsxs("div",{children:[B.jsxs("div",{onClick:()=>r(!0),className:"p-4 flex justify-between items-center border-b border-gray-50 hover:bg-gray-50 cursor-pointer",children:[B.jsxs("div",{className:"flex items-center gap-3",children:[B.jsx(L_,{size:18,className:"text-blue-500"}),B.jsx("span",{className:"text-sm font-medium",children:" "})]}),B.jsx(So,{size:16,className:"text-gray-400"})]}),B.jsxs("div",{className:"p-4 flex justify-between items-center hover:bg-gray-50 cursor-pointer",children:[B.jsxs("div",{className:"flex items-center gap-3",children:[B.jsx(aC,{size:18,className:"text-green-500"}),B.jsx("span",{className:"text-sm font-medium",children:"/  "})]}),B.jsx(So,{size:16,className:"text-gray-400"})]})]})]}),B.jsxs("section",{className:"bg-white rounded-xl border border-gray-100 overflow-hidden",children:[B.jsx("h3",{className:"text-xs font-bold text-gray-400 p-4 pb-0 mb-2 uppercase",children:""}),B.jsxs("div",{children:[B.jsxs("div",{onClick:a,className:"p-4 flex justify-between items-center border-b border-gray-50 hover:bg-gray-50 cursor-pointer",children:[B.jsxs("div",{className:"flex items-center gap-3",children:[B.jsx(nC,{size:18,className:"text-purple-500"}),B.jsx("span",{className:"text-sm font-medium",children:" /"})]}),B.jsx(So,{size:16,className:"text-gray-400"})]}),B.jsxs("div",{onClick:l,className:"p-4 flex justify-between items-center border-b border-gray-50 hover:bg-gray-50 cursor-pointer",children:[B.jsxs("div",{className:"flex items-center gap-3",children:[B.jsx(xL,{size:18,className:"text-teal-500"}),B.jsx("span",{className:"text-sm font-medium",children:" "})]}),B.jsx(So,{size:16,className:"text-gray-400"})]}),B.jsxs("label",{className:"p-4 flex justify-between items-center border-b border-gray-50 hover:bg-gray-50 cursor-pointer",children:[B.jsxs("div",{className:"flex items-center gap-3",children:[B.jsx(kL,{size:18,className:"text-orange-500"}),B.jsx("span",{className:"text-sm font-medium",children:" "})]}),B.jsx("input",{type:"file",className:"hidden",accept:".xlsx, .xls",onChange:u}),B.jsx(So,{size:16,className:"text-gray-400"})]}),B.jsxs("div",{onClick:s,className:"p-4 flex justify-between items-center hover:bg-red-50 cursor-pointer",children:[B.jsxs("div",{className:"flex items-center gap-3",children:[B.jsx(V_,{size:18,className:"text-red-500"}),B.jsx("span",{className:"text-sm font-medium text-red-600",children:"  "})]}),B.jsx(So,{size:16,className:"text-red-400"})]})]})]})]})]})},YW=()=>{const{isInputModalOpen:r,setIsInputModalOpen:e,editingId:t,categories:n,inputForm:a,setInputForm:s}=ka(),{saveItem:l}=nf();if(!r)return null;const u=()=>{if(!a.amount||!a.details){alert("  .");return}const f=parseInt(a.date.split("-")[2]),d={category:a.category,name:a.details,amount:parseInt(a.amount),type:a.type,day:isNaN(f)?null:f,details:a.details,memo:a.memo};l(d,t),e(!1)};return B.jsx("div",{className:"absolute inset-0 z-50 bg-black/60 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-in fade-in duration-200",children:B.jsxs("div",{className:"bg-white w-full max-w-sm rounded-3xl shadow-2xl overflow-hidden animate-in slide-in-from-bottom-10 duration-300 flex flex-col max-h-[95vh]",children:[B.jsxs("div",{className:"bg-blue-600 p-4 flex justify-between items-center text-white shrink-0",children:[B.jsx("h3",{className:"font-bold text-lg",children:t?" ":" "}),B.jsx("button",{onClick:()=>e(!1),children:B.jsx(hv,{size:24})})]}),B.jsxs("div",{className:"p-5 space-y-4 overflow-y-auto flex-1",children:[B.jsxs("div",{children:[B.jsx("label",{className:"text-xs font-bold text-gray-500 block mb-1",children:""}),B.jsx("input",{type:"date",value:a.date,onChange:f=>s({...a,date:f.target.value}),className:"w-full bg-gray-50 border border-gray-200 rounded-xl p-3 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),B.jsxs("div",{children:[B.jsx("label",{className:"text-xs font-bold text-gray-500 block mb-1",children:""}),B.jsx("div",{className:"flex flex-wrap gap-2",children:n.map(f=>B.jsx("button",{onClick:()=>s({...a,category:f.name}),className:`px-3 py-1.5 rounded-lg text-xs font-medium border transition-colors ${a.category===f.name?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-600 border-gray-200 hover:bg-gray-50"}`,children:f.name},f.id))})]}),B.jsxs("div",{className:"flex gap-2",children:[B.jsx("button",{onClick:()=>s({...a,type:"variable"}),className:`flex-1 py-2 rounded-xl text-sm font-medium border ${a.type==="variable"?"bg-green-100 text-green-700 border-green-200":"bg-white border-gray-200"}`,children:""}),B.jsx("button",{onClick:()=>s({...a,type:"fixed"}),className:`flex-1 py-2 rounded-xl text-sm font-medium border ${a.type==="fixed"?"bg-blue-100 text-blue-700 border-blue-200":"bg-white border-gray-200"}`,children:""})]}),B.jsxs("div",{children:[B.jsx("label",{className:"text-xs font-bold text-gray-500 block mb-1",children:""}),B.jsxs("div",{className:"relative",children:[B.jsx("input",{type:"text",placeholder:"0",value:yu(a.amount),onChange:f=>{const d=iC(f.target.value);s({...a,amount:d})},className:"w-full bg-gray-50 border border-gray-200 rounded-xl p-3 pl-3 pr-8 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"}),B.jsx("span",{className:"absolute right-3 top-3 text-sm text-gray-400",children:""})]})]}),B.jsxs("div",{children:[B.jsx("label",{className:"text-xs font-bold text-gray-500 block mb-1",children:""}),B.jsx("input",{type:"text",placeholder:" ",value:a.details,onChange:f=>s({...a,details:f.target.value}),className:"w-full bg-gray-50 border border-gray-200 rounded-xl p-3 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),B.jsxs("div",{children:[B.jsx("label",{className:"text-xs font-bold text-gray-500 block mb-1",children:""}),B.jsx("textarea",{placeholder:" ",value:a.memo,onChange:f=>s({...a,memo:f.target.value}),className:"w-full bg-gray-50 border border-gray-200 rounded-xl p-3 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 h-20 resize-none"})]}),B.jsx("button",{onClick:u,className:"w-full bg-blue-600 text-white py-3.5 rounded-xl font-bold shadow-lg hover:bg-blue-700 transition-colors",children:t?" ":""})]})]})})},$W=()=>{const{categories:r,setCategories:e}=ka(),[t,n]=Qe.useState(""),[a,s]=Qe.useState(null),l=Qe.useCallback(()=>{if(!t.trim()){alert("  .");return}if(r.some(x=>x.name===t.trim())){alert("  .");return}const d=op[r.length%op.length],m={id:`c${Date.now()}`,name:t.trim(),...d};e([...r,m]),n("")},[t,r,e]),u=Qe.useCallback((d,m)=>{m.trim()&&(e(r.map(x=>x.id===d?{...x,name:m.trim()}:x)),s(null))},[r,e]),f=Qe.useCallback(d=>{window.confirm("  ?        ''   .")&&e(r.filter(m=>m.id!==d))},[r,e]);return{newCategoryName:t,setNewCategoryName:n,editingCategory:a,setEditingCategory:s,handleAddCategory:l,handleUpdateCategory:u,handleDeleteCategory:f}},QW=()=>{const{isCategoryModalOpen:r,setIsCategoryModalOpen:e,categories:t}=ka(),{newCategoryName:n,setNewCategoryName:a,editingCategory:s,setEditingCategory:l,handleAddCategory:u,handleUpdateCategory:f,handleDeleteCategory:d}=$W();return r?B.jsx("div",{className:"absolute inset-0 z-50 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 animate-in fade-in duration-200",children:B.jsxs("div",{className:"bg-white w-full max-w-sm rounded-3xl shadow-2xl overflow-hidden flex flex-col max-h-[95vh]",children:[B.jsxs("div",{className:"bg-blue-600 p-4 flex justify-between items-center text-white shrink-0",children:[B.jsx("h3",{className:"font-bold text-lg",children:" "}),B.jsx("button",{onClick:()=>{e(!1),l(null)},children:B.jsx(hv,{size:24})})]}),B.jsxs("div",{className:"p-5 space-y-4 overflow-y-auto flex-1",children:[B.jsxs("div",{className:"flex gap-2",children:[B.jsx("input",{type:"text",placeholder:"  ",value:n,onChange:m=>a(m.target.value),className:"flex-grow bg-gray-50 border border-gray-200 rounded-xl p-3 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"}),B.jsx("button",{onClick:u,className:"bg-blue-600 text-white px-4 py-2 rounded-xl font-bold hover:bg-blue-700 transition-colors",children:""})]}),B.jsxs("div",{className:"space-y-2",children:[B.jsx("h4",{className:"text-xs font-bold text-gray-500 mt-4",children:" "}),B.jsx("div",{className:"space-y-2",children:t.map(m=>B.jsx("div",{className:"flex justify-between items-center bg-gray-50 p-3 rounded-lg",children:(s==null?void 0:s.id)===m.id?B.jsxs(B.Fragment,{children:[B.jsx("input",{type:"text",value:s.name,onChange:x=>l({...s,name:x.target.value}),className:"flex-grow bg-white border border-blue-300 rounded-md py-1 px-2 text-sm focus:outline-none focus:ring-1 focus:ring-blue-500",autoFocus:!0}),B.jsxs("div",{className:"flex gap-1 ml-2",children:[B.jsx("button",{onClick:()=>f(s.id,s.name),className:"p-1 text-green-600 hover:bg-green-100 rounded-md",children:B.jsx(nC,{size:16})}),B.jsx("button",{onClick:()=>l(null),className:"p-1 text-gray-500 hover:bg-gray-100 rounded-md",children:B.jsx(hv,{size:16})})]})]}):B.jsxs(B.Fragment,{children:[B.jsxs("div",{className:"flex items-center gap-3",children:[B.jsx("div",{className:`w-8 h-8 rounded flex items-center justify-center text-sm text-white shrink-0 ${m.chartColor.replace("text","bg")}`,children:m.icon}),B.jsx("span",{className:"text-sm font-medium text-gray-800",children:m.name})]}),B.jsxs("div",{className:"flex gap-1",children:[B.jsx("button",{onClick:()=>l(m),className:"p-1 text-gray-400 hover:text-blue-600 rounded-md hover:bg-blue-50 transition-colors",children:B.jsx(L_,{size:16})}),B.jsx("button",{onClick:()=>d(m.id),className:"p-1 text-gray-400 hover:text-red-600 rounded-md hover:bg-red-50 transition-colors",children:B.jsx(V_,{size:16})})]})]})},m.id))}),t.length===0&&B.jsx("p",{className:"text-sm text-gray-400 text-center py-4",children:" ."})]})]})]})}):null},JW=()=>{const{toast:r}=ka();if(!r.show)return null;const e={success:"bg-green-500",error:"bg-red-500",info:"bg-blue-500",warning:"bg-yellow-500"};return B.jsx("div",{className:"fixed bottom-20 left-1/2 transform -translate-x-1/2 z-[100] animate-in slide-in-from-bottom-5 duration-300",children:B.jsx("div",{className:`${e[r.type]} text-white px-5 py-3 rounded-xl shadow-lg flex items-center gap-3 min-w-[250px] max-w-md`,children:B.jsx("span",{className:"text-sm font-medium",children:r.message})})})};function ZW(){const{activeTab:r}=ka(),{openCreateModal:e}=nf(),t=()=>{switch(r){case"home":return B.jsx(lA,{});case"ledger":return B.jsx(GL,{});case"stats":return B.jsx(qL,{});case"settings":return B.jsx(WW,{});default:return B.jsx(lA,{})}};return B.jsx("div",{className:"flex justify-center bg-gray-100 min-h-screen",children:B.jsxs("div",{className:"w-full md:max-w-4xl md:mx-auto md:my-4 md:rounded-[2.5rem] bg-white shadow-2xl flex flex-col h-screen md:h-[95vh] overflow-hidden relative transition-all duration-300",children:[B.jsx(zL,{}),B.jsx("main",{className:"flex-1 overflow-hidden bg-gray-50 flex flex-col relative",children:t()}),B.jsx(jL,{}),B.jsx("div",{className:"absolute bottom-24 md:bottom-28 right-6 z-20",children:B.jsx("button",{onClick:e,className:"bg-blue-600 hover:bg-blue-700 text-white p-4 rounded-full shadow-xl shadow-blue-600/40 transition-transform active:scale-95 flex items-center justify-center",children:B.jsx(AL,{size:28,strokeWidth:3})})}),B.jsx(YW,{}),B.jsx(QW,{}),B.jsx(JW,{})]})})}const eY=({onSignIn:r,error:e})=>B.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100",children:B.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 w-full max-w-md mx-4",children:[B.jsxs("div",{className:"text-center mb-8",children:[B.jsx("div",{className:"text-6xl mb-4",children:""}),B.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"SmartSpend"}),B.jsx("p",{className:"text-gray-500",children:"  "})]}),e&&B.jsx("div",{className:"bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded-lg mb-6 text-sm",children:e}),B.jsxs("button",{onClick:r,className:"w-full flex items-center justify-center gap-3 bg-white border-2 border-gray-200 hover:border-gray-300 hover:bg-gray-50 text-gray-700 font-medium py-3 px-4 rounded-xl transition-all duration-200",children:[B.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[B.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),B.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),B.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),B.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Google "]}),B.jsx("p",{className:"text-center text-xs text-gray-400 mt-6",children:"    "})]})}),tY=({message:r=" ..."})=>B.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gray-50",children:[B.jsx("div",{className:"relative",children:B.jsx("div",{className:"w-12 h-12 border-4 border-blue-200 rounded-full animate-spin border-t-blue-500"})}),r&&B.jsx("p",{className:"mt-4 text-gray-500 text-sm",children:r})]});function rY(){const{user:r,loading:e,error:t,signIn:n}=Qk();return e?B.jsx(tY,{message:"  ..."}):r?B.jsx(J9,{userId:r.uid,children:B.jsx(ZW,{})}):B.jsx(eY,{onSignIn:n,error:t})}const nY=document.getElementById("root"),aY=eN.createRoot(nY);aY.render(B.jsx(Qe.StrictMode,{children:B.jsx(rY,{})}));
